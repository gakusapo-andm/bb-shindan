<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>採用ブラックボックス診断 | Gakusapo</title>
  
  <!-- ============================================================ -->
  <!-- v41: PDF出力ズレ修正 - table→flex, translateY→lineHeight, arbitrary値→inline -->
  <!-- ============================================================ -->
  <script>
    // 事前問診リダイレクト: ?id= パラメータ付きアクセスはcustomer/に転送
    (function() {
      var params = new URLSearchParams(window.location.search);
      if (params.get('id') && !window.location.pathname.includes('/customer')) {
        var newUrl = window.location.pathname.replace(/\/?$/, '/') + 'customer/?id=' + encodeURIComponent(params.get('id'));
        window.location.replace(newUrl);
        return;
      }
    })();
  </script>
  <script>
    // ★★★ 設定値 ★★★
    window.GAS_CONFIG = {
      enabled: true,
      currentUser: '',
      userEmail: '',
      userName: '',
      memberName: '',
      studentId: '',
      gasUrl: 'https://script.google.com/macros/s/AKfycbzyK8KteasB6HSFE-XO338ePEVgHcnHxdLUd8rH4b2MSitkLrk3HH_o1vPts1FxnbTZjg/exec',
      deploymentMode: 'standalone',
      permissions: []
    };
    
    // ★★★ Google OAuthクライアントID ★★★
    window.OAUTH_CONFIG = {
      clientId: '620212859862-7b25gilu0v1skqu6fpo8ovqb50s01nal.apps.googleusercontent.com'
    };
    
    // 認証状態管理
    window.AUTH = {
      idToken: null,
      user: null,
      isLoggedIn: false
    };
  </script>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Google Sign-In (v34) -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700;900&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
/**
 * ============================================
 * 採用ブラックボックス診断システム - スタイルシート
 * Gakusapo Recruitment Black Box Diagnosis System
 * ============================================
 * 
 * 目次:
 * 1. ベーススタイル
 * 2. ユーティリティクラス
 * 3. 診断シート
 * 4. ランクバッジ
 * 5. UIコンポーネント
 * 6. フォーム要素
 * 7. 顧客リスト
 * 8. アニメーション
 * 9. 印刷用スタイル
 */

/* ============================================
   1. ベーススタイル
   ============================================ */

* {
  font-family: 'Noto Sans JP', sans-serif;
  box-sizing: border-box;
}

body {
  background: linear-gradient(145deg, #f0f4f8 0%, #e2e8f0 50%, #f0f4f8 100%);
  min-height: 100vh;
  margin: 0;
  padding: 0;
}

/* ============================================
   2. ユーティリティクラス
   ============================================ */

/* Outfitフォント（数字用） */
.font-outfit { 
  font-family: 'Outfit', sans-serif; 
}

/* グラスモーフィズムカード */
.glass-card {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.8);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.06);
}

/* ============================================
   3. 診断シート
   ============================================ */

/* メイン診断シート */
.diagnosis-sheet {
  width: 1200px;
  min-height: 850px;
  background: #ffffff;
  position: relative;
  border-radius: 16px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
}

/* セクションカード */
.section-card {
  background: #ffffff;
  border: 1px solid #e8ecf0;
  border-radius: 16px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.03);
  overflow: visible;
}

/* セクションラベル */
.section-label {
  display: flex;
  align-items: center;
  font-size: 12px;
  color: #64748b;
  margin-bottom: 12px;
  height: 20px;
  line-height: 20px;
}

.section-label-dot {
  display: flex;
  align-items: center;
  width: 16px;
  padding-right: 8px;
  flex-shrink: 0;
}

.section-label-text {
  display: flex;
  align-items: center;
}

/* ============================================
   4. ランクバッジ
   ============================================ */

.rank-badge {
  font-family: 'Outfit', sans-serif;
  font-weight: 800;
  text-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

/* 各ランクのカラー */
.rank-s { 
  background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); 
  color: white; 
}

.rank-a { 
  background: linear-gradient(135deg, #34d399 0%, #10b981 100%); 
  color: white; 
}

.rank-b { 
  background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%); 
  color: white; 
}

.rank-c { 
  background: linear-gradient(135deg, #fb923c 0%, #f97316 100%); 
  color: white; 
}

.rank-d { 
  background: linear-gradient(135deg, #f87171 0%, #ef4444 100%); 
  color: white; 
}

/* ============================================
   5. UIコンポーネント
   ============================================ */

/* タイプダイヤモンドアイコン */
.type-diamond {
  width: 64px;
  height: 64px;
  position: relative;
}

/* スコアバー */
.score-bar-track {
  height: 12px;
  background: linear-gradient(90deg, #f1f5f9 0%, #e2e8f0 100%);
  border-radius: 6px;
  overflow: hidden;
  position: relative;
}

.score-bar-fill {
  height: 100%;
  border-radius: 6px;
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

/* タブバー */
.tab-bar {
  display: flex;
  background: #f8fafc;
  border-top: 1px solid #e2e8f0;
}

.tab-item {
  flex: 1;
  padding: 14px 16px 10px;
  text-align: center;
  font-size: 13px;
  font-weight: 500;
  color: #64748b;
  cursor: pointer;
  border-right: 1px solid #e2e8f0;
  transition: all 0.2s;
  position: relative;
}

.tab-item:last-child { 
  border-right: none; 
}

.tab-item.active {
  background: #ffffff;
  color: #1e40af;
  font-weight: 600;
  position: relative;
}

.tab-active-bar {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, #3b82f6, #6366f1);
}

/* ============================================
   サイドバナーボタン
   ============================================ */
.side-banner-container {
  position: fixed;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  z-index: 40;
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding-right: 0;
}

.side-banner-btn {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  padding: 20px 14px;
  font-size: 15px;
  font-weight: 600;
  letter-spacing: 0.1em;
  color: #3b82f6;
  background: white;
  border: 2px solid #3b82f6;
  border-right: none;
  border-radius: 12px 0 0 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: -2px 2px 8px rgba(59, 130, 246, 0.15);
  min-height: 100px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.side-banner-btn:hover {
  background: #3b82f6;
  color: white;
  transform: translateX(-4px);
  box-shadow: -4px 4px 16px rgba(59, 130, 246, 0.3);
}

.side-banner-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.side-banner-btn:active:not(:disabled) {
  transform: translateX(-2px) scale(0.96);
  filter: brightness(0.9);
}

.side-banner-btn:disabled:hover {
  background: white;
  color: #3b82f6;
}

/* Pro診断ボタン - プレミアムスタイル */
.side-banner-btn.pro-btn {
  background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 50%, #1e40af 100%);
  color: white;
  border: none;
  box-shadow: -4px 4px 20px rgba(59, 130, 246, 0.4);
  position: relative;
  overflow: hidden;
}

.side-banner-btn.pro-btn::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    45deg,
    transparent 30%,
    rgba(255, 255, 255, 0.1) 50%,
    transparent 70%
  );
  animation: pro-shine 3s ease-in-out infinite;
}

@keyframes pro-shine {
  0% { transform: translateX(-100%) rotate(45deg); }
  100% { transform: translateX(100%) rotate(45deg); }
}

.side-banner-btn.pro-btn:hover {
  background: linear-gradient(135deg, #2563eb 0%, #1e40af 50%, #1e3a8a 100%);
  transform: translateX(-6px);
  box-shadow: -6px 6px 30px rgba(59, 130, 246, 0.5);
}

.side-banner-btn.pro-btn:disabled {
  opacity: 0.6;
}

.side-banner-btn.pro-btn:disabled:hover {
  background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 50%, #1e40af 100%);
  color: white;
}

/* AI生成ローディングオーバーレイ */
.ai-loading-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(4px);
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: center;
}

.ai-loading-card {
  background: white;
  border-radius: 24px;
  padding: 48px 64px;
  text-align: center;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  max-width: 420px;
  min-width: 320px;
}

.ai-loading-spinner {
  width: 64px;
  height: 64px;
  border: 4px solid #e5e7eb;
  border-top-color: #3b82f6;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 24px;
}

.ai-loading-progress {
  width: 100%;
  height: 6px;
  background: #e5e7eb;
  border-radius: 3px;
  overflow: hidden;
  margin-top: 24px;
  position: relative;
}

.ai-loading-progress-bar {
  height: 100%;
  background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899, #8b5cf6, #3b82f6);
  background-size: 300% 100%;
  border-radius: 3px;
  animation: progress-shimmer 2s ease-in-out infinite, progress-grow 8s ease-out forwards;
}

@keyframes progress-shimmer {
  0% { background-position: 100% 0; }
  100% { background-position: -100% 0; }
}

@keyframes progress-grow {
  0% { width: 0%; }
  10% { width: 15%; }
  30% { width: 40%; }
  50% { width: 55%; }
  70% { width: 70%; }
  85% { width: 82%; }
  95% { width: 90%; }
  100% { width: 95%; }
}

/* ドットアニメーション */
.ai-loading-dots {
  display: inline-flex;
  gap: 4px;
  margin-left: 2px;
}

.ai-loading-dots span {
  width: 4px;
  height: 4px;
  background: #6b7280;
  border-radius: 50%;
  animation: dot-bounce 1.4s ease-in-out infinite;
}

.ai-loading-dots span:nth-child(1) { animation-delay: 0s; }
.ai-loading-dots span:nth-child(2) { animation-delay: 0.2s; }
.ai-loading-dots span:nth-child(3) { animation-delay: 0.4s; }

@keyframes dot-bounce {
  0%, 80%, 100% { 
    transform: translateY(0);
    opacity: 0.4;
  }
  40% { 
    transform: translateY(-6px);
    opacity: 1;
  }
}

/* ステータステキストのフェードアニメーション */
.ai-loading-status {
  animation: fade-pulse 2s ease-in-out infinite;
}

@keyframes fade-pulse {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

@media print {
  .side-banner-container {
    display: none !important;
  }
}

/* ファネルチャート */
.funnel-layer {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  color: white;
  font-size: 11px;
  font-weight: 600;
  border-radius: 4px;
  padding: 0 12px;
  position: relative;
  transition: transform 0.2s;
}

.funnel-layer:hover {
  transform: scale(1.02);
}

/* レジェンド */
.legend-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-top: 10px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 10px;
  color: #64748b;
}

.legend-dot {
  width: 10px;
  height: 10px;
  border-radius: 3px;
}

/* 比較フレーム（Before/After） */
.compare-frame {
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  overflow: hidden;
  background: #fafbfc;
}

.compare-frame.before {
  border-color: #fca5a5;
  background: linear-gradient(180deg, #fef2f2 0%, #ffffff 100%);
}

.compare-frame.after {
  border-color: #86efac;
  background: linear-gradient(180deg, #f0fdf4 0%, #ffffff 100%);
}

/* ============================================
   6. フォーム要素
   ============================================ */

/* スライダー */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  height: 8px;
  background: #e2e8f0;
  border-radius: 4px;
  outline: none;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);
}

input[type="range"]::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);
  border: none;
}

/* ============================================
   7. 顧客リスト
   ============================================ */

.customer-item {
  padding: 14px;
  border: 1px solid #e2e8f0;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.2s;
}

.customer-item:hover {
  background: #f8fafc;
  transform: translateX(4px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.04);
}

.customer-item.selected {
  border-color: #3b82f6;
  background: linear-gradient(135deg, #eff6ff 0%, #ffffff 100%);
}

/* ============================================
   8. アニメーション
   ============================================ */

/* フェードインアップ */
@keyframes fadeInUp {
  from { 
    opacity: 0; 
    transform: translateY(20px); 
  }
  to { 
    opacity: 1; 
    transform: translateY(0); 
  }
}

.animate-in {
  animation: fadeInUp 0.5s ease-out forwards;
}

/* 深層バー（シマー効果） */
.depth-bar {
  position: relative;
  overflow: hidden;
}

.depth-bar::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

/* ============================================
   9. PDF出力用スタイル
   ============================================ */

.pdf-export-mode {
  overflow: visible !important;
}

.pdf-export-mode * {
  overflow: visible !important;
  text-rendering: geometricPrecision;
  -webkit-font-smoothing: antialiased;
}

.pdf-export-mode canvas {
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}

/* PDF出力時のテキスト間隔 */
.pdf-export-mode .text-xs {
  letter-spacing: 0.05em;
}

/* レジェンド用フレックスレイアウト */
.legend-item-inline {
  display: inline-flex;
  align-items: center;
  vertical-align: middle;
}

.legend-dot-cell {
  display: flex;
  align-items: center;
  padding-right: 4px;
}

.legend-text-cell {
  display: flex;
  align-items: center;
}

/* PDF出力時: 左カラムの2カードを1カードに見せて右カラムと境界を揃える */
.pdf-export-mode .col-span-5.flex.flex-col.gap-4 {
  gap: 0 !important;
}

.pdf-export-mode .col-span-5.flex.flex-col .section-card:first-child {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
  border-bottom: 1px solid #e5e7eb;
  box-shadow: none;
}

.pdf-export-mode .col-span-5.flex.flex-col .section-card:last-child {
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  box-shadow: none;
}

/* PDF出力時: section-label/legendは既にflexboxのため追加修正不要 */

/* ============================================
   10. 印刷用スタイル
   ============================================ */

@media print {
  .no-print { 
    display: none !important; 
  }
  
  body { 
    background: white; 
  }
  
  .diagnosis-sheet {
    box-shadow: none;
  }
}

/* ============================================
 * ボタンフィードバック改善
 * ============================================ */

/* ① 全ボタン共通: クリック時の押し込みアニメーション */
button:not(:disabled):active {
  transform: scale(0.96);
  filter: brightness(0.92);
  transition: transform 0.08s ease, filter 0.08s ease;
}

/* リップルエフェクト */
.btn-ripple {
  position: relative;
  overflow: hidden;
}
.btn-ripple::after {
  content: '';
  position: absolute;
  top: 50%; left: 50%;
  width: 0; height: 0;
  background: rgba(255,255,255,0.3);
  border-radius: 50%;
  transform: translate(-50%, -50%);
  transition: width 0.4s ease, height 0.4s ease, opacity 0.4s ease;
  opacity: 0;
  pointer-events: none;
}
.btn-ripple:active::after {
  width: 300px; height: 300px;
  opacity: 1;
  transition: 0s;
}

/* ③ トースト通知アニメーション */
@keyframes toastSlideIn {
  from { transform: translateY(100%); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
@keyframes toastSlideOut {
  from { transform: translateY(0); opacity: 1; }
  to { transform: translateY(100%); opacity: 0; }
}
.toast-enter { animation: toastSlideIn 0.3s ease; }
.toast-exit { animation: toastSlideOut 0.3s ease forwards; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
/**
 * ============================================
 * 採用ブラックボックス診断システム
 * Gakusapo Recruitment Black Box Diagnosis System
 * ============================================
 * 
 * @version 2.0
 * @author Gakusapo
 * @description 企業の採用活動を8軸×3視点で多角的に分析する診断システム
 * 
 * 目次:
 * 1. 定数・設定
 *    - RANK_DEFINITIONS: S〜Dランク定義
 *    - DIAGNOSIS_TYPES: 6つの症例タイプ
 *    - EVALUATION_AXES: 6つの評価軸
 *    - MINDSET_AXES: マインドセット評価軸（5軸）
 *    - PHASE_AXIS_WEIGHT: 3層（表層部・中層部・深層部）
 *    - INDUSTRY_CODES: 業種コード
 * 
 * 2. ユーティリティ
 *    - StorageManager: LocalStorage管理
 *    - InquiryNoManager: 問い合わせ番号生成
 *    - スコア計算関数群
 * 
 * 3. コンポーネント
 *    - DiamondIcon: タイプアイコン
 *    - TripleRadarChart: 3視点レーダーチャート
 *    - FunnelChart: ファネル図
 *    - DepthBars: 深度バー
 *    - PhonePreview: Before/Afterプレビュー
 *    - InputForm: 入力フォーム
 *    - CustomerDatabase: 顧客データベース
 *    - DiagnosisSheet: 診断シート
 *    - App: メインアプリケーション
 */

const { useState, useEffect, useRef, useCallback, forwardRef, useMemo } = React;

// ========================================
// デバッグ設定（本番環境ではfalseに設定）
// ========================================
const DEBUG_MODE = false; // デバッグモードの有効/無効

// デバッグ用ログ関数（本番環境では何もしない）
const debugLog = (...args) => {
  if (DEBUG_MODE) {
    console.log(...args);
  }
};

// ========================================
// ツールチップコンポーネント
// ========================================
const Tooltip = ({ children, content, position = 'top', maxWidth = 300 }) => {
  const [isVisible, setIsVisible] = useState(false);
  const [tooltipStyle, setTooltipStyle] = useState({});
  const triggerRef = useRef(null);
  const tooltipRef = useRef(null);
  
  const showTooltip = () => {
    if (!content) return;
    setIsVisible(true);
  };
  
  const hideTooltip = () => {
    setIsVisible(false);
  };
  
  useEffect(() => {
    if (isVisible && triggerRef.current && tooltipRef.current) {
      const triggerRect = triggerRef.current.getBoundingClientRect();
      const tooltipRect = tooltipRef.current.getBoundingClientRect();
      const scrollY = window.scrollY;
      const scrollX = window.scrollX;
      
      let top, left;
      
      switch (position) {
        case 'bottom':
          top = triggerRect.bottom + scrollY + 8;
          left = triggerRect.left + scrollX + (triggerRect.width / 2) - (tooltipRect.width / 2);
          break;
        case 'left':
          top = triggerRect.top + scrollY + (triggerRect.height / 2) - (tooltipRect.height / 2);
          left = triggerRect.left + scrollX - tooltipRect.width - 8;
          break;
        case 'right':
          top = triggerRect.top + scrollY + (triggerRect.height / 2) - (tooltipRect.height / 2);
          left = triggerRect.right + scrollX + 8;
          break;
        default: // top
          top = triggerRect.top + scrollY - tooltipRect.height - 8;
          left = triggerRect.left + scrollX + (triggerRect.width / 2) - (tooltipRect.width / 2);
      }
      
      // 画面端からはみ出ないように調整
      if (left < 10) left = 10;
      if (left + tooltipRect.width > window.innerWidth - 10) {
        left = window.innerWidth - tooltipRect.width - 10;
      }
      
      setTooltipStyle({ top, left, maxWidth });
    }
  }, [isVisible, position, maxWidth]);
  
  if (!content) {
    return children;
  }
  
  return (
    <span className="relative inline-flex items-center">
      <span
        ref={triggerRef}
        onMouseEnter={showTooltip}
        onMouseLeave={hideTooltip}
        onFocus={showTooltip}
        onBlur={hideTooltip}
        className="cursor-help border-b border-dashed border-gray-400"
      >
        {children}
      </span>
      {isVisible && (
        <div
          ref={tooltipRef}
          style={tooltipStyle}
          className="fixed z-[9999] px-3 py-2 text-xs text-white bg-gray-800 rounded-lg shadow-lg whitespace-pre-line"
        >
          {content}
          <div className={`absolute w-2 h-2 bg-gray-800 transform rotate-45 ${
            position === 'bottom' ? '-top-1 left-1/2 -translate-x-1/2' :
            position === 'left' ? 'top-1/2 -right-1 -translate-y-1/2' :
            position === 'right' ? 'top-1/2 -left-1 -translate-y-1/2' :
            '-bottom-1 left-1/2 -translate-x-1/2'
          }`} />
        </div>
      )}
    </span>
  );
};

// 情報アイコン付きツールチップ
const InfoTooltip = ({ content, position = 'top' }) => {
  if (!content) return null;
  
  return (
    <Tooltip content={content} position={position}>
      <span className="inline-flex items-center justify-center w-4 h-4 ml-1 text-[10px] text-gray-400 hover:text-blue-500 rounded-full border border-gray-300 hover:border-blue-400 transition cursor-help">
        ?
      </span>
    </Tooltip>
  );
};

// ========================================
// 定数・設定（新仕様）
// ========================================

// 【inventory 4-5】S〜Dランク定義（S:80〜, A:65〜, B:50〜, C:35〜, D:0〜34）
const RANK_DEFINITIONS = {
  S: { 
    name: '採用マスター', 
    minScore: 80,
    color: '#f59e0b',
    gradient: 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)',
    description: '経営・現場・学生が三位一体。東海エリアで 「一人勝ち」 できる組織OS。',
    salesTalk: '東海エリアの採用の鏡です。次は『母集団の質』の極限化を狙いましょう。'
  },
  A: { 
    name: '優良ホワイト', 
    minScore: 65,
    color: '#10b981',
    gradient: 'linear-gradient(135deg, #34d399 0%, #10b981 100%)',
    description: '手法は正しいが、上層部と現場の微細なズレ（摩擦）で数%のロスが発生している。',
    salesTalk: '非常に高い水準です。あと少し『学生への翻訳』を磨くだけでSランクに届きます。'
  },
  B: { 
    name: '隠れブラックボックス', 
    minScore: 45,
    color: '#3b82f6',
    gradient: 'linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%)',
    description: '中身はS級なのに、見せ方の不備でB判定。これほど 『もったいない』 ことはありません。',
    salesTalk: '中身はS級なのに、見せ方の不備でB判定。これほど『もったいない』ことはありません。'
  },
  C: { 
    name: 'ザル採用（要改善）', 
    minScore: 20,
    color: '#f97316',
    gradient: 'linear-gradient(135deg, #fb923c 0%, #f97316 100%)',
    description: '穴の空いたバケツに水を注いでいます。手法以前に、組織のOSを書き換える必要があります。',
    salesTalk: '穴の空いたバケツに水を注いでいます。手法以前に、組織のOSを書き換える必要があります。'
  },
  D: { 
    name: '危険ライン', 
    minScore: 0,
    color: '#ef4444',
    gradient: 'linear-gradient(135deg, #f87171 0%, #ef4444 100%)',
    description: '組織全体で採用を見直す必要があります。採用すればするほど会社の評判が落ちる可能性すらあります。',
    salesTalk: '今のままでは採用すればするほど会社の評判が落ちます。根本からのカイゼンが必須です。'
  }
};

// 【inventory 4-4】6つの症例タイプ
const DIAGNOSIS_TYPES = {
  'stealth-ghost': {
    name: 'ステルス・ゴースト',
    subname: '透明人間型',
    description: 'ネット上に生存証明がない。学生から 「存在しない会社」 扱い。',
    color: '#6b7280',
    gradient: 'linear-gradient(135deg, #9ca3af 0%, #6b7280 100%)',
    weakness: '認知到達力'
  },
  'passion-mismatch': {
    name: '情熱の空回りドン・キホーテ',
    subname: '押し売り型',
    description: '社長の熱意はあるが、学生が知りたい条件がない。 「熱い」 だけでは選ばれない。',
    color: '#f59e0b',
    gradient: 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)',
    weakness: '具体性スコア'
  },
  'diamond-rough': {
    name: 'ダイヤモンドの原石',
    subname: '磨けば光る型',
    description: '強みはあるが、証明・差別化が足りない。 「なぜこの会社か」 を裏付けできていない。',
    color: '#06b6d4',
    gradient: 'linear-gradient(135deg, #22d3ee 0%, #06b6d4 100%)',
    weakness: '差別化力'
  },
  'future-blind': {
    name: '今だけ企業',
    subname: '将来像不在型',
    description: 'キャリアパスや会社の想いが見えない。 「ここで働きたい」 と思わせられていない。',
    color: '#14b8a6',
    gradient: 'linear-gradient(135deg, #2dd4bf 0%, #14b8a6 100%)',
    weakness: '共感・ビジョン力'
  },
  'selection-maze': {
    name: '選考迷路',
    subname: 'UX崩壊型',
    description: '応募のハードルが高すぎる。連絡が遅い。学生に無駄なストレスを与えている。',
    color: '#f43f5e',
    gradient: 'linear-gradient(135deg, #fb7185 0%, #f43f5e 100%)',
    weakness: '選考UX'
  },
  'closing-weak': {
    name: 'あと一歩企業',
    subname: 'クロージング弱者型',
    description: '内定までは行くが承諾されない。最後の一押しで競合に負けている。',
    color: '#84cc16',
    gradient: 'linear-gradient(135deg, #a3e635 0%, #84cc16 100%)',
    weakness: '対話力'
  }
};

// ========================================
// 業種×人数規模×地域別 歩留まり率平均値マスターデータ
// ========================================
// 
// 【編集方法】
// このBASE_YIELD_DATAオブジェクトを編集することで、
// 業種・人数規模ごとの歩留まり率平均値を変更できます。
// CSVインポート/エクスポート機能も利用可能です。
//
// 構造: BASE_YIELD_DATA[業種キー][人数規模キー] = {
//   awarenessToInterest: 認知→興味の歩留まり率(%),
//   interestToApplication: 興味→応募の歩留まり率(%),
//   applicationToScreening: 応募→選考の歩留まり率(%),
//   screeningToOffer: 選考→内定の歩留まり率(%),
//   offerToAcceptance: 内々定→承諾の歩留まり率(%)
// }
//

// 地域リスト
const REGION_LIST = [
  { key: 'aichi', label: '愛知県' },
  { key: 'gifu', label: '岐阜県' },
  { key: 'mie', label: '三重県' },
  { key: 'shizuoka', label: '静岡県' }
];

const INDUSTRY_LIST = [
  { key: 'manufacturing_mono', label: '製造業（ものづくり）' },
  { key: 'manufacturing_food', label: '製造業（食品メーカー・その他）' },
  { key: 'it', label: 'IT・通信' },
  { key: 'finance', label: '金融・保険' },
  { key: 'retail', label: '小売・流通' },
  { key: 'service', label: 'サービス業' },
  { key: 'construction', label: '建設・不動産' },
  { key: 'medical', label: '医療・福祉' },
  { key: 'medical_qualified', label: '医療・福祉（資格職含む）' },
  { key: 'nursing', label: '介護・福祉' },
  { key: 'food', label: '飲食・宿泊' },
  { key: 'logistics', label: '運輸・物流' },
  { key: 'media', label: 'マスコミ・広告' },
  { key: 'consulting', label: 'コンサルティング' },
  { key: 'trading', label: '商社・卸売' },
  { key: 'other', label: 'その他' }
];

const COMPANY_SIZE_LIST = [
  { key: 'micro', label: '～30名' },
  { key: 'small', label: '31～100名' },
  { key: 'medium', label: '101～300名' },
  { key: 'large', label: '301～1000名' },
  { key: 'enterprise', label: '1001名以上' }
];

// 基本歩留まり率データ（地域補正前）
const BASE_YIELD_DATA = {
  manufacturing_mono: {
    micro:      { awarenessToInterest: 18, interestToApplication: 20, applicationToScreening: 22, screeningToOffer: 38, offerToAcceptance: 75 },
    small:      { awarenessToInterest: 20, interestToApplication: 22, applicationToScreening: 24, screeningToOffer: 40, offerToAcceptance: 78 },
    medium:     { awarenessToInterest: 22, interestToApplication: 25, applicationToScreening: 25, screeningToOffer: 42, offerToAcceptance: 80 },
    large:      { awarenessToInterest: 25, interestToApplication: 28, applicationToScreening: 28, screeningToOffer: 45, offerToAcceptance: 82 },
    enterprise: { awarenessToInterest: 28, interestToApplication: 30, applicationToScreening: 30, screeningToOffer: 48, offerToAcceptance: 85 }
  },
  manufacturing_food: {
    micro:      { awarenessToInterest: 20, interestToApplication: 22, applicationToScreening: 20, screeningToOffer: 36, offerToAcceptance: 72 },
    small:      { awarenessToInterest: 22, interestToApplication: 24, applicationToScreening: 22, screeningToOffer: 38, offerToAcceptance: 75 },
    medium:     { awarenessToInterest: 24, interestToApplication: 27, applicationToScreening: 24, screeningToOffer: 40, offerToAcceptance: 78 },
    large:      { awarenessToInterest: 27, interestToApplication: 30, applicationToScreening: 27, screeningToOffer: 43, offerToAcceptance: 80 },
    enterprise: { awarenessToInterest: 30, interestToApplication: 33, applicationToScreening: 30, screeningToOffer: 46, offerToAcceptance: 83 }
  },
  manufacturing: {
    micro:      { awarenessToInterest: 18, interestToApplication: 20, applicationToScreening: 22, screeningToOffer: 38, offerToAcceptance: 75 },
    small:      { awarenessToInterest: 20, interestToApplication: 22, applicationToScreening: 24, screeningToOffer: 40, offerToAcceptance: 78 },
    medium:     { awarenessToInterest: 22, interestToApplication: 25, applicationToScreening: 25, screeningToOffer: 42, offerToAcceptance: 80 },
    large:      { awarenessToInterest: 25, interestToApplication: 28, applicationToScreening: 28, screeningToOffer: 45, offerToAcceptance: 82 },
    enterprise: { awarenessToInterest: 28, interestToApplication: 30, applicationToScreening: 30, screeningToOffer: 48, offerToAcceptance: 85 }
  },
  it: {
    micro:      { awarenessToInterest: 25, interestToApplication: 28, applicationToScreening: 20, screeningToOffer: 35, offerToAcceptance: 65 },
    small:      { awarenessToInterest: 28, interestToApplication: 30, applicationToScreening: 22, screeningToOffer: 38, offerToAcceptance: 68 },
    medium:     { awarenessToInterest: 30, interestToApplication: 32, applicationToScreening: 25, screeningToOffer: 40, offerToAcceptance: 70 },
    large:      { awarenessToInterest: 32, interestToApplication: 35, applicationToScreening: 28, screeningToOffer: 43, offerToAcceptance: 72 },
    enterprise: { awarenessToInterest: 35, interestToApplication: 38, applicationToScreening: 30, screeningToOffer: 45, offerToAcceptance: 75 }
  },
  finance: {
    micro:      { awarenessToInterest: 15, interestToApplication: 18, applicationToScreening: 28, screeningToOffer: 45, offerToAcceptance: 85 },
    small:      { awarenessToInterest: 18, interestToApplication: 20, applicationToScreening: 30, screeningToOffer: 48, offerToAcceptance: 87 },
    medium:     { awarenessToInterest: 20, interestToApplication: 22, applicationToScreening: 32, screeningToOffer: 50, offerToAcceptance: 88 },
    large:      { awarenessToInterest: 22, interestToApplication: 25, applicationToScreening: 35, screeningToOffer: 52, offerToAcceptance: 90 },
    enterprise: { awarenessToInterest: 25, interestToApplication: 28, applicationToScreening: 38, screeningToOffer: 55, offerToAcceptance: 92 }
  },
  retail: {
    micro:      { awarenessToInterest: 20, interestToApplication: 22, applicationToScreening: 20, screeningToOffer: 35, offerToAcceptance: 70 },
    small:      { awarenessToInterest: 22, interestToApplication: 24, applicationToScreening: 22, screeningToOffer: 38, offerToAcceptance: 72 },
    medium:     { awarenessToInterest: 24, interestToApplication: 26, applicationToScreening: 24, screeningToOffer: 40, offerToAcceptance: 75 },
    large:      { awarenessToInterest: 26, interestToApplication: 28, applicationToScreening: 26, screeningToOffer: 42, offerToAcceptance: 78 },
    enterprise: { awarenessToInterest: 28, interestToApplication: 30, applicationToScreening: 28, screeningToOffer: 45, offerToAcceptance: 80 }
  },
  service: {
    micro:      { awarenessToInterest: 22, interestToApplication: 25, applicationToScreening: 22, screeningToOffer: 38, offerToAcceptance: 72 },
    small:      { awarenessToInterest: 24, interestToApplication: 27, applicationToScreening: 24, screeningToOffer: 40, offerToAcceptance: 75 },
    medium:     { awarenessToInterest: 26, interestToApplication: 29, applicationToScreening: 26, screeningToOffer: 42, offerToAcceptance: 77 },
    large:      { awarenessToInterest: 28, interestToApplication: 31, applicationToScreening: 28, screeningToOffer: 44, offerToAcceptance: 80 },
    enterprise: { awarenessToInterest: 30, interestToApplication: 33, applicationToScreening: 30, screeningToOffer: 46, offerToAcceptance: 82 }
  },
  construction: {
    micro:      { awarenessToInterest: 15, interestToApplication: 18, applicationToScreening: 25, screeningToOffer: 42, offerToAcceptance: 78 },
    small:      { awarenessToInterest: 17, interestToApplication: 20, applicationToScreening: 27, screeningToOffer: 44, offerToAcceptance: 80 },
    medium:     { awarenessToInterest: 19, interestToApplication: 22, applicationToScreening: 29, screeningToOffer: 46, offerToAcceptance: 82 },
    large:      { awarenessToInterest: 21, interestToApplication: 24, applicationToScreening: 31, screeningToOffer: 48, offerToAcceptance: 84 },
    enterprise: { awarenessToInterest: 23, interestToApplication: 26, applicationToScreening: 33, screeningToOffer: 50, offerToAcceptance: 86 }
  },
  medical: {
    micro:      { awarenessToInterest: 18, interestToApplication: 20, applicationToScreening: 30, screeningToOffer: 50, offerToAcceptance: 82 },
    small:      { awarenessToInterest: 20, interestToApplication: 22, applicationToScreening: 32, screeningToOffer: 52, offerToAcceptance: 84 },
    medium:     { awarenessToInterest: 22, interestToApplication: 24, applicationToScreening: 34, screeningToOffer: 54, offerToAcceptance: 86 },
    large:      { awarenessToInterest: 24, interestToApplication: 26, applicationToScreening: 36, screeningToOffer: 56, offerToAcceptance: 88 },
    enterprise: { awarenessToInterest: 26, interestToApplication: 28, applicationToScreening: 38, screeningToOffer: 58, offerToAcceptance: 90 }
  },
  medical_qualified: {
    micro:      { awarenessToInterest: 20, interestToApplication: 70, applicationToScreening: 80, screeningToOffer: 70, offerToAcceptance: 75 },
    small:      { awarenessToInterest: 25, interestToApplication: 72, applicationToScreening: 82, screeningToOffer: 72, offerToAcceptance: 77 },
    medium:     { awarenessToInterest: 30, interestToApplication: 74, applicationToScreening: 84, screeningToOffer: 74, offerToAcceptance: 79 },
    large:      { awarenessToInterest: 35, interestToApplication: 75, applicationToScreening: 85, screeningToOffer: 75, offerToAcceptance: 80 },
    enterprise: { awarenessToInterest: 40, interestToApplication: 70, applicationToScreening: 85, screeningToOffer: 70, offerToAcceptance: 75 }
  },
  nursing: {
    micro:      { awarenessToInterest: 10, interestToApplication: 15, applicationToScreening: 20, screeningToOffer: 70, offerToAcceptance: 25 },
    small:      { awarenessToInterest: 12, interestToApplication: 20, applicationToScreening: 25, screeningToOffer: 65, offerToAcceptance: 30 },
    medium:     { awarenessToInterest: 15, interestToApplication: 25, applicationToScreening: 30, screeningToOffer: 60, offerToAcceptance: 35 },
    large:      { awarenessToInterest: 18, interestToApplication: 30, applicationToScreening: 35, screeningToOffer: 55, offerToAcceptance: 40 },
    enterprise: { awarenessToInterest: 20, interestToApplication: 35, applicationToScreening: 40, screeningToOffer: 50, offerToAcceptance: 45 }
  },
  food: {
    micro:      { awarenessToInterest: 25, interestToApplication: 28, applicationToScreening: 18, screeningToOffer: 32, offerToAcceptance: 65 },
    small:      { awarenessToInterest: 27, interestToApplication: 30, applicationToScreening: 20, screeningToOffer: 35, offerToAcceptance: 68 },
    medium:     { awarenessToInterest: 29, interestToApplication: 32, applicationToScreening: 22, screeningToOffer: 38, offerToAcceptance: 70 },
    large:      { awarenessToInterest: 31, interestToApplication: 34, applicationToScreening: 24, screeningToOffer: 40, offerToAcceptance: 72 },
    enterprise: { awarenessToInterest: 33, interestToApplication: 36, applicationToScreening: 26, screeningToOffer: 42, offerToAcceptance: 75 }
  },
  logistics: {
    micro:      { awarenessToInterest: 16, interestToApplication: 18, applicationToScreening: 24, screeningToOffer: 40, offerToAcceptance: 76 },
    small:      { awarenessToInterest: 18, interestToApplication: 20, applicationToScreening: 26, screeningToOffer: 42, offerToAcceptance: 78 },
    medium:     { awarenessToInterest: 20, interestToApplication: 22, applicationToScreening: 28, screeningToOffer: 44, offerToAcceptance: 80 },
    large:      { awarenessToInterest: 22, interestToApplication: 24, applicationToScreening: 30, screeningToOffer: 46, offerToAcceptance: 82 },
    enterprise: { awarenessToInterest: 24, interestToApplication: 26, applicationToScreening: 32, screeningToOffer: 48, offerToAcceptance: 84 }
  },
  media: {
    micro:      { awarenessToInterest: 30, interestToApplication: 20, applicationToScreening: 15, screeningToOffer: 30, offerToAcceptance: 60 },
    small:      { awarenessToInterest: 32, interestToApplication: 22, applicationToScreening: 17, screeningToOffer: 32, offerToAcceptance: 62 },
    medium:     { awarenessToInterest: 34, interestToApplication: 24, applicationToScreening: 19, screeningToOffer: 34, offerToAcceptance: 65 },
    large:      { awarenessToInterest: 36, interestToApplication: 26, applicationToScreening: 21, screeningToOffer: 36, offerToAcceptance: 68 },
    enterprise: { awarenessToInterest: 38, interestToApplication: 28, applicationToScreening: 23, screeningToOffer: 38, offerToAcceptance: 70 }
  },
  consulting: {
    micro:      { awarenessToInterest: 28, interestToApplication: 25, applicationToScreening: 18, screeningToOffer: 35, offerToAcceptance: 62 },
    small:      { awarenessToInterest: 30, interestToApplication: 27, applicationToScreening: 20, screeningToOffer: 38, offerToAcceptance: 65 },
    medium:     { awarenessToInterest: 32, interestToApplication: 29, applicationToScreening: 22, screeningToOffer: 40, offerToAcceptance: 68 },
    large:      { awarenessToInterest: 34, interestToApplication: 31, applicationToScreening: 24, screeningToOffer: 42, offerToAcceptance: 70 },
    enterprise: { awarenessToInterest: 36, interestToApplication: 33, applicationToScreening: 26, screeningToOffer: 44, offerToAcceptance: 72 }
  },
  trading: {
    micro:      { awarenessToInterest: 22, interestToApplication: 24, applicationToScreening: 22, screeningToOffer: 38, offerToAcceptance: 74 },
    small:      { awarenessToInterest: 24, interestToApplication: 26, applicationToScreening: 24, screeningToOffer: 40, offerToAcceptance: 76 },
    medium:     { awarenessToInterest: 26, interestToApplication: 28, applicationToScreening: 26, screeningToOffer: 42, offerToAcceptance: 78 },
    large:      { awarenessToInterest: 28, interestToApplication: 30, applicationToScreening: 28, screeningToOffer: 44, offerToAcceptance: 80 },
    enterprise: { awarenessToInterest: 30, interestToApplication: 32, applicationToScreening: 30, screeningToOffer: 46, offerToAcceptance: 82 }
  },
  other: {
    micro:      { awarenessToInterest: 20, interestToApplication: 23, applicationToScreening: 23, screeningToOffer: 38, offerToAcceptance: 75 },
    small:      { awarenessToInterest: 22, interestToApplication: 25, applicationToScreening: 25, screeningToOffer: 40, offerToAcceptance: 77 },
    medium:     { awarenessToInterest: 24, interestToApplication: 27, applicationToScreening: 27, screeningToOffer: 42, offerToAcceptance: 80 },
    large:      { awarenessToInterest: 26, interestToApplication: 29, applicationToScreening: 29, screeningToOffer: 44, offerToAcceptance: 82 },
    enterprise: { awarenessToInterest: 28, interestToApplication: 31, applicationToScreening: 31, screeningToOffer: 46, offerToAcceptance: 85 }
  }
};

// 地域別補正係数（愛知を基準1.0として）
const REGION_COEFFICIENTS = {
  aichi:    { awarenessToInterest: 1.00, interestToApplication: 1.00, applicationToScreening: 1.00, screeningToOffer: 1.00, offerToAcceptance: 1.00 },
  gifu:     { awarenessToInterest: 0.95, interestToApplication: 0.93, applicationToScreening: 1.02, screeningToOffer: 1.05, offerToAcceptance: 1.02 },
  mie:      { awarenessToInterest: 0.92, interestToApplication: 0.90, applicationToScreening: 1.03, screeningToOffer: 1.08, offerToAcceptance: 1.05 },
  shizuoka: { awarenessToInterest: 0.98, interestToApplication: 0.96, applicationToScreening: 1.01, screeningToOffer: 1.03, offerToAcceptance: 1.01 }
};

// ========================================
// 採用手法カテゴリ別 歩留まり率補正係数
// ========================================
// BASE_YIELD_DATAは「ナビサイト」利用時の歩留まり率を基準（1.0）としています。
// 各採用手法カテゴリには固有の特性があり、歩留まり率が異なります。
// この係数をBASE_YIELD_DATAに乗算して手法別の業界平均値を算出します。
//
// 例: 製造業(micro)の認知→興味 = 18% がナビサイト基準
//   → ダイレクトリクルーティング: 18% × 1.40 = 25%
//   → インターンシップ: 18% × 1.80 = 32%

const DEFAULT_METHOD_CATEGORY_LIST = [
  { key: 'ナビサイト', label: 'ナビサイト', description: '広くリーチ、エントリー管理型' },
  { key: 'ダイレクトリクルーティング', label: 'ダイレクトリクルーティング', description: 'スカウト型、ターゲット絞り込み' },
  { key: '口コミ・情報サイト', label: '口コミ・情報サイト', description: '事前リサーチ済み候補者' },
  { key: '大学連携', label: '大学連携', description: '信頼ルート、推薦・キャリアセンター' },
  { key: '合同説明会', label: '合同説明会', description: '対面接点、広範囲の学生' },
  { key: '地域特化', label: '地域特化', description: '地元志向の学生にリーチ' },
  { key: 'SNS・動画', label: 'SNS・動画', description: '広範リーチ、潜在層への認知' },
  { key: '求人サイト', label: '求人サイト', description: 'Indeed等、検索型' },
  { key: '業界特化', label: '業界特化', description: '専門職・資格職向けサイト' },
  { key: 'インターンシップ', label: 'インターンシップ', description: '体験型、高エンゲージメント' },
  { key: 'その他', label: 'その他（リファラル等）', description: '紹介・口コミ・自社説明会等' }
];

// 手法カテゴリ一覧を動的に取得（スプレッドシートのデータを優先し、未知のカテゴリも自動追加）
const getMethodCategoryList = () => {
  const gasCategories = (typeof GASDataManager !== 'undefined') ? GASDataManager.getMethodCategories() : null;
  
  if (!gasCategories || gasCategories.length === 0) {
    return DEFAULT_METHOD_CATEGORY_LIST;
  }
  
  // デフォルトのdescriptionマップ
  const descMap = {};
  const labelMap = {};
  DEFAULT_METHOD_CATEGORY_LIST.forEach(item => {
    descMap[item.key] = item.description;
    labelMap[item.key] = item.label;
  });
  
  // GASカテゴリを元にリスト生成（出現順維持）
  const result = gasCategories.map(key => ({
    key: key,
    label: labelMap[key] || key,
    description: descMap[key] || ''
  }));
  
  return result;
};

// 地域×業種×規模×手法カテゴリ別の歩留まり率を取得する関数
// 新構造: master[methodCategory][region][industry][size] = yieldData
// 旧構造（後方互換）: master[region][industry][size] = yieldData
const getYieldData = (region, industry, size, customYieldMaster, methodCategory) => {
  // 日本語→英語キーのマッピング（GAS側と同じ）
  const regionMap = {
    '愛知県': 'aichi', '愛知': 'aichi', 'aichi': 'aichi',
    '岐阜県': 'gifu', '岐阜': 'gifu', 'gifu': 'gifu',
    '三重県': 'mie', '三重': 'mie', 'mie': 'mie',
    '静岡県': 'shizuoka', '静岡': 'shizuoka', 'shizuoka': 'shizuoka',
    '東京都': 'tokyo', '東京': 'tokyo', 'tokyo': 'tokyo',
    '大阪府': 'osaka', '大阪': 'osaka', 'osaka': 'osaka',
    'その他': 'other', 'other': 'other'
  };
  
  const industryMap = {
    '製造業（ものづくり）': 'manufacturing_mono', 'manufacturing_mono': 'manufacturing_mono',
    '製造業（食品メーカー・その他）': 'manufacturing_food', 'manufacturing_food': 'manufacturing_food',
    '製造業': 'manufacturing', 'manufacturing': 'manufacturing',
    'IT・通信': 'it', 'IT': 'it', 'it': 'it',
    '金融・保険': 'finance', '金融': 'finance', 'finance': 'finance',
    '小売・流通': 'retail', '小売': 'retail', 'retail': 'retail',
    'サービス業': 'service', 'サービス': 'service', 'service': 'service',
    '建設・不動産': 'construction', '建設': 'construction', 'construction': 'construction',
    '医療・福祉': 'medical', '医療': 'medical', 'medical': 'medical',
    '医療・福祉（資格職含む）': 'medical_qualified', 'medical_qualified': 'medical_qualified',
    '介護・福祉': 'nursing', '介護': 'nursing', 'nursing': 'nursing',
    '飲食・宿泊': 'food', '飲食': 'food', 'food': 'food',
    '運輸・物流': 'logistics', '運輸': 'logistics', 'logistics': 'logistics',
    'マスコミ・広告': 'media', 'マスコミ': 'media', 'media': 'media',
    '教育': 'education', 'education': 'education',
    '官公庁・公社': 'government', '官公庁': 'government', 'government': 'government',
    'その他': 'other', 'other': 'other'
  };
  
  const sizeMap = {
    '～30名': 'micro', '〜30名': 'micro', '~30名': 'micro',
    '1～30名': 'micro', '1〜30名': 'micro', '1~30名': 'micro',
    '30名以下': 'micro', 'micro': 'micro',
    '31～100名': 'small', '31〜100名': 'small', '31~100名': 'small',
    'small': 'small',
    '101～300名': 'medium', '101〜300名': 'medium', '101~300名': 'medium',
    'medium': 'medium',
    '301～1000名': 'large', '301〜1000名': 'large', '301~1000名': 'large',
    'large': 'large',
    '1001名以上': 'enterprise', '1000名以上': 'enterprise',
    '1001～名': 'enterprise', '1001〜名': 'enterprise', '1001~名': 'enterprise',
    'enterprise': 'enterprise'
  };
  
  const regionKey = regionMap[region] || region?.toLowerCase() || region || '';
  const industryKey = industryMap[industry] || industry || '';
  const sizeKey = sizeMap[size] || size || '';
  const method = methodCategory || 'ナビサイト';
  
  const yieldMaster = customYieldMaster || (typeof GASDataManager !== 'undefined' ? GASDataManager.getYieldMaster() : null);
  
  if (yieldMaster) {
    // 新4次元構造判定: トップレベルキーが手法カテゴリ名かどうか
    const topKeys = Object.keys(yieldMaster);
    const knownRegions = new Set(['aichi', 'gifu', 'mie', 'shizuoka', 'tokyo', 'osaka', 'other']);
    const isNew4D = topKeys.length > 0 && !topKeys.some(k => knownRegions.has(k));
    
    if (isNew4D) {
      // 新構造: master[methodCategory][region][industry][size]
      // 1. 指定手法 × 地域 × 業種 × 規模
      if (yieldMaster[method]?.[regionKey]?.[industryKey]?.[sizeKey]) {
        return yieldMaster[method][regionKey][industryKey][sizeKey];
      }
      // 2. 指定手法 × 業種 × 規模（地域なし）
      if (yieldMaster[method]?.[industryKey]?.[sizeKey]) {
        return yieldMaster[method][industryKey][sizeKey];
      }
      // 3. ナビサイトにフォールバック × 地域 × 業種 × 規模
      if (method !== 'ナビサイト') {
        if (yieldMaster['ナビサイト']?.[regionKey]?.[industryKey]?.[sizeKey]) {
          return yieldMaster['ナビサイト'][regionKey][industryKey][sizeKey];
        }
        if (yieldMaster['ナビサイト']?.[industryKey]?.[sizeKey]) {
          return yieldMaster['ナビサイト'][industryKey][sizeKey];
        }
      }
    } else {
      // 旧3次元構造（後方互換）: master[region][industry][size]
      if (yieldMaster[regionKey]?.[industryKey]?.[sizeKey]) {
        return yieldMaster[regionKey][industryKey][sizeKey];
      }
      if (yieldMaster[industryKey]?.[sizeKey]) {
        return yieldMaster[industryKey][sizeKey];
      }
    }
  }
  
  // フォールバック: ハードコードBASE_YIELD_DATA + 地域補正
  const baseData = BASE_YIELD_DATA[industryKey]?.[sizeKey];
  const coef = REGION_COEFFICIENTS[regionKey] || REGION_COEFFICIENTS.aichi;
  
  if (!baseData) return null;
  
  return {
    awarenessToInterest: Math.round(baseData.awarenessToInterest * coef.awarenessToInterest),
    interestToApplication: Math.round(baseData.interestToApplication * coef.interestToApplication),
    applicationToScreening: Math.round(baseData.applicationToScreening * coef.applicationToScreening),
    screeningToOffer: Math.round(baseData.screeningToOffer * coef.screeningToOffer),
    offerToAcceptance: Math.round(baseData.offerToAcceptance * coef.offerToAcceptance)
  };
};

// ========================================
// 学生マトリクス（ターゲット学生属性）A〜H層
// ========================================
const STUDENT_MATRIX = {
  A: {
    label: 'A層',
    name: '上位・理系',
    description: 'アカデミック・エリート（名大・名工大院生等）',
    color: '#3b82f6',
    characteristics: '研究第一、ナビサイト不使用、教授推薦・技術マッチング'
  },
  B: {
    label: 'B層',
    name: '中堅・理系',
    description: '産業の屋台骨（名城大理工・愛工大等）',
    color: '#10b981',
    characteristics: '大手志向、学内説明会・キャリアセンター信頼'
  },
  C: {
    label: 'C層',
    name: '上位・文系',
    description: '意識高い系・東京志向（南山大・名大文系等）',
    color: '#8b5cf6',
    characteristics: 'コンサル・外資志望、Why重視、知的興奮を求める'
  },
  D: {
    label: 'D層',
    name: '中堅・文系',
    description: 'ボリュームゾーン・安定志向（愛大・中京大等）',
    color: '#f59e0b',
    characteristics: '大手病と不安の板挟み、ナビサイト大量登録'
  },
  E: {
    label: 'E層',
    name: '実務・理系',
    description: '現場・技術職志望（専門学校・中堅理工系）',
    color: '#06b6d4',
    characteristics: 'ES苦手、実技に自信、即戦力'
  },
  F: {
    label: 'F層',
    name: '地域・文系',
    description: '地元・安定志望（地域密着大学・短大）',
    color: '#ec4899',
    characteristics: '自己肯定感低め、活動開始遅い、安心感重視'
  },
  G: {
    label: 'G層',
    name: '福祉・介護・保育',
    description: 'エッセンシャルワーカー（日福大等）',
    color: '#14b8a6',
    characteristics: '実習が決定打、業界特化サイト利用'
  },
  H: {
    label: 'H層',
    name: '建築・施工管理',
    description: '現場監督・インフラ（建築学科・専門学校）',
    color: '#f43f5e',
    characteristics: '3Kイメージ払拭重視、条件シビア、動画メディア好む'
  }
};

// ========================================
// 採用手法・ツール一覧（デフォルト）
// ========================================
// 採用手法マスター（GASモードではスプレッドシートから取得）
// ※ スタンドアロンモードは廃止されました。GAS専用です。
const DEFAULT_RECRUITMENT_METHODS = {
  labbase: { name: 'LabBase（ラボベース）', category: 'ダイレクトリクルーティング', targetLayers: ['A'], description: '理系上位層向け、研究キーワードでスカウト', phaseMapping: { surface: 0.7, middle: 0.6, deep: 0.3 } },
  offerbox: { name: 'OfferBox', category: 'ダイレクトリクルーティング', targetLayers: ['A','B','C','D'], description: 'スカウト型、登録率高いがインフラ化', phaseMapping: { surface: 0.7, middle: 0.6, deep: 0.3 } },
  mynavi: { name: 'マイナビ', category: 'ナビサイト', targetLayers: ['B','C','D'], description: '大手エントリー管理用、中小は埋没リスク', phaseMapping: { surface: 1.0, middle: 0.2, deep: 0.0 } },
  rikunabi: { name: 'リクナビ', category: 'ナビサイト', targetLayers: ['B','C','D'], description: '大手エントリー管理用、中小は埋没リスク', phaseMapping: { surface: 1.0, middle: 0.2, deep: 0.0 } },
  onecareer: { name: 'One Career', category: '口コミ・情報サイト', targetLayers: ['C'], description: '上位校向け、選考攻略情報', phaseMapping: { surface: 0.6, middle: 0.8, deep: 0.3 } },
  openwork: { name: 'OpenWork', category: '口コミ・情報サイト', targetLayers: ['C','D'], description: '社員口コミ、ブラック企業排除用', phaseMapping: { surface: 0.6, middle: 0.8, deep: 0.3 } },
  wantedly: { name: 'Wantedly', category: '口コミ・情報サイト', targetLayers: ['C'], description: 'ビジョン重視層向け、ストーリー訴求', phaseMapping: { surface: 0.6, middle: 0.8, deep: 0.3 } },
  university_fair: { name: '学内企業説明会', category: '大学連携', targetLayers: ['B','D','F'], description: '大学主催、推薦枠獲得のチャンス', phaseMapping: { surface: 0.8, middle: 0.5, deep: 0.3 } },
  career_center: { name: 'キャリアセンター連携', category: '大学連携', targetLayers: ['B','E','F'], description: '大学公認の信頼獲得', phaseMapping: { surface: 0.8, middle: 0.5, deep: 0.3 } },
  professor_route: { name: '教授・研究室ルート', category: '大学連携', targetLayers: ['A','B'], description: '理系推薦、アナログ地上戦', phaseMapping: { surface: 0.8, middle: 0.5, deep: 0.3 } },
  mynavi_expo: { name: 'マイナビ合同説明会', category: '合同説明会', targetLayers: ['B','C','D','F'], description: 'マイナビ主催の大規模合説、多数の学生と接点', phaseMapping: { surface: 0.9, middle: 0.4, deep: 0.2 } },
  other_expo: { name: 'その他・合同説明会', category: '合同説明会', targetLayers: ['B','C','D','E','F'], description: '地域・業界特化型合説など', phaseMapping: { surface: 0.9, middle: 0.4, deep: 0.2 } },
  meidaisha: { name: '名大社（ジモト就職フェア）', category: '地域特化', targetLayers: ['D','F'], description: '東海圏特化、地元志向学生に強い', phaseMapping: { surface: 0.9, middle: 0.3, deep: 0.2 } },
  instagram: { name: 'Instagram', category: 'SNS・動画', targetLayers: ['D','F','H'], description: '職場雰囲気確認、アカウント必須', phaseMapping: { surface: 0.7, middle: 0.7, deep: 0.3 } },
  tiktok: { name: 'TikTok / YouTube Shorts', category: 'SNS・動画', targetLayers: ['E','H'], description: '15秒で給与・休日訴求、現場系に有効', phaseMapping: { surface: 0.7, middle: 0.7, deep: 0.3 } },
  youtube: { name: 'YouTube', category: 'SNS・動画', targetLayers: ['E','H'], description: '企業PR動画、技術解説', phaseMapping: { surface: 0.7, middle: 0.7, deep: 0.3 } },
  indeed: { name: 'Indeed', category: '求人サイト', targetLayers: ['E'], description: 'バイト探し延長、キーワード検索', phaseMapping: { surface: 0.9, middle: 0.2, deep: 0.1 } },
  medical_site: { name: 'コメディカルドットコム等', category: '業界特化', targetLayers: ['G'], description: '福祉・医療業界特化', phaseMapping: { surface: 0.8, middle: 0.4, deep: 0.2 } },
  qualification_school: { name: '資格予備校ルート', category: '業界特化', targetLayers: ['H'], description: '施工管理技士等の資格学校経由', phaseMapping: { surface: 0.8, middle: 0.4, deep: 0.2 } },
  internship_short: { name: '1dayインターンシップ', category: 'インターンシップ', targetLayers: ['B','C','D','F'], description: '短期体験、認知・興味喚起に有効', phaseMapping: { surface: 0.5, middle: 0.8, deep: 0.4 } },
  internship_long: { name: '長期インターンシップ（1週間以上）', category: 'インターンシップ', targetLayers: ['A','B','C','E'], description: '深い理解・信頼構築、内定直結型', phaseMapping: { surface: 0.3, middle: 1.0, deep: 0.7 } },
  practical_training: { name: '実習受け入れ', category: 'その他', targetLayers: ['G'], description: '福祉系は実習が決定打', phaseMapping: { surface: 0.3, middle: 1.0, deep: 0.7 } },
  referral: { name: '先輩・友人紹介（リファラル）', category: 'その他', targetLayers: ['F'], description: '口コミ、リアルな声が信頼される', phaseMapping: { surface: 0.4, middle: 0.6, deep: 0.8 } },
  company_briefing: { name: '自社説明会・オープンカンパニー', category: 'その他', targetLayers: ['B','C','D','F'], description: '直接対話で動機づけ', phaseMapping: { surface: 0.5, middle: 0.8, deep: 0.4 } }
};


// デフォルトのカテゴリ一覧
const DEFAULT_METHOD_CATEGORIES = [
  'ダイレクトリクルーティング',
  'ナビサイト', 
  '口コミ・情報サイト',
  '大学連携',
  '合同説明会',
  '地域特化',
  'SNS・動画',
  '求人サイト',
  '業界特化',
  'インターンシップ',
  'その他'
];

// methodMasterからフェーズマッピングを取得するヘルパー関数
// ※ GAS専用：スプレッドシートのmethodMasterから取得
const getMethodPhaseMapping = (methodMaster, methodKey) => {
  const method = methodMaster?.[methodKey];
  if (method?.phaseMapping) {
    return method.phaseMapping;
  }
  // methodMasterにない場合はデフォルト値を返す
  return { surface: 0.5, middle: 0.5, deep: 0.5 };
};

// ========================================
// 学生層別 媒体利用率マスター（デフォルト値）
// 各層が就活でどの媒体をどのくらい活用しているか（%）
// ========================================
// 媒体利用率マスター（GASモードではスプレッドシートから取得）
// ※ スタンドアロンモードは廃止されました。GAS専用です。
const DEFAULT_LAYER_MEDIA_USAGE = {};

// 実際に使用するRECRUITMENT_METHODSを取得する関数
const getRecruitmentMethods = (data) => {
  return data?.methodMaster || DEFAULT_RECRUITMENT_METHODS;
};

// 【inventory 4-1】6つの評価軸（3視点）
// 旧8軸→現行6軸の変換は inventory A-2 参照
const EVALUATION_AXES = {
  recognition: {
    name: '認知到達力',
    description: '狙いたい学生層が使う媒体・チャネルで、検索・閲覧されているか',
    tooltip: '【チェックポイント】\n・ターゲット学生が使う媒体（ナビサイト/DR/SNS等）に露出しているか\n・検索キーワードで上位表示されているか\n・企業名で検索したとき、十分な情報が出てくるか',
    color: '#3b82f6'
  },
  specificity: {
    name: '具体性スコア',
    description: '給与・勤務地・仕事内容・1日の流れなど、学生が知りたい情報が数字や事例で示されているか',
    tooltip: '【チェックポイント】\n・初任給・賞与・昇給実績が明記されているか\n・配属先・勤務地の選択肢が具体的か\n・「先輩の1日」「入社1年目の仕事」など具体例があるか',
    color: '#10b981'
  },
  differentiation: {
    name: '差別化力',
    description: '「なぜ競合ではなく御社か」を、実績・数字・社員の声で証明できているか',
    tooltip: '【チェックポイント】\n・競合他社と比較した強みを言語化できているか\n・その強みを裏付ける数字・実績・第三者評価があるか\n・社員インタビューや口コミで一貫したメッセージが伝わっているか',
    color: '#8b5cf6'
  },
  visionEmpathy: {
    name: '共感・ビジョン力',
    description: '5年後・10年後の成長イメージと、会社の理念・カルチャーに「ここで働きたい」と思えるか',
    tooltip: '【チェックポイント】\n・キャリアパス・昇進モデルが具体的に示されているか\n・会社のビジョン・ミッションが学生に響く言葉で伝わっているか\n・社風・働く人の雰囲気が伝わるコンテンツがあるか',
    color: '#06b6d4'
  },
  selectionUX: {
    name: '選考UX',
    description: '応募のしやすさ、連絡のスピード、面接の雰囲気など、選考体験にストレスがないか',
    tooltip: '【チェックポイント】\n・エントリーフォームが簡潔で離脱されていないか\n・書類選考・面接結果の連絡が3日以内に届いているか\n・面接官の態度・質問内容が学生に好印象を与えているか',
    color: '#ec4899'
  },
  dialogue: {
    name: '対話力',
    description: '学生の不安・疑問に寄り添い、内定後も「選ばれる関係」を築けているか',
    tooltip: '【チェックポイント】\n・選考中に学生の質問・相談に丁寧に対応しているか\n・内定者フォロー（面談・イベント・連絡頻度）が競合に負けていないか\n・親御さん（オヤカク）対策ができているか',
    color: '#f43f5e'
  }
};

// 【inventory 2-9】担当者＋上層部の平均スコアを計算するヘルパー関数
// 回答がある視点のみで平均を取る（片方のみでも有効）
// ※ スコア0（全問不正解）も有効値として平均計算に含める。null/undefinedのみを「未回答」として除外
const calcAvgScores = (staffScores, executiveScores) => {
  const result = {};
  Object.keys(EVALUATION_AXES).forEach(key => {
    const staff = staffScores?.[key];
    const exec = executiveScores?.[key];
    const values = [];
    if (staff !== null && staff !== undefined) values.push(staff);
    if (exec !== null && exec !== undefined) values.push(exec);
    result[key] = values.length > 0 ? values.reduce((a, b) => a + b, 0) / values.length : 0;
  });
  return result;
};

// 【inventory 4-2】マインドセット評価軸（5軸）= 採用基礎力
// 「現場が大変であること」の無駄を数値化
const MINDSET_AXES = {
  structure: {
    name: '採用体制',
    description: 'そもそも採用活動ができる体制が整っているか',
    tooltip: '【チェックポイント】\n・採用担当者が専任（または十分な時間確保）されているか\n・採用活動に必要な予算が確保されているか\n・採用活動の意思決定者が明確か',
    checkPoints: [
      '採用担当者が専任（または十分な時間確保）されているか',
      '採用活動に必要な予算が確保されているか',
      '採用活動の意思決定者が明確か'
    ]
  },
  ownership: {
    name: '自責',
    description: '環境や学生のせいにせず、自社に改善点を見出す姿勢',
    tooltip: '【チェックポイント】\n・「最近の学生は〇〇だ」と学生のせいにしていないか\n・「景気が悪い」「業界が不人気」と環境のせいにしていないか\n・辞退やドタキャンを「学生のマナー」で片付けていないか',
    checkPoints: [
      '「最近の学生は〇〇だ」と学生のせいにしていないか',
      '「景気が悪い」「業界が不人気」と環境のせいにしていないか',
      '辞退やドタキャンを「学生のマナー」で片付けていないか'
    ]
  },
  management: {
    name: '経営関与',
    description: '経営層が採用の重要性を理解し、関与しているか',
    tooltip: '【チェックポイント】\n・経営者・役員が採用活動に直接関与しているか\n・「なぜ採用するのか」が経営戦略と紐づいているか\n・採用の期限・目標が経営レベルで設定されているか',
    checkPoints: [
      '経営者・役員が採用活動に直接関与しているか',
      '「なぜ採用するのか」が経営戦略と紐づいているか',
      '採用の期限・目標が経営レベルで設定されているか'
    ]
  },
  marketUnderstanding: {
    name: '市場理解',
    description: '採用市場・競合・ターゲット学生を理解しているか',
    tooltip: '【チェックポイント】\n・採用競合企業を把握し、差別化ポイントを説明できるか\n・ターゲット学生像（WHO）が明確に定義されているか\n・学生が企業選びで重視するポイントを把握しているか',
    checkPoints: [
      '採用競合企業を把握し、差別化ポイントを説明できるか',
      'ターゲット学生像（WHO）が明確に定義されているか',
      '学生が企業選びで重視するポイントを把握しているか'
    ]
  },
  planning: {
    name: '計画性',
    description: '「採れてあたりまえ」のマインドで計画的に活動しているか',
    tooltip: '【チェックポイント】\n・年間の採用スケジュールが策定されているか\n・採用KPI（目標数値）が設定されているか\n・振り返り・改善のPDCAサイクルが回っているか',
    checkPoints: [
      '年間の採用スケジュールが策定されているか',
      '採用KPI（目標数値）が設定されているか',
      '振り返り・改善のPDCAサイクルが回っているか'
    ]
  }
};

// ========================================
// 注力タイプ（3層フェーズ）の定義
// ========================================
const DEPTH_PHASES = {
  surface: {
    name: '表層部',
    description: '候補者集め、母集団形成',
    range: '〜エントリーまで',
    color: '#3b82f6'
  },
  middle: {
    name: '中層部',
    description: '選考、見極め、動機づけ',
    range: 'エントリー〜内々定',
    color: '#10b981'
  },
  deep: {
    name: '深層部',
    description: '入社、定着、活躍',
    range: '内々定〜',
    color: '#f59e0b'
  }
};

// ========================================
// 【inventory 4-3】フェーズ × 軸 マッピング（寄与度）
// ◎=1.0、○=0.6、なし=0.0
// ========================================
const PHASE_AXIS_WEIGHT = {
  // 【①表層部】〜エントリーまで
  // 認知度◎、具体性◎、差別化力○、共感・ビジョン力○、選考UX○、対話力なし
  recognition:      { surface: 1.0, middle: 0.0, deep: 0.0 },
  specificity:      { surface: 1.0, middle: 0.0, deep: 0.0 },
  // 【②中層部】エントリー〜内々定
  // 差別化力◎、共感・ビジョン力◎、選考UX◎、対話力◎
  differentiation:  { surface: 0.6, middle: 1.0, deep: 1.0 },
  visionEmpathy:    { surface: 0.6, middle: 1.0, deep: 1.0 },
  selectionUX:      { surface: 0.6, middle: 1.0, deep: 0.6 },
  // 【③深層部】内々定〜（オヤカク含む）
  // 対話力◎
  dialogue:         { surface: 0.0, middle: 1.0, deep: 1.0 }
};

// ========================================
// 質問マスターデータ構造
// ========================================

// デフォルト質問マスターデータ
// scoreType: 'penalty'（減点方式）または 'bonus'（加点方式）
// points: 配点（減点または加点の点数）
// 質問マスター（GASモードではスプレッドシートから取得）
// ※ スタンドアロンモードは廃止されました。GAS専用です。
const DEFAULT_QUESTION_MASTER = {
  base: { small: { staff: [], executive: [], student: [] }, medium: { staff: [], executive: [], student: [] }, large: { staff: [], executive: [], student: [] } },
  industry: {},
  targetLayer: {},
  depth: { surface: { staff: [], executive: [], student: [] }, middle: { staff: [], executive: [], student: [] }, deep: { staff: [], executive: [], student: [] } },
  recruitmentMethod: {}
};

// 質問マスターを取得するヘルパー関数（GASモードではスプレッドシートのデータを優先）
const getQuestionMasterFromStorage = () => {
  try {
    // GASモードの場合はスプレッドシートのデータを優先
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    if (isGasMode && typeof GASDataManager !== 'undefined') {
      const gasData = GASDataManager.getQuestionMaster();
      if (gasData) {
        // 古いデータにrecruitmentMethodがない場合は追加
        if (!gasData.recruitmentMethod) {
          gasData.recruitmentMethod = {};
        }
        return gasData;
      }
    }
    
    // ローカルストレージから取得
    const saved = localStorage.getItem('gakusapo_question_master');
    if (saved) {
      const parsed = JSON.parse(saved);
      // 古いデータにrecruitmentMethodがない場合は追加
      if (!parsed.recruitmentMethod) {
        parsed.recruitmentMethod = {};
      }
      return parsed;
    }
    return DEFAULT_QUESTION_MASTER;
  } catch (e) {
    console.error('質問マスターの読み込みに失敗:', e);
    return DEFAULT_QUESTION_MASTER;
  }
};

/**
 * 有効な問診マスターを取得
 * 顧客データに保存時のマスタースナップショットがあればそれを使用、
 * なければ現在のマスターにフォールバック
 */
const getEffectiveQuestionMaster = (data) => {
  if (data && data.savedQuestionMaster && typeof data.savedQuestionMaster === 'object') {
    const saved = data.savedQuestionMaster;
    // 最低限の構造チェック（baseキーが存在するか）
    if (saved.base) {
      // recruitmentMethodがない古いスナップショットへの互換対応
      if (!saved.recruitmentMethod) saved.recruitmentMethod = {};
      return saved;
    }
  }
  return getQuestionMasterFromStorage();
};

/**
 * 採用手法別質問: activeな手法のカテゴリをユニーク化して取得
 * 例: マイナビ(ナビサイト) + リクナビ(ナビサイト) + OfferBox(DR) → ['ナビサイト', 'ダイレクトリクルーティング']
 */
const getActiveMethodCategories = (data) => {
  const methodMaster = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
  const activeMethods = Object.keys(data?.recruitmentMethods || {}).filter(k => data.recruitmentMethods[k]?.active);
  return [...new Set(activeMethods.map(k => methodMaster[k]?.category).filter(Boolean))];
};

/**
 * カテゴリに対応する質問を取得（新旧フォーマット両対応）
 * - 新フォーマット: master.recruitmentMethod['ナビサイト'][role] → カテゴリキー
 * - 旧フォーマット: master.recruitmentMethod['navi_mynavi'][role] → 手法キー（後方互換）
 * 両方からマージして重複除去する
 */
const getMethodQuestionsByCategory = (master, categoryName, methodMaster, roleKey) => {
  // 新フォーマット: カテゴリ名でダイレクトに取得
  const newQuestions = master?.recruitmentMethod?.[categoryName]?.[roleKey] || [];
  
  // 旧フォーマット: methodMaster内の手法キーでカテゴリが一致するものを収集
  const oldQuestions = [];
  Object.entries(master?.recruitmentMethod || {}).forEach(([key, roles]) => {
    if (methodMaster?.[key] && methodMaster[key].category === categoryName) {
      oldQuestions.push(...(roles?.[roleKey] || []));
    }
  });
  
  // 重複除去（IDベース、新フォーマット優先）
  const seen = new Set(newQuestions.map(q => q.id));
  const merged = [...newQuestions];
  oldQuestions.forEach(q => {
    if (!seen.has(q.id)) {
      seen.add(q.id);
      merged.push(q);
    }
  });
  return merged;
};

/**
 * 質問IDでrecruitmentMethod内のtargetArrayを検索（新旧フォーマット両対応）
 * 編集・削除時に使用。カテゴリキーに見つからなければ旧手法キーも検索する。
 */
const findMethodQuestionTargetArray = (master, categoryName, mMaster, roleKey, questionId) => {
  // 新フォーマット: カテゴリ名キーで直接検索
  const newArr = master?.recruitmentMethod?.[categoryName]?.[roleKey];
  if (newArr && newArr.some(q => q.id === questionId)) return newArr;
  // 旧フォーマット: 同カテゴリの手法キーを横断検索
  for (const [key, roles] of Object.entries(master?.recruitmentMethod || {})) {
    if (mMaster?.[key]?.category === categoryName) {
      const arr = roles?.[roleKey];
      if (arr && arr.some(q => q.id === questionId)) return arr;
    }
  }
  return null;
};

// 人数規模からカテゴリを判定（質問マスターは3段階: small/medium/large）
const getCompanySizeCategory = (sizeLabel) => {
  if (!sizeLabel) return 'small';
  
  // キーベースの判定（COMPANY_SIZE_LISTのkey）
  if (sizeLabel === 'micro' || sizeLabel === 'small') return 'small';  // ～30名, 31～100名 → small (100名以下)
  if (sizeLabel === 'medium') return 'medium';                          // 101～300名 → medium
  if (sizeLabel === 'large' || sizeLabel === 'enterprise') return 'large'; // 301名以上 → large
  
  // ラベルベースの判定（後方互換性）
  if (sizeLabel.includes('30名') || sizeLabel.includes('100名') || sizeLabel.includes('50名')) return 'small';
  if (sizeLabel.includes('300名')) return 'medium';
  return 'large';
};

// ========================================
// AI設定・プロンプト管理
// ========================================

// 設定画面パスワード管理
const DEFAULT_ADMIN_PASSWORD = 'andme0405';

const AdminPasswordManager = {
  getPassword: () => {
    try {
      const saved = localStorage.getItem('gakusapo_admin_password');
      return saved || DEFAULT_ADMIN_PASSWORD;
    } catch (e) {
      return DEFAULT_ADMIN_PASSWORD;
    }
  },
  setPassword: (newPassword) => {
    try {
      localStorage.setItem('gakusapo_admin_password', newPassword);
      return true;
    } catch (e) {
      console.error('設定画面パスワードの保存に失敗:', e);
      return false;
    }
  },
  verify: (password) => {
    return password === AdminPasswordManager.getPassword();
  }
};

// 口調プリセット定義
const AI_TONE_PRESETS = {
  strict: {
    id: 'strict',
    name: '🔥 辛口',
    description: '容赦なく切り捨てる。危機感を持たせたい経営者向け',
    systemPrompt: `あなたは「無駄を容赦なく切り捨て、本質だけに集中させる」ことを使命とする厳格な採用コンサルタントです。

【あなたの方針】
- 一切の妥協なく、丁寧すぎる対応・効果の薄い広告・形骸化した面接プロセスを斬り捨てる
- 「やめろ」「捨てろ」「集中しろ」と断言する
- 経営者の甘えや言い訳を許さず、ハッとさせる鋭い指摘を行う
- 備考欄の情報を最大限活用し、その企業固有の無駄を容赦なく暴く

【口調】
- 断定的で歯切れの良い命令形を使う
- 「〜かもしれません」「〜も良いでしょう」といった曖昧な表現は一切禁止
- 「今すぐ捨てろ」「やめなさい」「ここに集中しろ」と明確に指示する`
  },
  standard: {
    id: 'standard',
    name: '⚖️ 標準',
    description: '断定的だが攻撃的ではない。通常の商談向け',
    systemPrompt: `あなたは「無駄を徹底的に捨て、本質に集中させる」ことを信条とする鋭い視点を持つ採用コンサルタントです。

【あなたの方針】
- 丁寧すぎる対応、効果の薄い広告、形骸化した面接プロセスをズバッと切り捨てる
- 「やめるべきこと」を明確に指摘し、リソースをどこに集中すべきか具体的に提言する
- 耳障りの良い一般論ではなく、経営者がハッとするような鋭い指摘を行う
- 備考欄の情報を最大限活用し、その企業固有の文脈に沿ったアドバイスを生成する

【口調】
- 断定的で歯切れの良い表現を使う
- 「〜かもしれません」「〜も検討してみては」といった曖昧な表現は避ける
- 「捨てるべきです」「やめてください」「集中してください」と明確に指示する`
  },
  polite: {
    id: 'polite',
    name: '🌸 丁寧',
    description: '提案型で柔らかい表現。慎重な担当者向け',
    systemPrompt: `あなたは「無駄を見直し、本質に注力することを提案する」経験豊富な採用コンサルタントです。

【あなたの方針】
- 現状の課題を丁寧に分析し、改善の方向性を提案する
- 「見直しをご検討ください」「優先度を下げることをお勧めします」といった表現を使う
- 経営者や担当者の立場に配慮しながら、建設的な提案を行う
- 備考欄の情報を活用し、その企業の状況に寄り添ったアドバイスを生成する

【口調】
- 丁寧語を基本とし、提案型の表現を使う
- 相手の判断を尊重しながらも、明確な方向性を示す
- 「ご検討いただければ幸いです」「〜されることをお勧めいたします」と配慮ある表現を使う`
  },
  custom: {
    id: 'custom',
    name: 'カスタム',
    description: '自由に編集可能',
    systemPrompt: ''
  }
};

// デフォルトのユーザープロンプトテンプレート
const DEFAULT_USER_PROMPT_TEMPLATE = `以下の診断結果と備考欄の内容に基づき、改善アドバイスを生成してください。

【企業基本情報】
- 会社名: {companyName}
- 業種: {industry}
- 従業員規模: {employeeCount}

【診断結果サマリー】
- 診断ランク: {rank}
- 症例タイプ: {diagnosisTypeName}
- 症例の特徴: {diagnosisTypeDescription}

【伝達力スコア（10点満点）】
採用メッセージが学生に「届いているか」「響いているか」を測定
- 認知到達力: {scores.recognition}（ターゲット学生への露出度）
- 具体性スコア: {scores.specificity}（給与・仕事内容の明確さ）
- 差別化力: {scores.differentiation}（競合との違いの訴求力）
- 共感・ビジョン力: {scores.visionEmpathy}（将来像・カルチャーの魅力）
- 選考UX: {scores.selectionUX}（応募〜内定の体験品質）
- 対話力: {scores.dialogue}（学生の不安への寄り添い）

【注力フェーズ別スコア（10点満点）】
採用ファネルのどの段階に強み・弱みがあるかを測定
- 表層部（認知→興味）: {depthScores.surface}
- 中層部（興味→選考）: {depthScores.middle}
- 深層部（内定→承諾）: {depthScores.deep}

【歩留まり実績と目標の乖離】
{yieldGapAnalysis}

【フェーズ別投資分析】
{investmentAnalysis}

【採用手法・投資分析】
投資予算総額: {totalBudget}万円
{recruitmentAnalysis}

【備考（現場の悩み・状況）】
{remarks}

---

【出力指示】
以下の4項目について、それぞれ150〜200文字程度で作成してください。
各項目の先頭には必ず指定のタグを入れてください。

★ 分析の観点 ★
1. 伝達力スコアの低い項目（6点以下）は重点改善対象
2. 注力フェーズ別スコアと歩留まり実績の乖離を分析
3. 投資予算配分と注力順位を踏まえ、投資対効果の改善を提言
4. 備考欄の具体的な悩みに直接回答すること

[SECTION_1]
■ 処方箋：この症例から脱却するために「今すぐ捨てるべき活動」
→ 症例タイプ「{diagnosisTypeName}」の根本原因を踏まえ、最優先でやめるべき施策を指摘
→ 注力フェーズ別スコア（表層{depthScores.surface}/中層{depthScores.middle}/深層{depthScores.deep}）と歩留まり乖離の関係を分析
→ 過剰投資の媒体があれば具体的に見直しを提言

[SECTION_2]
■ 採用担当者へ：現場が明日からやめるべき「無駄な作業」
→ 伝達力スコアの低い項目に関連する日常業務の改善を提言
→ ターゲット層に合っていない媒体への工数投下を見直す観点を含める
→ 選考UX（{scores.selectionUX}点）と対話力（{scores.dialogue}点）の改善アクション

[SECTION_3]
■ 上層部へ：投資対効果の低い「無駄なコスト」
→ 投資予算額と注力順位から、予算配分の見直しを提言
→ 認知到達力（{scores.recognition}点）改善のための投資先を具体的に提案
→ 推奨配分との乖離が大きい媒体を根拠に具体的に提言

[SECTION_4]
■ 組織の課題：根本原因となっている「マインドセットの無駄」
→ なぜこの症例「{diagnosisTypeName}」に陥ったのか、組織文化の問題を指摘
→ 注力フェーズと歩留まり結果の不一致から見える組織の盲点を指摘
→ 「投資すれば解決する」という思い込みへの警鐘

---

【重要な注意点】
- 備考欄に具体的なサービス名や媒体名があれば、それに言及した具体的なアドバイスを出すこと
- 採用手法分析で「過剰投資」「投資不足」と判定された媒体は必ず言及すること
- 伝達力スコア6点以下の項目は重点課題として必ず言及すること
- 注力フェーズ別スコアと歩留まり実績の乖離がある場合は、その原因を分析して言及すること
- 曖昧な表現は禁止
- 各セクションは必ず「捨てる」「やめる」「集中する」のいずれかの行動を明示すること`;

// サイドバナーボタンのデフォルト設定
const DEFAULT_SIDE_BUTTONS = [
  {
    id: 'btn1',
    label: '再診断',
    prompt: `以下の診断結果に基づき、総合的な改善アドバイスを生成してください。

【企業基本情報】
- 会社名: {companyName}
- 業種: {industry}
- 従業員規模: {employeeCount}

【診断結果サマリー】
- 診断ランク: {rank}
- 症例タイプ: {diagnosisTypeName}
- 症例の特徴: {diagnosisTypeDescription}

【伝達力スコア（10点満点）】
- 認知到達力: {scores.recognition}
- 具体性スコア: {scores.specificity}
- 差別化力: {scores.differentiation}
- 共感・ビジョン力: {scores.visionEmpathy}
- 選考UX: {scores.selectionUX}
- 対話力: {scores.dialogue}

【注力フェーズ別スコア（10点満点）】
- 表層部（認知→興味）: {depthScores.surface}
- 中層部（興味→選考）: {depthScores.middle}
- 深層部（内定→承諾）: {depthScores.deep}

【歩留まり実績と目標の乖離】
{yieldGapAnalysis}

【フェーズ別投資分析】
{investmentAnalysis}

【採用手法・投資分析】
投資予算総額: {totalBudget}万円
{recruitmentAnalysis}

【備考】
{remarks}

---

【出力指示】
以下の4項目について、それぞれ150〜200文字程度で作成してください。

★ 重点分析ポイント ★
- 伝達力スコア6点以下の項目は重点改善対象
- フェーズ別スコア（表層{depthScores.surface}/中層{depthScores.middle}/深層{depthScores.deep}）と歩留まり乖離の関係
- 投資予算配分の最適化

[SECTION_1]
■ 処方箋：今すぐ捨てるべき活動
→ 症例「{diagnosisTypeName}」の根本原因を踏まえた最優先施策
→ フェーズ別スコアと歩留まり乖離があれば、どのフェーズに問題があるか指摘

[SECTION_2]
■ 採用担当者へ：現場が明日からやめるべき無駄な作業
→ 選考UX（{scores.selectionUX}点）と対話力（{scores.dialogue}点）の改善アクション

[SECTION_3]
■ 上層部へ：投資対効果の低い無駄なコスト
→ 投資予算額と注力順位を根拠に予算見直しを提言

[SECTION_4]
■ 組織の課題：根本原因となっているマインドセット
→ フェーズ別スコアと歩留まり結果の不一致から見える組織の盲点を指摘`
  },
  {
    id: 'btn2',
    label: '担当診断',
    prompt: `以下の診断結果に基づき、【採用担当者向け】の具体的なアドバイスを生成してください。

【企業基本情報】
- 会社名: {companyName}
- 業種: {industry}
- 従業員規模: {employeeCount}

【診断結果サマリー】
- 診断ランク: {rank}
- 症例タイプ: {diagnosisTypeName}
- 症例の特徴: {diagnosisTypeDescription}

【伝達力スコア（10点満点）】
- 認知到達力: {scores.recognition}
- 具体性スコア: {scores.specificity}
- 差別化力: {scores.differentiation}
- 共感・ビジョン力: {scores.visionEmpathy}
- 選考UX: {scores.selectionUX}
- 対話力: {scores.dialogue}

【注力フェーズ別スコア（10点満点）】
- 表層部（認知→興味）: {depthScores.surface}
- 中層部（興味→選考）: {depthScores.middle}
- 深層部（内定→承諾）: {depthScores.deep}

【歩留まり実績と目標の乖離】
{yieldGapAnalysis}

【採用手法・投資分析】
投資予算総額: {totalBudget}万円
{recruitmentAnalysis}

【備考】
{remarks}

---

【出力指示】
採用担当者が明日から実践できる具体的なアクションを中心に、以下の4項目を作成してください。

★ 担当者向け重点ポイント ★
- 選考UX（{scores.selectionUX}点）と対話力（{scores.dialogue}点）の現場改善
- 注力順位と投資予算の整合性の改善
- 具体性スコア（{scores.specificity}点）改善のためのコンテンツ作成

[SECTION_1]
■ 処方箋：採用担当者として最優先で取り組むべきこと
→ 伝達力スコアで最も低い項目の改善から着手

[SECTION_2]
■ 採用担当者へ：日々の業務で改善すべき具体的なポイント
→ 選考UX（{scores.selectionUX}点）改善：応募者対応スピード・面接体験
→ 対話力（{scores.dialogue}点）改善：内定者フォロー・不安解消

[SECTION_3]
■ 上層部へ：担当者から上層部へ提案すべき内容
→ 投資予算額と注力順位を根拠に予算・権限の見直しを提案

[SECTION_4]
■ 組織の課題：採用担当者の立場から見た組織の問題点
→ なぜ「{diagnosisTypeName}」に陥ったか、現場視点での分析`
  },
  {
    id: 'btn3',
    label: '組織診断',
    prompt: `以下の診断結果に基づき、【組織・経営層向け】の戦略的アドバイスを生成してください。

【企業基本情報】
- 会社名: {companyName}
- 業種: {industry}
- 従業員規模: {employeeCount}

【診断結果サマリー】
- 診断ランク: {rank}
- 症例タイプ: {diagnosisTypeName}
- 症例の特徴: {diagnosisTypeDescription}

【伝達力スコア（10点満点）】
- 認知到達力: {scores.recognition}
- 具体性スコア: {scores.specificity}
- 差別化力: {scores.differentiation}
- 共感・ビジョン力: {scores.visionEmpathy}
- 選考UX: {scores.selectionUX}
- 対話力: {scores.dialogue}

【注力フェーズ別スコア（10点満点）】
- 表層部（認知→興味）: {depthScores.surface}
- 中層部（興味→選考）: {depthScores.middle}
- 深層部（内定→承諾）: {depthScores.deep}

【歩留まり実績と目標の乖離】
{yieldGapAnalysis}

【フェーズ別投資分析】
{investmentAnalysis}

【採用手法・投資分析】
投資予算総額: {totalBudget}万円
{recruitmentAnalysis}

【備考】
{remarks}

---

【出力指示】
経営判断や組織改革の観点から、以下の4項目を作成してください。

★ 経営層向け重点ポイント ★
- 投資予算配分の経営インパクト
- 認知到達力（{scores.recognition}点）向上のための投資判断
- フェーズ別スコア（表層{depthScores.surface}/中層{depthScores.middle}/深層{depthScores.deep}）に基づく戦略的資源配分

[SECTION_1]
■ 処方箋：経営として即座に決断すべき施策
→ 症例「{diagnosisTypeName}」脱却のための経営判断

[SECTION_2]
■ 採用担当者へ：組織として担当者に与えるべき権限と環境
→ 選考UX（{scores.selectionUX}点）改善に必要な権限移譲

[SECTION_3]
■ 上層部へ：投資判断と予算配分の見直し
→ 投資予算額と注力順位を根拠に過剰投資の削減と再配分を提言
→ 認知到達力（{scores.recognition}点）向上のための投資先

[SECTION_4]
■ 組織の課題：採用力を阻害している組織文化・構造の問題
→ フェーズ別スコアと歩留まり乖離が示す組織の構造的問題`
  },
  {
    id: 'btn4',
    label: 'Pro診断',
    prompt: `以下の診断結果に基づき、【プロフェッショナル向け】の高度な分析とアドバイスを生成してください。

【企業基本情報】
- 会社名: {companyName}
- 業種: {industry}
- 従業員規模: {employeeCount}

【診断結果サマリー】
- 診断ランク: {rank}
- 症例タイプ: {diagnosisTypeName}
- 症例の特徴: {diagnosisTypeDescription}

【伝達力スコア（10点満点）】
- 認知到達力: {scores.recognition}
- 具体性スコア: {scores.specificity}
- 差別化力: {scores.differentiation}
- 共感・ビジョン力: {scores.visionEmpathy}
- 選考UX: {scores.selectionUX}
- 対話力: {scores.dialogue}

【注力フェーズ別スコア（10点満点）】
- 表層部（認知→興味）: {depthScores.surface}
- 中層部（興味→選考）: {depthScores.middle}
- 深層部（内定→承諾）: {depthScores.deep}

【歩留まり実績と目標の乖離】
{yieldGapAnalysis}

【フェーズ別投資分析】
{investmentAnalysis}

【採用手法・投資詳細分析】
投資予算総額: {totalBudget}万円
{recruitmentAnalysisPro}

【備考】
{remarks}

---

【出力指示】
コンサルタント視点での高度な分析を含め、以下の4項目を作成してください。
データに基づいた論理的な提言を心がけてください。

★ Pro分析フレームワーク ★
1. 伝達力スコア×フェーズ別スコアのクロス分析
2. 歩留まり乖離の根本原因特定
3. 投資予算配分の定量的改善提案
4. ROI最大化のための優先順位付け

[SECTION_1]
■ 処方箋：根本原因の分析と最も効果的な介入ポイント
→ 症例「{diagnosisTypeName}」の構造的要因を分析
→ フェーズ別スコア（表層{depthScores.surface}/中層{depthScores.middle}/深層{depthScores.deep}）と伝達力スコアの相関
→ 「過剰投資」「投資不足」の媒体を特定し、優先度の高い改善点を明示

[SECTION_2]
■ 採用担当者へ：KPI設計と効果測定の仕組み構築
→ 伝達力スコア6項目をKPIに組み込む提案
→ 選考UX（{scores.selectionUX}点）・対話力（{scores.dialogue}点）の測定方法
→ 推奨配分に近づけるための具体的なアクションプラン

[SECTION_3]
■ 上層部へ：ROI最大化のための投資戦略
→ 投資予算の再配分による期待効果を定量化
→ 過剰投資媒体からの予算削減額と、投資不足媒体への再配分を具体的に提示
→ 認知到達力（{scores.recognition}点）向上のための費用対効果分析

[SECTION_4]
■ 組織の課題：競争優位性を構築するための組織変革
→ なぜ「{diagnosisTypeName}」に陥ったのか、組織的な意思決定の問題点を指摘
→ フェーズ別スコアと歩留まり乖離から見える組織の盲点
→ データドリブンな採用投資判断ができる組織体制の構築提案`
  }
];

// AI設定の保存・読み込み
const AISettingsManager = {
  getSettings: () => {
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    
    // GASモードの場合はスプレッドシートの設定を優先
    if (isGasMode && typeof GASDataManager !== 'undefined') {
      const gasSettings = GASDataManager.getAISettings();
      console.log('GASDataManager.getAISettings():', gasSettings);
      if (gasSettings && (gasSettings.apiKey || gasSettings.selectedPreset || gasSettings.sideButtons)) {
        // ローカル設定とマージ（GASの設定を優先）
        try {
          const localData = localStorage.getItem('gakusapo_bb_ai_settings');
          const localSettings = localData ? JSON.parse(localData) : {};
          const mergedSettings = {
            // API設定（GAS優先）
            apiType: gasSettings.apiType || localSettings.apiType || 'gemini',
            apiKey: gasSettings.apiKey || localSettings.apiKey || '',
            model: gasSettings.model || localSettings.model || 'claude-3-haiku-20240307',
            maxTokens: gasSettings.maxTokens || localSettings.maxTokens || 2000,
            // プロンプト設定（GAS優先）
            selectedPreset: gasSettings.selectedPreset || localSettings.selectedPreset || 'standard',
            customSystemPrompt: gasSettings.customSystemPrompt || localSettings.customSystemPrompt || '',
            userPromptTemplate: gasSettings.userPromptTemplate || localSettings.userPromptTemplate || DEFAULT_USER_PROMPT_TEMPLATE,
            // 診断ボタン設定（GAS優先、nullの場合はデフォルトを使用）
            sideButtons: (gasSettings.hasOwnProperty('sideButtons') && gasSettings.sideButtons !== null) 
              ? gasSettings.sideButtons 
              : (localSettings.sideButtons || DEFAULT_SIDE_BUTTONS),
            // ローカルのみの設定
            masterSpreadsheetUrl: localSettings.masterSpreadsheetUrl || ''
          };
          console.log('マージ後のAI設定:', mergedSettings);
          return mergedSettings;
        } catch (e) {
          console.error('AI設定のマージに失敗:', e);
        }
      }
    }
    
    // ローカルストレージから取得
    try {
      const data = localStorage.getItem('gakusapo_bb_ai_settings');
      if (data) {
        const parsed = JSON.parse(data);
        // サイドボタン設定がない場合はデフォルトを追加
        if (!parsed.sideButtons) {
          parsed.sideButtons = DEFAULT_SIDE_BUTTONS;
        }
        // マスターデータ用スプレッドシートURLがない場合は空文字
        if (!parsed.masterSpreadsheetUrl) {
          parsed.masterSpreadsheetUrl = '';
        }
        return parsed;
      }
    } catch (e) {
      console.error('AI設定の読み込みに失敗:', e);
    }
    // デフォルト設定
    return {
      apiType: 'gemini',
      apiKey: '',
      selectedPreset: 'standard',
      customSystemPrompt: '',
      userPromptTemplate: DEFAULT_USER_PROMPT_TEMPLATE,
      sideButtons: DEFAULT_SIDE_BUTTONS,
      masterSpreadsheetUrl: ''
    };
  },
  saveSettings: (settings) => {
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    const isAdmin = window.GAS_CONFIG?.permissions?.includes('admin');
    
    try {
      localStorage.setItem('gakusapo_bb_ai_settings', JSON.stringify(settings));
      
      // GASモードかつ管理者の場合はスプレッドシートにも保存
      if (isGasMode && isAdmin && typeof GASDataManager !== 'undefined') {
        GASDataManager.saveAISettings({
          // API設定
          enabled: true,
          apiType: settings.apiType || 'gemini',
          apiKey: settings.apiKey || '',
          model: settings.model || 'claude-3-haiku-20240307',
          maxTokens: settings.maxTokens || 2000,
          // プロンプト設定
          selectedPreset: settings.selectedPreset || 'standard',
          customSystemPrompt: settings.customSystemPrompt || '',
          userPromptTemplate: settings.userPromptTemplate || '',
          // 診断ボタン設定
          sideButtons: settings.sideButtons || DEFAULT_SIDE_BUTTONS
        });
      }
      
      return true;
    } catch (e) {
      console.error('AI設定の保存に失敗:', e);
      return false;
    }
  }
};

// ========================================
// v34: 認証付きAPI通信ユーティリティ
// ========================================

/**
 * 認証付きGETリクエスト
 * @param {string} action - APIアクション名
 * @param {object} params - 追加パラメータ
/**
 * IDトークンのサイレントリフレッシュを試行
 * @returns {Promise<boolean>} リフレッシュ成功ならtrue
 */
async function refreshIdToken() {
  return new Promise((resolve) => {
    if (!window.google?.accounts?.id) {
      resolve(false);
      return;
    }
    
    // コールバックを一時的に差し替え
    const originalCallback = window._handleGoogleCredential;
    let resolved = false;
    
    window.google.accounts.id.initialize({
      client_id: window.OAUTH_CONFIG.clientId,
      callback: (response) => {
        if (resolved) return;
        resolved = true;
        if (response?.credential) {
          window.AUTH.idToken = response.credential;
          try { sessionStorage.setItem('bb_auth_token', response.credential); } catch(e) {}
          console.log('[refreshIdToken] トークンリフレッシュ成功');
          // リフレッシュタイマーを再セット
          scheduleTokenRefresh();
          resolve(true);
        } else {
          resolve(false);
        }
      },
      auto_select: true
    });
    
    window.google.accounts.id.prompt((notification) => {
      if (resolved) return;
      if (notification.isNotDisplayed() || notification.isSkippedMoment()) {
        resolved = true;
        console.warn('[refreshIdToken] サイレントリフレッシュ失敗:', notification.getNotDisplayedReason?.() || notification.getSkippedReason?.());
        resolve(false);
      }
    });
    
    // 5秒のタイムアウト
    setTimeout(() => {
      if (!resolved) {
        resolved = true;
        console.warn('[refreshIdToken] リフレッシュタイムアウト');
        resolve(false);
      }
    }, 5000);
  });
}

/**
 * トークンリフレッシュタイマーをセット（45分後に自動リフレッシュ）
 */
let _refreshTimer = null;
function scheduleTokenRefresh() {
  if (_refreshTimer) clearTimeout(_refreshTimer);
  _refreshTimer = setTimeout(async () => {
    console.log('[scheduleTokenRefresh] 自動リフレッシュ開始');
    const ok = await refreshIdToken();
    if (!ok) {
      console.warn('[scheduleTokenRefresh] 自動リフレッシュ失敗 - 次のAPI呼び出し時にリトライ');
    }
  }, 45 * 60 * 1000); // 45分（IDトークンの有効期限60分より余裕を持たせる）
}

/**
 * トークン期限切れを検出してリフレッシュを試行する共通処理
 * @returns {boolean} リフレッシュ不要ならfalse、期限切れだがリフレッシュ成功ならtrue
 */
function isTokenExpiredError(result) {
  return !result.success && result.error && 
    (result.error.includes('IDトークン') || result.error.includes('ログイン') || result.error.includes('期限切れ'));
}

/**
 * 認証付きGETリクエスト（トークン期限切れ時は自動リフレッシュ＆リトライ）
 * @param {string} action - APIアクション名
 * @param {object} params - 追加パラメータ
 * @returns {Promise<object>} レスポンスJSON
 */
async function authFetch(action, params = {}) {
  if (!window.AUTH.idToken) {
    throw new Error('未ログインです。再ログインしてください。');
  }
  
  const doFetch = async () => {
    const url = new URL(window.GAS_CONFIG.gasUrl);
    url.searchParams.set('action', action);
    url.searchParams.set('id_token', window.AUTH.idToken);
    Object.entries(params).forEach(([key, value]) => {
      if (value !== undefined && value !== null) {
        url.searchParams.set(key, String(value));
      }
    });
    const response = await fetch(url.toString(), { method: 'GET', redirect: 'follow' });
    const contentType = response.headers.get('content-type') || '';
    if (!contentType.includes('application/json') && !contentType.includes('text/plain')) {
      throw new Error('APIから不正なレスポンスが返りました (content-type: ' + contentType + ')');
    }
    return response.json();
  };
  
  let result = await doFetch();
  
  // トークン期限切れ → リフレッシュしてリトライ（1回のみ）
  if (isTokenExpiredError(result)) {
    console.warn('[authFetch] トークン期限切れ検出、リフレッシュ試行中...');
    const refreshed = await refreshIdToken();
    if (refreshed) {
      result = await doFetch();
      if (!isTokenExpiredError(result)) {
        return result; // リトライ成功
      }
    }
    // リフレッシュ失敗 → ログイン画面へ（データは保存警告付き）
    window.AUTH._tokenExpired = true;
    window.dispatchEvent(new Event('auth-expired'));
    throw new Error('セッションが期限切れです。再ログイン後にもう一度保存してください。');
  }
  
  return result;
}

/**
 * 認証付きPOSTリクエスト（トークン期限切れ時は自動リフレッシュ＆リトライ）
 * @param {string} action - APIアクション名
 * @param {object} data - リクエストボディ
 * @returns {Promise<object>} レスポンスJSON
 */
async function authPost(action, data = {}) {
  if (!window.AUTH.idToken) {
    throw new Error('未ログインです。再ログインしてください。');
  }
  
  const doPost = async () => {
    const response = await fetch(window.GAS_CONFIG.gasUrl, {
      method: 'POST',
      redirect: 'follow',
      headers: { 'Content-Type': 'text/plain;charset=utf-8' },
      body: JSON.stringify({
        ...data,
        action: action,
        id_token: window.AUTH.idToken
      })
    });
    return response.json();
  };
  
  let result = await doPost();
  
  // トークン期限切れ → リフレッシュしてリトライ（1回のみ）
  if (isTokenExpiredError(result)) {
    console.warn('[authPost] トークン期限切れ検出、リフレッシュ試行中...');
    const refreshed = await refreshIdToken();
    if (refreshed) {
      // リトライ時はリフレッシュ後のトークンでbodyを再構築
      result = await doPost();
      if (!isTokenExpiredError(result)) {
        return result; // リトライ成功
      }
    }
    // リフレッシュ失敗 → ログイン画面へ（データは保存警告付き）
    window.AUTH._tokenExpired = true;
    window.dispatchEvent(new Event('auth-expired'));
    throw new Error('セッションが期限切れです。再ログイン後にもう一度保存してください。');
  }
  
  return result;
}

/**
 * 認証不要のGETリクエスト（事前問診データ取得等）
 */
async function publicFetch(action, params = {}) {
  const url = new URL(window.GAS_CONFIG.gasUrl);
  url.searchParams.set('action', action);
  Object.entries(params).forEach(([key, value]) => {
    if (value !== undefined && value !== null) {
      url.searchParams.set(key, String(value));
    }
  });
  const response = await fetch(url.toString(), { method: 'GET', redirect: 'follow' });
  return response.json();
}

/**
 * 認証不要のPOSTリクエスト（事前問診保存等）
 */
async function publicPost(action, data = {}) {
  const response = await fetch(window.GAS_CONFIG.gasUrl, {
    method: 'POST',
    redirect: 'follow',
    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
    body: JSON.stringify({ ...data, action: action })
  });
  return response.json();
}

// ========================================
// v34: Google OAuth ログイン画面
// ========================================

const GoogleLoginScreen = ({ onLoginSuccess }) => {
  const [error, setError] = React.useState('');
  const [loading, setLoading] = React.useState(false);
  const btnRef = React.useRef(null);

  React.useEffect(() => {
    const initGSI = () => {
      if (!window.google?.accounts?.id) {
        // GSIライブラリがまだ読み込まれていない場合はリトライ
        setTimeout(initGSI, 500);
        return;
      }
      
      window.google.accounts.id.initialize({
        client_id: window.OAUTH_CONFIG.clientId,
        callback: handleCredentialResponse,
        auto_select: true
      });
      
      if (btnRef.current) {
        window.google.accounts.id.renderButton(btnRef.current, {
          theme: 'outline',
          size: 'large',
          width: 300,
          text: 'signin_with',
          locale: 'ja'
        });
      }
      
      // One Tapプロンプトも表示
      window.google.accounts.id.prompt();
    };
    
    initGSI();
  }, []);

  const handleCredentialResponse = async (response) => {
    setLoading(true);
    setError('');
    
    try {
      const idToken = response.credential;
      
      // GAS APIでトークン検証 + メンバーチェック
      const url = new URL(window.GAS_CONFIG.gasUrl);
      url.searchParams.set('action', 'login');
      url.searchParams.set('id_token', idToken);
      
      const res = await fetch(url.toString(), { method: 'GET', redirect: 'follow' });
      const data = await res.json();
      
      if (!data.success) {
        setError(data.error || 'ログインに失敗しました');
        setLoading(false);
        return;
      }
      
      // 認証情報を保存
      window.AUTH.idToken = idToken;
      window.AUTH.user = data.user;
      window.AUTH.isLoggedIn = true;
      
      // GAS_CONFIGを更新（既存コードとの互換性維持）
      window.GAS_CONFIG.currentUser = data.user.email;
      window.GAS_CONFIG.userEmail = data.user.email;
      window.GAS_CONFIG.userName = data.user.name;
      window.GAS_CONFIG.memberName = data.user.name;
      window.GAS_CONFIG.studentId = data.user.studentId;
      window.GAS_CONFIG.permissions = data.user.permissions;
      window.GAS_CONFIG.deploymentMode = 'gas'; // 互換性のため'gas'に設定
      
      // トークンリフレッシュタイマーを設定
      scheduleTokenRefresh();
      
      // sessionStorageにログイン状態を保存（タブ間で維持）
      try {
        sessionStorage.setItem('bb_auth_token', idToken);
        sessionStorage.setItem('bb_auth_user', JSON.stringify(data.user));
      } catch (e) {}
      
      if (onLoginSuccess) {
        onLoginSuccess(data.user);
      }
      
    } catch (err) {
      console.error('ログインエラー:', err);
      setError('通信エラーが発生しました: ' + err.message);
    }
    setLoading(false);
  };

  // グローバルに公開（Google GSI コールバック用）
  window._handleGoogleCredential = handleCredentialResponse;

  return (
    <div style={{
      minHeight: '100vh',
      display: 'flex',
      alignItems: 'center',
      justifyContent: 'center',
      background: 'linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%)'
    }}>
      <div style={{
        background: 'rgba(255,255,255,0.97)',
        borderRadius: '20px',
        padding: '48px 40px',
        maxWidth: '440px',
        width: '90%',
        textAlign: 'center',
        boxShadow: '0 25px 80px rgba(0,0,0,0.4)'
      }}>
        {/* 会社ロゴ */}
        <div style={{
          width: '80px', height: '80px', margin: '0 auto 20px',
          display: 'flex', alignItems: 'center', justifyContent: 'center'
        }}>
          <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iX+ODrOOCpOODpOODvF8xIiBkYXRhLW5hbWU9IuODrOOCpOODpOODvCAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMTEuMDQgMzUyLjMiPgogIDxkZWZzPgogICAgPHN0eWxlPgogICAgICAuY2xzLTEgewogICAgICAgIGZpbGw6IG5vbmU7CiAgICAgIH0KCiAgICAgIC5jbHMtMiB7CiAgICAgICAgZmlsbDogIzAwMmUzYjsKICAgICAgfQoKICAgICAgLmNscy0zIHsKICAgICAgICBmaWxsOiAjZmZlMjAwOwogICAgICB9CgogICAgICAuY2xzLTQgewogICAgICAgIGZpbGw6ICNjZjJhMjc7CiAgICAgIH0KCiAgICAgIC5jbHMtNSB7CiAgICAgICAgZmlsbDogIzI2YThhYTsKICAgICAgfQoKICAgICAgLmNscy02IHsKICAgICAgICBmaWxsOiAjZmZmOwogICAgICAgIHN0cm9rZTogIzA0MDAwMDsKICAgICAgICBzdHJva2UtbWl0ZXJsaW1pdDogMTA7CiAgICAgIH0KICAgIDwvc3R5bGU+CiAgPC9kZWZzPgogIDxwYXRoIGNsYXNzPSJjbHMtMiIgZD0ibTE1NS40NSwxNzUuMzdjLTExLjg1LDAtMjEuNDksOS42NC0yMS40OSwyMS40OXM5LjY0LDIxLjQ5LDIxLjQ5LDIxLjQ5LDIxLjQ5LTkuNjQsMjEuNDktMjEuNDktOS42NC0yMS40OS0yMS40OS0yMS40OVptMCwzMy4xOGMtNi40NiwwLTExLjY5LTUuMjMtMTEuNjktMTEuNjlzNS4yMy0xMS42OSwxMS42OS0xMS42OSwxMS42OSw1LjIzLDExLjY5LDExLjY5LTUuMjMsMTEuNjktMTEuNjksMTEuNjlaIi8+CiAgPHBhdGggY2xhc3M9ImNscy0xIiBkPSJtMTU1LjQ1LDIzMC45NWM5LjM0LDAsMTcuODEtMy43NiwyMy45Ny05Ljg0bC4yOS0uMDUuMDUtLjI5YzYuMDgtNi4xNyw5Ljg0LTE0LjYzLDkuODQtMjMuOTdzLTMuNzYtMTcuODEtOS44NC0yMy45N2wtLjA1LS4yOS0uMjktLjA1Yy02LjE3LTYuMDgtMTQuNjMtOS44NC0yMy45Ny05Ljg0cy0xNy44MSwzLjc2LTIzLjk3LDkuODRsLS4yOS4wNS0uMDUuMjljLTYuMDgsNi4xNy05Ljg0LDE0LjYzLTkuODQsMjMuOTdzMy43NiwxNy44MSw5Ljg0LDIzLjk3bC4wNS4yOS4yOS4wNWM2LjE3LDYuMDgsMTQuNjMsOS44NCwyMy45Nyw5Ljg0WiIvPgogIDxwYXRoIGNsYXNzPSJjbHMtMiIgZD0ibTE1NS40NSwxNjIuNjZjOS4zNCwwLDE3LjgxLDMuNzYsMjMuOTcsOS44NGwuMjkuMDUtNi4wNy0zMi44MmMtOS4xOCwzLjgzLTE3LjI3LDQuNjMtMTcuNjMsNC42NmwtLjU3LjA1LS41Ny0uMDVjLS4zNS0uMDMtOC40NS0uODItMTcuNjItNC42NmwtNi4wNywzMi44Mi4yOS0uMDVjNi4xNy02LjA4LDE0LjYzLTkuODQsMjMuOTctOS44NFoiLz4KICA8cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Im0xMjEuMywxOTYuOGMwLTkuMzQsMy43Ni0xNy44MSw5Ljg0LTIzLjk3bC4wNS0uMjlMMCwxOTYuOGwxMzEuMTksMjQuMjYtLjA1LS4yOWMtNi4wOC02LjE3LTkuODQtMTQuNjMtOS44NC0yMy45N1oiLz4KICA8cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Im0xNzkuNDIsMjIxLjEyYy02LjE3LDYuMDgtMTQuNjMsOS44NC0yMy45Nyw5Ljg0cy0xNy44MS0zLjc2LTIzLjk3LTkuODRsLS4yOS0uMDUsMjQuMjYsMTMxLjE5LDI0LjI2LTEzMS4xOS0uMjkuMDVaIi8+CiAgPHBhdGggY2xhc3M9ImNscy0yIiBkPSJtMTg5LjU5LDE5Ni44YzAsOS4zNC0zLjc2LDE3LjgxLTkuODQsMjMuOTdsLS4wNS4yOSwxMzEuMTktMjQuMjYtMTMxLjE5LTI0LjI2LjA1LjI5YzYuMDgsNi4xNyw5Ljg0LDE0LjYzLDkuODQsMjMuOTdaIi8+CiAgPHBvbHlnb24gY2xhc3M9ImNscy00IiBwb2ludHM9IjEyOC4yMSAxNTUuMTUgODUuMjQgMTI1LjE4IDExNC43NyAxNjkuMzggMTI1Ljk2IDE2Ny4zMiAxMjguMjEgMTU1LjE1Ii8+CiAgPHBvbHlnb24gY2xhc3M9ImNscy00IiBwb2ludHM9IjExMy43OSAyMjQuMDQgODMuODIgMjY3LjAyIDEyOC4wMiAyMzcuNDggMTI1Ljk2IDIyNi4yOSAxMTMuNzkgMjI0LjA0Ii8+CiAgPHBvbHlnb24gY2xhc3M9ImNscy00IiBwb2ludHM9IjE4Mi42OSAyMzguNDYgMjI1LjY2IDI2OC40MyAxOTYuMTIgMjI0LjIzIDE4NC45NCAyMjYuMjkgMTgyLjY5IDIzOC40NiIvPgogIDxwb2x5Z29uIGNsYXNzPSJjbHMtNCIgcG9pbnRzPSIxODQuOTQgMTY3LjMyIDE5Ny4xIDE2OS41NyAyMjcuMDcgMTI2LjU5IDE4Mi44NyAxNTYuMTMgMTg0Ljk0IDE2Ny4zMiIvPgogIDxwYXRoIGNsYXNzPSJjbHMtNCIgZD0ibTE3MC4wOSwzMDYuNTdsLTIuOTUsMTUuOTdjNjAuMzItNS41NiwxMDguNDgtNTMuNzIsMTE0LjA0LTExNC4wNGwtMTUuOTcsMi45NWMtNi41Myw0OS40NC00NS42OCw4OC41OS05NS4xMiw5NS4xMloiLz4KICA8cGF0aCBjbGFzcz0iY2xzLTQiIGQ9Im00NS42OCwyMTEuNDVsLTE1Ljk3LTIuOTVjNS41Niw2MC4zMiw1My43MiwxMDguNDgsMTE0LjA0LDExNC4wNGwtMi45NS0xNS45N2MtNDkuNDQtNi41My04OC41OS00NS42OC05NS4xMi05NS4xMloiLz4KICA8cGF0aCBjbGFzcz0iY2xzLTYiIGQ9Im0xNTUuNDUsMTQ0LjQ0LTE4LjE5LTQuNzEiLz4KICA8cGF0aCBjbGFzcz0iY2xzLTUiIGQ9Im0xNTQuODgsMTQ0LjM5Yy0uMzUtLjAzLTguNDUtLjgyLTE3LjYyLTQuNjZsLTYuMDcsMzIuODIuMjktLjA1YzYuMTctNi4wOCwxNC42My05Ljg0LDIzLjk3LTkuODR2LTE4LjIyaDBzLS41Ny0uMDUtLjU3LS4wNVoiLz4KICA8cGF0aCBjbGFzcz0iY2xzLTUiIGQ9Im0xMzEuMTksMTcyLjZMMCwxOTYuODZoMTIxLjNjMC05LjM0LDMuNzYtMTcuODEsOS44NC0yMy45N2wuMDUtLjI5WiIvPgogIDxwYXRoIGNsYXNzPSJjbHMtNSIgZD0ibTE1NS40NSwyMzEuMDFoMHYxMjEuM2wyNC4zMS0xMzEuNDdjLTYuMTksNi4yOC0xNC44LDEwLjE4LTI0LjMxLDEwLjE4WiIvPgogIDxwYXRoIGNsYXNzPSJjbHMtNSIgZD0ibTE4OS43NCwxOTYuODZoMTIxLjNsLTEzMS40NywyNC4zMWM2LjI4LTYuMTksMTAuMTgtMTQuOCwxMC4xOC0yNC4zMVoiLz4KICA8cGF0aCBjbGFzcz0iY2xzLTMiIGQ9Im0xNTUuNDUsMTYyLjY2YzkuMzQsMCwxNy44MSwzLjc2LDIzLjk3LDkuODRsLjI5LjA1LTYuMDctMzIuODJjLTkuMTgsMy44My0xNy4yNyw0LjYzLTE3LjYzLDQuNjZsLS41Ny4wNS0uNTctLjA1Yy0uMzUtLjAzLTguNDUtLjgyLTE3LjYyLTQuNjZsLTYuMDcsMzIuODIuMjktLjA1YzYuMTctNi4wOCwxNC42My05Ljg0LDIzLjk3LTkuODRaIi8+CiAgPHBhdGggY2xhc3M9ImNscy0zIiBkPSJtMTIxLjMsMTk2LjhjMC05LjM0LDMuNzYtMTcuODEsOS44NC0yMy45N2wuMDUtLjI5TDAsMTk2LjhsMTMxLjE5LDI0LjI2LS4wNS0uMjljLTYuMDgtNi4xNy05Ljg0LTE0LjYzLTkuODQtMjMuOTdaIi8+CiAgPHBhdGggY2xhc3M9ImNscy0zIiBkPSJtMTc5LjQyLDIyMS4xMmMtNi4xNyw2LjA4LTE0LjYzLDkuODQtMjMuOTcsOS44NHMtMTcuODEtMy43Ni0yMy45Ny05Ljg0bC0uMjktLjA1LDI0LjI2LDEzMS4xOSwyNC4yNi0xMzEuMTktLjI5LjA1WiIvPgogIDxwYXRoIGNsYXNzPSJjbHMtMyIgZD0ibTE4OS41OSwxOTYuOGMwLDkuMzQtMy43NiwxNy44MS05Ljg0LDIzLjk3bC0uMDUuMjksMTMxLjE5LTI0LjI2LTEzMS4xOS0yNC4yNi4wNS4yOWM2LjA4LDYuMTcsOS44NCwxNC42Myw5Ljg0LDIzLjk3WiIvPgogIDxnPgogICAgPHBhdGggY2xhc3M9ImNscy00IiBkPSJtMTU1LjQ1LDE3NS4zN2MtMTEuODUsMC0yMS40OSw5LjY0LTIxLjQ5LDIxLjQ5czkuNjQsMjEuNDksMjEuNDksMjEuNDksMjEuNDktOS42NCwyMS40OS0yMS40OS05LjY0LTIxLjQ5LTIxLjQ5LTIxLjQ5Wm0wLDMzLjE4Yy02LjQ2LDAtMTEuNjktNS4yMy0xMS42OS0xMS42OXM1LjIzLTExLjY5LDExLjY5LTExLjY5LDExLjY5LDUuMjMsMTEuNjksMTEuNjktNS4yMywxMS42OS0xMS42OSwxMS42OVoiLz4KICAgIDxwYXRoIGNsYXNzPSJjbHMtNCIgZD0ibTEyMS4zLDE5Ni44aDBzLTkwLjc4LDAtOTAuNzgsMGw5NS43My0xNy43YzEuMzgtMi4yOCwzLjAyLTQuMzgsNC44OS02LjI3bC4wNS0uMjlMMCwxOTYuOGwxMzEuMTksMjQuMjYtLjA1LS4yOWMtNi4wOC02LjE3LTkuODQtMTQuNjMtOS44NC0yMy45N1oiLz4KICAgIDxwYXRoIGNsYXNzPSJjbHMtNCIgZD0ibTE3My4wOSwyMjYuMDRsLTE3LjY0LDk1LjR2LTkwLjQ5Yy05LjM0LDAtMTcuODEtMy43Ni0yMy45Ny05Ljg0bC0uMjktLjA1LDI0LjI2LDEzMS4xOSwyNC4yNi0xMzEuMTktLjI5LjA1Yy0xLjksMS44OC00LjAzLDMuNTMtNi4zMyw0LjkyWiIvPgogICAgPHBhdGggY2xhc3M9ImNscy00IiBkPSJtMTc5LjcxLDE3Mi41NWwuMDUuMjljNi4wOCw2LjE3LDkuODQsMTQuNjMsOS44NCwyMy45NywwLC4wMiwwLC4wNCwwLC4wNWg5MC41NWwtOTUuNSwxNy42NmMtMS4zOCwyLjI3LTMuMDIsNC4zNy00Ljg4LDYuMjZsLS4wNS4yOSwxMzEuMTktMjQuMjYtMTMxLjE5LTI0LjI2WiIvPgogICAgPGc+CiAgICAgIDxwYXRoIGNsYXNzPSJjbHMtNCIgZD0ibTE3My42NCwxMzkuNzNjLTkuMTgsMy44My0xNy4yNyw0LjYzLTE3LjYzLDQuNjZsLS41Ny4wNS0uNTctLjA1cy0uMTUtLjAyLS4zMS0uMDNsLjA5LDE4LjMyYy4yNiwwLC41Mi0uMDIuNzgtLjAyLDkuMzQsMCwxNy44MSwzLjc2LDIzLjk3LDkuODRsLjI5LjA1LTYuMDctMzIuODJaIi8+CiAgICAgIDxwYXRoIGNsYXNzPSJjbHMtNCIgZD0ibTE0Mi42OSwxNDEuNzFjLTEuNzMtLjU1LTMuNTYtMS4yLTUuNDQtMS45OWwtNi4wNywzMi44Mi4yOS0uMDVjMS45NS0xLjkzLDQuMTQtMy42Miw2LjUxLTUuMDNsNC43MS0yNS43NVoiLz4KICAgIDwvZz4KICA8L2c+CiAgPHBhdGggY2xhc3M9ImNscy00IiBkPSJtMjgxLjE4LDE4NS4xN2MtMy4yMy0zNS4wMi0yMC44NC02NS45My00Ni44NC04Ni43OWwzLjY0LDI0LjEtLjQyLjEzYzE0LjY5LDE2LjIzLDI0LjY0LDM2LjgyLDI3LjY1LDU5LjYxbDE1Ljk3LDIuOTVaIi8+CiAgPGc+CiAgICA8cG9seWdvbiBjbGFzcz0iY2xzLTQiIHBvaW50cz0iMjUyLjEyIDQwLjg2IDIzMi44OCAzMi43MyAyMzIuODggNDguNCAyNTIuMTIgNDAuODYiLz4KICAgIDxnPgogICAgICA8cGF0aCBjbGFzcz0iY2xzLTMiIGQ9Im0xMDUuOTgsNTkuMzVzMTIuNjktMjguOTUsNDkuNDQtMjcuNjJMMTU1LjQ1LDAsNTguNzcsNDAuODZsNDcuMjEsMTguNDhaIi8+CiAgICAgIDxwYXRoIGNsYXNzPSJjbHMtNCIgZD0ibTIyOC40OCwxMDEuMmwtMi40NS0xNi4yMWMyLjg4LTEuNjMsNC44Mi00LjcyLDQuODItOC4yNiwwLTQuMTUtMi42Ny03LjY4LTYuMzgtOC45NnYtMjEuNDJoLS4wM3MwLTE3LjE5LDAtMTcuMTlMMTU1LjQ1LDBsLjAyLDMxLjczYzM2Ljc1LTEuMzQsNDkuNDQsMjcuNjIsNDkuNDQsMjcuNjJsMTMuMDItNS4xdjEzLjY1Yy0zLjU0LDEuMzgtNi4wNCw0LjgxLTYuMDQsOC44NCwwLDMuNDEsMS44LDYuNCw0LjUsOC4wN2wtMi40OCwxNi4zOS0yLjU0LDE2LjgxYzMuMS45Niw2LjQsMS40Nyw5LjgyLDEuNDdzNi43Mi0uNTIsOS44Mi0xLjQ3bC0yLjU0LTE2LjgxWiIvPgogICAgICA8Zz4KICAgICAgICA8cGF0aCBjbGFzcz0iY2xzLTMiIGQ9Im0xMTUuODUsNjguOTFjNS45Ny00LjEyLDEzLTYuMywyMC4zMy02LjMsNi45MywwLDEzLjY1LDEuOTMsMTkuNTIsNS40M3YtMzAuMTZzLS4wNCwwLS4wNiwwYy0yNS40MiwwLTQ2LjAyLDE2LjMxLTQ2LjAyLDM2LjQzLDAsLjAyLDAsLjA1LDAsLjA3LDEuODQtMi4wNSwzLjkzLTMuODgsNi4yMy01LjQ3WiIvPgogICAgICAgIDxwYXRoIGNsYXNzPSJjbHMtMyIgZD0ibTE0Ny44MywxMzcuNTljMi41MS44LDUuMTIsMS4yMiw3LjgxLDEuMjIuMDIsMCwuMDQsMCwuMDYsMHYtNC4xNmMtMi41LDEuMjktNS4xNCwyLjI4LTcuODcsMi45NFoiLz4KICAgICAgPC9nPgogICAgICA8cGF0aCBjbGFzcz0iY2xzLTMiIGQ9Im0xNTUuNjQsMTM4Ljgxcy4wNCwwLC4wNiwwdi02NS4wOWMtMTEuMDItNy45LTI1Ljg0LTguNzEtMzcuMTUtLjktMy4zLDIuMjgtNi4wMiw1LjA5LTguMTMsOC4yNi4xOC43NS4zOCwxLjQ5LjYyLDIuMjItMi4zOSwxLjA2LTQuMzIsMi43My01LjUsNC45Ni0zLjYyLDYuODYsMS4xNCwxNi40NywxMC42MiwyMS40NywxLjMuNjksMi42MiwxLjI1LDMuOTQsMS42OS4zOCwyLjg1LDEuMzEsNS4zNCwyLjU4LDcuMTMsMi4xNCwzLjYzLDYuMDksNy44NSwxMS4xNywxMS42NSw0LjM2LDMuMjUsOC43OCw1LjYyLDEyLjUzLDYuODcsMi45NCwxLjEzLDYuMDUsMS43Myw5LjI3LDEuNzNaIi8+CiAgICAgIDxnPgogICAgICAgIDxnPgogICAgICAgICAgPHBhdGggY2xhc3M9ImNscy00IiBkPSJtMTk1LjU1LDY4LjkxYy01Ljk3LTQuMTItMTMtNi4zLTIwLjMzLTYuMy02LjkzLDAtMTMuNjUsMS45My0xOS41Miw1LjQzdi0zMC4xNnMuMDQsMCwuMDYsMGMyNS40MiwwLDQ2LjAyLDE2LjMxLDQ2LjAyLDM2LjQzLDAsLjAyLDAsLjA1LDAsLjA3LTEuODQtMi4wNS0zLjkzLTMuODgtNi4yMy01LjQ3WiIvPgogICAgICAgICAgPHBhdGggY2xhc3M9ImNscy00IiBkPSJtMTYzLjU3LDEzNy41OWMtMi41MS44LTUuMTIsMS4yMi03LjgxLDEuMjItLjAyLDAtLjA0LDAtLjA2LDB2LTQuMTZjMi41LDEuMjksNS4xNCwyLjI4LDcuODcsMi45NFoiLz4KICAgICAgICA8L2c+CiAgICAgICAgPHBhdGggY2xhc3M9ImNscy00IiBkPSJtMTU1Ljc2LDEzOC44MXMtLjA0LDAtLjA2LDB2LTY1LjA5YzExLjAyLTcuOSwyNS44NC04LjcxLDM3LjE1LS45LDMuMywyLjI4LDYuMDIsNS4wOSw4LjEzLDguMjYtLjE4Ljc1LS4zOCwxLjQ5LS42MiwyLjIyLDIuMzksMS4wNiw0LjMyLDIuNzMsNS41LDQuOTYsMy42Miw2Ljg2LTEuMTQsMTYuNDctMTAuNjIsMjEuNDctMS4zLjY5LTIuNjIsMS4yNS0zLjk0LDEuNjktLjM4LDIuODUtMS4zMSw1LjM0LTIuNTgsNy4xMy0yLjE0LDMuNjMtNi4wOSw3Ljg1LTExLjE3LDExLjY1LTQuMzYsMy4yNS04Ljc4LDUuNjItMTIuNTMsNi44Ny0yLjk0LDEuMTMtNi4wNSwxLjczLTkuMjcsMS43M1oiLz4KICAgICAgPC9nPgogICAgICA8cGF0aCBjbGFzcz0iY2xzLTQiIGQ9Im05OS42OSw4NS40Yy40NC0uODQuOTYtMS42MiwxLjU0LTIuMzctLjAxLS4wNC0uMDItLjA4LS4wMy0uMTItMzkuMDgsMTguNzgtNjcuMDgsNTcuMDktNzEuMjQsMTAyLjJsMTUuOTctMi45NWM0LjU1LTM0LjQzLDI0LjkzLTYzLjg2LDUzLjU4LTgwLjc3LTIuMzEtNS4zMi0yLjQzLTExLjAzLjE5LTE1Ljk5WiIvPgogICAgPC9nPgogIDwvZz4KPC9zdmc+" alt="Gakusapo" style={{ width: '100%', height: '100%', objectFit: 'contain' }} />
        </div>
        
        <h1 style={{ fontSize: '22px', fontWeight: '700', marginBottom: '6px', color: '#1e293b' }}>
          採用ブラックボックス診断<span style={{ fontSize: '12px', verticalAlign: 'super' }}>®</span>
        </h1>
        <p style={{ color: '#64748b', fontSize: '14px', marginBottom: '32px' }}>
          Gakusapo メンバー専用
        </p>
        
        {/* Google Sign-In ボタン */}
        <div ref={btnRef} style={{ 
          display: 'flex', justifyContent: 'center', marginBottom: '16px', minHeight: '44px'
        }}></div>
        
        {loading && (
          <div style={{ color: '#3b82f6', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px', margin: '12px 0' }}>
            <svg width="20" height="20" viewBox="0 0 24 24" style={{ animation: 'spin 1s linear infinite' }}>
              <circle cx="12" cy="12" r="10" stroke="#3b82f6" strokeWidth="3" fill="none" strokeDasharray="31 31" strokeLinecap="round"/>
            </svg>
            認証中...
          </div>
        )}
        {error && (
          <div style={{
            background: '#fef2f2', border: '1px solid #fecaca', borderRadius: '8px',
            padding: '12px', margin: '12px 0', color: '#dc2626', fontSize: '13px', textAlign: 'left'
          }}>
            <strong>⚠ エラー:</strong> {error}
          </div>
        )}
        
        <p style={{ color: '#94a3b8', fontSize: '11px', marginTop: '28px', lineHeight: '1.5' }}>
          メンバーシートに登録されたGoogleアカウントでログインしてください<br/>
          ※ 登録がない場合は管理者にお問い合わせください
        </p>
      </div>
      <style>{`@keyframes spin { to { transform: rotate(360deg) } }`}</style>
    </div>
  );
};

// ========================================
// Googleスプレッドシート連携
// ========================================

const SpreadsheetManager = {
  // スプレッドシート設定の取得（v34: 常にGAS_CONFIG.gasUrlを使用）
  getConfig: () => {
    // GAS_CONFIGにgasUrlが設定されていれば有効
    if (window.GAS_CONFIG?.gasUrl) {
      return {
        enabled: true,
        scriptUrl: window.GAS_CONFIG.gasUrl,
        lastSync: null,
        autoConfigured: true
      };
    }
    
    try {
      const data = localStorage.getItem('gakusapo_spreadsheet_config');
      if (data) {
        return JSON.parse(data);
      }
    } catch (e) {
      console.error('スプレッドシート設定の読み込みに失敗:', e);
    }
    return {
      enabled: false,
      scriptUrl: '',
      lastSync: null
    };
  },
  
  // スプレッドシート設定の保存
  saveConfig: (config) => {
    try {
      localStorage.setItem('gakusapo_spreadsheet_config', JSON.stringify(config));
      return true;
    } catch (e) {
      console.error('スプレッドシート設定の保存に失敗:', e);
      return false;
    }
  },
  
  // 接続テスト
  testConnection: async (scriptUrl) => {
    try {
      const response = await fetch(`${scriptUrl}?action=ping`, {
        method: 'GET',
        redirect: 'follow'
      });
      const result = await response.json();
      return result.success === true;
    } catch (e) {
      console.error('接続テストに失敗:', e);
      return false;
    }
  },
  
  // 全顧客データを取得
  // 全顧客データを取得（v34: authFetch使用）
  fetchAllCustomers: async () => {
    const config = SpreadsheetManager.getConfig();
    if (!config.enabled || !config.scriptUrl) {
      console.warn('[fetchAllCustomers] 設定無効のため中断');
      return null;
    }
    
    try {
      console.log('[fetchAllCustomers] authFetch開始');
      const result = await authFetch('getCustomers');
      console.log('[fetchAllCustomers] 結果:', result ? `success=${result.success}, customers=${(result.customers || []).length}件` : 'null');
      
      if (result.success) {
        return { customers: result.customers || result.data || [], questionMasterCache: result.questionMasterCache || {} };
      }
      throw new Error(result.error || '取得に失敗しました');
    } catch (e) {
      console.error('[fetchAllCustomers] エラー:', e);
      throw e;
    }
  },
  
  // 顧客データを保存
  saveCustomer: async (customer, scores = {}) => {
    const config = SpreadsheetManager.getConfig();
    if (!config.enabled || !config.scriptUrl) {
      return null;
    }
    
    try {
      // 【inventory 10-A #1】effectiveData構築（共通関数を使用）
      const { effectiveData, finalScore, rank, typeDef } = buildEffectiveData(customer);
      
      const customerData = {
        ...customer,
        ...effectiveData,
        finalScore: finalScore,
        rank: rank,
        diagnosisType: typeDef?.name || ''
      };
      
      // v34: authPost使用
      const result = await authPost('saveCustomer', { customer: customerData });
      if (result.success) {
        // 同期日時を更新
        SpreadsheetManager.saveConfig({
          ...config,
          lastSync: new Date().toISOString()
        });
        return result.data;
      }
      throw new Error(result.error || '保存に失敗しました');
    } catch (e) {
      console.error('顧客データ保存に失敗:', e);
      throw e;
    }
  },
  
  // 顧客データを削除
  deleteCustomer: async (id) => {
    const config = SpreadsheetManager.getConfig();
    if (!config.enabled || !config.scriptUrl) {
      return null;
    }
    
    try {
      // v34: authPost使用
      const result = await authPost('deleteCustomer', { customerId: id });
      if (result.success) {
        return true;
      }
      throw new Error(result.error || '削除に失敗しました');
    } catch (e) {
      console.error('顧客データ削除に失敗:', e);
      throw e;
    }
  },
  
  // AI診断履歴を保存
  // v34: authPost使用
  saveAIHistory: async (history) => {
    try {
      const result = await authPost('saveAIHistory', { history: history });
      return result.success ? result.data : null;
    } catch (e) {
      console.error('AI履歴保存に失敗:', e);
      return null;
    }
  },
  
  // ローカルの全データをスプレッドシートに一括アップロード
  syncAllToSpreadsheet: async (customers, onProgress) => {
    const config = SpreadsheetManager.getConfig();
    if (!config.enabled || !config.scriptUrl) {
      throw new Error('スプレッドシート連携が有効になっていません');
    }
    
    const results = { success: 0, failed: 0, errors: [] };
    
    for (let i = 0; i < customers.length; i++) {
      const customer = customers[i];
      try {
        await SpreadsheetManager.saveCustomer(customer);
        results.success++;
      } catch (e) {
        results.failed++;
        results.errors.push({ id: customer.id, name: customer.companyName, error: e.message });
      }
      
      if (onProgress) {
        onProgress(i + 1, customers.length, customer.companyName);
      }
    }
    
    // 同期日時を更新
    SpreadsheetManager.saveConfig({
      ...config,
      lastSync: new Date().toISOString()
    });
    
    return results;
  },
  
  // スプレッドシートからローカルに読み込み（上書き or マージ）
  loadFromSpreadsheet: async (mode = 'merge') => {
    const config = SpreadsheetManager.getConfig();
    if (!config.enabled || !config.scriptUrl) {
      throw new Error('スプレッドシート連携が有効になっていません');
    }
    
    const fetchResult = await SpreadsheetManager.fetchAllCustomers();
    const spreadsheetData = fetchResult ? (fetchResult.customers || fetchResult) : null;
    if (!spreadsheetData || !Array.isArray(spreadsheetData)) {
      throw new Error('スプレッドシートからデータを取得できませんでした');
    }
    
    const localCustomers = StorageManager.getCustomers();
    let resultCustomers;
    
    if (mode === 'overwrite') {
      // 上書きモード：スプレッドシートのデータでローカルを完全に置き換え
      resultCustomers = spreadsheetData;
    } else {
      // マージモード：両方のデータをマージ（IDで重複判定、新しい方を優先）
      const mergedMap = new Map();
      
      // まずローカルデータを追加
      localCustomers.forEach(c => {
        mergedMap.set(c.id, c);
      });
      
      // スプレッドシートデータで上書き/追加（updatedAtで比較、新しい方を採用）
      spreadsheetData.forEach(c => {
        const existing = mergedMap.get(c.id);
        if (!existing) {
          mergedMap.set(c.id, c);
        } else {
          // 更新日時で比較、新しい方を採用
          const existingDate = new Date(existing.updatedAt || 0);
          const newDate = new Date(c.updatedAt || 0);
          if (newDate >= existingDate) {
            mergedMap.set(c.id, c);
          }
        }
      });
      
      resultCustomers = Array.from(mergedMap.values());
    }
    
    // ローカルに保存
    localStorage.setItem('gakusapo_bb_v2_customers', JSON.stringify(resultCustomers));
    
    // 同期日時を更新
    SpreadsheetManager.saveConfig({
      ...config,
      lastSync: new Date().toISOString()
    });
    
    return {
      mode,
      localCount: localCustomers.length,
      spreadsheetCount: spreadsheetData.length,
      resultCount: resultCustomers.length,
      customers: resultCustomers
    };
  },
  
  // スプレッドシートのデータを完全にローカルと同期（ローカルにないものを削除）
  fullSyncToSpreadsheet: async (customers, onProgress) => {
    const config = SpreadsheetManager.getConfig();
    if (!config.enabled || !config.scriptUrl) {
      throw new Error('スプレッドシート連携が有効になっていません');
    }
    
    try {
      const response = await fetch(config.scriptUrl, {
        method: 'POST',
        redirect: 'follow',
        headers: {
          'Content-Type': 'text/plain;charset=utf-8'
        },
        body: JSON.stringify({
          action: 'fullSync',
          customers: customers.map(c => {
            // 【inventory 10-A #2】effectiveData構築（共通関数を使用）
            const { effectiveData, finalScore, rank, typeDef } = buildEffectiveData(c);
            return {
              ...c,
              finalScore,
              rank,
              diagnosisType: typeDef?.name || '',
              studentScores: effectiveData.studentScores
            };
          })
        })
      });
      const result = await response.json();
      
      if (result.success) {
        SpreadsheetManager.saveConfig({
          ...config,
          lastSync: new Date().toISOString()
        });
        return result;
      }
      throw new Error(result.error || '同期に失敗しました');
    } catch (e) {
      console.error('完全同期に失敗:', e);
      throw e;
    }
  }
};

// ========================================
// マスターデータ用スプレッドシート連携
// ========================================

const MasterDataSpreadsheetManager = {
  // 設定の取得（GAS_CONFIGを優先）
  getConfig: () => {
    // GASモードの場合は自動設定を使用
    if (window.GAS_CONFIG?.deploymentMode === 'gas' && window.GAS_CONFIG?.gasUrl) {
      return {
        enabled: true,
        scriptUrl: window.GAS_CONFIG.gasUrl,
        lastSync: null,
        autoConfigured: true
      };
    }
    
    try {
      const data = localStorage.getItem('gakusapo_master_spreadsheet_config');
      if (data) {
        return JSON.parse(data);
      }
    } catch (e) {
      console.error('マスターデータスプレッドシート設定の読み込みに失敗:', e);
    }
    return {
      enabled: false,
      scriptUrl: '',
      lastSync: null
    };
  },
  
  // 設定の保存
  saveConfig: (config) => {
    try {
      localStorage.setItem('gakusapo_master_spreadsheet_config', JSON.stringify(config));
      return true;
    } catch (e) {
      console.error('マスターデータスプレッドシート設定の保存に失敗:', e);
      return false;
    }
  },
  
  // 接続テスト
  testConnection: async (scriptUrl) => {
    try {
      const response = await fetch(`${scriptUrl}?action=ping`, {
        method: 'GET',
        redirect: 'follow'
      });
      const result = await response.json();
      return result.success === true;
    } catch (e) {
      console.error('接続テストに失敗:', e);
      return false;
    }
  },
  
  // 採用手法マスターを取得
  fetchRecruitmentMethods: async (scriptUrl) => {
    try {
      const response = await fetch(`${scriptUrl}?action=getRecruitmentMethods`, {
        method: 'GET',
        redirect: 'follow'
      });
      const result = await response.json();
      if (result.success) {
        return result.data;
      }
      throw new Error(result.error || '取得に失敗しました');
    } catch (e) {
      console.error('採用手法マスター取得に失敗:', e);
      throw e;
    }
  },
  
  // 歩留まり率マスターを取得
  fetchYieldRates: async (scriptUrl) => {
    try {
      debugLog('fetchYieldRates: リクエスト送信 ->', scriptUrl + '?action=getYieldMaster');
      const response = await fetch(`${scriptUrl}?action=getYieldMaster`, {
        method: 'GET',
        redirect: 'follow'
      });
      debugLog('fetchYieldRates: レスポンスステータス ->', response.status);
      const result = await response.json();
      debugLog('fetchYieldRates: レスポンスJSON ->', result);
      if (result.success) {
        return result.data;
      }
      throw new Error(result.error || '取得に失敗しました');
    } catch (e) {
      console.error('歩留まり率マスター取得に失敗:', e);
      throw e;
    }
  },
  
  // 質問マスターを取得
  fetchQuestionMaster: async (scriptUrl) => {
    try {
      const response = await fetch(`${scriptUrl}?action=getQuestionMaster`, {
        method: 'GET',
        redirect: 'follow'
      });
      const result = await response.json();
      if (result.success) {
        return result.data;
      }
      throw new Error(result.error || '取得に失敗しました');
    } catch (e) {
      console.error('質問マスター取得に失敗:', e);
      throw e;
    }
  },
  
  // 媒体利用率マスターを取得
  fetchLayerMediaUsage: async (scriptUrl) => {
    try {
      const response = await fetch(`${scriptUrl}?action=getLayerMediaUsage`, {
        method: 'GET',
        redirect: 'follow'
      });
      const result = await response.json();
      if (result.success) {
        return result.data;
      }
      throw new Error(result.error || '取得に失敗しました');
    } catch (e) {
      console.error('媒体利用率マスター取得に失敗:', e);
      throw e;
    }
  }
};

// AI API呼び出し関数（Gemini）
const generateAIDiagnosisGemini = async (systemPrompt, userPrompt, apiKey) => {
  // 最新のモデル名を使用
  const MODEL_NAME = 'gemini-2.0-flash';
  const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent`;
  
  try {
    const response = await fetch(`${API_URL}?key=${apiKey}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        contents: [{
          role: "user",
          parts: [{ text: systemPrompt + "\n\n" + userPrompt }]
        }],
        generationConfig: {
          temperature: 0.7,
          maxOutputTokens: 2048,
        }
      })
    });

    // エラーチェック（429: Too Many Requests - レート制限）
    if (response.status === 429) {
      console.warn("APIレート制限に達しました。バックアップ文言を使用します。");
      return generateFallbackResponse();
    }

    if (!response.ok) {
      const errorData = await response.json().catch(() => ({}));
      throw new Error(`API Error: ${response.status} - ${errorData.error?.message || 'Unknown error'}`);
    }

    const resData = await response.json();
    return resData.candidates[0].content.parts[0].text;
  } catch (error) {
    console.error("Gemini API エラー:", error);
    // 完全にエラーになった場合もフォールバック文言を返す
    if (error.message?.includes('429') || error.message?.includes('quota')) {
      return generateFallbackResponse();
    }
    throw error;
  }
};

// フォールバック用のレスポンス生成関数
const generateFallbackResponse = () => {
  return `[SECTION_1]
■ 処方箋：今すぐ捨てるべき活動
【現在AIコンサルタントが混み合っています】
基本診断結果に基づき、御社は「無駄を削ぎ落とし、本質的な魅力を再定義する」フェーズにあります。まずは効果測定ができていない施策を全てリストアップし、投資対効果の低いものから順に停止してください。

[SECTION_2]
■ 採用担当者へ：明日からやめるべき無駄な作業
「全員に丁寧に対応する」という姿勢を見直してください。ターゲット外の学生への対応時間を削減し、本命層への接触時間を倍増させることが急務です。

[SECTION_3]
■ 上層部へ：投資対効果の低い無駄なコスト
複数のナビサイトへの同時掲載を見直してください。効果の薄い媒体への投資を止め、最も反応の良い1〜2媒体に予算を集中させることで、ROIを改善できます。

[SECTION_4]
■ 組織の課題：根本原因のマインドセット
「とりあえず広く網を張る」という思考が無駄の根源です。「選ばれる企業になる」のではなく「選ぶ企業になる」へのマインドシフトが必要です。`;
};

// AI API呼び出し関数（OpenAI）
const generateAIDiagnosisOpenAI = async (systemPrompt, userPrompt, apiKey) => {
  const API_URL = 'https://api.openai.com/v1/chat/completions';
  
  try {
    const response = await fetch(API_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${apiKey}`
      },
      body: JSON.stringify({
        model: "gpt-4",
        messages: [
          { role: "system", content: systemPrompt },
          { role: "user", content: userPrompt }
        ],
        temperature: 0.7
      })
    });

    // エラーチェック（429: Too Many Requests - レート制限）
    if (response.status === 429) {
      console.warn("OpenAI APIレート制限に達しました。バックアップ文言を使用します。");
      return generateFallbackResponse();
    }

    if (!response.ok) {
      const errorData = await response.json().catch(() => ({}));
      throw new Error(`API Error: ${response.status} - ${errorData.error?.message || 'Unknown error'}`);
    }

    const resData = await response.json();
    return resData.choices[0].message.content;
  } catch (error) {
    console.error("OpenAI API エラー:", error);
    // 完全にエラーになった場合もフォールバック文言を返す
    if (error.message?.includes('429') || error.message?.includes('quota') || error.message?.includes('rate')) {
      return generateFallbackResponse();
    }
    throw error;
  }
};

// AIレスポンスのパース関数
const parseAIResponse = (aiAdvice) => {
  if (!aiAdvice) return null;
  
  const sections = aiAdvice.split(/\[SECTION_\d+\]/);
  
  const cleanSection = (text) => {
    if (!text) return '';
    return text
      .replace(/^[\s\n]*■[^\n]*\n?/m, '')
      .replace(/^→[^\n]*\n?/m, '')
      .trim();
  };
  
  return {
    prescription: cleanSection(sections[1]) || '',
    forRecruiter: cleanSection(sections[2]) || '',
    forManagement: cleanSection(sections[3]) || '',
    organizationIssue: cleanSection(sections[4]) || ''
  };
};

// プロンプトテンプレートに値を埋め込む関数
// ========================================
// 採用手法の効率を計算
// ========================================

// 学生層別媒体利用率マスターを取得
const getLayerMediaUsage = () => {
  try {
    const saved = localStorage.getItem('gakusapo_layer_media_usage');
    return saved ? JSON.parse(saved) : DEFAULT_LAYER_MEDIA_USAGE;
  } catch (e) {
    return DEFAULT_LAYER_MEDIA_USAGE;
  }
};

// 【inventory 2-12】採用手法効率分析（activeMethods, totalBudget, methodDetails）
const calcRecruitmentEfficiency = (data) => {
  const METHODS = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
  const LAYER_USAGE = data.layerMediaUsage || getLayerMediaUsage();
  
  // ターゲット層と重み付けを取得
  const targetLayerConfig = Object.entries(data.targetLayers || {})
    .filter(([_, v]) => v?.enabled)
    .map(([layer, config]) => ({
      layer,
      weight: config.ratio || 0
    }));
  
  // 重みの合計を計算（正規化用）
  const totalWeight = targetLayerConfig.reduce((sum, t) => sum + t.weight, 0);
  
  if (targetLayerConfig.length === 0 || totalWeight === 0) {
    return {
      targetLayers: [],
      targetLayerDetails: [],
      activeMethods: [],
      totalBudget: 0,
      methodDetails: [],
      recommendedAllocation: {}
    };
  }
  
  // 利用中の媒体を取得
  const activeMethods = Object.entries(data.recruitmentMethods || {})
    .filter(([_, m]) => m?.active)
    .map(([key, m]) => ({
      key,
      name: METHODS[key]?.name || key,
      category: METHODS[key]?.category || '不明',
      budget: parseInt(m.budget) || 0,
      priority: parseInt(m.priority) || 0
    }));
  
  if (activeMethods.length === 0) {
    return {
      targetLayers: targetLayerConfig.map(t => t.layer),
      targetLayerDetails: targetLayerConfig,
      activeMethods: [],
      totalBudget: 0,
      methodDetails: [],
      recommendedAllocation: {}
    };
  }
  
  // 各媒体のターゲット到達期待値を計算
  const methodReachRates = {};
  let totalReachRate = 0;
  
  activeMethods.forEach(method => {
    let reachRate = 0;
    
    targetLayerConfig.forEach(({ layer, weight }) => {
      const layerUsage = LAYER_USAGE[layer]?.[method.key] || 0;
      reachRate += layerUsage * (weight / totalWeight);
    });
    
    methodReachRates[method.key] = Math.round(reachRate * 10) / 10;
    totalReachRate += reachRate;
  });
  
  // 推奨投資配分を計算（ターゲット到達期待値に基づく）
  const recommendedAllocation = {};
  activeMethods.forEach(method => {
    if (totalReachRate > 0) {
      recommendedAllocation[method.key] = Math.round((methodReachRates[method.key] / totalReachRate) * 100);
    } else {
      recommendedAllocation[method.key] = Math.round(100 / activeMethods.length);
    }
  });
  
  // 推奨配分の合計を100%に調整
  const recommendedSum = Object.values(recommendedAllocation).reduce((a, b) => a + b, 0);
  if (recommendedSum !== 100 && activeMethods.length > 0) {
    const diff = 100 - recommendedSum;
    const maxKey = Object.entries(recommendedAllocation).sort((a, b) => b[1] - a[1])[0]?.[0];
    if (maxKey) recommendedAllocation[maxKey] += diff;
  }
  
  const totalBudget = activeMethods.reduce((sum, m) => sum + m.budget, 0);
  
  const methodDetails = activeMethods.map(method => {
    const recommended = recommendedAllocation[method.key] || 0;
    const reachRate = methodReachRates[method.key] || 0;
    const budgetRatio = totalBudget > 0 ? Math.round((method.budget / totalBudget) * 100) : 0;
    
    return {
      ...method,
      reachRate,
      recommended,
      budgetRatio
    };
  });
  
  return {
    targetLayers: targetLayerConfig.map(t => t.layer),
    targetLayerDetails: targetLayerConfig,
    activeMethods,
    totalBudget,
    methodDetails,
    recommendedAllocation,
    methodReachRates
  };
};

// 【inventory 3-2】採用手法分析をテキストに変換（{recruitmentAnalysis} に展開）
const formatRecruitmentAnalysis = (efficiency) => {
  if (!efficiency || efficiency.activeMethods.length === 0) {
    return '採用手法データなし';
  }
  
  let text = '';
  
  // ターゲット層と重み
  const layerText = efficiency.targetLayerDetails
    .map(t => `${t.layer}層(${t.weight}%)`)
    .join(', ');
  text += `ターゲット学生層: ${layerText}\n`;
  text += `利用媒体数: ${efficiency.activeMethods.length}件\n`;
  text += `投資予算合計: ${efficiency.totalBudget.toLocaleString()}万円\n\n`;
  
  // 媒体別詳細（注力順位でソート）
  text += `【媒体別分析】\n`;
  const sorted = [...efficiency.methodDetails].sort((a, b) => {
    if (a.priority && b.priority) return a.priority - b.priority;
    if (a.priority) return -1;
    if (b.priority) return 1;
    return b.budget - a.budget;
  });
  sorted.forEach(m => {
    const priorityStr = m.priority ? `注力${m.priority}位` : '順位未設定';
    text += `${m.name}（${m.category}）[${priorityStr}]\n`;
    text += `  投資予算: ${m.budget.toLocaleString()}万円（構成比${m.budgetRatio}%）\n`;
    text += `  ターゲット到達期待値: ${m.reachRate}% → 推奨配分: ${m.recommended}%\n`;
  });
  
  return text;
};

// Pro診断用：推奨配分との比較を可視化
const formatRecruitmentAnalysisPro = (efficiency) => {
  if (!efficiency || efficiency.activeMethods.length === 0) {
    return '採用手法データなし';
  }
  
  let text = formatRecruitmentAnalysis(efficiency);
  
  text += `\n【推奨投資配分 vs 実際の配分】\n`;
  text += `媒体名               | 注力順位 | 予算(万円) | 構成比 | 推奨配分\n`;
  text += `---------------------|---------|-----------|-------|--------\n`;
  
  efficiency.methodDetails
    .sort((a, b) => b.recommended - a.recommended)
    .forEach(m => {
      const name = (m.name + '                    ').substring(0, 18);
      const priority = m.priority ? `${m.priority}位   ` : '未設定  ';
      text += `${name} | ${priority.substring(0, 7)} | ${(m.budget.toLocaleString() + '      ').substring(0, 9)} | ${(m.budgetRatio + '%   ').substring(0, 5)} | ${m.recommended}%\n`;
    });
  
  return text;
};

// 【inventory 3-1 / 9-B】AIプロンプト完成文を構築（テンプレートのプレースホルダーを置換）
const buildUserPrompt = (template, data) => {
  // 採用手法効率を計算
  const efficiency = data.recruitmentEfficiency || { methodDetails: [], totalBudget: 0 };
  const recruitmentAnalysis = formatRecruitmentAnalysis(efficiency);
  const recruitmentAnalysisPro = formatRecruitmentAnalysisPro(efficiency);
  
  // 注力タイプスコア（フェーズ別スコア）
  const depthScores = data.depthScores || { surface: 0, middle: 0, deep: 0 };
  
  // 歩留まり実績と目標の乖離分析
  const yieldGapAnalysis = formatYieldGapAnalysis(data);
  
  // 【強化】投資分析サマリー
  const investmentAnalysis = formatInvestmentAnalysisSummary(data);
  
  // 投資予算合計
  const totalBudget = efficiency.totalBudget || 0;
  
  // replaceAllを使用して、同じプレースホルダーが複数回出現しても全て置換する
  return template
    .replaceAll('{companyName}', data.companyName || '未入力')
    .replaceAll('{industry}', data.industry || '未選択')
    .replaceAll('{employeeCount}', data.companySize || '未選択')
    .replaceAll('{rank}', data.rank || '未判定')
    .replaceAll('{diagnosisTypeName}', data.diagnosisType?.name || '未判定')
    .replaceAll('{diagnosisTypeDescription}', data.diagnosisType?.description || '')
    .replaceAll('{scores.recognition}', String(data.scores?.recognition ?? '-'))
    .replaceAll('{scores.specificity}', String(data.scores?.specificity ?? '-'))
    .replaceAll('{scores.differentiation}', String(data.scores?.differentiation ?? '-'))
    .replaceAll('{scores.visionEmpathy}', String(data.scores?.visionEmpathy ?? '-'))
    .replaceAll('{scores.selectionUX}', String(data.scores?.selectionUX ?? '-'))
    .replaceAll('{scores.dialogue}', String(data.scores?.dialogue ?? '-'))
    .replaceAll('{depthScores.surface}', String(depthScores.surface ?? '-'))
    .replaceAll('{depthScores.middle}', String(depthScores.middle ?? '-'))
    .replaceAll('{depthScores.deep}', String(depthScores.deep ?? '-'))
    .replaceAll('{yieldGapAnalysis}', yieldGapAnalysis)
    .replaceAll('{investmentAnalysis}', investmentAnalysis)
    .replaceAll('{recruitmentAnalysisPro}', recruitmentAnalysisPro)
    .replaceAll('{recruitmentAnalysis}', recruitmentAnalysis)
    .replaceAll('{mismatchRate}', String(totalBudget))
    .replaceAll('{wasteRate}', '0')
    .replaceAll('{totalBudget}', String(totalBudget))
    .replaceAll('{remarks}', data.remarks || '特になし');
};

// 【inventory 3-4】歩留まり実績と目標の乖離を分析してテキスト化（{yieldGapAnalysis} に展開）
const formatYieldGapAnalysis = (data) => {
  const funnelData = data.funnelData || {};
  const industryAverages = data.industryAverages || {};
  const adjustedAverages = data.adjustedAverages || {};
  
  // 実績値
  const awareness = funnelData.targetAwareness;
  const interest = funnelData.interest;
  const applications = funnelData.applications;
  const screening = funnelData.screening;
  const offers = funnelData.offers;
  const acceptance = funnelData.acceptance;
  
  // データが入力されていない場合
  if (!awareness && !interest && !applications && !screening && !offers && !acceptance) {
    return '採用実績データが未入力のため、歩留まり分析はできません。';
  }
  
  // 業界平均（調整値優先）
  const avgRates = {
    awarenessToInterest: adjustedAverages?.awarenessToInterest ?? industryAverages?.awarenessToInterest ?? 22,
    interestToApplication: adjustedAverages?.interestToApplication ?? industryAverages?.interestToApplication ?? 25,
    applicationToScreening: adjustedAverages?.applicationToScreening ?? industryAverages?.applicationToScreening ?? 25,
    screeningToOffer: adjustedAverages?.screeningToOffer ?? industryAverages?.screeningToOffer ?? 41,
    offerToAcceptance: adjustedAverages?.offerToAcceptance ?? industryAverages?.offerToAcceptance ?? 80
  };
  
  // 実績の歩留まり率を計算
  const actualRates = {
    awarenessToInterest: awareness > 0 ? Math.round((interest / awareness) * 100) : null,
    interestToApplication: interest > 0 ? Math.round((applications / interest) * 100) : null,
    applicationToScreening: applications > 0 ? Math.round((screening / applications) * 100) : null,
    screeningToOffer: screening > 0 ? Math.round((offers / screening) * 100) : null,
    offerToAcceptance: offers > 0 ? Math.round((acceptance / offers) * 100) : null
  };
  
  // フェーズ名のマッピング
  const phaseNames = {
    awarenessToInterest: '認知→興味（表層部）',
    interestToApplication: '興味→接触（中層部）',
    applicationToScreening: '接触→選考（中層部）',
    screeningToOffer: '選考→内々定（中層部）',
    offerToAcceptance: '内々定→承諾（深層部）'
  };
  
  let analysis = [];
  let surfaceIssues = [];
  let middleIssues = [];
  let deepIssues = [];
  
  Object.entries(actualRates).forEach(([key, actualRate]) => {
    if (actualRate !== null) {
      const targetRate = avgRates[key];
      const gap = actualRate - targetRate;
      const gapText = gap >= 0 ? `+${gap}%（目標達成）` : `${gap}%（目標未達）`;
      
      analysis.push(`- ${phaseNames[key]}: 実績${actualRate}% / 目標${targetRate}% → 乖離${gapText}`);
      
      // フェーズ別に問題を分類
      if (gap < -10) { // 10%以上の乖離
        if (key === 'awarenessToInterest') {
          surfaceIssues.push(`${phaseNames[key]}で大きな乖離（${gap}%）`);
        } else if (key === 'offerToAcceptance') {
          deepIssues.push(`${phaseNames[key]}で大きな乖離（${gap}%）`);
        } else {
          middleIssues.push(`${phaseNames[key]}で大きな乖離（${gap}%）`);
        }
      }
    }
  });
  
  if (analysis.length === 0) {
    return '歩留まり率を計算するためのデータが不足しています。';
  }
  
  let result = analysis.join('\n');
  
  // 問題点のサマリー
  let issues = [];
  if (surfaceIssues.length > 0) {
    issues.push(`【表層部の課題】${surfaceIssues.join('、')}`);
  }
  if (middleIssues.length > 0) {
    issues.push(`【中層部の課題】${middleIssues.join('、')}`);
  }
  if (deepIssues.length > 0) {
    issues.push(`【深層部の課題】${deepIssues.join('、')}`);
  }
  
  if (issues.length > 0) {
    result += '\n\n' + issues.join('\n');
  }
  
  return result;
};

// ========================================
// ユーティリティ
// ========================================

const StorageManager = {
  getCustomers: () => {
    try {
      const data = localStorage.getItem('gakusapo_bb_v2_customers');
      return data ? JSON.parse(data) : [];
    } catch { return []; }
  },
  saveCustomer: (customer) => {
    const customers = StorageManager.getCustomers();
    const idx = customers.findIndex(c => c.id === customer.id);
    if (idx >= 0) customers[idx] = customer;
    else customers.push(customer);
    localStorage.setItem('gakusapo_bb_v2_customers', JSON.stringify(customers));
  },
  deleteCustomer: (id) => {
    const customers = StorageManager.getCustomers().filter(c => c.id !== id);
    localStorage.setItem('gakusapo_bb_v2_customers', JSON.stringify(customers));
  },
  // 学生番号の管理
  getStudentId: () => {
    return localStorage.getItem('gakusapo_student_id') || '0001';
  },
  setStudentId: (id) => {
    localStorage.setItem('gakusapo_student_id', id);
  },
  // 月別商談カウントの管理
  getMonthlyCount: (yearMonth) => {
    try {
      const data = localStorage.getItem('gakusapo_monthly_counts');
      const counts = data ? JSON.parse(data) : {};
      return counts[yearMonth] || 0;
    } catch { return 0; }
  },
  incrementMonthlyCount: (yearMonth) => {
    try {
      const data = localStorage.getItem('gakusapo_monthly_counts');
      const counts = data ? JSON.parse(data) : {};
      counts[yearMonth] = (counts[yearMonth] || 0) + 1;
      localStorage.setItem('gakusapo_monthly_counts', JSON.stringify(counts));
      return counts[yearMonth];
    } catch { return 1; }
  }
};

// ========================================
// GASデータマネージャー（スプレッドシート連携）
// ========================================

// GASから取得したマスターデータをキャッシュ
let _gasYieldMaster = null;
let _gasMethodCategories = null;  // スプレッドシートから取得した手法カテゴリ一覧
let _gasQuestionMaster = null;
let _gasMethodMaster = null;
let _gasMediaUsageMaster = null;
let _gasAISettings = null;
let _gasMasterDataLoaded = false;

/**
 * 【inventory A-1 / A-2 / A-3】GAS から受け取った顧客データを正規化する共通関数
 * google.script.runのシリアライゼーションで失われる可能性のあるデータを
 * 複数のソースから多段フォールバックで復元する
 */
const normalizeGASCustomer = (c, questionMasterCache = {}) => {
  // JSON文字列を安全にパースするヘルパー
  const safeParse = (val) => {
    if (!val) return null;
    if (typeof val === 'object') return val; // 既にオブジェクト
    if (typeof val !== 'string') return null;
    try { return JSON.parse(val); } catch(e) { return null; }
  };
  
  // 非空オブジェクト判定（配列やプレーンオブジェクトのみ、文字列は除外）
  const hasContent = (obj) => obj && typeof obj === 'object' && !Array.isArray(obj) && Object.keys(obj).length > 0;
  
  // 1. 診断データJSON から全データ復元（最も信頼性の高いバックアップ）
  const fullData = safeParse(c['診断データJSON']) || {};
  
  // 2. 回答データ: GASパース済み → 列の生JSON → fullData → 空
  const staffAnswers = (hasContent(c.staffAnswers) ? c.staffAnswers : null)
    || safeParse(c['担当者回答'])
    || (hasContent(fullData.staffAnswers) ? fullData.staffAnswers : null)
    || {};
  const executiveAnswers = (hasContent(c.executiveAnswers) ? c.executiveAnswers : null)
    || safeParse(c['経営者回答'])
    || (hasContent(fullData.executiveAnswers) ? fullData.executiveAnswers : null)
    || {};
  const studentAnswers = (hasContent(c.studentAnswers) ? c.studentAnswers : null)
    || safeParse(c['学生回答'])
    || (hasContent(fullData.studentAnswers) ? fullData.studentAnswers : null)
    || {};
  
  // 3. スコアデータ: GASパース済み → fullData → 空
  const staffScores = (hasContent(c.staffScores) ? c.staffScores : null) || fullData.staffScores || {};
  const executiveScores = (hasContent(c.executiveScores) ? c.executiveScores : null) || fullData.executiveScores || {};
  const studentScores = (hasContent(c.studentScores) ? c.studentScores : null) || fullData.studentScores || {};
  const mindsetScores = (hasContent(c.mindsetScores) ? c.mindsetScores : null) || fullData.mindsetScores || {};
  const depthScores = (hasContent(c.depthScores) ? c.depthScores : null) || fullData.depthScores || {};
  
  // 4. ファネル・手法等
  const funnelData = (hasContent(c.funnelData) ? c.funnelData : null) || fullData.funnelData || {
    targetAwareness: c['認知数'] ?? 0,
    interest: c['興味数'] ?? 0,
    applications: c['応募数'] ?? 0,
    screening: c['選考数'] ?? 0,
    offers: c['内定数'] ?? 0,
    acceptance: c['承諾数'] ?? 0
  };
  const channelLabels = (hasContent(c.channelLabels) ? c.channelLabels : null) || fullData.channelLabels || null;
  const recruitmentMethods = (hasContent(c.recruitmentMethods) ? c.recruitmentMethods : null) || fullData.recruitmentMethods || {};
  const targetLayers = (hasContent(c.targetLayers) ? c.targetLayers : null) || fullData.targetLayers || {};
  const yieldSettings = (hasContent(c.yieldSettings) ? c.yieldSettings : null) || fullData.yieldSettings || {};
  const industryAverages = (hasContent(c.industryAverages) ? c.industryAverages : null) || fullData.industryAverages || {};
  const adjustedAverages = (hasContent(c.adjustedAverages) ? c.adjustedAverages : null) || fullData.adjustedAverages || {};
  
  return {
    ...c,
    // 基本情報
    id: c['問い合わせNo'] || c.inquiryNo || c.id,
    inquiryNo: c['問い合わせNo'] || c.inquiryNo,
    companyName: c['会社名'] || c.companyName,
    diagnosisDate: c['診断日時'] || c.diagnosisDate,
    industry: c['業種'] || c.industry,
    region: c['地域'] || c.region,
    contactName: c['担当者名'] || c.contactName,
    email: c['メール'] || c.email,
    phone: c['電話'] || c.phone,
    companySize: c['従業員規模'] || c.employeeCount || c.companySize,
    totalScore: c['総合スコア'] ?? c.totalScore,
    rank: c['ランク'] || c.rank,
    diagnosisType: c['症例タイプ'] || c.diagnosisType,
    targetLayer: c['ターゲット層'] || c.targetLayer || '',
    // 備考: UIは data.notes で読み書き、GAS保存は data.remarks で読み取るため両方に設定
    notes: c['備考'] || c.remarks || c.notes || '',
    remarks: c['備考'] || c.remarks || c.notes || '',
    assigneeId: (() => {
      const raw = c['担当者ID'] ?? c.assigneeId ?? '';
      const padded = String(raw || '').padStart(4, '0');
      return (padded && padded !== '0000') ? padded : String(c['問い合わせNo'] || '').padStart(13, '0').substring(0, 4) || '0000';
    })(),
    aiResult: c['AI診断結果'] || c.aiResult || '',
    // 回答データ（多段フォールバック復元済み）
    staffAnswers,
    executiveAnswers,
    studentAnswers,
    // スコアデータ（多段フォールバック復元済み）
    staffScores,
    executiveScores,
    studentScores,
    mindsetScores,
    depthScores,
    // ファネル・手法等
    funnelData,
    channelLabels,
    recruitmentMethods,
    targetLayers,
    yieldSettings,
    industryAverages,
    adjustedAverages,
    // その他
    todayChallenge: c.todayChallenge || fullData.todayChallenge || '',
    pastChallenges: c.pastChallenges || fullData.pastChallenges || '',
    improvementGoals: (hasContent(c.improvementGoals) ? c.improvementGoals : null) || fullData.improvementGoals || {},
    targetNotes: c.targetNotes || fullData.targetNotes || '',
    // 診断時の問診マスタースナップショット
    // 優先順: インラインsavedQuestionMaster → questionMasterIdからキャッシュ解決 → fullData → null
    savedQuestionMaster: (() => {
      // 1. インラインで保持されている場合（旧方式互換）
      if (hasContent(c.savedQuestionMaster)) return c.savedQuestionMaster;
      // 2. マスターIDからキャッシュ解決（別シート分離方式）
      const masterId = c.questionMasterId || fullData.questionMasterId;
      if (masterId && questionMasterCache[masterId]) return questionMasterCache[masterId];
      // 3. fullData内のインラインバックアップ
      if (hasContent(fullData.savedQuestionMaster)) return fullData.savedQuestionMaster;
      return null;
    })(),
    // マスターID（再保存時にスナップショットを再利用するため保持）
    questionMasterId: c.questionMasterId || fullData.questionMasterId || null
  };
};

const GASDataManager = {
  // 歩留まりマスターを読み込み
  loadYieldMaster: async () => {
      const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
      
      const _handleResult = (result) => {
        if (result.success && result.data) {
          _gasYieldMaster = result.data;
          // 手法カテゴリ一覧も保存
          if (result.methodCategories && result.methodCategories.length > 0) {
            _gasMethodCategories = result.methodCategories;
            try {
              localStorage.setItem('gakusapo_method_categories', JSON.stringify(result.methodCategories));
            } catch (e) {}
          }
          try {
            localStorage.setItem('gakusapo_yield_master', JSON.stringify(result.data));
          } catch (e) {}
        }
        return result.data || null;
      };
      
      // v34: authFetch使用
      try {
        const result = await authFetch('getYieldMaster');
        if (result.success && result.data) {
          return _handleResult(result);
        } else {
          return null;
        }
      } catch (err) {
        console.error('歩留まりマスター読み込みエラー:', err);
        return null;
      }
  },
  
  // 歩留まりマスターを取得（キャッシュから）
  getYieldMaster: () => {
    if (_gasYieldMaster) {
      return _gasYieldMaster;
    }
    // フォールバック: ローカルストレージから
    try {
      const saved = localStorage.getItem('gakusapo_yield_master');
      return saved ? JSON.parse(saved) : null;
    } catch (e) {
      return null;
    }
  },
  
  // スプレッドシートから取得した手法カテゴリ一覧を返す
  getMethodCategories: () => {
    if (_gasMethodCategories && _gasMethodCategories.length > 0) {
      return _gasMethodCategories;
    }
    try {
      const saved = localStorage.getItem('gakusapo_method_categories');
      if (saved) {
        const parsed = JSON.parse(saved);
        if (Array.isArray(parsed) && parsed.length > 0) return parsed;
      }
    } catch (e) {}
    return null;  // nullの場合はフォールバックリストを使用
  },
  
  // 歩留まりマスターを保存（スプレッドシートに）
  saveYieldMaster: async (masterData) => {
      const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
      
      // ローカルストレージに保存
      try {
        localStorage.setItem('gakusapo_yield_master', JSON.stringify(masterData));
        _gasYieldMaster = masterData;
      } catch (e) {}
      
      // v34: authPost使用
      try {
        const result = await authPost('saveYieldMaster', { masterData: masterData });
        console.log('歩留まりマスターをスプレッドシートに保存しました');
        return result;
      } catch (err) {
        console.error('歩留まりマスター保存エラー:', err);
        return { success: false, error: err.message };
      } 
  },
  
  // 質問マスターを読み込み
  loadQuestionMaster: async () => {
      try {
        // v34: authFetch使用
        try {
          const qmResult = await authFetch('getQuestionMaster');
          if (qmResult.success && qmResult.data) {
            _gasQuestionMaster = qmResult.data;
            try { localStorage.setItem('gakusapo_question_master', JSON.stringify(qmResult.data)); } catch (e) {}
          }
          return qmResult.data || null;
        } catch (err) {
          console.error('質問マスター読み込みエラー:', err);
          return null;
        }
      } catch (err) {
        console.error('質問マスター読み込みエラー:', err);
        return null;
      }
  },
  
  // 質問マスターを取得（キャッシュから）
  getQuestionMaster: () => {
    if (_gasQuestionMaster) {
      return _gasQuestionMaster;
    }
    // フォールバック: ローカルストレージから
    try {
      const saved = localStorage.getItem('gakusapo_question_master');
      return saved ? JSON.parse(saved) : null;
    } catch (e) {
      return null;
    }
  },
  
  // 質問マスターを保存（スプレッドシートに）
  saveQuestionMaster: async (questionsData) => {
      // ローカルストレージに保存
      try {
        localStorage.setItem('gakusapo_question_master', JSON.stringify(questionsData));
      } catch (e) {}
      
      // v34: authPost使用
      _gasQuestionMaster = questionsData;
      try {
        const qmSaveResult = await authPost('saveQuestionMaster', { questionsData: questionsData });
        console.log('質問マスターをスプレッドシートに保存しました');
        return qmSaveResult;
      } catch (err) {
        console.error('質問マスター保存エラー:', err);
        return { success: false, error: err.message };
      }
  },
  
  // AI設定を読み込み
  loadAISettings: async () => {
      try {
        // v34: authFetch使用
        try {
          const aiResult = await authFetch('getAISettings');
          if (aiResult.success && aiResult.settings) {
            _gasAISettings = aiResult.settings;
            console.log('AI設定をGASから読み込み:', aiResult.settings);
            try { localStorage.setItem('gakusapo_ai_settings', JSON.stringify(aiResult.settings)); } catch (e) {}
          }
          return aiResult.settings || null;
        } catch (err) {
          console.error('AI設定読み込みエラー:', err);
          return null;
        }
/* v34: removed */
      } catch (err) {
        console.error('AI設定読み込みエラー:', err);
        return null;
      }
  },
  
  // AI設定を取得（キャッシュから）
  getAISettings: () => {
    console.log('GASDataManager.getAISettings() キャッシュ確認:', _gasAISettings);
    if (_gasAISettings) {
      return _gasAISettings;
    }
    // フォールバック: ローカルストレージから
    try {
      const saved = localStorage.getItem('gakusapo_ai_settings');
      console.log('AI設定 ローカルストレージから取得:', saved);
      return saved ? JSON.parse(saved) : null;
    } catch (e) {
      return null;
    }
  },
  
  // AI設定を保存（スプレッドシートに）
  saveAISettings: async (settings) => {
      const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
      
      try {
        localStorage.setItem('gakusapo_ai_settings', JSON.stringify(settings));
        _gasAISettings = settings;
      } catch (e) {}
      
      // v34: authPost使用
      try {
        const aiSaveResult = await authPost('saveAISettings', { settings: settings });
        console.log('AI設定をスプレッドシートに保存しました');
        return aiSaveResult;
      } catch (err) {
        console.error('AI設定保存エラー:', err);
        return { success: false, error: err.message };
      }
  },
  
  // 採用手法マスターを読み込み（スプレッドシートから取得）
  loadMethodMaster: async () => {
      try {
        const mmResult = await authFetch('getRecruitmentMethods');
        if (mmResult.success && mmResult.data && Object.keys(mmResult.data).length > 0) {
          _gasMethodMaster = mmResult.data;
          console.log('[マスター] 採用手法マスター読み込み完了:', Object.keys(mmResult.data).length, '件');
          try { localStorage.setItem('gakusapo_method_master', JSON.stringify(mmResult.data)); } catch (e) {}
          return mmResult.data;
        }
        // GAS側 initializeDefaultData がログイン時に自動投入するため、通常ここには来ない
        console.warn('[マスター] 採用手法マスターがスプレッドシートから取得できませんでした。GAS側の初期化を確認してください。');
        // localStorageキャッシュをフォールバックとして使用
        try {
          const cached = localStorage.getItem('gakusapo_method_master');
          if (cached) {
            const parsed = JSON.parse(cached);
            if (parsed && Object.keys(parsed).length > 0) {
              _gasMethodMaster = parsed;
              console.log('[マスター] localStorageキャッシュから採用手法マスターを復元:', Object.keys(parsed).length, '件');
              return parsed;
            }
          }
        } catch (e) {}
        return null;
      } catch (err) {
        console.error('採用手法マスター読み込みエラー:', err);
        return null;
      }
  },
  
  // 採用手法マスターを取得（キャッシュから）
  getMethodMaster: () => {
    if (_gasMethodMaster) {
      return _gasMethodMaster;
    }
    try {
      const saved = localStorage.getItem('gakusapo_method_master');
      return saved ? JSON.parse(saved) : null;
    } catch (e) {
      return null;
    }
  },
  
  // 採用手法マスターを保存
  saveMethodMaster: async (methodsData) => {
      const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
      
      try {
        localStorage.setItem('gakusapo_method_master', JSON.stringify(methodsData));
        _gasMethodMaster = methodsData;
      } catch (e) {}
      
      // v34: authPost使用
      try {
        const mmSaveResult = await authPost('saveRecruitmentMethods', { methodsData: methodsData });
        console.log('採用手法マスターをスプレッドシートに保存しました');
        return mmSaveResult;
      } catch (err) {
        console.error('採用手法マスター保存エラー:', err);
        return { success: false, error: err.message };
      }
  },
  
  // 媒体利用率マスターを読み込み（スプレッドシートから取得）
  loadMediaUsageMaster: async () => {
      try {
        const muResult = await authFetch('getLayerMediaUsage');
        if (muResult.success && muResult.data && Object.keys(muResult.data).length > 0) {
          _gasMediaUsageMaster = muResult.data;
          console.log('[マスター] 媒体利用率マスター読み込み完了:', Object.keys(muResult.data).length, '層');
          try { localStorage.setItem('gakusapo_layer_media_usage', JSON.stringify(muResult.data)); } catch (e) {}
          return muResult.data;
        }
        // GAS側 initializeDefaultData がログイン時に自動投入するため、通常ここには来ない
        console.warn('[マスター] 媒体利用率マスターがスプレッドシートから取得できませんでした。');
        // localStorageキャッシュをフォールバックとして使用
        try {
          const cached = localStorage.getItem('gakusapo_layer_media_usage');
          if (cached) {
            const parsed = JSON.parse(cached);
            if (parsed && Object.keys(parsed).length > 0) {
              _gasMediaUsageMaster = parsed;
              console.log('[マスター] localStorageキャッシュから媒体利用率マスターを復元');
              return parsed;
            }
          }
        } catch (e) {}
        return null;
      } catch (err) {
        console.error('媒体利用率マスター読み込みエラー:', err);
        return null;
      }
  },
  
  // 媒体利用率マスターを取得（キャッシュから）
  getMediaUsageMaster: () => {
    if (_gasMediaUsageMaster) {
      return _gasMediaUsageMaster;
    }
    try {
      const saved = localStorage.getItem('gakusapo_layer_media_usage');
      return saved ? JSON.parse(saved) : null;
    } catch (e) {
      return null;
    }
  },
  
  // 媒体利用率マスターを保存
  saveMediaUsageMaster: async (mediaData) => {
      const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
      
      try {
        localStorage.setItem('gakusapo_layer_media_usage', JSON.stringify(mediaData));
        _gasMediaUsageMaster = mediaData;
      } catch (e) {}
      
      // v34: authPost使用
      try {
        const muSaveResult2 = await authPost('saveLayerMediaUsage', { usageData: mediaData });
        console.log('媒体利用率マスターをスプレッドシートに保存しました');
        return muSaveResult2;
      } catch (err) {
        console.error('媒体利用率マスター保存エラー:', err);
        return { success: false, error: err.message };
      }
  },
  
  // 全マスターデータを読み込み（起動時に呼び出す）
  loadAllMasterData: async () => {
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    if (!isGasMode) {
      _gasMasterDataLoaded = true;
      return;
    }
    
    await Promise.all([
      GASDataManager.loadYieldMaster(),
      GASDataManager.loadQuestionMaster(),
      GASDataManager.loadMethodMaster(),
      GASDataManager.loadMediaUsageMaster(),
      GASDataManager.loadAISettings(),
      LoginManager.loadConfigFromGAS()
    ]);
    
    _gasMasterDataLoaded = true;
  },
  
  // マスターデータが読み込まれたかどうか
  isMasterDataLoaded: () => _gasMasterDataLoaded,
  
  // キャッシュ更新メソッド（保存せずにキャッシュのみ更新）
  updateYieldMasterCache: (data) => {
    _gasYieldMaster = data;
    try {
      localStorage.setItem('gakusapo_yield_master', JSON.stringify(data));
    } catch (e) {}
  },
  updateQuestionMasterCache: (data) => {
    _gasQuestionMaster = data;
    try {
      localStorage.setItem('gakusapo_question_master', JSON.stringify(data));
    } catch (e) {}
  },
  updateMethodMasterCache: (data) => {
    _gasMethodMaster = data;
    try {
      localStorage.setItem('gakusapo_method_master', JSON.stringify(data));
    } catch (e) {}
  },
  updateMediaUsageCache: (data) => {
    _gasMediaUsageMaster = data;
    try {
      localStorage.setItem('gakusapo_layer_media_usage', JSON.stringify(data));
    } catch (e) {}
  },

  // 全顧客データを取得（SpreadsheetManagerに委譲）
  fetchAllCustomers: async () => {
    return SpreadsheetManager.fetchAllCustomers();
  },

  // 顧客データを保存（SpreadsheetManagerに委譲）
  saveCustomer: async (customer, scores = {}) => {
    return SpreadsheetManager.saveCustomer(customer, scores);
  },

  // 顧客データを削除（SpreadsheetManagerに委譲）
  deleteCustomer: async (id) => {
    return SpreadsheetManager.deleteCustomer(id);
  }
};

// ========================================
// ログイン管理
// ========================================

// GASから取得したログイン設定をキャッシュ
let _gasLoginConfig = null;

const LoginManager = {
  // ログイン設定を取得（GASモードの場合はスプレッドシートから）
  getConfig: () => {
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    
    // GASモードでキャッシュがある場合はキャッシュを返す
    if (isGasMode && _gasLoginConfig) {
      return _gasLoginConfig;
    }
    
    // ローカルストレージから取得（フォールバック）
    try {
      const data = localStorage.getItem('gakusapo_login_config');
      if (data) {
        return JSON.parse(data);
      }
    } catch (e) {
      console.error('ログイン設定の読み込みに失敗:', e);
    }
    // デフォルト設定: ログイン有効、初期パスワード設定済み
    return {
      enabled: true,
      password: 'gakusapo2026',  // 初期パスワード（設定画面で変更可能）
      sessionTimeout: 24 // 時間（時間単位）
    };
  },
  
  // GASからログイン設定を読み込み（起動時に呼び出す）
  // v34: authFetch使用
  loadConfigFromGAS: async () => {
      try {
        const result = await authFetch('getLoginConfig');
        if (result.success && result.config) {
          _gasLoginConfig = result.config;
          return result.config;
        } else {
          return LoginManager.getConfig();
        }
      } catch (err) {
        return LoginManager.getConfig();
      }
  },
  
  // ログイン設定を保存（GASモードの場合はスプレッドシートにも保存）
  saveConfig: (config) => {
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    
    try {
      localStorage.setItem('gakusapo_login_config', JSON.stringify(config));
      
      // v34: authPost使用
      _gasLoginConfig = config;
      authPost('saveLoginConfig', { config: config })
        .then(() => console.log('設定をスプレッドシートに保存しました'))
        .catch((err) => console.error('設定保存エラー:', err));
      
      return true;
    } catch (e) {
      console.error('ログイン設定の保存に失敗:', e);
      return false;
    }
  },
  
  // セッションを保存（localStorageを使用 - GAS環境対応）
  saveSession: () => {
    try {
      const config = LoginManager.getConfig();
      const expiry = Date.now() + (config.sessionTimeout * 60 * 60 * 1000);
      localStorage.setItem('gakusapo_session', JSON.stringify({
        loggedIn: true,
        expiry: expiry
      }));
      
      // v34: ログイン記録（authPostで送信）
      // Note: recordLogin APIは必要に応じてGAS側に追加
    } catch (e) {
      console.error('セッション保存エラー:', e);
    }
  },
  
  // セッションを確認
  checkSession: () => {
    // v34: Google OAuth認証済みの場合はパスワード不要
    if (window.AUTH?.isLoggedIn) {
      return true;
    }
    
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    const config = LoginManager.getConfig();
    
    // GASモードでキャッシュがまだない場合は、ログイン必要
    if (isGasMode && !_gasLoginConfig) {
      return false;
    }
    
    // ログインが無効の場合は常にtrue
    if (!config.enabled) {
      return true;
    }
    
    // パスワードが設定されていない場合は常にtrue
    if (!config.password) {
      return true;
    }
    
    try {
      const data = localStorage.getItem('gakusapo_session');
      if (data) {
        const session = JSON.parse(data);
        if (session.loggedIn && session.expiry > Date.now()) {
          return true;
        }
      }
    } catch (e) {
      console.error('セッション確認エラー:', e);
    }
    return false;
  },
  
  // ログアウト
  logout: () => {
    try {
      // v34: ログアウト処理（Google Sign-Outも実行）
      if (window.google?.accounts?.id) {
        window.google.accounts.id.disableAutoSelect();
      }
      window.AUTH.idToken = null;
      window.AUTH.user = null;
      window.AUTH.isLoggedIn = false;
      try { sessionStorage.removeItem('bb_auth_token'); sessionStorage.removeItem('bb_auth_user'); } catch(e) {}
      
      localStorage.removeItem('gakusapo_session');
    } catch (e) {
      console.error('ログアウトエラー:', e);
    }
  },
  
  // パスワード検証
  verifyPassword: (inputPassword) => {
    const config = LoginManager.getConfig();
    return inputPassword === config.password;
  }
};

// 業種コードマッピング
const INDUSTRY_CODES = {
  '製造業（ものづくり）': '01',
  '製造業（食品メーカー・その他）': '02',
  'IT・通信': '03',
  '金融・保険': '04',
  '小売・流通': '05',
  'サービス業': '06',
  '建設・不動産': '07',
  '医療・福祉': '08',
  '飲食・宿泊': '09',
  '運輸・物流': '10',
  'マスコミ・広告': '11',
  'コンサルティング': '12',
  '商社・卸売': '13',
  'その他': '99'
};

// 問い合わせ番号生成ユーティリティ
const InquiryNoManager = {
  // 年コードを生成（2026年 → 26）
  getYearCode: (dateStr) => {
    const date = dateStr ? new Date(dateStr) : new Date();
    return date.getFullYear().toString().slice(-2); // 26
  },
  // 月コードを生成（1月 → 01）
  getMonthCode: (dateStr) => {
    const date = dateStr ? new Date(dateStr) : new Date();
    return String(date.getMonth() + 1).padStart(2, '0'); // 01
  },
  // 業種コードを取得
  getIndustryCode: (industry) => {
    return INDUSTRY_CODES[industry] || '00';
  },
  
  // v34: 問い合わせ番号を組み立て（予約済み通番から）
  // 構造: 担当者ID(4桁) + 年(2桁) + 業種(2桁) + 月(2桁) + 通番(3桁) = 13桁
  buildInquiryNo: (studentId, industry, diagnosisDate, seqNo) => {
    const sid = String(studentId || '0000').padStart(4, '0');
    const year = InquiryNoManager.getYearCode(diagnosisDate);
    const ic = InquiryNoManager.getIndustryCode(industry);
    const month = InquiryNoManager.getMonthCode(diagnosisDate);
    const seq = String(seqNo || 1).padStart(3, '0');
    return `${sid}${year}${ic}${month}${seq}`;
  },
  
  // v34: GAS APIから通番を予約（サーバー側で排他制御＆一元管理）
  // 返値: { inquiryNo, sequentialNo } or null（失敗時）
  reserveFromServer: async (industry = '', diagnosisDate = '') => {
    try {
      const gasStudentId = window.GAS_CONFIG?.deploymentMode === 'gas' ? window.GAS_CONFIG?.studentId : null;
      const studentId = (gasStudentId || StorageManager.getStudentId()).padStart(4, '0');
      const industryCode = InquiryNoManager.getIndustryCode(industry);
      
      const result = await authFetch('reserveInquiryNo', {
        studentId: studentId,
        industryCode: industryCode,
        diagnosisDate: diagnosisDate
      });
      
      if (result.success) {
        console.log('[InquiryNoManager] サーバー採番成功: ' + result.inquiryNo + ' (通番=' + result.sequentialNo + ')');
        return {
          inquiryNo: result.inquiryNo,
          sequentialNo: result.sequentialNo,
          yearMonth: result.yearMonth
        };
      } else {
        console.error('[InquiryNoManager] サーバー採番失敗:', result.error);
        return null;
      }
    } catch (e) {
      console.error('[InquiryNoManager] サーバー採番通信エラー:', e.message);
      return null;
    }
  },
  
  // v34: ローカルフォールバック（GAS未接続時 or スタンドアロンモード用）
  generateNextInquiryNoLocal: (industry = '', diagnosisDate = '') => {
    const gasStudentId = window.GAS_CONFIG?.deploymentMode === 'gas' ? window.GAS_CONFIG?.studentId : null;
    const studentId = (gasStudentId || StorageManager.getStudentId()).padStart(4, '0');
    const year = InquiryNoManager.getYearCode(diagnosisDate);
    const month = InquiryNoManager.getMonthCode(diagnosisDate);
    const yearMonth = year + month;
    const nextCount = StorageManager.getMonthlyCount(yearMonth) + 1;
    const countStr = String(nextCount).padStart(3, '0');
    const industryCode = InquiryNoManager.getIndustryCode(industry);
    return `${studentId}${year}${industryCode}${month}${countStr}`;
  },
  
  // 後方互換: 同期版（初期state等で使用 - localStorageベース）
  generateNextInquiryNo: (industry = '', diagnosisDate = '') => {
    return InquiryNoManager.generateNextInquiryNoLocal(industry, diagnosisDate);
  },
  
  // 保存時に商談数をインクリメント（スタンドアロンモード用のみ。GASモードではサーバーで管理済み）
  confirmInquiryNo: (diagnosisDate = '') => {
    // GASモードではサーバー側で予約済みのためスキップ
    if (window.GAS_CONFIG?.deploymentMode === 'gas') {
      console.log('[InquiryNoManager] GASモード: confirmInquiryNoスキップ（サーバー管理）');
      return 0;
    }
    const year = InquiryNoManager.getYearCode(diagnosisDate);
    const month = InquiryNoManager.getMonthCode(diagnosisDate);
    const yearMonth = year + month;
    return StorageManager.incrementMonthlyCount(yearMonth);
  }
};

// ========================================
// 質問回答からスコアを計算する関数群
// ========================================

// 【inventory 2-13 / 9-A】質問の回答から各軸のスコアを一括計算
// 出力: staffScores, executiveScores, studentScores, mindsetScores, depthScores 等
// scoreType: 'penalty'（減点方式）、'bonus'（加点方式）
// points: 配点（減点または加点の点数）
const calcScoresFromAnswers = (data) => {
  const master = getEffectiveQuestionMaster(data);
  const sizeCategory = getCompanySizeCategory(data.companySize);
  
  // axisTypeを正規化する関数（日本語→英語キー変換）
  const normalizeAxisType = (type) => {
    if (!type) return type;
    if (type === 'evaluation' || type === 'mindset' || type === 'depth') return type;
    if (type.includes('評価軸') || type.includes('加点')) return 'evaluation';
    if (type.includes('マインドセット') || type.includes('減点')) return 'mindset';
    if (type.includes('注力タイプ')) return 'depth';
    return type.toLowerCase();
  };
  
  // axisKeyを正規化する関数（日本語→英語キー変換）
  const normalizeAxisKey = (key) => {
    if (!key) return key;
    const keyMap = {
      // マインドセット5軸
      '計画性': 'planning',
      '組織体制': 'structure',
      '採用体制': 'structure',
      '市場理解': 'marketUnderstanding',
      '経営関与': 'management',
      '当事者意識': 'ownership',
      '自責': 'ownership',
      // 評価軸6軸
      '認知到達力': 'recognition',
      '認知度': 'recognition',
      '具体性': 'specificity',
      '具体性スコア': 'specificity',
      '差別化力': 'differentiation',
      '独自性': 'differentiation',
      '差別化': 'differentiation',
      '共感・ビジョン力': 'visionEmpathy',
      'ビジョン共感': 'visionEmpathy',
      '共感性': 'visionEmpathy',
      '将来像': 'visionEmpathy',
      '選考UX': 'selectionUX',
      '選考体験': 'selectionUX',
      '対話力': 'dialogue',
      '対話姿勢': 'dialogue',
      // 後方互換性（旧軸名→正しい軸名に変換）
      '将来像提示力': 'visionEmpathy',
      'visionPresentation': 'visionEmpathy',
      '信頼性': 'differentiation',
      'credibility': 'differentiation',
      '共感形成力': 'visionEmpathy',
      'empathyBuilding': 'visionEmpathy'
    };
    return keyMap[key] || key;
  };
  
  // デバッグログ（最初の1回のみ）
  if (DEBUG_MODE && !window._calcScoresDebugLogged) {
    debugLog('=== calcScoresFromAnswers デバッグ ===');
    debugLog('companySize(raw):', data.companySize);
    debugLog('sizeCategory(変換後):', sizeCategory);
    debugLog('master.base のキー:', Object.keys(master.base || {}));
    debugLog('master.base[' + sizeCategory + ']:', master.base?.[sizeCategory]);
    debugLog('staffAnswers:', data.staffAnswers);
    window._calcScoresDebugLogged = true;
  }
  
  // 全質問を収集（depth質問・採用手法別質問含む）
  const getAllQuestions = (roleKey) => {
    const baseQuestions = master.base?.[sizeCategory]?.[roleKey] || [];
    const industryQuestions = master.industry?.[data.industry]?.[sizeCategory]?.[roleKey] || [];
    const targetLayers = Object.keys(data.targetLayers || {}).filter(k => data.targetLayers[k]?.enabled);
    const targetQuestions = targetLayers.flatMap(layer => master.targetLayer?.[layer]?.[roleKey] || []);
    // 注力タイプ質問を追加
    const depthQuestions = [
      ...(master.depth?.surface?.[roleKey] || []),
      ...(master.depth?.middle?.[roleKey] || []),
      ...(master.depth?.deep?.[roleKey] || [])
    ];
    // 採用手法別質問を追加（activeな手法のカテゴリ単位でユニーク化）
    const methodMaster = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
    const activeCategories = getActiveMethodCategories(data);
    const recruitmentMethodQuestions = activeCategories.flatMap(cat => 
      getMethodQuestionsByCategory(master, cat, methodMaster, roleKey)
    );
    
    const allQ = [...baseQuestions, ...industryQuestions, ...targetQuestions, ...depthQuestions, ...recruitmentMethodQuestions];
    
    // デバッグログ
    if (DEBUG_MODE && !window._getAllQuestionsDebugLogged?.[roleKey]) {
      debugLog(`getAllQuestions(${roleKey}):`, {
        baseQuestions: baseQuestions.length,
        industryQuestions: industryQuestions.length,
        targetQuestions: targetQuestions.length,
        depthQuestions: depthQuestions.length,
        recruitmentMethodQuestions: recruitmentMethodQuestions.length,
        total: allQ.length
      });
      if (!window._getAllQuestionsDebugLogged) window._getAllQuestionsDebugLogged = {};
      window._getAllQuestionsDebugLogged[roleKey] = true;
    }
    
    return allQ;
  };
  
  // 注力タイプ別スコアを計算（加点方式）
  // depthKeyが設定されている全ての質問から計算（基本質問・業種別・ターゲット層別含む）
  const calcDepthScoresForRole = (roleKey) => {
    const scores = { surface: null, middle: null, deep: null };
    const answers = data[`${roleKey}Answers`] || {};
    
    // 全ての質問を取得
    const allQuestions = getAllQuestions(roleKey);
    
    ['surface', 'middle', 'deep'].forEach(depthKey => {
      // depthKeyが設定されている質問を抽出
      const relevantQuestions = allQuestions.filter(q => q.depthKey === depthKey);
      if (relevantQuestions.length === 0) return;
      
      let totalPoints = 0;
      let maxPoints = 0;
      let answeredCount = 0;
      
      relevantQuestions.forEach(q => {
        const answer = answers[q.id];
        const points = q.points || 2;
        maxPoints += points;
        
        if (answer) {
          answeredCount++;
          if (answer === q.correctAnswer) {
            totalPoints += points;
          }
        }
      });
      
      if (answeredCount > 0 && maxPoints > 0) {
        // 10点満点に正規化（小数点1桁まで保持）
        scores[depthKey] = Math.round((totalPoints / maxPoints) * 100) / 10;
      }
    });
    
    return scores;
  };
  
  // マインドセット軸のスコアを計算（減点方式）- 担当者と上層部を別々に計算
  // 採用基礎力: 10点満点から開始、不正解で減点（正解しても加点なし）
  // ※回答がある質問のみカウント
  const calcMindsetScoresForRole = (roleKey) => {
    const scores = {};
    const questions = getAllQuestions(roleKey);
    const answers = data[`${roleKey}Answers`] || {};
    
    Object.keys(MINDSET_AXES).forEach(axisKey => {
      let totalPoints = 10; // 10点から開始
      let answeredCount = 0;
      
      questions.forEach(q => {
        const normalizedAxisType = normalizeAxisType(q.axisType);
        const normalizedAxisKey = normalizeAxisKey(q.axisKey);
        if (normalizedAxisType === 'mindset' && normalizedAxisKey === axisKey) {
          const answer = answers[q.id];
          
          // 回答がある場合のみ処理
          if (answer) {
            answeredCount++;
            const points = q.points || q.penaltyPoints || 2;
            
            if (answer !== q.correctAnswer) {
              // 不正解の場合のみ減点
              totalPoints -= points;
            }
            // 正解の場合は何もしない（10点のまま）
          }
        }
      });
      
      // 回答がある場合のみスコアを設定、なければnull
      if (answeredCount > 0) {
        scores[axisKey] = Math.max(0, Math.min(10, totalPoints));
      } else {
        scores[axisKey] = null; // 回答なし
      }
    });
    
    return scores;
  };
  
  const staffMindsetScores = calcMindsetScoresForRole('staff');
  const execMindsetScores = calcMindsetScoresForRole('executive');
  
  // 合算マインドセットスコア（従来の計算方法 - 係数計算用）
  const mindsetScores = {};
  Object.keys(MINDSET_AXES).forEach(axisKey => {
    const staffScore = staffMindsetScores[axisKey];
    const execScore = execMindsetScores[axisKey];
    
    if (staffScore !== null && execScore !== null) {
      // 両方に回答がある場合は平均
      mindsetScores[axisKey] = Math.round((staffScore + execScore) / 2);
    } else if (staffScore !== null) {
      mindsetScores[axisKey] = staffScore;
    } else if (execScore !== null) {
      mindsetScores[axisKey] = execScore;
    } else {
      mindsetScores[axisKey] = null;
    }
  });
  
  // 評価軸のスコアを計算（加点方式）
  // 魅力伝達力: 回答がある質問のみでスコア計算
  const calcEvaluationScores = (roleKey) => {
    const scores = {};
    const questions = getAllQuestions(roleKey);
    const answers = data[`${roleKey}Answers`] || {};
    
    // デバッグ: 詳細な情報を出力
    if (DEBUG_MODE) {
      debugLog(`=== calcEvaluationScores(${roleKey}) デバッグ ===`);
      debugLog('取得した質問数:', questions.length);
      debugLog('回答オブジェクト:', answers);
      debugLog('回答数:', Object.keys(answers).length);
      
      if (questions.length > 0) {
        debugLog('質問サンプル (最初の5件):', questions.slice(0, 5).map(q => ({
          id: q.id,
          axisType: q.axisType,
          axisTypeNormalized: normalizeAxisType(q.axisType),
          axisKey: q.axisKey,
          axisKeyNormalized: normalizeAxisKey(q.axisKey),
          scoreType: q.scoreType
        })));
        
        // 質問IDと回答IDの一致を確認
        const questionIds = questions.map(q => q.id);
        const answerIds = Object.keys(answers);
        const matchingIds = answerIds.filter(id => questionIds.includes(id));
        debugLog('質問IDと回答IDが一致する数:', matchingIds.length);
        debugLog('一致しているID:', matchingIds);
        
        // axisTypeの分布を確認（正規化後）
        const axisTypes = questions.reduce((acc, q) => {
          const normalized = normalizeAxisType(q.axisType);
          acc[normalized] = (acc[normalized] || 0) + 1;
          return acc;
        }, {});
        debugLog('axisTypeの分布（正規化後）:', axisTypes);
      }
    }
    
    Object.keys(EVALUATION_AXES).forEach(axisKey => {
      let totalPoints = 0;
      let maxPoints = 0;
      let answeredCount = 0;
      
      questions.forEach(q => {
        const normalizedAxisType = normalizeAxisType(q.axisType);
        const normalizedAxisKey = normalizeAxisKey(q.axisKey);
        if (normalizedAxisType === 'evaluation' && normalizedAxisKey === axisKey) {
          const answer = answers[q.id];
          
          // 回答がある場合のみ処理
          if (answer) {
            answeredCount++;
            const points = q.points || q.penaltyPoints || 2;
            const scoreType = q.scoreType || 'penalty';
            
            if (scoreType === 'bonus') {
              // 加点方式: 正解で加点
              maxPoints += points;
              if (answer === q.correctAnswer) {
                totalPoints += points;
              }
            } else {
              // 減点方式: 不正解で減点（10点ベース）
              maxPoints += points;
              if (answer === q.correctAnswer) {
                totalPoints += points;
              }
            }
          }
        }
      });
      
      // 回答がある場合のみスコアを設定
      if (answeredCount > 0 && maxPoints > 0) {
        scores[axisKey] = Math.round((totalPoints / maxPoints) * 10);
        if (DEBUG_MODE) {
          debugLog(`${axisKey}: 回答${answeredCount}件, ${totalPoints}/${maxPoints}点 → スコア${scores[axisKey]}`);
        }
      } else {
        scores[axisKey] = null; // 回答なし
      }
    });
    
    if (DEBUG_MODE) {
      debugLog('最終スコア:', scores);
      debugLog('=== デバッグ終了 ===');
    }
    
    return scores;
  };
  
  // 注力タイプスコアを各ロールから計算し合算
  const staffDepthScores = calcDepthScoresForRole('staff');
  const execDepthScores = calcDepthScoresForRole('executive');
  const studentDepthScores = calcDepthScoresForRole('student');
  
  // 合算（回答があるもののみ平均）
  const mergedDepthScores = {};
  ['surface', 'middle', 'deep'].forEach(key => {
    const values = [staffDepthScores[key], execDepthScores[key], studentDepthScores[key]]
      .filter(v => v !== null && v !== undefined);
    if (values.length > 0) {
      // 小数点1桁まで保持
      mergedDepthScores[key] = Math.round(values.reduce((a, b) => a + b, 0) / values.length * 10) / 10;
    } else {
      mergedDepthScores[key] = null;
    }
  });
  
  return {
    mindsetScores,           // 合算（係数計算用）
    staffMindsetScores,      // 担当者のマインドセット
    execMindsetScores,       // 上層部のマインドセット
    staffScores: calcEvaluationScores('staff'),
    executiveScores: calcEvaluationScores('executive'),
    studentScores: calcEvaluationScores('student'),
    depthScores: mergedDepthScores,  // 注力タイプスコア
    staffDepthScores,
    execDepthScores,
    studentDepthScores
  };
};

// 【inventory 4-9】スコアをマージするヘルパー（nullの軸は未入力としてnullを保持）
const mergeScores = (calculated, original, axisDefinition) => {
  const merged = {};
  Object.keys(axisDefinition).forEach(key => {
    // 計算されたスコアがnullでなければそれを使用、なければ元データ、それもなければnull（未入力）
    if (calculated?.[key] !== null && calculated?.[key] !== undefined) {
      merged[key] = calculated[key];
    } else if (original?.[key] !== null && original?.[key] !== undefined) {
      merged[key] = original[key];
    } else {
      merged[key] = null; // 未入力はnull
    }
  });
  return merged;
};

// 【inventory 2-3】マインド係数の計算（0.4〜1.2）- 質問回答から自動計算
// ※回答がある軸のみを計算対象とする
const calcMindsetCoefficient = (mindsetScores) => {
  if (!mindsetScores || Object.keys(mindsetScores).length === 0) return 0.4; // 未入力は最低係数
  const axes = Object.keys(MINDSET_AXES);
  
  let total = 0;
  let validCount = 0;
  
  axes.forEach(key => {
    const score = mindsetScores[key];
    // 回答がある場合のみカウント
    if (score !== null && score !== undefined) {
      total += score;
      validCount++;
    }
  });
  
  // 有効な回答がない場合は最低係数
  if (validCount === 0) return 0.4;
  
  const avg = total / validCount;
  // 0〜10のスコアを0.4〜1.2に変換
  return 0.4 + (avg / 10) * 0.8;
};

// 内部摩擦減点の計算（担当者 vs 上層部のギャップ）
// ※担当者・上層部の両方に回答がある場合のみ計算（片方でも回答がなければペナルティなし）
// 内部摩擦減点の計算（担当者 vs 上層部のギャップ）
// ※現在は無効化（常に0を返す）
const calcFrictionPenalty = (staffScores, executiveScores) => {
  // 内部摩擦ペナルティを無効化
  return 0;
  
  /* 以下は無効化前の元のロジック
  if (!staffScores || !executiveScores) return 0;
  
  const axes = Object.keys(EVALUATION_AXES);
  
  // 担当者に有効な回答があるか確認
  const hasStaffAnswers = axes.some(key => 
    staffScores[key] !== null && staffScores[key] !== undefined
  );
  
  // 上層部に有効な回答があるか確認
  const hasExecAnswers = axes.some(key => 
    executiveScores[key] !== null && executiveScores[key] !== undefined
  );
  
  // 片方でも回答がなければペナルティなし
  if (!hasStaffAnswers || !hasExecAnswers) return 0;
  
  let totalGap = 0;
  let validAxisCount = 0; // 両方に回答がある軸の数
  
  axes.forEach(key => {
    const staffScore = staffScores[key];
    const execScore = executiveScores[key];
    
    // 両方に回答がある場合のみギャップを計算
    if (staffScore !== null && staffScore !== undefined && 
        execScore !== null && execScore !== undefined) {
      const gap = Math.abs(staffScore - execScore);
      totalGap += gap;
      validAxisCount++;
    }
  });
  
  // 両方に回答がある軸がない場合はペナルティなし
  if (validAxisCount === 0) return 0;
  
  const avgGap = totalGap / validAxisCount;
  // ギャップに応じた減点（0〜1点差: 0点、2〜4点差: -5点、5点以上: -10点）
  if (avgGap < 2) return 0;
  if (avgGap < 5) return -5;
  return -10;
  */
};

// 【inventory 2-4】ギャップ係数の計算（企業側 vs 学生のギャップ - gapCheck対象質問のみ, 範囲: 0.6〜1.0）
// 戻り値: { coefficient, companyRate, studentRate, combinedRate, gapQuestionCount }
const calcGapCoefficient = (data) => {
  const master = getEffectiveQuestionMaster(data);
  const sizeCategory = getCompanySizeCategory(data.companySize);
  
  // 学生問診と同じロジックで質問を収集（担当者・上層部の両方から取得）
  const sourceRoles = ['staff', 'executive'];
  
  // ベース質問を取得
  const baseQuestions = sourceRoles.flatMap(role => 
    (master.base?.[sizeCategory]?.[role] || []).map(q => ({ ...q, sourceRole: role }))
  );
  
  // 業種別質問を取得
  const industryQuestions = sourceRoles.flatMap(role =>
    (master.industry?.[data.industry]?.[sizeCategory]?.[role] || []).map(q => ({ ...q, sourceRole: role }))
  );
  
  // ターゲット層別質問を取得
  const targetLayers = Object.keys(data.targetLayers || {}).filter(k => data.targetLayers[k]?.enabled);
  const targetQuestions = targetLayers.flatMap(layer => 
    sourceRoles.flatMap(role =>
      (master.targetLayer?.[layer]?.[role] || []).map(q => ({ ...q, layer, sourceRole: role }))
    )
  );
  
  // 注力タイプ質問を取得（表層部・中層部・深層部）
  const depthQuestions = sourceRoles.flatMap(role => [
    ...(master.depth?.surface?.[role] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'surface', sourceRole: role })),
    ...(master.depth?.middle?.[role] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'middle', sourceRole: role })),
    ...(master.depth?.deep?.[role] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'deep', sourceRole: role }))
  ]);
  
  // 採用手法別質問を取得（activeな手法のカテゴリ単位でユニーク化）
  const methodMasterForGap = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
  const activeCategoriesForGap = getActiveMethodCategories(data);
  const recruitmentMethodQuestions = activeCategoriesForGap.flatMap(cat => 
    sourceRoles.flatMap(role =>
      getMethodQuestionsByCategory(master, cat, methodMasterForGap, role).map(q => ({ ...q, category: 'recruitmentMethod', methodCategory: cat, sourceRole: role }))
    )
  );
  
  // 全質問を結合
  const rawQuestions = [
    ...baseQuestions,
    ...industryQuestions,
    ...targetQuestions,
    ...depthQuestions,
    ...recruitmentMethodQuestions
  ];
  
  // 重複を除去（質問IDでユニーク化）- 学生問診画面と同じロジック
  const seenIds = new Set();
  const uniqueQuestions = rawQuestions.filter(q => {
    if (seenIds.has(q.id)) {
      return false;
    }
    seenIds.add(q.id);
    return true;
  });
  
  // gapCheck=trueの質問のみ抽出（学生問診に表示される設問）
  const gapQuestions = uniqueQuestions.filter(q => q.gapCheck === true || q.gapCheck === 'true');
  
  if (gapQuestions.length === 0) {
    return { coefficient: 1.0, companyRate: null, studentRate: null, combinedRate: null, gapQuestionCount: 0 };
  }
  
  // 企業側（担当者 + 上層部）の正解数を計算
  let companyCorrect = 0;
  let companyAnswered = 0;
  
  // 学生側の正解数を計算（全gapCheck質問に対して）
  let studentCorrect = 0;
  let studentAnswered = 0;
  
  gapQuestions.forEach(q => {
    const staffAnswer = data.staffAnswers?.[q.id];
    const execAnswer = data.executiveAnswers?.[q.id];
    const studentAnswer = data.studentAnswers?.[q.id];
    
    // 担当者または上層部が正解したかチェック
    const staffCorrect = staffAnswer && staffAnswer === q.correctAnswer;
    const execCorrect = execAnswer && execAnswer === q.correctAnswer;
    const companyIsCorrect = staffCorrect || execCorrect;
    
    // 企業側の回答数と正解数をカウント
    if (staffAnswer || execAnswer) {
      companyAnswered++;
      if (companyIsCorrect) companyCorrect++;
    }
    
    // 学生の回答数と正解数をカウント（全gapCheck質問対象）
    if (studentAnswer) {
      studentAnswered++;
      if (studentAnswer === q.correctAnswer) {
        studentCorrect++;
      }
    }
  });
  
  // 「知りたい」に応えている率 = 企業側の正解率
  const companyRate = companyAnswered > 0 ? Math.round((companyCorrect / companyAnswered) * 100) : null;
  
  // 「伝わった」率 = 学生が回答した質問に対する正解率
  const studentRate = studentAnswered > 0 
    ? Math.round((studentCorrect / studentAnswered) * 100) 
    : null;
  
  // 「知りたいことが伝わった」率 = 「知りたい」に応えている率 × 「伝わった」率
  let combinedRate = null;
  let coefficient = 1.0;
  
  if (companyRate !== null && studentRate !== null) {
    combinedRate = Math.round((companyRate * studentRate) / 100);
    // combinedRateに応じた係数（低いほどペナルティ）
    if (combinedRate <= 5) coefficient = 0.6;
    else if (combinedRate <= 15) coefficient = 0.7;
    else if (combinedRate <= 30) coefficient = 0.8;
    else if (combinedRate <= 60) coefficient = 0.9;
    else coefficient = 1.0;
  }
  
  return { coefficient, companyRate, studentRate, combinedRate, gapQuestionCount: gapQuestions.length };
};

// 市場盲目係数の計算（学生軸を廃止したため常に1.0を返す）
const calcMarketBlindCoefficient = (staffScores, executiveScores, studentScores) => {
  return 1.0;
};

// 【inventory 2-2】基本点の計算（6軸平均 × 10, 範囲: 0〜100）
// ※回答がある軸のみを計算対象とする（担当者・上層部のみ）
const calcBaseScore = (staffScores, executiveScores) => {
  const axes = Object.keys(EVALUATION_AXES);
  let total = 0;
  let validAxisCount = 0;
  
  axes.forEach(key => {
    const staff = staffScores?.[key];
    const exec = executiveScores?.[key];
    
    // 回答がある視点のみで平均を計算（担当者・上層部）
    let viewpoints = [];
    if (staff !== null && staff !== undefined) viewpoints.push(staff);
    if (exec !== null && exec !== undefined) viewpoints.push(exec);
    
    // 1つ以上の回答がある軸のみカウント
    if (viewpoints.length > 0) {
      total += viewpoints.reduce((sum, v) => sum + v, 0) / viewpoints.length;
      validAxisCount++;
    }
  });
  
  // 有効な軸がない場合は0点
  if (validAxisCount === 0) return 0;
  
  return Math.round((total / validAxisCount) * 10);
};

// 【inventory 2-1 / 9-A】最終スコアの計算（減点方式, 範囲: 0〜100）
// finalScore = round(baseScore × mindsetCoeff × gapCoeff + yieldPenalty)
const calcFinalScore = (data) => {
  const baseScore = calcBaseScore(data.staffScores, data.executiveScores);
  // 内部摩擦ペナルティは無効化
  // const frictionPenalty = calcFrictionPenalty(data.staffScores, data.executiveScores);
  const mindsetCoef = calcMindsetCoefficient(data.mindsetScores);
  
  // ギャップ係数（企業 vs 学生）
  const gapResult = calcGapCoefficient(data);
  const gapCoef = gapResult.coefficient;
  
  // 【強化2】歩留まり-投資整合性ペナルティ（-10〜0）
  const yieldInvestmentPenalty = calcYieldInvestmentPenalty(data);
  
  const finalScore = Math.round(
    (baseScore + yieldInvestmentPenalty) 
    * mindsetCoef 
    * gapCoef
  );
  return Math.max(0, Math.min(100, finalScore));
};

// ========================================
// 【inventory 2-5】歩留まり-投資整合性ペナルティ（範囲: -10〜0）
// 投資しているのに歩留まりが悪い→魅力伝達力の問題
// ========================================
const calcYieldInvestmentPenalty = (data) => {
  const funnelData = data.funnelData || {};
  const industryAverages = data.industryAverages || {};
  const adjustedAverages = data.adjustedAverages || {};
  
  // 歩留まりデータがない場合はペナルティなし
  const awareness = funnelData.targetAwareness;
  const interest = funnelData.interest;
  const applications = funnelData.applications;
  const screening = funnelData.screening;
  const offers = funnelData.offers;
  const acceptance = funnelData.acceptance;
  
  if (!awareness && !interest && !applications && !screening && !offers) {
    return 0;
  }
  
  // フェーズ別投資配分を計算
  const phaseInvestment = calcPhaseInvestmentRatio(data);
  
  // 業界平均
  const avgRates = {
    awarenessToInterest: adjustedAverages?.awarenessToInterest ?? industryAverages?.awarenessToInterest ?? 22,
    interestToApplication: adjustedAverages?.interestToApplication ?? industryAverages?.interestToApplication ?? 25,
    applicationToScreening: adjustedAverages?.applicationToScreening ?? industryAverages?.applicationToScreening ?? 25,
    screeningToOffer: adjustedAverages?.screeningToOffer ?? industryAverages?.screeningToOffer ?? 41,
    offerToAcceptance: adjustedAverages?.offerToAcceptance ?? industryAverages?.offerToAcceptance ?? 80
  };
  
  // 実績の歩留まり率
  const actualRates = {
    surface: awareness > 0 ? (interest / awareness) * 100 : null,  // 認知→興味（表層部）
    middle: interest > 0 && screening > 0 
      ? ((applications / interest) * (screening / applications) * (offers / screening)) ** (1/3) * 100 
      : null, // 中層部の幾何平均
    deep: offers > 0 ? (acceptance / offers) * 100 : null  // 内々定→承諾（深層部）
  };
  
  // 目標の歩留まり率
  const targetRates = {
    surface: avgRates.awarenessToInterest,
    middle: (avgRates.interestToApplication * avgRates.applicationToScreening * avgRates.screeningToOffer) ** (1/3),
    deep: avgRates.offerToAcceptance
  };
  
  let totalPenalty = 0;
  
  // 各フェーズで「投資しているのに歩留まりが悪い」場合にペナルティ
  ['surface', 'middle', 'deep'].forEach(phase => {
    const investment = phaseInvestment[phase] || 0;
    const actual = actualRates[phase];
    const target = targetRates[phase];
    
    if (actual !== null && investment > 20) {  // 20%以上投資している場合
      const gapRate = (target - actual) / target;  // 目標に対する乖離率
      if (gapRate > 0.3) {  // 30%以上乖離している場合
        // 投資量と乖離率に比例してペナルティ
        const penalty = Math.min(4, (investment / 100) * gapRate * 10);
        totalPenalty += penalty;
      }
    }
  });
  
  return -Math.round(Math.min(10, totalPenalty));
};

// ========================================
// フェーズ別投資配分を計算
// ========================================
const calcPhaseInvestmentRatio = (data) => {
  const recruitmentMethods = data.recruitmentMethods || {};
  const methodMaster = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
  
  let surfaceTotal = 0;
  let middleTotal = 0;
  let deepTotal = 0;
  let grandTotal = 0;
  
  Object.entries(recruitmentMethods).forEach(([key, method]) => {
    if (!method?.active) return;
    
    const budget = parseInt(method.budget) || 0;
    if (budget === 0) return;
    
    const phaseMapping = getMethodPhaseMapping(methodMaster, key);
    if (!phaseMapping) return;
    
    // 各フェーズへの寄与を計算
    const totalPhaseWeight = phaseMapping.surface + phaseMapping.middle + phaseMapping.deep;
    if (totalPhaseWeight > 0) {
      surfaceTotal += budget * (phaseMapping.surface / totalPhaseWeight);
      middleTotal += budget * (phaseMapping.middle / totalPhaseWeight);
      deepTotal += budget * (phaseMapping.deep / totalPhaseWeight);
      grandTotal += budget;
    }
  });
  
  if (grandTotal === 0) {
    return { surface: 0, middle: 0, deep: 0, total: 0 };
  }
  
  return {
    surface: Math.round((surfaceTotal / grandTotal) * 100),
    middle: Math.round((middleTotal / grandTotal) * 100),
    deep: Math.round((deepTotal / grandTotal) * 100),
    total: grandTotal
  };
};

// ========================================
// 【inventory 3-5】投資分析サマリーを生成（AIプロンプト用, {investmentAnalysis} に展開）
// ========================================
const formatInvestmentAnalysisSummary = (data) => {
  const efficiency = calcRecruitmentEfficiency(data);
  const phaseInvestment = calcPhaseInvestmentRatio(data);
  const avgScores = calcAvgScores(data.staffScores, data.executiveScores);
  const phaseScores = calcPhaseScores(avgScores, data.depthScores);
  
  if (efficiency.activeMethods.length === 0) {
    return '採用手法データが未入力のため、投資分析はできません。';
  }
  
  let analysis = [];
  
  // 投資概要
  analysis.push(`【採用投資概要】`);
  analysis.push(`- 利用媒体数: ${efficiency.activeMethods.length}件`);
  analysis.push(`- 投資予算合計: ${efficiency.totalBudget.toLocaleString()}万円`);
  
  // 注力順位上位
  const prioritized = efficiency.methodDetails
    .filter(m => m.priority)
    .sort((a, b) => a.priority - b.priority);
  if (prioritized.length > 0) {
    analysis.push(`- 注力順: ${prioritized.map(m => `${m.priority}位 ${m.name}(${m.budget}万円)`).join('、')}`);
  }
  
  // フェーズ別投資配分
  if (phaseInvestment.total > 0) {
    analysis.push('');
    analysis.push('【フェーズ別投資配分】');
    analysis.push(`- 表層部（認知獲得）: 投資${phaseInvestment.surface}% ← 魅力伝達スコア${phaseScores.surface.score}%`);
    analysis.push(`- 中層部（選考プロセス）: 投資${phaseInvestment.middle}% ← 魅力伝達スコア${phaseScores.middle.score}%`);
    analysis.push(`- 深層部（内定承諾）: 投資${phaseInvestment.deep}% ← 魅力伝達スコア${phaseScores.deep.score}%`);
    
    // 整合性の警告
    const warnings = [];
    if (phaseScores.surface.score > 50 && phaseInvestment.surface < 20) {
      warnings.push('⚠ 表層部は魅力伝達できているが投資不足の可能性');
    }
    if (phaseScores.surface.score < 30 && phaseInvestment.surface > 40) {
      warnings.push('⚠ 表層部への過剰投資（魅力伝達力の改善が先）');
    }
    if (phaseScores.middle.score > 50 && phaseInvestment.middle < 20) {
      warnings.push('⚠ 中層部は魅力伝達できているが投資不足の可能性');
    }
    if (phaseScores.middle.score < 30 && phaseInvestment.middle > 40) {
      warnings.push('⚠ 中層部への過剰投資（魅力伝達力の改善が先）');
    }
    if (phaseScores.deep.score > 50 && phaseInvestment.deep < 10) {
      warnings.push('⚠ 深層部は魅力伝達できているが投資不足の可能性');
    }
    if (phaseScores.deep.score < 30 && phaseInvestment.deep > 30) {
      warnings.push('⚠ 深層部への過剰投資（魅力伝達力の改善が先）');
    }
    
    if (warnings.length > 0) {
      analysis.push('');
      analysis.push('【投資バランスの警告】');
      warnings.forEach(w => analysis.push(w));
    }
  }
  
  return analysis.join('\n');
};

// ========================================
// リソース効率判定ロジック
// ========================================

// 各軸へのリソース投入量を計算
// 【inventory 2-10】フェーズ別スコアの計算（表層・中層・深層, 各0〜100）
// scores: 6軸の評価スコア（担当者+上層部の平均を渡すこと）
// depthScores: 注力タイプ質問からのスコア（オプション）
const calcPhaseScores = (scores, depthScores = {}) => {
  const phases = {
    surface: { axes: [], score: 0, depthBonus: 0, name: '表層部', description: '候補者集め' },
    middle: { axes: [], score: 0, depthBonus: 0, name: '中層部', description: '選考・動機づけ' },
    deep: { axes: [], score: 0, depthBonus: 0, name: '深層部', description: '定着・活躍' }
  };
  
  Object.entries(PHASE_AXIS_WEIGHT).forEach(([axisKey, weights]) => {
    const axisScore = scores?.[axisKey] ?? 0;
    
    // 各フェーズへの寄与を計算（重みが0.5以上の軸のみ）
    if (weights.surface > 0.5) phases.surface.axes.push({ key: axisKey, score: axisScore, weight: weights.surface });
    if (weights.middle > 0.5) phases.middle.axes.push({ key: axisKey, score: axisScore, weight: weights.middle });
    if (weights.deep > 0.5) phases.deep.axes.push({ key: axisKey, score: axisScore, weight: weights.deep });
  });
  
  // 各フェーズのスコアを計算
  Object.keys(phases).forEach(phase => {
    const axes = phases[phase].axes;
    let axisBasedScore = 0;
    
    if (axes.length > 0) {
      const totalWeight = axes.reduce((sum, a) => sum + a.weight, 0);
      const weightedSum = axes.reduce((sum, a) => sum + a.score * a.weight, 0);
      axisBasedScore = Math.round((weightedSum / totalWeight) * 10);
    }
    
    // 注力タイプ質問からのボーナススコア（0-10点）
    const depthBonus = depthScores?.[phase] ?? 0;
    phases[phase].depthBonus = depthBonus;
    
    // 合計スコア（軸ベース + 質問ボーナスの加重平均）
    if (axisBasedScore > 0 && depthBonus > 0) {
      // 両方ある場合：軸ベース70% + 質問ボーナス30%
      phases[phase].score = Math.round(axisBasedScore * 0.7 + depthBonus * 10 * 0.3);
    } else if (depthBonus > 0) {
      // 質問ボーナスのみ
      phases[phase].score = depthBonus * 10;
    } else {
      // 軸ベースのみ
      phases[phase].score = axisBasedScore;
    }
  });
  
  return phases;
};

// 【inventory 2-14】ランク判定（S:80〜, A:65〜, B:50〜, C:35〜, D:0〜34）
const determineRank = (score) => {
  if (score >= RANK_DEFINITIONS.S.minScore) return 'S';
  if (score >= RANK_DEFINITIONS.A.minScore) return 'A';
  if (score >= RANK_DEFINITIONS.B.minScore) return 'B';
  if (score >= RANK_DEFINITIONS.C.minScore) return 'C';
  return 'D';
};

// 【inventory 2-15】症例タイプ判定（6種）
// 他のスコア計算と統一し、常に担当者+上層部の平均で判定する
const determineDiagnosisType = (data) => {
  const staffScores = data.staffScores || {};
  const executiveScores = data.executiveScores || {};
  const axes = Object.keys(EVALUATION_AXES);
  
  // 担当者と上層部のスコアの平均を使用（他の計算ロジックと統一）
  const effectiveScores = {};
  axes.forEach(key => {
    const staffScore = staffScores[key];
    const execScore = executiveScores[key];
    const validScores = [staffScore, execScore].filter(s => s !== null && s !== undefined);
    if (validScores.length > 0) {
      effectiveScores[key] = Math.round(validScores.reduce((a, b) => a + b, 0) / validScores.length);
    } else {
      effectiveScores[key] = 0;
    }
  });
  
  // フェーズ別の軸マッピング（◎=primary, ○=secondary）
  // ユーザー提供のマッピングに基づく
  const phaseAxisMapping = {
    // 【①表層部】〜エントリーまで
    surface: {
      primary: ['recognition', 'specificity'],           // ◎
      secondary: ['differentiation', 'visionEmpathy', 'selectionUX']  // ○
    },
    // 【②中層部】エントリー〜内々定
    middle: {
      primary: ['differentiation', 'visionEmpathy', 'selectionUX', 'dialogue'],  // ◎
      secondary: []
    },
    // 【③深層部】内々定〜
    deep: {
      primary: ['differentiation', 'visionEmpathy', 'dialogue'],  // ◎
      secondary: ['selectionUX']  // ○
    }
  };
  
  // 歩留まりステージとフェーズの対応
  const yieldToPhaseMapping = {
    awarenessToInterest: 'surface',      // 認知→興味：表層部
    interestToApplication: 'surface',    // 興味→接触：表層部
    applicationToScreening: 'middle',    // 接触→選考：中層部
    screeningToOffer: 'middle',          // 選考→内々定：中層部
    offerToAcceptance: 'deep'            // 内々定→承諾：深層部
  };
  
  // 歩留まり率の実績と業界平均を計算
  const funnelData = data.funnelData || {};
  const savedIndustryAverages = data.industryAverages || {};
  const adjustedAverages = data.adjustedAverages || {};
  
  // デフォルト値なし - 未入力時は0
  const awareness = funnelData.targetAwareness || 0;
  const interest = funnelData.interest || 0;
  const applications = funnelData.applications || 0;
  const screening = funnelData.screening || 0;
  const offers = funnelData.offers || 0;
  const acceptance = funnelData.acceptance || 0;
  
  // 業界平均値
  const industryAverages = {
    awarenessToInterest: adjustedAverages.awarenessToInterest ?? savedIndustryAverages.awarenessToInterest ?? 22,
    interestToApplication: adjustedAverages.interestToApplication ?? savedIndustryAverages.interestToApplication ?? 25,
    applicationToScreening: adjustedAverages.applicationToScreening ?? savedIndustryAverages.applicationToScreening ?? 25,
    screeningToOffer: adjustedAverages.screeningToOffer ?? savedIndustryAverages.screeningToOffer ?? 41,
    offerToAcceptance: adjustedAverages.offerToAcceptance ?? savedIndustryAverages.offerToAcceptance ?? 80
  };
  
  // 実績の歩留まり率（データがない場合は計算しない）
  const actualRates = {
    awarenessToInterest: awareness > 0 ? (interest / awareness) * 100 : null,
    interestToApplication: interest > 0 ? (applications / interest) * 100 : null,
    applicationToScreening: applications > 0 ? (screening / applications) * 100 : null,
    screeningToOffer: screening > 0 ? (offers / screening) * 100 : null,
    offerToAcceptance: offers > 0 ? (acceptance / offers) * 100 : null
  };
  
  // 業界平均を下回っている段階を特定（差分が大きい順）- データがある場合のみ
  const belowAverageStages = [];
  Object.keys(yieldToPhaseMapping).forEach(stage => {
    if (actualRates[stage] !== null) {
      const diff = industryAverages[stage] - actualRates[stage];
      if (diff > 0) {
        const phase = yieldToPhaseMapping[stage];
        belowAverageStages.push({ 
          stage, 
          diff, 
          phase,
          primaryAxes: phaseAxisMapping[phase].primary,
          secondaryAxes: phaseAxisMapping[phase].secondary
        });
      }
    }
  });
  // 差分が大きい順にソート
  belowAverageStages.sort((a, b) => b.diff - a.diff);
  
  // 軸に応じた症例タイプ
  const typeMapping = {
    recognition: 'stealth-ghost',
    specificity: 'passion-mismatch',
    differentiation: 'diamond-rough',
    visionEmpathy: 'future-blind',
    selectionUX: 'selection-maze',
    dialogue: 'closing-weak'
  };
  
  // 歩留まり課題がある場合、その課題フェーズに関連する軸から最低スコアを選択
  if (belowAverageStages.length > 0) {
    // 最も課題が大きいフェーズから順に確認
    for (const stage of belowAverageStages) {
      // まずprimary軸（◎）から最低スコアを探す
      const primaryAxisData = stage.primaryAxes.map(key => ({
        key,
        score: effectiveScores[key] ?? 0
      }));
      
      if (primaryAxisData.length > 0) {
        const lowestPrimaryScore = Math.min(...primaryAxisData.map(a => a.score));
        const lowestPrimaryAxes = primaryAxisData.filter(a => a.score === lowestPrimaryScore);
        
        if (lowestPrimaryAxes.length > 0) {
          return typeMapping[lowestPrimaryAxes[0].key] || 'diamond-rough';
        }
      }
      
      // primary軸がなければsecondary軸（○）を確認
      const secondaryAxisData = stage.secondaryAxes.map(key => ({
        key,
        score: effectiveScores[key] ?? 0
      }));
      
      if (secondaryAxisData.length > 0) {
        const lowestSecondaryScore = Math.min(...secondaryAxisData.map(a => a.score));
        const lowestSecondaryAxes = secondaryAxisData.filter(a => a.score === lowestSecondaryScore);
        
        if (lowestSecondaryAxes.length > 0) {
          return typeMapping[lowestSecondaryAxes[0].key] || 'diamond-rough';
        }
      }
    }
  }
  
  // 歩留まりデータがない場合は、全軸の中で最低スコアの軸を選択
  const allAxisData = axes.map(key => ({
    key,
    score: effectiveScores[key] ?? 0
  }));
  
  const lowestScore = Math.min(...allAxisData.map(a => a.score));
  const lowestAxes = allAxisData.filter(a => a.score === lowestScore);
  
  // 最も優先度の高い軸を選択（デフォルトの優先順位）
  const defaultPriority = ['recognition', 'specificity', 'differentiation', 'visionEmpathy', 'selectionUX', 'dialogue'];
  lowestAxes.sort((a, b) => defaultPriority.indexOf(a.key) - defaultPriority.indexOf(b.key));
  
  return typeMapping[lowestAxes[0]?.key] || 'diamond-rough';
};

// ========================================
// 共通データ構築関数
// ========================================
// 【inventory 10-A】effectiveData 構築の共通関数
// 問診回答からスコアを計算し、既存値とマージして確定データを構築する。
// 8箇所で同一パターンが使われていたものを一元化。修正時はここだけ変更すればよい。
// 依存: calcScoresFromAnswers → mergeScores → calcFinalScore → determineRank → determineDiagnosisType
// 参照: inventory セクション 9-A（計算依存関係フロー）
const buildEffectiveData = (data) => {
  const calculatedScores = calcScoresFromAnswers(data);
  
  // 各スコアをマージ（計算値優先 → 既存値フォールバック）
  const effectiveMindsetScores = mergeScores(calculatedScores.mindsetScores, data.mindsetScores, MINDSET_AXES);
  const effectiveStaffMindsetScores = mergeScores(calculatedScores.staffMindsetScores, data.staffMindsetScores, MINDSET_AXES);
  // 決裁者モード: 上層部マインドセットは担当者のスコアをコピー
  const effectiveExecMindsetScores = data.isDecisionMaker
    ? { ...effectiveStaffMindsetScores }
    : mergeScores(calculatedScores.execMindsetScores, data.execMindsetScores, MINDSET_AXES);
  const effectiveStaffScores = mergeScores(calculatedScores.staffScores, data.staffScores, EVALUATION_AXES);
  const effectiveExecScores = mergeScores(calculatedScores.executiveScores, data.executiveScores, EVALUATION_AXES);
  const effectiveStudentScores = mergeScores(calculatedScores.studentScores, data.studentScores, EVALUATION_AXES);
  // null = 未回答を保持（0点と区別するため ?? null を使用）
  const effectiveDepthScores = {
    surface: calculatedScores.depthScores?.surface ?? data.depthScores?.surface ?? null,
    middle: calculatedScores.depthScores?.middle ?? data.depthScores?.middle ?? null,
    deep: calculatedScores.depthScores?.deep ?? data.depthScores?.deep ?? null
  };
  
  const effectiveData = {
    ...data,
    mindsetScores: effectiveMindsetScores,
    staffMindsetScores: effectiveStaffMindsetScores,
    execMindsetScores: effectiveExecMindsetScores,
    staffScores: effectiveStaffScores,
    executiveScores: effectiveExecScores,
    studentScores: effectiveStudentScores,
    depthScores: effectiveDepthScores
  };
  
  // 【inventory 9-A】finalScore = round(baseScore × mindsetCoeff × gapCoeff + yieldPenalty)
  const finalScore = calcFinalScore(effectiveData);
  const rank = determineRank(finalScore);
  const diagType = determineDiagnosisType(effectiveData);
  const typeDef = DIAGNOSIS_TYPES[diagType];
  const rankDef = RANK_DEFINITIONS[rank];
  
  return {
    effectiveData,
    calculatedScores,
    finalScore,
    rank,
    diagType,
    typeDef,
    rankDef,
    // DiagnosisSheet / ScoreCalculationDetails で個別参照に使用
    effectiveMindsetScores,
    effectiveStaffMindsetScores,
    effectiveExecMindsetScores,
    effectiveStaffScores,
    effectiveExecScores,
    effectiveStudentScores,
    effectiveDepthScores
  };
};

// 【inventory 10-C】AI診断データ構築の共通関数
// diagnosisDataForAI オブジェクトを構築する。
// 3箇所（handleReDiagnosis, handleGenerateAIWithButton, 診断画面）で同一パターンが使われていたものを一元化。
// 参照: inventory セクション 5（AIプロンプトに渡されるデータ）/ セクション 9-B（AI診断データ構築チェーン）
const buildDiagnosisDataForAI = (currentData, effectiveData, rank, typeDef) => {
  // 【inventory 2-9】担当者+上層部の6軸平均（スコア0も有効値として平均に含む）
  const avgScores = calcAvgScores(effectiveData.staffScores, effectiveData.executiveScores);
  // 【inventory 2-10】PHASE_AXIS_WEIGHT × avgScores + depthBonus
  const phaseScores = calcPhaseScores(avgScores, effectiveData.depthScores);
  
  const diagnosisDataForAI = {
    // 【inventory 5-1〜5-3】会社基本情報
    companyName: currentData.companyName,
    industry: currentData.industry,
    companySize: currentData.companySize,
    employeeCount: currentData.companySize,  // 【inventory A-1】AIプロンプトは {employeeCount} で展開
    // 【inventory 5-4〜5-5】判定結果
    rank: rank,
    diagnosisType: typeDef,
    // 【inventory 5-6】calcAvgScores の結果（担当者+上層部の平均）
    scores: {
      recognition: avgScores.recognition ?? 0,
      specificity: avgScores.specificity ?? 0,
      differentiation: avgScores.differentiation ?? 0,
      visionEmpathy: avgScores.visionEmpathy ?? 0,
      selectionUX: avgScores.selectionUX ?? 0,
      dialogue: avgScores.dialogue ?? 0
    },
    // 【inventory 5-7】calcPhaseScores の結果
    depthScores: {
      surface: phaseScores.surface.score,
      middle: phaseScores.middle.score,
      deep: phaseScores.deep.score
    },
    // 【inventory 5-8〜5-10】参考情報（直接展開なし）
    staffScores: effectiveData.staffScores,
    executiveScores: effectiveData.executiveScores,
    studentScores: effectiveData.studentScores,
    // 【inventory 5-11〜5-15】歩留まり・投資関連
    funnelData: currentData.funnelData,
    industryAverages: currentData.industryAverages,
    adjustedAverages: currentData.adjustedAverages,
    recruitmentMethods: currentData.recruitmentMethods,
    targetLayers: currentData.targetLayers,
    // 【inventory 5-16】採用手法効率分析
    recruitmentEfficiency: calcRecruitmentEfficiency(currentData),
    // 【inventory 5-17 / A-1】備考: notes 優先でフォールバック
    remarks: currentData.notes || currentData.remarks || ''
  };
  
  return { diagnosisDataForAI, avgScores, phaseScores };
};

// ========================================
// コンポーネント
// ========================================

// ダイヤモンドアイコン
const DiamondIcon = ({ color, size = 64 }) => (
  <svg width={size} height={size} viewBox="0 0 64 64">
    <defs>
      <linearGradient id={`diamond-${color.replace('#', '')}`} x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stopColor={color} stopOpacity="0.2" />
        <stop offset="100%" stopColor={color} stopOpacity="0.5" />
      </linearGradient>
      <filter id="diamond-shadow" x="-50%" y="-50%" width="200%" height="200%">
        <feDropShadow dx="0" dy="2" stdDeviation="3" floodColor={color} floodOpacity="0.3"/>
      </filter>
    </defs>
    <path 
      d="M32 4 L58 32 L32 60 L6 32 Z" 
      fill={`url(#diamond-${color.replace('#', '')})`}
      stroke={color}
      strokeWidth="2"
      filter="url(#diamond-shadow)"
    />
    <path 
      d="M32 14 L48 32 L32 50 L16 32 Z" 
      fill="none"
      stroke={color}
      strokeWidth="1"
      opacity="0.5"
    />
    <path 
      d="M32 22 L40 32 L32 42 L24 32 Z" 
      fill={color}
      opacity="0.4"
    />
  </svg>
);

// 3視点レーダーチャート（円形グリッド・高解像度版・アニメーション付き）
const TripleRadarChart = ({ staffData, execData, size = 280, labels, title, maxValue = 10 }) => {
  const canvasRef = useRef(null);
  const [animationProgress, setAnimationProgress] = useState(0);
  
  // アニメーション開始
  useEffect(() => {
    const timer = setTimeout(() => {
      let start = 0;
      const duration = 1000;
      const animate = (timestamp) => {
        if (!start) start = timestamp;
        const elapsed = timestamp - start;
        const progress = Math.min(elapsed / duration, 1);
        // イージング関数（ease-out-cubic）
        const eased = 1 - Math.pow(1 - progress, 3);
        setAnimationProgress(eased);
        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      };
      requestAnimationFrame(animate);
    }, 200);
    return () => clearTimeout(timer);
  }, []);
  
  // 描画
  useEffect(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;
    
    // 高解像度対応
    const dpr = window.devicePixelRatio || 1;
    canvas.width = size * dpr;
    canvas.height = size * dpr;
    canvas.style.width = size + 'px';
    canvas.style.height = size + 'px';
    
    const ctx = canvas.getContext('2d');
    ctx.scale(dpr, dpr);
    
    const centerX = size / 2;
    const centerY = size / 2;
    const radius = size * 0.38; // 円をさらに大きく
    const numPoints = labels.length;
    const gridLevels = 5;
    
    ctx.clearRect(0, 0, size, size);
    
    // 外側のグレー背景円
    ctx.beginPath();
    ctx.arc(centerX, centerY, radius + 30, 0, Math.PI * 2);
    ctx.fillStyle = '#f3f4f6';
    ctx.fill();
    
    // 内側の白円
    ctx.beginPath();
    ctx.arc(centerX, centerY, radius + 8, 0, Math.PI * 2);
    ctx.fillStyle = '#ffffff';
    ctx.fill();
    
    // 円形グリッド（同心円）
    for (let i = gridLevels; i >= 1; i--) {
      const gridRadius = (radius * i) / gridLevels;
      ctx.beginPath();
      ctx.arc(centerX, centerY, gridRadius, 0, Math.PI * 2);
      ctx.strokeStyle = '#e5e7eb';
      ctx.lineWidth = 1;
      ctx.stroke();
    }
    
    // 軸線（点線）
    ctx.setLineDash([3, 3]);
    for (let i = 0; i < numPoints; i++) {
      const angle = (Math.PI * 2 * i) / numPoints - Math.PI / 2;
      ctx.beginPath();
      ctx.moveTo(centerX, centerY);
      ctx.lineTo(centerX + Math.cos(angle) * radius, centerY + Math.sin(angle) * radius);
      ctx.strokeStyle = '#d1d5db';
      ctx.lineWidth = 1;
      ctx.stroke();
    }
    ctx.setLineDash([]);
    
    // 数値目盛り（上向きの軸に表示）
    ctx.font = '9px "Noto Sans JP"';
    ctx.textAlign = 'left';
    ctx.textBaseline = 'middle';
    ctx.fillStyle = '#9ca3af';
    
    for (let i = 1; i <= gridLevels; i++) {
      const value = Math.round((maxValue / gridLevels) * i);
      const yPos = centerY - (radius * i) / gridLevels;
      ctx.fillText(value.toString(), centerX + 3, yPos);
    }
    // 中央に0
    ctx.textAlign = 'center';
    ctx.fillText('0', centerX, centerY + 10);
    
    // データ描画関数（アニメーション対応）
    const drawData = (data, fillColor, strokeColor, lineWidth = 1) => {
      if (!data || data.length !== numPoints) return;
      
      ctx.beginPath();
      for (let i = 0; i <= numPoints; i++) {
        const idx = i % numPoints;
        const angle = (Math.PI * 2 * idx) / numPoints - Math.PI / 2;
        // アニメーション進捗を適用
        const value = (Math.min(data[idx], maxValue) / maxValue) * animationProgress;
        const x = centerX + Math.cos(angle) * radius * value;
        const y = centerY + Math.sin(angle) * radius * value;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.closePath();
      ctx.fillStyle = fillColor;
      ctx.fill();
      ctx.strokeStyle = strokeColor;
      ctx.lineWidth = lineWidth;
      ctx.stroke();
    };
    
    // 2視点のデータを描画（後ろから順に: 上層部 → 担当者）
    if (execData) {
      drawData(execData, 'rgba(59, 130, 246, 0.25)', '#3b82f6', 0.5); // 上層部（青）
    }
    if (staffData) {
      drawData(staffData, 'rgba(103, 232, 249, 0.35)', '#06b6d4', 0.5); // 担当者（シアン）
    }
    
    // ラベル描画（円の内側に配置）
    ctx.font = '10px "Noto Sans JP"';
    ctx.textBaseline = 'middle';
    ctx.fillStyle = '#374151';
    
    for (let i = 0; i < numPoints; i++) {
      const angle = (Math.PI * 2 * i) / numPoints - Math.PI / 2;
      const labelRadius = radius - 5; // 円の内側に配置
      let x = centerX + Math.cos(angle) * labelRadius;
      let y = centerY + Math.sin(angle) * labelRadius;
      
      // 角度に応じてテキストアラインを細かく調整
      const angleDeg = ((angle * 180 / Math.PI) + 450) % 360; // 0度を上に正規化
      
      if (angleDeg >= 350 || angleDeg < 10) {
        // 上（0度付近）- より上にずらして数値と被らないように
        ctx.textAlign = 'center';
        y -= 15;
      } else if (angleDeg >= 10 && angleDeg < 80) {
        // 右上
        ctx.textAlign = 'left';
      } else if (angleDeg >= 80 && angleDeg < 100) {
        // 右
        ctx.textAlign = 'left';
      } else if (angleDeg >= 100 && angleDeg < 170) {
        // 右下
        ctx.textAlign = 'left';
      } else if (angleDeg >= 170 && angleDeg < 190) {
        // 下 - 少し下にずらす
        ctx.textAlign = 'center';
        y += 8;
      } else if (angleDeg >= 190 && angleDeg < 260) {
        // 左下
        ctx.textAlign = 'right';
      } else if (angleDeg >= 260 && angleDeg < 280) {
        // 左
        ctx.textAlign = 'right';
      } else {
        // 左上
        ctx.textAlign = 'right';
      }
      
      ctx.fillText(labels[i], x, y);
    }
    
  }, [staffData, execData, size, labels, maxValue, animationProgress]);
  
  return <canvas ref={canvasRef} style={{ display: 'block' }} />;
};

// ファネル図（アニメーション付き）
const FunnelChart = ({ data }) => {
  const [animationProgress, setAnimationProgress] = useState(0);
  
  // データが入力されているか確認
  const hasData = data.targetAwareness || data.interest || data.applications || 
                  data.screening || data.offers || data.acceptance;
  
  useEffect(() => {
    if (!hasData) return;
    const timer = setTimeout(() => {
      let start = 0;
      const duration = 800;
      const animate = (timestamp) => {
        if (!start) start = timestamp;
        const elapsed = timestamp - start;
        const progress = Math.min(elapsed / duration, 1);
        const eased = 1 - Math.pow(1 - progress, 3);
        setAnimationProgress(eased);
        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      };
      requestAnimationFrame(animate);
    }, 100);
    return () => clearTimeout(timer);
  }, [hasData]);
  
  // データがない場合はメッセージ表示
  if (!hasData) {
    return (
      <div className="flex flex-col items-center justify-center h-full text-gray-400 text-sm py-4">
        <div>採用実績未入力</div>
      </div>
    );
  }
  
  const funnelData = [
    { label: '認知', value: data.targetAwareness || 0, width: 100, color: '#60a5fa' },
    { label: '興味', value: data.interest || 0, width: 80, color: '#818cf8' },
    { label: '接触', value: data.applications || 0, width: 60, color: '#a78bfa' },
    { label: '選考', value: data.screening || 0, width: 45, color: '#c084fc' },
    { label: '内々定', value: data.offers || 0, width: 32, color: '#e879f9' },
    { label: '承諾', value: data.acceptance || 0, width: 22, color: '#f0abfc' }
  ];
  
  return (
    <div className="flex flex-col items-center gap-1">
      {funnelData.map((item, idx) => (
        <div
          key={item.label}
          className="funnel-layer"
          style={{
            width: `${item.width * animationProgress}%`,
            height: '28px',
            background: item.color,
            opacity: animationProgress
          }}
        >
          <span className="text-[10px] mr-2 opacity-80">{item.label}</span>
          <span className="font-bold">{Math.round(item.value * animationProgress)}</span>
        </div>
      ))}
    </div>
  );
};

// 深度バー（表層・中層・深層）（アニメーション付き）
// scoresは10点満点のスコア（0-10）
const DepthBars = ({ scores }) => {
  const [animationProgress, setAnimationProgress] = useState(0);
  
  useEffect(() => {
    const timer = setTimeout(() => {
      let start = 0;
      const duration = 800;
      const animate = (timestamp) => {
        if (!start) start = timestamp;
        const elapsed = timestamp - start;
        const progress = Math.min(elapsed / duration, 1);
        const eased = 1 - Math.pow(1 - progress, 3);
        setAnimationProgress(eased);
        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      };
      requestAnimationFrame(animate);
    }, 200);
    return () => clearTimeout(timer);
  }, []);
  
  const layers = [
    { key: 'surface', name: '表層部', color: '#7DD3FC', bgColor: '#e0f2fe' },
    { key: 'middle', name: '中層部', color: '#A5B4FC', bgColor: '#e0e7ff' },
    { key: 'deep', name: '深層部', color: '#DDD6FE', bgColor: '#f3e8ff' }
  ];
  
  return (
    <div className="py-2">
      {layers.map((layer, index) => {
        const score = scores?.[layer.key] ?? 0;  // 0-10のスコア
        const percentage = (score / 10) * 100;  // パーセンテージに変換（小数点あり）
        const displayPercentage = percentage % 1 === 0 ? percentage.toFixed(0) : percentage.toFixed(1);  // 整数なら小数点なし、そうでなければ1桁
        return (
          <div key={layer.key}>
            <div className="flex items-center gap-4 py-4">
              <span className="text-xs text-gray-700 w-14">{layer.name}</span>
              <div className="flex-1 h-5 rounded-full overflow-hidden relative" style={{ background: layer.bgColor }}>
                <div 
                  className="h-full rounded-full flex items-center justify-end pr-2"
                  style={{ 
                    width: `${percentage * animationProgress}%`, 
                    background: layer.color,
                    minWidth: percentage > 0 ? '40px' : '0px'
                  }}
                >
                  {percentage > 0 && animationProgress > 0.8 && (
                    <span className="text-xs font-medium text-gray-700">{displayPercentage}%</span>
                  )}
                </div>
                <div className="absolute top-0 bottom-0 left-1/2 border-l border-dashed border-gray-400" style={{ transform: 'translateX(-50%)' }}></div>
              </div>
            </div>
            {index < layers.length - 1 && <div className="border-b border-gray-300"></div>}
          </div>
        );
      })}
    </div>
  );
};

// スマホプレビュー（Before/After）
const PhonePreview = ({ type, content }) => {
  const isBefore = type === 'before';
  
  return (
    <div className={`compare-frame ${type}`}>
      <div 
        className="compare-label"
        style={{ 
          background: isBefore ? '#fecaca' : '#bbf7d0',
          color: isBefore ? '#dc2626' : '#16a34a'
        }}
      >
        {isBefore ? '現状' : '改善後'}
      </div>
      <div className="p-3 h-28 flex flex-col items-center justify-center">
        <div className="text-3xl mb-2">{isBefore ? '📱' : '✨'}</div>
        <div className="text-xs text-center text-gray-600 leading-relaxed">
          {isBefore ? content.before || '情報が\n見つけにくい' : content.after || '魅力が\nしっかり伝わる'}
        </div>
      </div>
    </div>
  );
};

// 歩留まり実績チャート
const YieldPerformanceChart = ({ funnelData, savedIndustryAverages, adjustedAverages, targetHires }) => {
  const [animationProgress, setAnimationProgress] = useState(0);
  
  // ファネルデータから値を取得（デフォルト値なし）
  const awareness = funnelData?.targetAwareness;
  const interest = funnelData?.interest;
  const applications = funnelData?.applications;
  const screening = funnelData?.screening;
  const offers = funnelData?.offers;
  const acceptance = funnelData?.acceptance;
  
  // データが入力されているか確認
  const hasData = awareness || interest || applications || screening || offers || acceptance;
  
  // アニメーション
  useEffect(() => {
    if (!hasData) return;
    const timer = setTimeout(() => {
      let start = 0;
      const duration = 800;
      const animate = (timestamp) => {
        if (!start) start = timestamp;
        const elapsed = timestamp - start;
        const progress = Math.min(elapsed / duration, 1);
        // イージング関数（ease-out）
        const eased = 1 - Math.pow(1 - progress, 3);
        setAnimationProgress(eased);
        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      };
      requestAnimationFrame(animate);
    }, 300);
    return () => clearTimeout(timer);
  }, [funnelData, targetHires, hasData]);
  
  // データがない場合はメッセージを表示
  if (!hasData) {
    return (
      <div className="bg-gray-50 rounded-xl flex flex-col items-center justify-center h-full min-h-[200px]">
        <div className="text-gray-400 mb-2">
          <svg className="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg>
        </div>
        <div className="text-gray-500 font-medium">採用実績が未入力です</div>
        <div className="text-gray-400 text-sm mt-1 text-center px-4">「採用実績」タブで数値を入力すると、歩留まりグラフが表示されます</div>
      </div>
    );
  }
  
  // 業界平均値（調整値があればそれを優先、なければ業界平均値、さらになければデフォルト）
  const industryAverages = {
    awarenessToInterest: adjustedAverages?.awarenessToInterest ?? savedIndustryAverages?.awarenessToInterest ?? 22,
    interestToApplication: adjustedAverages?.interestToApplication ?? savedIndustryAverages?.interestToApplication ?? 25,
    applicationToScreening: adjustedAverages?.applicationToScreening ?? savedIndustryAverages?.applicationToScreening ?? 25,
    screeningToOffer: adjustedAverages?.screeningToOffer ?? savedIndustryAverages?.screeningToOffer ?? 41,
    offerToAcceptance: adjustedAverages?.offerToAcceptance ?? savedIndustryAverages?.offerToAcceptance ?? 80
  };
  
  // 値がない場合は0として扱う
  const safeAwareness = awareness || 0;
  const safeInterest = interest || 0;
  const safeApplications = applications || 0;
  const safeScreening = screening || 0;
  const safeOffers = offers || 0;
  const safeAcceptance = acceptance || Math.round((safeOffers) * 0.8);
  
  // 目標目安を業界平均から逆算（採用目標人数がある場合は逆算、ない場合は従来の順算）
  let targetAwareness, targetInterest, targetApplications, targetScreening, targetOffers, targetAcceptance;
  
  if (targetHires && targetHires > 0) {
    // 目標人数からの逆算方式
    targetAcceptance = targetHires;
    targetOffers = Math.ceil(targetAcceptance / (industryAverages.offerToAcceptance / 100));
    targetScreening = Math.ceil(targetOffers / (industryAverages.screeningToOffer / 100));
    targetApplications = Math.ceil(targetScreening / (industryAverages.applicationToScreening / 100));
    targetInterest = Math.ceil(targetApplications / (industryAverages.interestToApplication / 100));
    targetAwareness = Math.ceil(targetInterest / (industryAverages.awarenessToInterest / 100));
  } else {
    // 従来の順算方式（認知数を起点）
    targetAwareness = safeAwareness;
    targetInterest = Math.round(safeAwareness * industryAverages.awarenessToInterest / 100);
    targetApplications = Math.round(targetInterest * industryAverages.interestToApplication / 100);
    targetScreening = Math.round(targetApplications * industryAverages.applicationToScreening / 100);
    targetOffers = Math.round(targetScreening * industryAverages.screeningToOffer / 100);
    targetAcceptance = Math.round(targetOffers * industryAverages.offerToAcceptance / 100);
  }
  
  // 実績の歩留まり率を計算
  const actualRates = {
    awarenessToInterest: safeAwareness > 0 ? Math.round((safeInterest / safeAwareness) * 100) : 0,
    interestToApplication: safeInterest > 0 ? Math.round((safeApplications / safeInterest) * 100) : 0,
    applicationToScreening: safeApplications > 0 ? Math.round((safeScreening / safeApplications) * 100) : 0,
    screeningToOffer: safeScreening > 0 ? Math.round((safeOffers / safeScreening) * 100) : 0,
    offerToAcceptance: safeOffers > 0 ? Math.round((safeAcceptance / safeOffers) * 100) : 0
  };
  
  // グラデーションカラー（御社の採用力のバランスと同じ色）
  const barColors = [
    '#7DD3FC', // 認知 - 表層部
    '#A5B4FC', // 興味 - 中層部
    '#A5B4FC', // 接触 - 中層部
    '#A5B4FC', // 選考 - 中層部
    '#A5B4FC', // 内々定 - 中層部
    '#DDD6FE'  // 承諾 - 深層部
  ];
  
  // 背景カラー（御社の採用力のバランスと同じ色）
  const barBgColors = [
    '#e0f2fe', // 認知 - 表層部背景
    '#e0e7ff', // 興味 - 中層部背景
    '#e0e7ff', // 接触 - 中層部背景
    '#e0e7ff', // 選考 - 中層部背景
    '#e0e7ff', // 内々定 - 中層部背景
    '#f3e8ff'  // 承諾 - 深層部背景
  ];
  
  // 棒グラフデータ
  const barData = [
    { label: '認知', actual: safeAwareness, target: targetAwareness },
    { label: '興味', actual: safeInterest, target: targetInterest },
    { label: '接触', actual: safeApplications, target: targetApplications },
    { label: '選考', actual: safeScreening, target: targetScreening },
    { label: '内々定', actual: safeOffers, target: targetOffers },
    { label: '承諾', actual: safeAcceptance, target: targetAcceptance }
  ];
  
  // 最大値を統一（実績と目標の大きい方を基準）
  const globalMax = Math.max(safeAwareness, targetAwareness);
  
  return (
    <div className="flex gap-3">
      {/* 左側：棒グラフ */}
      <div className="flex-1">
        {/* X軸目盛り */}
        <div className="flex items-center mb-2 ml-12">
          <div className="flex-1 flex justify-between text-gray-400" style={{ fontSize: '10px' }}>
            <span>0</span>
            <span>{Math.round(globalMax / 2)}</span>
            <span>{globalMax}</span>
          </div>
        </div>
        
        {/* 棒グラフ */}
        <div className="space-y-2">
          {barData.map((item, idx) => {
            const actualWidth = (item.actual / globalMax) * 100 * animationProgress;
            const targetWidth = (item.target / globalMax) * 100 * animationProgress;
            // 数字がバーに被るかどうか（70%以上なら被る）
            const actualTextOverlap = actualWidth > 70;
            const targetTextOverlap = targetWidth > 70;
            
            return (
              <div key={item.label} className="flex items-start gap-2">
                <div className="w-10 text-right text-xs text-gray-600 font-medium pt-1">{item.label}</div>
                <div className="flex-1 space-y-0.5">
                  {/* 実績値（上段）- カラーバー */}
                  <div 
                    className="overflow-hidden relative"
                    style={{ backgroundColor: barBgColors[idx], borderRadius: '4px', height: '18px' }}
                  >
                    <div 
                      className="h-full"
                      style={{ 
                        width: `${actualWidth}%`,
                        backgroundColor: barColors[idx],
                        borderRadius: '4px',
                        transition: 'none'
                      }}
                    />
                    <span 
                      className="absolute right-1.5 top-0 font-medium"
                      style={{ color: actualTextOverlap ? '#ffffff' : '#6b7280', fontSize: '10px', lineHeight: '18px' }}
                    >
                      {Math.round(item.actual * animationProgress)}
                    </span>
                  </div>
                  {/* 目標目安（下段）- グレーの棒グラフ（上段の半分の太さ） */}
                  <div 
                    className="bg-gray-100 overflow-hidden relative"
                    style={{ borderRadius: '4px', height: '9px' }}
                  >
                    <div 
                      className="h-full"
                      style={{ 
                        width: `${targetWidth}%`,
                        backgroundColor: '#9ca3af',
                        borderRadius: '4px',
                        transition: 'none'
                      }}
                    />
                    <span 
                      className="absolute right-1.5 top-0"
                      style={{ color: targetTextOverlap ? '#d1d5db' : '#9ca3af', fontSize: '9px', lineHeight: '9px' }}
                    >
                      {Math.round(item.target * animationProgress)}
                    </span>
                  </div>
                </div>
              </div>
            );
          })}
        </div>
        
        {/* 凡例 */}
        <div className="text-center mt-3 text-gray-600 font-bold" style={{ fontSize: '10px' }}>
          上段：実績値　　下段：目標目安{targetHires > 0 && `（目標${targetHires}人から逆算）`}
        </div>
      </div>
      
      {/* 右側：歩留まり情報（仕切り付き） */}
      <div className="w-44 pl-3 border-l border-gray-300" style={{ fontSize: '10px' }}>
        <div className="font-bold text-gray-800 mb-2">【歩留まり率業界平均値】</div>
        <div className="space-y-1 text-gray-600">
          <div>認知→興味：{industryAverages.awarenessToInterest}%（実績 {actualRates.awarenessToInterest}%）</div>
          <div>興味→接触：{industryAverages.interestToApplication}%（実績 {actualRates.interestToApplication}%）</div>
          <div>接触→選考：{industryAverages.applicationToScreening}%（実績 {actualRates.applicationToScreening}%）</div>
          <div>選考→内々定：{industryAverages.screeningToOffer}%（実績 {actualRates.screeningToOffer}%）</div>
          <div>内々定→承諾：{industryAverages.offerToAcceptance}%（実績 {actualRates.offerToAcceptance}%）</div>
        </div>
        
        {/* コメント（業界平均を下回っている項目） */}
        {(() => {
          const belowAverageItems = [];
          if (actualRates.awarenessToInterest < industryAverages.awarenessToInterest) {
            belowAverageItems.push({ label: '認知→興味', diff: industryAverages.awarenessToInterest - actualRates.awarenessToInterest });
          }
          if (actualRates.interestToApplication < industryAverages.interestToApplication) {
            belowAverageItems.push({ label: '興味→接触', diff: industryAverages.interestToApplication - actualRates.interestToApplication });
          }
          if (actualRates.applicationToScreening < industryAverages.applicationToScreening) {
            belowAverageItems.push({ label: '接触→選考', diff: industryAverages.applicationToScreening - actualRates.applicationToScreening });
          }
          if (actualRates.screeningToOffer < industryAverages.screeningToOffer) {
            belowAverageItems.push({ label: '選考→内々定', diff: industryAverages.screeningToOffer - actualRates.screeningToOffer });
          }
          if (actualRates.offerToAcceptance < industryAverages.offerToAcceptance) {
            belowAverageItems.push({ label: '内々定→承諾', diff: industryAverages.offerToAcceptance - actualRates.offerToAcceptance });
          }
          
          if (belowAverageItems.length === 0) return null;
          
          return (
            <>
              <div className="border-t border-gray-200 my-2"></div>
              <div className="font-bold text-gray-800 mb-1">コメント</div>
              <div className="text-gray-600 leading-relaxed">
                {belowAverageItems.map((item, idx) => (
                  <div key={idx}>
                    {item.label}：業界平均より<span className="text-red-500 font-bold">▲{item.diff}%</span>
                  </div>
                ))}
              </div>
            </>
          );
        })()}
      </div>
    </div>
  );
};

// ========================================
// スコア計算詳細コンポーネント
// ========================================

const ScoreCalculationDetails = ({ data }) => {
  // 各軸のスコア計算
  const axisKeys = Object.keys(EVALUATION_AXES);
  const staffScores = data.staffScores || {};
  const execScores = data.executiveScores || {};
  
  // マインドセット（担当者・上層部それぞれ取得）
  const staffMindsetScores = data.staffMindsetScores || {};
  const execMindsetScores = data.execMindsetScores || {};
  const mindsetScores = data.mindsetScores || {};
  
  // 担当者・上層部の回答有無をチェック（0より大きい値があるか）
  const hasValidScore = (score) => score !== null && score !== undefined && score > 0;
  const hasStaffEvaluation = Object.values(staffScores).some(hasValidScore);
  const hasExecEvaluation = Object.values(execScores).some(hasValidScore);
  const hasStaffMindset = Object.values(staffMindsetScores).some(v => v !== null && v !== undefined);
  const hasExecMindset = Object.values(execMindsetScores).some(v => v !== null && v !== undefined);
  
  // 軸ごとの計算詳細（回答がない場合はnullを保持）- 担当者と上層部のみ
  const axisDetails = axisKeys.map(key => {
    const staff = staffScores[key];
    const exec = execScores[key];
    
    // 回答がある視点のみで平均を計算（担当者と上層部、0より大きい値のみ）
    let viewpoints = [];
    if (hasValidScore(staff)) viewpoints.push(staff);
    if (hasValidScore(exec)) viewpoints.push(exec);
    
    const avg = viewpoints.length > 0 
      ? (viewpoints.reduce((sum, v) => sum + v, 0) / viewpoints.length).toFixed(1)
      : null;
    
    return {
      key,
      name: EVALUATION_AXES[key].name,
      staff: hasValidScore(staff) ? staff : '-',
      exec: hasValidScore(exec) ? exec : '-',
      avg: avg !== null ? parseFloat(avg) : null,
      hasData: viewpoints.length > 0
    };
  });
  
  // 基礎スコア計算（回答がある軸のみ）
  const validAxes = axisDetails.filter(a => a.hasData);
  const totalAvg = validAxes.length > 0 
    ? validAxes.reduce((sum, axis) => sum + axis.avg, 0) / validAxes.length 
    : 0;
  const baseScore = (totalAvg * 10).toFixed(1);
  
  // マインドセット詳細（担当者・上層部それぞれ）
  const mindsetKeys = Object.keys(MINDSET_AXES);
  const mindsetDetails = mindsetKeys.map(key => {
    const staff = staffMindsetScores[key];
    const exec = execMindsetScores[key];
    const merged = mindsetScores[key];
    
    return {
      key,
      name: MINDSET_AXES[key].name,
      staff: (staff !== null && staff !== undefined) ? staff : '-',
      exec: (exec !== null && exec !== undefined) ? exec : '-',
      merged: (merged !== null && merged !== undefined) ? merged : '-'
    };
  });
  
  // マインドセット係数計算（有効な値のみで平均 - calcMindsetCoefficientと同じロジック）
  const validMindsetValues = mindsetKeys
    .map(k => mindsetScores[k])
    .filter(v => v !== null && v !== undefined);
  const mindsetAvg = validMindsetValues.length > 0 
    ? validMindsetValues.reduce((a, b) => a + b, 0) / validMindsetValues.length 
    : 0;
  // 0.4 + (avg / 10) * 0.8 = 0.4 〜 1.2
  const mindsetCoef = validMindsetValues.length > 0 
    ? (0.4 + (mindsetAvg / 10) * 0.8).toFixed(3)
    : '0.400';
  
  // ギャップ係数（企業 vs 学生）
  const gapResult = calcGapCoefficient(data);
  const gapCoef = gapResult.coefficient.toFixed(2);
  
  // 最終スコア
  const finalScore = Math.max(0, Math.min(100, 
    Math.round(parseFloat(baseScore) * parseFloat(mindsetCoef) * parseFloat(gapCoef))
  ));
  
  return (
    <div className="space-y-4 text-sm">
      {/* 6軸スコア詳細 */}
      <div className="bg-gray-50 rounded-lg p-4">
        <div className="font-bold text-gray-700 mb-2 flex items-center">
          ① 6軸評価スコア（魅力伝達力）
          <InfoTooltip content="採用活動において学生に自社の魅力を伝える力を6つの軸で評価します。\n\n担当者と上層部それぞれの回答から算出し、平均値×10が基礎スコアになります。\n\n各軸にカーソルを合わせると詳細が表示されます。" position="bottom" />
        </div>
        {!hasStaffEvaluation && !hasExecEvaluation && (
          <div className="text-xs text-amber-600 mb-2 flex items-center gap-1">
            <span>⚠</span>
            <span>問診に回答すると数値が反映されます</span>
          </div>
        )}
        <div className="overflow-x-auto">
          <table className="w-full text-xs">
            <thead>
              <tr className="border-b border-gray-300 bg-gray-100">
                <th className="text-left py-2 px-2 w-28">軸名</th>
                <th className="text-center py-2 px-2 w-16">担当者</th>
                <th className="text-center py-2 px-2 w-16">上層部</th>
                <th className="text-center py-2 px-2 w-16">平均</th>
              </tr>
            </thead>
            <tbody>
              {axisDetails.map(axis => (
                <tr key={axis.key} className="border-b border-gray-100">
                  <td className="py-2 px-2 font-medium text-gray-700">
                    <Tooltip content={EVALUATION_AXES[axis.key]?.tooltip} position="right">
                      {axis.name}
                    </Tooltip>
                  </td>
                  <td className="text-center py-2 px-2 text-gray-600">{axis.staff}</td>
                  <td className="text-center py-2 px-2 text-gray-600">{axis.exec}</td>
                  <td className="text-center py-2 px-2 font-bold text-blue-600">{axis.avg !== null ? axis.avg : '-'}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
        <div className="mt-3 text-right text-xs text-gray-500">
          6軸平均 × 10 → <span className="font-bold text-gray-700">基礎スコア: {baseScore}点</span>
        </div>
      </div>
      
      {/* マインドセット係数（採用基礎力） */}
      <div className="bg-blue-50 rounded-lg p-4">
        <div className="font-bold text-gray-700 mb-2 flex items-center">
          ② 採用基礎力係数（マインドセット）
          <InfoTooltip content="採用活動の土台となる組織の姿勢・体制を5軸で評価します。\n\n【計算式】\n0.4 + (5軸平均 / 10) × 0.8\n\n【係数範囲】0.4〜1.2\n・基礎力が高い（10点満点）→ 1.2倍\n・基礎力が低い（0点）→ 0.4倍\n\n各軸にカーソルを合わせると詳細が表示されます。" position="bottom" />
        </div>
        {!hasStaffMindset && !hasExecMindset && (
          <div className="text-xs text-amber-600 mb-2 flex items-center gap-1">
            <span>⚠</span>
            <span>問診に回答すると数値が反映されます</span>
          </div>
        )}
        <div className="overflow-x-auto">
          <table className="w-full text-xs mb-3">
            <thead>
              <tr className="border-b border-gray-300 bg-blue-100">
                <th className="text-left py-2 px-2 w-28">軸名</th>
                <th className="text-center py-2 px-2 w-16">担当者</th>
                <th className="text-center py-2 px-2 w-16">上層部</th>
                <th className="text-center py-2 px-2 w-16">合算</th>
              </tr>
            </thead>
            <tbody>
              {mindsetDetails.map(axis => (
                <tr key={axis.key} className="border-b border-gray-100">
                  <td className="py-2 px-2 font-medium text-gray-700">
                    <Tooltip content={MINDSET_AXES[axis.key]?.tooltip} position="right">
                      {axis.name}
                    </Tooltip>
                  </td>
                  <td className="text-center py-2 px-2 text-gray-600">{axis.staff}</td>
                  <td className="text-center py-2 px-2 text-gray-600">{axis.exec}</td>
                  <td className="text-center py-2 px-2 font-bold text-blue-600">{axis.merged}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
        <div className="text-xs text-gray-600">
          計算式: 0.4 + (平均 {mindsetAvg.toFixed(1)} / 10) × 0.8 = <span className="font-bold text-blue-600">×{mindsetCoef}</span>
        </div>
        <div className="text-[10px] text-gray-400 mt-1">
          ※ 係数範囲: 0.4〜1.2（基礎力が高いほどスコアにプラス効果）
        </div>
        {hasStaffMindset && !hasExecMindset && (
          <div className="text-[10px] text-blue-500 mt-1">
            ※ 担当者のみの回答で計算しています
          </div>
        )}
      </div>
      
      {/* ギャップ係数 */}
      <div className="bg-amber-50 rounded-lg p-4">
        <div className="font-bold text-gray-700 mb-2 flex items-center">
          ③ ギャップ係数（企業 vs 学生）
          <InfoTooltip content="企業が「伝えているつもり」の情報と、学生が「受け取れている」情報のギャップを測定します。\n\n【計算方法】\n①「知りたい」に応えている率 = 企業の正解率\n②「伝わった」率 = 学生の正解率\n③「知りたいことが伝わった」率 = ① × ② ÷ 100\n\n【係数変換】\n・61%以上 → 1.0\n・41〜60% → 0.85\n・21〜40% → 0.7\n・20%以下 → 0.5" position="bottom" />
        </div>
        <div className="text-xs text-gray-600 mb-2">
          ギャップチェック対象の質問について、企業側の正解率と学生側の正解率から算出します。
          企業が「伝えているつもり」でも学生に「届いていない」場合、係数が低下します。
        </div>
        
        {gapResult.gapQuestionCount === 0 ? (
          <div className="text-xs text-gray-500 mb-2 flex items-center gap-1">
            <span>ℹ</span>
            <span>ギャップチェック対象の質問がありません</span>
          </div>
        ) : gapResult.companyRate === null ? (
          <div className="text-xs text-gray-500 mb-2 flex items-center gap-1">
            <span>ℹ</span>
            <span>企業問診が未回答です（係数は1.0で計算）</span>
          </div>
        ) : gapResult.studentRate === null ? (
          <div className="text-xs text-gray-500 mb-2 flex items-center gap-1">
            <span>ℹ</span>
            <span>学生問診が未回答です（係数は1.0で計算）</span>
          </div>
        ) : parseFloat(gapCoef) < 1 ? (
          <div className="bg-white rounded p-2 text-xs mb-2">
            <div className="text-amber-600 flex items-center gap-1 mb-1">
              <span>⚠</span>
              <span>企業と学生の間に認識ギャップがあります</span>
            </div>
            <div className="text-gray-600 space-y-0.5">
              <div>「知りたい」に応えている率: <span className="font-medium">{gapResult.companyRate}%</span></div>
              <div>「伝わった」率: <span className="font-medium">{gapResult.studentRate}%</span></div>
              <div>「知りたいことが伝わった」率: <span className="font-medium text-amber-600">{gapResult.combinedRate}%</span></div>
            </div>
          </div>
        ) : (
          <div className="bg-white rounded p-2 text-xs mb-2">
            <div className="text-green-600 flex items-center gap-1 mb-1">
              <span>✓</span>
              <span>認識ギャップは小さいです</span>
            </div>
            <div className="text-gray-600 space-y-0.5">
              <div>「知りたい」に応えている率: <span className="font-medium">{gapResult.companyRate}%</span></div>
              <div>「伝わった」率: <span className="font-medium">{gapResult.studentRate}%</span></div>
              <div>「知りたいことが伝わった」率: <span className="font-medium">{gapResult.combinedRate}%</span></div>
            </div>
          </div>
        )}
        
        <div className="text-xs">
          係数: <span className="font-bold text-amber-600">×{gapCoef}</span>
          {gapResult.gapQuestionCount > 0 && (
            <span className="text-gray-400 ml-2">（対象質問: {gapResult.gapQuestionCount}問）</span>
          )}
        </div>
        <div className="text-[10px] text-gray-400 mt-1">
          ※ 係数範囲: 0.5〜1.0（「知りたいことが伝わった」率60%以下で低下、20%以下で最低値）
        </div>
      </div>
      
      {/* 最終計算 */}
      <div className="bg-gradient-to-r from-indigo-100 to-purple-100 rounded-lg p-4">
        <div className="font-bold text-gray-700 mb-2 flex items-center">
          ④ 最終スコア計算
          <InfoTooltip content="【最終スコア計算式】\n基礎スコア × 採用基礎力係数 × ギャップ係数\n\n【スコア範囲】0〜100点\n\n【ランク判定】\n・S（80点以上）: 採用マスター\n・A（65点以上）: 優良ホワイト\n・B（45点以上）: 隠れブラックボックス\n・C（20点以上）: ザル採用（要改善）\n・D（20点未満）: 危険ライン" position="bottom" />
        </div>
        <div className="text-xs space-y-1">
          <div className="flex items-center gap-2 flex-wrap">
            <div className="flex flex-col items-center">
              <span className="text-[10px] text-gray-500">基礎</span>
              <span className="bg-white px-2 py-1 rounded font-medium">{baseScore}</span>
            </div>
            <span className="text-gray-400">×</span>
            <div className="flex flex-col items-center">
              <span className="text-[10px] text-gray-500">基礎力</span>
              <span className="bg-white px-2 py-1 rounded font-medium">{mindsetCoef}</span>
            </div>
            <span className="text-gray-400">×</span>
            <div className="flex flex-col items-center">
              <span className="text-[10px] text-gray-500">ギャップ</span>
              <span className="bg-white px-2 py-1 rounded font-medium">{gapCoef}</span>
            </div>
            <span className="text-gray-400">=</span>
            <div className="flex flex-col items-center">
              <span className="text-[10px] text-white">最終</span>
              <span className="bg-indigo-600 text-white px-3 py-1 rounded font-bold text-base">{finalScore}点</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

// ========================================
// AI診断モーダル
// ========================================

const AIDiagnosisModal = ({ data, onClose, onComplete }) => {
  const [isAnalyzing, setIsAnalyzing] = useState(true);
  const [analysisStep, setAnalysisStep] = useState(0);
  
  const analysisSteps = [
    { label: '質問回答を収集中...' },
    { label: '採用基礎力を分析中...' },
    { label: '魅力伝達力を評価中...' },
    { label: 'ターゲット適合度を計算中...' },
    { label: 'AIアドバイスを生成中...' },
    { label: '診断レポートを作成中...' }
  ];
  
  // 質問回答を文字情報に変換
  const generateAnswersSummary = () => {
    const master = getEffectiveQuestionMaster(data);
    const sizeCategory = getCompanySizeCategory(data.companySize);
    let summary = [];
    
    // 基本情報
    summary.push(`【基本情報】`);
    summary.push(`企業名: ${data.companyName || '未設定'}`);
    summary.push(`業種: ${data.industry || '未設定'}`);
    summary.push(`従業員規模: ${data.companySize || '未設定'}`);
    summary.push(`地域: ${REGION_LIST.find(r => r.key === data.yieldSettings?.region)?.label || '愛知県'}`);
    summary.push(`歩留まり率基準手法: ${data.yieldSettings?.methodCategory || 'ナビサイト'}`);
    summary.push('');
    
    // ターゲット学生
    const enabledLayers = Object.entries(data.targetLayers || {})
      .filter(([k, v]) => v?.enabled)
      .map(([k, v]) => `${k}層(${v.ratio}%)`);
    if (enabledLayers.length > 0) {
      summary.push(`【ターゲット学生】${enabledLayers.join(', ')}`);
      summary.push('');
    }
    
    // 採用手法
    const METHODS = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
    const activeMethods = Object.entries(data.recruitmentMethods || {})
      .filter(([k, v]) => v?.active)
      .map(([k, v]) => METHODS[k]?.name || k);
    if (activeMethods.length > 0) {
      summary.push(`【採用手法】${activeMethods.join(', ')}`);
      summary.push('');
    }
    
    // 各視点の回答を収集
    ['staff', 'executive', 'student'].forEach(roleKey => {
      const roleName = { staff: '採用担当者', executive: '上層部', student: '学生' }[roleKey];
      const answers = data[`${roleKey}Answers`] || {};
      
      if (Object.keys(answers).length > 0) {
        summary.push(`【${roleName}の回答】`);
        
        // ベース質問
        const baseQuestions = master.base?.[sizeCategory]?.[roleKey] || [];
        baseQuestions.forEach(q => {
          if (answers[q.id]) {
            const isCorrect = answers[q.id] === q.correctAnswer;
            summary.push(`Q: ${q.question}`);
            summary.push(`A: ${answers[q.id] === 'A' ? q.choiceA : q.choiceB} ${isCorrect ? '✓' : '✗(-' + (q.points || q.penaltyPoints || 2) + '点)'}`);
          }
        });
        
        // 業種別質問
        const industryQuestions = master.industry?.[data.industry]?.[sizeCategory]?.[roleKey] || [];
        industryQuestions.forEach(q => {
          if (answers[q.id]) {
            const isCorrect = answers[q.id] === q.correctAnswer;
            summary.push(`Q: ${q.question}`);
            summary.push(`A: ${answers[q.id] === 'A' ? q.choiceA : q.choiceB} ${isCorrect ? '✓' : '✗(-' + (q.points || q.penaltyPoints || 2) + '点)'}`);
          }
        });
        
        summary.push('');
      }
    });
    
    return summary.join('\n');
  };
  
  // 【inventory 10-A #3】effectiveData構築（共通関数を使用）
  const { effectiveData, finalScore, rank, diagType, typeDef } = buildEffectiveData(data);
  
  // フェーズ別スコアを計算（担当者+上層部の平均 × PHASE_AXIS_WEIGHT）
  const avgScoresForAI = calcAvgScores(effectiveData.staffScores, effectiveData.executiveScores);
  const phaseScoresForAI = calcPhaseScores(avgScoresForAI, effectiveData.depthScores);
  const surfaceScore = phaseScoresForAI.surface.score;
  const middleScore = phaseScoresForAI.middle.score;
  const deepScore = phaseScoresForAI.deep.score;
  
  // AI診断レポートを生成
  const generateAIReport = () => {
    const answersSummary = generateAnswersSummary();
    
    // 強み・弱みを分析（担当者+上層部の平均ベース）
    const axisScores = Object.entries(EVALUATION_AXES).map(([key, axis]) => ({
      key,
      name: axis.name,
      score: avgScoresForAI[key] ?? 0,
      phase: ''
    })).sort((a, b) => b.score - a.score);
    
    const strengths = axisScores.slice(0, 3);
    const weaknesses = axisScores.slice(-3).reverse();
    
    // マインドセットスコア
    const mindsetScores = Object.entries(MINDSET_AXES).map(([key, axis]) => ({
      key,
      name: axis.name,
      score: effectiveData.mindsetScores?.[key] ?? 0
    }));
    const mindsetAvg = mindsetScores.reduce((sum, m) => sum + m.score, 0) / mindsetScores.length;
    
    // 組織課題を特定
    const orgIssues = [];
    if (mindsetAvg < 5) orgIssues.push('採用に対するマインドセットの改善が必要です');
    if (weaknesses[0]?.score < 4) orgIssues.push(`「${weaknesses[0]?.name}」の強化が急務です`);
    
    // 内部摩擦ペナルティは無効化
    // const frictionPenalty = calcFrictionPenalty(effectiveData.staffScores, effectiveData.executiveScores);
    // if (frictionPenalty < -5) orgIssues.push('担当者と上層部の認識ギャップを解消する必要があります');
    
    return {
      answersSummary,
      typeDef,
      finalScore,
      rank,
      surfaceScore,
      middleScore,
      deepScore,
      strengths,
      weaknesses,
      mindsetScores,
      mindsetAvg,
      orgIssues,
      recommendations: [
        {
          title: '最優先アクション',
          content: weaknesses[0]?.score < 5 
            ? `「${weaknesses[0]?.name}」を改善するため、${
                weaknesses[0]?.phase === '仕入れ' ? 'ターゲット学生への認知度向上施策を検討してください。SNS活用や大学連携の強化が効果的です。' :
                weaknesses[0]?.phase === '加工' ? '選考プロセスの見直しを行い、学生体験を向上させてください。レスポンス速度の改善や情報開示の充実が重要です。' :
                'クロージング力を強化してください。内定者フォローや入社動機の醸成に注力しましょう。'
              }`
            : '現状の採用活動を継続しながら、さらなる強化ポイントを探りましょう。'
        },
        {
          title: '短期施策（1-3ヶ月）',
          content: orgIssues.length > 0 
            ? orgIssues[0]
            : '採用サイトの情報を最新化し、具体的な数字や社員の声を追加してください。'
        },
        {
          title: '中長期施策（3-6ヶ月）',
          content: `${strengths[0]?.name}が強みです。この強みを活かした採用ブランディングを構築し、差別化を図りましょう。`
        }
      ]
    };
  };
  
  // 分析を実行
  useEffect(() => {
    let stepIndex = 0;
    const interval = setInterval(() => {
      stepIndex++;
      setAnalysisStep(stepIndex);
      
      if (stepIndex >= analysisSteps.length) {
        clearInterval(interval);
        setTimeout(() => {
          setIsAnalyzing(false);
          // AI診断レポートを表示せず、診断結果画面に遷移
          if (onComplete) {
            onComplete();
          }
          onClose();
        }, 500);
      }
    }, 800);
    
    return () => clearInterval(interval);
  }, []);
  
  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl shadow-2xl w-full max-w-3xl overflow-hidden">
        {/* ヘッダー */}
        <div className="p-5 border-b border-gray-200 flex justify-between items-center bg-gradient-to-r from-indigo-600 to-purple-600">
          <div className="text-white">
            <h2 className="text-2xl font-bold">診断実行中</h2>
            <p className="text-sm opacity-80">採用ブラックボックス診断</p>
          </div>
        </div>
        
        {/* ローディング画面 */}
        <div className="flex flex-col items-center justify-center py-20 px-12">
          <div className="relative w-40 h-40 mb-10">
            {/* 回転するリング */}
            <div className="absolute inset-0 border-4 border-indigo-200 rounded-full"></div>
            <div className="absolute inset-0 border-4 border-transparent border-t-indigo-600 rounded-full animate-spin"></div>
            <div className="absolute inset-4 border-4 border-transparent border-t-purple-500 rounded-full animate-spin" style={{animationDirection: 'reverse', animationDuration: '1.5s'}}></div>
            <div className="absolute inset-8 border-4 border-transparent border-t-blue-400 rounded-full animate-spin" style={{animationDuration: '2s'}}></div>
          </div>
          
          <div className="text-2xl font-bold text-gray-800 mb-6">
            {analysisSteps[Math.min(analysisStep, analysisSteps.length - 1)]?.label}
          </div>
          
          {/* プログレスバー */}
          <div className="w-full max-w-md bg-gray-200 rounded-full h-3 overflow-hidden mb-4">
            <div 
              className="h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-500"
              style={{ width: `${Math.min(((analysisStep + 1) / analysisSteps.length) * 100, 100)}%` }}
            ></div>
          </div>
          
          {/* パーセント表示 */}
          <div className="text-lg font-bold text-indigo-600 mb-6">
            {Math.min(Math.round(((analysisStep + 1) / analysisSteps.length) * 100), 100)}%
          </div>
          
          {/* ステップインジケーター */}
          <div className="flex gap-3 mt-2">
            {analysisSteps.map((step, idx) => (
              <div
                key={idx}
                className={`w-4 h-4 rounded-full transition-all ${
                  idx <= analysisStep ? 'bg-indigo-500 scale-100' : 'bg-gray-300 scale-75'
                }`}
              ></div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

// ========================================
// 質問マスター設定モーダル
// ========================================

const QuestionMasterModal = ({ onClose, questionMaster, onSave }) => {
  const [localMaster, setLocalMaster] = useState(JSON.parse(JSON.stringify(questionMaster)));
  const [activeSection, setActiveSection] = useState('base');
  const [selectedSize, setSelectedSize] = useState('small');
  const [selectedIndustry, setSelectedIndustry] = useState('製造業（ものづくり）');
  const [selectedLayer, setSelectedLayer] = useState('A');
  const [selectedDepth, setSelectedDepth] = useState('surface');
  const [selectedRole, setSelectedRole] = useState('staff');
  
  const roles = [
    { id: 'staff', label: '担当者' },
    { id: 'executive', label: '上層部' }
  ];
  
  const sizes = [
    { id: 'small', label: '100名以下' },
    { id: 'medium', label: '101〜300名' },
    { id: 'large', label: '301名以上' }
  ];
  
  const depthPhases = [
    { id: 'surface', label: '表層部（認知〜興味）' },
    { id: 'middle', label: '中層部（応募〜選考）' },
    { id: 'deep', label: '深層部（内定〜承諾）' }
  ];
  
  const industries = ['製造業（ものづくり）', '製造業（食品メーカー・その他）', 'IT・通信', '金融・保険', '小売・流通', 'サービス業', '建設・不動産', '医療・福祉', '飲食・宿泊', '運輸・物流', 'マスコミ・広告', 'コンサルティング', '商社・卸売', 'その他'];
  const layers = Object.keys(STUDENT_MATRIX);
  
  // 質問を取得
  const getQuestions = () => {
    if (activeSection === 'base') {
      return localMaster.base?.[selectedSize]?.[selectedRole] || [];
    } else if (activeSection === 'industry') {
      return localMaster.industry?.[selectedIndustry]?.[selectedSize]?.[selectedRole] || [];
    } else if (activeSection === 'depth') {
      return localMaster.depth?.[selectedDepth]?.[selectedRole] || [];
    } else {
      return localMaster.targetLayer?.[selectedLayer]?.[selectedRole] || [];
    }
  };
  
  // 質問を更新
  const updateQuestions = (questions) => {
    const newMaster = { ...localMaster };
    if (activeSection === 'base') {
      if (!newMaster.base) newMaster.base = {};
      if (!newMaster.base[selectedSize]) newMaster.base[selectedSize] = {};
      newMaster.base[selectedSize][selectedRole] = questions;
    } else if (activeSection === 'industry') {
      if (!newMaster.industry) newMaster.industry = {};
      if (!newMaster.industry[selectedIndustry]) newMaster.industry[selectedIndustry] = {};
      if (!newMaster.industry[selectedIndustry][selectedSize]) newMaster.industry[selectedIndustry][selectedSize] = {};
      newMaster.industry[selectedIndustry][selectedSize][selectedRole] = questions;
    } else if (activeSection === 'depth') {
      if (!newMaster.depth) newMaster.depth = {};
      if (!newMaster.depth[selectedDepth]) newMaster.depth[selectedDepth] = {};
      newMaster.depth[selectedDepth][selectedRole] = questions;
    } else {
      if (!newMaster.targetLayer) newMaster.targetLayer = {};
      if (!newMaster.targetLayer[selectedLayer]) newMaster.targetLayer[selectedLayer] = {};
      newMaster.targetLayer[selectedLayer][selectedRole] = questions;
    }
    setLocalMaster(newMaster);
  };
  
  // 質問を追加
  const addQuestion = () => {
    const questions = getQuestions();
    const newId = `q_${Date.now()}`;
    const newQuestion = {
      id: newId,
      question: '新しい質問',
      choiceA: '選択肢A（正解）',
      choiceB: '選択肢B（不正解）',
      correctAnswer: 'A',
      scoreType: selectedRole === 'student' ? 'bonus' : 'penalty',  // 学生は加点方式、他は減点方式
      points: 2,
      axisType: selectedRole === 'student' ? 'evaluation' : 'mindset',
      axisKey: selectedRole === 'student' ? 'specificity' : 'marketUnderstanding'
    };
    updateQuestions([...questions, newQuestion]);
  };
  
  // 質問を削除
  const deleteQuestion = (id) => {
    const questions = getQuestions();
    updateQuestions(questions.filter(q => q.id !== id));
  };
  
  // 質問を編集
  const updateQuestion = (id, field, value) => {
    const questions = getQuestions();
    updateQuestions(questions.map(q => q.id === id ? { ...q, [field]: value } : q));
  };
  
  // CSVエクスポート
  const exportCSV = () => {
    // CSVセルをエスケープする関数（改行とダブルクォート対応）
    const escapeCSV = (str) => {
      if (!str) return '';
      // ダブルクォートを二重にし、改行はそのまま保持（ダブルクォートで囲む）
      return '"' + String(str).replace(/"/g, '""') + '"';
    };
    
    // 軸タイプの日本語変換
    const axisTypeToJa = (type) => {
      const map = { mindset: '土台', evaluation: '伝達力' };
      return map[type] || type || '伝達力';
    };
    
    // 軸の日本語変換
    const axisKeyToJa = (key) => {
      const map = {
        // 評価軸6軸
        recognition: '認知到達力', specificity: '具体性', differentiation: '差別化力',
        visionEmpathy: '共感・ビジョン力', selectionUX: '選考UX', dialogue: '対話力',
        // マインドセット5軸
        structure: '採用体制', ownership: '自責', management: '経営関与',
        marketUnderstanding: '市場理解', planning: '計画性',
        // 後方互換性（旧軸名）
        credibility: '信頼性', visionPresentation: '将来像提示力', empathyBuilding: '共感形成力'
      };
      return map[key] || key || '認知到達力';
    };
    
    // 注力タイプの日本語変換
    const depthToJa = (depth) => {
      const map = { surface: '表層部', middle: '中層部', deep: '深層部' };
      return map[depth] || depth || '';
    };
    
    let csv = 'セクション,人数規模,業種,ターゲット層,注力タイプ,採用手法,対象者,ID,質問,学生向け質問,選択肢A,選択肢B,学生向け選択肢A,学生向け選択肢B,正解,点数,軸タイプ,軸,ギャップチェック\n';
    
    // ベース質問
    Object.entries(localMaster.base || {}).forEach(([size, roles]) => {
      Object.entries(roles).forEach(([role, questions]) => {
        questions.forEach(q => {
          csv += `ベース,${size},,,,,${{ staff: '担当者', executive: '上層部', student: '学生' }[role]},${q.id},${escapeCSV(q.question)},${escapeCSV(q.studentQuestion || '')},${escapeCSV(q.choiceA)},${escapeCSV(q.choiceB)},${escapeCSV(q.studentChoiceA || '')},${escapeCSV(q.studentChoiceB || '')},${q.correctAnswer},${q.points || 3},${axisTypeToJa(q.axisType)},${axisKeyToJa(q.axisKey)},${q.gapCheck ? 'TRUE' : 'FALSE'}\n`;
        });
      });
    });
    
    // 業種別質問
    Object.entries(localMaster.industry || {}).forEach(([industry, sizes]) => {
      Object.entries(sizes).forEach(([size, roles]) => {
        Object.entries(roles).forEach(([role, questions]) => {
          questions.forEach(q => {
            csv += `業種別,${size},${industry},,,,${{ staff: '担当者', executive: '上層部', student: '学生' }[role]},${q.id},${escapeCSV(q.question)},${escapeCSV(q.studentQuestion || '')},${escapeCSV(q.choiceA)},${escapeCSV(q.choiceB)},${escapeCSV(q.studentChoiceA || '')},${escapeCSV(q.studentChoiceB || '')},${q.correctAnswer},${q.points || 3},${axisTypeToJa(q.axisType)},${axisKeyToJa(q.axisKey)},${q.gapCheck ? 'TRUE' : 'FALSE'}\n`;
          });
        });
      });
    });
    
    // ターゲット層別質問
    Object.entries(localMaster.targetLayer || {}).forEach(([layer, roles]) => {
      Object.entries(roles).forEach(([role, questions]) => {
        questions.forEach(q => {
          csv += `ターゲット層,,,${layer},,,${{ staff: '担当者', executive: '上層部', student: '学生' }[role]},${q.id},${escapeCSV(q.question)},${escapeCSV(q.studentQuestion || '')},${escapeCSV(q.choiceA)},${escapeCSV(q.choiceB)},${escapeCSV(q.studentChoiceA || '')},${escapeCSV(q.studentChoiceB || '')},${q.correctAnswer},${q.points || 3},${axisTypeToJa(q.axisType)},${axisKeyToJa(q.axisKey)},${q.gapCheck ? 'TRUE' : 'FALSE'}\n`;
        });
      });
    });
    
    // 注力タイプ別質問
    Object.entries(localMaster.depth || {}).forEach(([depthPhase, roles]) => {
      Object.entries(roles).forEach(([role, questions]) => {
        questions.forEach(q => {
          csv += `注力タイプ,,,,${depthToJa(depthPhase)},,${{ staff: '担当者', executive: '上層部', student: '学生' }[role]},${q.id},${escapeCSV(q.question)},${escapeCSV(q.studentQuestion || '')},${escapeCSV(q.choiceA)},${escapeCSV(q.choiceB)},${escapeCSV(q.studentChoiceA || '')},${escapeCSV(q.studentChoiceB || '')},${q.correctAnswer},${q.points || 3},${axisTypeToJa(q.axisType)},${axisKeyToJa(q.axisKey)},${q.gapCheck ? 'TRUE' : 'FALSE'}\n`;
        });
      });
    });
    
    // 採用手法別質問（キーがカテゴリ名 or 旧手法キーの両方に対応）
    Object.entries(localMaster.recruitmentMethod || {}).forEach(([key, roles]) => {
      // 旧手法キーの場合はカテゴリ名に変換、カテゴリ名の場合はそのまま
      const categoryName = (methodMaster || DEFAULT_RECRUITMENT_METHODS)[key]?.category || key;
      Object.entries(roles).forEach(([role, questions]) => {
        questions.forEach(q => {
          csv += `採用手法別,,,,,${categoryName},${{ staff: '担当者', executive: '上層部', student: '学生' }[role]},${q.id},${escapeCSV(q.question)},${escapeCSV(q.studentQuestion || '')},${escapeCSV(q.choiceA)},${escapeCSV(q.choiceB)},${escapeCSV(q.studentChoiceA || '')},${escapeCSV(q.studentChoiceB || '')},${q.correctAnswer},${q.points || 3},${axisTypeToJa(q.axisType)},${axisKeyToJa(q.axisKey)},${q.gapCheck ? 'TRUE' : 'FALSE'}\n`;
        });
      });
    });
    
    const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = '質問マスター.csv';
    a.click();
  };
  
  // CSVインポート
  const importCSV = (e) => {
    const file = e.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = (event) => {
      const text = event.target.result;
      
      // 改行を含むCSVを正しくパースする関数
      const parseCSV = (csvText) => {
        const rows = [];
        let currentRow = [];
        let currentCell = '';
        let inQuotes = false;
        
        for (let i = 0; i < csvText.length; i++) {
          const char = csvText[i];
          const nextChar = csvText[i + 1];
          
          if (inQuotes) {
            if (char === '"' && nextChar === '"') {
              // エスケープされたダブルクォート
              currentCell += '"';
              i++; // 次の"をスキップ
            } else if (char === '"') {
              // クォート終了
              inQuotes = false;
            } else {
              currentCell += char;
            }
          } else {
            if (char === '"') {
              inQuotes = true;
            } else if (char === ',') {
              currentRow.push(currentCell.trim());
              currentCell = '';
            } else if (char === '\n' || (char === '\r' && nextChar === '\n')) {
              currentRow.push(currentCell.trim());
              if (currentRow.length > 1 || currentRow[0] !== '') {
                rows.push(currentRow);
              }
              currentRow = [];
              currentCell = '';
              if (char === '\r') i++; // \r\nの場合は\nもスキップ
            } else if (char !== '\r') {
              currentCell += char;
            }
          }
        }
        
        // 最後のセルと行を追加
        if (currentCell || currentRow.length > 0) {
          currentRow.push(currentCell.trim());
          if (currentRow.length > 1 || currentRow[0] !== '') {
            rows.push(currentRow);
          }
        }
        
        return rows;
      };
      
      const rows = parseCSV(text);
      const newMaster = { base: {}, industry: {}, targetLayer: {}, depth: {}, recruitmentMethod: {} };
      
      // ヘッダーをスキップして処理
      rows.slice(1).forEach(columns => {
        if (columns.length < 14) return;
        
        // 複数フォーマットに対応
        // 新フォーマット（19列）: セクション,人数規模,業種,ターゲット層,注力タイプ,採用手法,対象者,ID,質問,学生向け質問,選択肢A,選択肢B,学生向け選択肢A,学生向け選択肢B,正解,点数,軸タイプ,軸,ギャップチェック
        // 旧フォーマット（21列）: セクション,人数規模,業種,ターゲット層,注力タイプ,採用手法,対象者,ID,質問,学生向け質問,選択肢A,選択肢B,学生向け選択肢A,学生向け選択肢B,正解,スコア方式,点数,軸タイプ,軸キー,ギャップチェック,ヒント
        
        let section, size, industry, layer, depthPhase, methodKey, role, id, question, studentQuestion, choiceA, choiceB, studentChoiceA, studentChoiceB, correct, points, axisType, axisKey, gapCheck;
        
        if (columns.length >= 21) {
          // 旧フォーマット（21列、スコア方式・ヒントあり）
          [section, size, industry, layer, depthPhase, methodKey, role, id, question, studentQuestion, choiceA, choiceB, studentChoiceA, studentChoiceB, correct, , points, axisType, axisKey, gapCheck] = columns;
        } else if (columns.length >= 19) {
          // 新フォーマット（19列）
          [section, size, industry, layer, depthPhase, methodKey, role, id, question, studentQuestion, choiceA, choiceB, studentChoiceA, studentChoiceB, correct, points, axisType, axisKey, gapCheck] = columns;
        } else if (columns.length >= 17) {
          // 旧フォーマット（採用手法なし）
          [section, size, industry, layer, depthPhase, role, id, question, studentQuestion, choiceA, choiceB, studentChoiceA, studentChoiceB, correct, points, axisType, axisKey, gapCheck] = columns;
          methodKey = '';
        } else {
          // 最小フォーマット
          [section, size, industry, layer, depthPhase, role, id, question, choiceA, choiceB, correct, points, axisType, axisKey, gapCheck] = columns;
          methodKey = '';
          studentQuestion = '';
          studentChoiceA = '';
          studentChoiceB = '';
        }
        
        const roleKey = { '担当者': 'staff', '上層部': 'executive', '学生': 'student' }[role];
        if (!roleKey) return;
        
        // 軸タイプの日本語→英語変換
        const axisTypeMap = {
          '土台': 'mindset', 'マインドセット': 'mindset',
          '伝達力': 'evaluation', '評価軸': 'evaluation',
          'mindset': 'mindset', 'evaluation': 'evaluation'
        };
        
        // 軸の日本語→英語変換
        const axisKeyMap = {
          // 評価軸6軸
          '認知到達力': 'recognition', '認知度': 'recognition',
          '具体性': 'specificity', '具体性スコア': 'specificity',
          '差別化力': 'differentiation', '独自性': 'differentiation',
          '共感・ビジョン力': 'visionEmpathy', 'ビジョン共感': 'visionEmpathy', '共感性': 'visionEmpathy',
          '選考UX': 'selectionUX', '選考体験': 'selectionUX',
          '対話力': 'dialogue', '対話姿勢': 'dialogue',
          // マインドセット5軸
          '採用体制': 'structure', '組織体制': 'structure',
          '自責': 'ownership', '当事者意識': 'ownership',
          '経営関与': 'management',
          '市場理解': 'marketUnderstanding',
          '計画性': 'planning',
          // 英語キーはそのまま通す
          'recognition': 'recognition', 'specificity': 'specificity',
          'differentiation': 'differentiation', 'visionEmpathy': 'visionEmpathy',
          'selectionUX': 'selectionUX', 'dialogue': 'dialogue',
          'structure': 'structure', 'ownership': 'ownership', 'management': 'management',
          'marketUnderstanding': 'marketUnderstanding', 'planning': 'planning',
          // 後方互換性（旧軸名→正しい軸名に変換）
          '信頼性': 'differentiation', 'credibility': 'differentiation',
          '将来像提示力': 'visionEmpathy', 'visionPresentation': 'visionEmpathy',
          '共感形成力': 'visionEmpathy', 'empathyBuilding': 'visionEmpathy'
        };
        
        const pointsNum = parseInt(points) || 3;
        const questionObj = {
          id: id || `q_${Date.now()}_${Math.random()}`,
          question,
          studentQuestion: studentQuestion || '',
          choiceA,
          choiceB,
          studentChoiceA: studentChoiceA || '',
          studentChoiceB: studentChoiceB || '',
          correctAnswer: correct,
          points: pointsNum,
          axisType: axisTypeMap[axisType] || axisType || 'evaluation',
          axisKey: axisKeyMap[axisKey] || axisKey || 'recognition',
          gapCheck: gapCheck === 'TRUE' || gapCheck === 'true' || gapCheck === '1'
        };
        
        if (section === 'ベース' && size) {
          if (!newMaster.base[size]) newMaster.base[size] = { staff: [], executive: [], student: [] };
          newMaster.base[size][roleKey].push(questionObj);
        } else if (section === '業種別' && industry && size) {
          if (!newMaster.industry[industry]) newMaster.industry[industry] = {};
          if (!newMaster.industry[industry][size]) newMaster.industry[industry][size] = { staff: [], executive: [], student: [] };
          newMaster.industry[industry][size][roleKey].push(questionObj);
        } else if (section === 'ターゲット層' && layer) {
          if (!newMaster.targetLayer[layer]) newMaster.targetLayer[layer] = { staff: [], executive: [], student: [] };
          newMaster.targetLayer[layer][roleKey].push(questionObj);
        } else if ((section === '注力タイプ' || section === '注力タイプ別') && depthPhase) {
          const depthKey = { '表層部': 'surface', '中層部': 'middle', '深層部': 'deep', 'surface': 'surface', 'middle': 'middle', 'deep': 'deep' }[depthPhase] || depthPhase;
          if (!newMaster.depth[depthKey]) newMaster.depth[depthKey] = { staff: [], executive: [], student: [] };
          newMaster.depth[depthKey][roleKey].push(questionObj);
        } else if ((section === '採用手法別' || section === '採用手法') && methodKey) {
          // methodKeyがカテゴリ名か旧手法キーかを判別し、カテゴリ名に正規化
          const mMaster = methodMaster || DEFAULT_RECRUITMENT_METHODS;
          const catName = mMaster[methodKey]?.category || methodKey; // 旧手法キーならカテゴリ名に変換、それ以外はそのまま
          if (!newMaster.recruitmentMethod[catName]) newMaster.recruitmentMethod[catName] = { staff: [], executive: [], student: [] };
          newMaster.recruitmentMethod[catName][roleKey].push(questionObj);
        }
      });
      
      setLocalMaster(newMaster);
      alert('CSVを読み込みました。\n\n※ 右下の「変更を保存」ボタンを押して保存してください。');
    };
    reader.readAsText(file);
    e.target.value = ''; // ファイル入力をリセット
  };
  
  const questions = getQuestions();
  
  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col">
        {/* ヘッダー */}
        <div className="p-4 border-b border-gray-200 flex justify-between items-center bg-gradient-to-r from-blue-50 to-indigo-50">
          <div>
            <h2 className="text-xl font-bold text-gray-800">質問マスター設定</h2>
            <p className="text-sm text-gray-500">診断項目の質問内容を編集できます</p>
          </div>
          <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg">
            <svg className="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        
        {/* セクション選択 */}
        <div className="p-4 border-b border-gray-200 bg-gray-50">
          <div className="flex gap-2 mb-3">
            {[
              { id: 'base', label: '①ベース質問' },
              { id: 'industry', label: '②業種別追加質問' },
              { id: 'target', label: '③ターゲット属性別質問' },
              { id: 'depth', label: '④注力タイプ別質問' }
            ].map(sec => (
              <button
                key={sec.id}
                onClick={() => setActiveSection(sec.id)}
                className={`px-4 py-2 rounded-lg text-sm font-medium transition ${
                  activeSection === sec.id
                    ? 'bg-blue-600 text-white'
                    : 'bg-white text-gray-600 hover:bg-gray-100 border'
                }`}
              >
                {sec.label}
              </button>
            ))}
          </div>
          
          {/* フィルター */}
          <div className="flex gap-4 flex-wrap">
            {/* 人数規模（ベース・業種別で表示） */}
            {(activeSection === 'base' || activeSection === 'industry') && (
              <div>
                <label className="block text-xs text-gray-500 mb-1">人数規模</label>
                <select
                  value={selectedSize}
                  onChange={(e) => setSelectedSize(e.target.value)}
                  className="px-3 py-2 border rounded-lg text-sm"
                >
                  {sizes.map(s => <option key={s.id} value={s.id}>{s.label}</option>)}
                </select>
              </div>
            )}
            
            {/* 業種（業種別で表示） */}
            {activeSection === 'industry' && (
              <div>
                <label className="block text-xs text-gray-500 mb-1">業種</label>
                <select
                  value={selectedIndustry}
                  onChange={(e) => setSelectedIndustry(e.target.value)}
                  className="px-3 py-2 border rounded-lg text-sm"
                >
                  {industries.map(i => <option key={i} value={i}>{i}</option>)}
                </select>
              </div>
            )}
            
            {/* ターゲット層（ターゲット別で表示） */}
            {activeSection === 'target' && (
              <div>
                <label className="block text-xs text-gray-500 mb-1">ターゲット層</label>
                <select
                  value={selectedLayer}
                  onChange={(e) => setSelectedLayer(e.target.value)}
                  className="px-3 py-2 border rounded-lg text-sm"
                >
                  {layers.map(l => <option key={l} value={l}>{l}層 - {STUDENT_MATRIX[l].name}</option>)}
                </select>
              </div>
            )}
            
            {/* 注力タイプ（注力タイプ別で表示） */}
            {activeSection === 'depth' && (
              <div>
                <label className="block text-xs text-gray-500 mb-1">注力タイプ</label>
                <select
                  value={selectedDepth}
                  onChange={(e) => setSelectedDepth(e.target.value)}
                  className="px-3 py-2 border rounded-lg text-sm"
                >
                  {depthPhases.map(d => <option key={d.id} value={d.id}>{d.label}</option>)}
                </select>
              </div>
            )}
            
            {/* 対象者 */}
            <div>
              <label className="block text-xs text-gray-500 mb-1">対象者</label>
              <select
                value={selectedRole}
                onChange={(e) => setSelectedRole(e.target.value)}
                className="px-3 py-2 border rounded-lg text-sm"
              >
                {roles.map(r => <option key={r.id} value={r.id}>{r.label}</option>)}
              </select>
            </div>
          </div>
        </div>
        
        {/* 質問一覧 */}
        <div className="flex-1 overflow-y-auto p-4">
          <div className="space-y-3">
            {questions.map((q, idx) => (
              <div key={q.id} className="bg-gray-50 rounded-xl p-4 border">
                <div className="flex justify-between items-start mb-3">
                  <span className="text-xs text-gray-400">Q{idx + 1}</span>
                  <button
                    onClick={() => deleteQuestion(q.id)}
                    className="text-red-500 hover:bg-red-50 p-1 rounded"
                  >
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                  </button>
                </div>
                
                {/* 質問文 */}
                <textarea
                  value={q.question}
                  onChange={(e) => updateQuestion(q.id, 'question', e.target.value)}
                  className="w-full px-3 py-2 border rounded-lg text-sm mb-3 resize-none"
                  placeholder="質問文（改行可）"
                  rows={2}
                />
                
                {/* 選択肢 */}
                <div className="grid grid-cols-2 gap-3 mb-3">
                  <div>
                    <label className="block text-xs text-gray-500 mb-1">選択肢A</label>
                    <input
                      type="text"
                      value={q.choiceA}
                      onChange={(e) => updateQuestion(q.id, 'choiceA', e.target.value)}
                      className="w-full px-3 py-2 border rounded-lg text-sm"
                    />
                  </div>
                  <div>
                    <label className="block text-xs text-gray-500 mb-1">選択肢B</label>
                    <input
                      type="text"
                      value={q.choiceB}
                      onChange={(e) => updateQuestion(q.id, 'choiceB', e.target.value)}
                      className="w-full px-3 py-2 border rounded-lg text-sm"
                    />
                  </div>
                </div>
                
                {/* 設定 */}
                <div className="grid grid-cols-3 gap-3">
                  <div>
                    <label className="block text-xs text-gray-500 mb-1">正解</label>
                    <select
                      value={q.correctAnswer}
                      onChange={(e) => updateQuestion(q.id, 'correctAnswer', e.target.value)}
                      className="w-full px-3 py-2 border rounded-lg text-sm"
                    >
                      <option value="A">A</option>
                      <option value="B">B</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-xs text-gray-500 mb-1">点数</label>
                    <input
                      type="number"
                      min="0"
                      max="10"
                      value={q.points || 3}
                      onChange={(e) => {
                        const val = parseInt(e.target.value) || 0;
                        const questions = getQuestions();
                        updateQuestions(questions.map(item => item.id === q.id ? { ...item, points: val } : item));
                      }}
                      className="w-full px-3 py-2 border rounded-lg text-sm"
                    />
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-3 mt-3">
                  <div>
                    <label className="block text-xs text-gray-500 mb-1">軸タイプ</label>
                    <select
                      value={q.axisType}
                      onChange={(e) => updateQuestion(q.id, 'axisType', e.target.value)}
                      className="w-full px-3 py-2 border rounded-lg text-sm"
                    >
                      <option value="mindset">土台（5軸）</option>
                      <option value="evaluation">伝達力（8軸）</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-xs text-gray-500 mb-1">軸</label>
                    <select
                      value={q.axisKey}
                      onChange={(e) => updateQuestion(q.id, 'axisKey', e.target.value)}
                      className="w-full px-3 py-2 border rounded-lg text-sm"
                    >
                      {(q.axisType === 'mindset' || q.axisType?.includes('マインドセット')) ? (
                        Object.entries(MINDSET_AXES).map(([key, axis]) => (
                          <option key={key} value={key}>{axis.name}</option>
                        ))
                      ) : (
                        Object.entries(EVALUATION_AXES).map(([key, axis]) => (
                          <option key={key} value={key}>{axis.name}</option>
                        ))
                      )}
                    </select>
                  </div>
                </div>
                <div className="mt-3 flex items-center gap-2">
                  <label className="flex items-center gap-2 cursor-pointer">
                    <input
                      type="checkbox"
                      checked={q.gapCheck || false}
                      onChange={(e) => updateQuestion(q.id, 'gapCheck', e.target.checked)}
                      className="w-4 h-4 text-blue-600 rounded"
                    />
                    <span className="text-xs text-gray-600">ギャップチェック対象</span>
                  </label>
                  <span className="text-[10px] text-gray-400">（企業側と学生側の認識ギャップを計測）</span>
                </div>
                
                {/* 学生向け質問文（gapCheck=trueの場合のみ表示） */}
                {(q.gapCheck === true || q.gapCheck === 'true') && (
                  <div className="mt-3 p-3 bg-orange-50 border border-orange-200 rounded-lg">
                    <label className="text-xs text-orange-700 font-medium block mb-1.5 flex items-center gap-1">
                      <svg className="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                      </svg>
                      学生向け質問・回答
                      <span className="text-orange-400 font-normal">※任意（空欄なら企業向けをそのまま使用）</span>
                    </label>
                    <textarea
                      value={q.studentQuestion || ''}
                      onChange={(e) => updateQuestion(q.id, 'studentQuestion', e.target.value)}
                      className="w-full text-sm px-3 py-2 border border-orange-200 rounded-lg focus:ring-2 focus:ring-orange-300 focus:border-orange-400 bg-white"
                      rows={2}
                      placeholder="例: この会社の強みを理解していますか？"
                    />
                    
                    {/* 学生向け選択肢 */}
                    <div className="grid grid-cols-2 gap-3 mt-2">
                      <div>
                        <label className="text-[10px] text-orange-600 block mb-0.5">学生向け選択肢A</label>
                        <input
                          type="text"
                          value={q.studentChoiceA || ''}
                          onChange={(e) => updateQuestion(q.id, 'studentChoiceA', e.target.value)}
                          className="w-full text-sm px-2 py-1.5 border border-orange-200 rounded focus:ring-1 focus:ring-orange-400 bg-white"
                          placeholder={`空欄なら「${q.choiceA}」を使用`}
                        />
                      </div>
                      <div>
                        <label className="text-[10px] text-orange-600 block mb-0.5">学生向け選択肢B</label>
                        <input
                          type="text"
                          value={q.studentChoiceB || ''}
                          onChange={(e) => updateQuestion(q.id, 'studentChoiceB', e.target.value)}
                          className="w-full text-sm px-2 py-1.5 border border-orange-200 rounded focus:ring-1 focus:ring-orange-400 bg-white"
                          placeholder={`空欄なら「${q.choiceB}」を使用`}
                        />
                      </div>
                    </div>
                    <p className="text-[10px] text-orange-500 mt-2">
                      💡 企業向け: 「{q.choiceA}」/「{q.choiceB}」 → 学生向けに変更できます
                    </p>
                  </div>
                )}
                
                <div className="mt-3">
                  <label className="text-xs text-gray-500 block mb-1">
                    ヒント（質問の意図・背景） <span className="text-gray-400">※任意</span>
                  </label>
                  <input
                    type="text"
                    value={q.hint || ''}
                    onChange={(e) => updateQuestion(q.id, 'hint', e.target.value)}
                    className="w-full text-xs px-2 py-1.5 border border-gray-200 rounded focus:ring-1 focus:ring-blue-500"
                    placeholder="例: この質問は企業の採用への本気度を測定します"
                  />
                </div>
              </div>
            ))}
            
            {questions.length === 0 && (
              <div className="text-center py-8 text-gray-400">
                質問がありません。「+ 追加」ボタンで質問を追加してください。
              </div>
            )}
          </div>
          
          {/* 追加ボタン */}
          <button
            onClick={addQuestion}
            className="mt-4 w-full py-3 border-2 border-dashed border-gray-300 rounded-xl text-gray-500 hover:border-blue-400 hover:text-blue-500 transition flex items-center justify-center gap-2"
          >
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
            </svg>
            質問を追加
          </button>
        </div>
        
        {/* フッター */}
        <div className="p-4 border-t border-gray-200 bg-gray-50 flex justify-between items-center">
          <div className="flex gap-2">
            <button
              onClick={exportCSV}
              className="px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition"
            >
              CSVエクスポート
            </button>
            <label className="px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition cursor-pointer">
              CSVインポート
              <input type="file" accept=".csv" onChange={importCSV} className="hidden" />
            </label>
          </div>
          <div className="flex gap-2">
            <button
              onClick={onClose}
              className="px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition"
            >
              キャンセル
            </button>
            <button
              onClick={() => { onSave(localMaster); onClose(); }}
              className="px-6 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
            >
              保存
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

// ========================================
// 入力フォーム
// ========================================

const InputForm = ({ data, onChange, onStartDiagnosis, onImportPreInput }) => {
  const [activeTab, setActiveTab] = useState('basic');
  
  // 問診票表示設定
  const [showAxisInfo, setShowAxisInfo] = useState(false);        // 軸情報の表示
  const [showCorrectAnswer, setShowCorrectAnswer] = useState(false); // 正解/不正解の表示
  const [showAnswerSummary, setShowAnswerSummary] = useState(false); // 回答サマリーの表示
  const [showCategoryBadge, setShowCategoryBadge] = useState(false);  // カテゴリバッジの表示（ベース、業種別など）
  const [showGapBadge, setShowGapBadge] = useState(false);            // ギャップバッジの表示
  
  // 【inventory 10-A #4】effectiveData構築（共通関数を使用）
  // DiagnosisSheetでは個別effective変数を内訳表示に使用する
  const {
    effectiveData,
    effectiveMindsetScores,
    effectiveStaffMindsetScores,
    effectiveExecMindsetScores,
    effectiveStaffScores,
    effectiveExecScores,
    effectiveStudentScores,
    effectiveDepthScores
  } = buildEffectiveData(data);
  
  const handleScoreChange = (category, key, value) => {
    const categoryKey = `${category}Scores`;
    onChange({ 
      ...data, 
      [categoryKey]: { 
        ...data[categoryKey], 
        [key]: parseInt(value) 
      } 
    });
  };
  
  const tabs = [
    { id: 'basic', label: '基本情報' },
    { id: 'target', label: 'ターゲット学生' },
    { id: 'method', label: '採用手法' },
    { id: 'staff', label: '採用担当者問診' },
    { id: 'executive', label: '上層部問診' },
    { id: 'student', label: '学生問診' },
    { id: 'funnel', label: 'ファネル数値' },
    { id: 'settings', label: '詳細設定' }
  ];
  
  return (
    <div className="space-y-4">
      {/* タブナビゲーション */}
      <div className="glass-card rounded-xl p-2 flex gap-2 overflow-x-auto items-center">
        {tabs.map(tab => (
          <button
            key={tab.id}
            onClick={() => setActiveTab(tab.id)}
            className={`px-4 py-2.5 rounded-lg text-sm font-medium transition whitespace-nowrap ${
              activeTab === tab.id 
                ? 'bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg' 
                : 'text-gray-600 hover:bg-gray-100'
            }`}
          >
            {tab.label}
          </button>
        ))}
        
        {/* 右端のスペーサー */}
        <div className="flex-grow"></div>
        
        {/* 診断開始ボタン */}
        <button
          onClick={onStartDiagnosis}
          disabled={!data.companyName}
          className="px-4 py-2.5 text-sm bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white rounded-xl font-medium shadow-lg transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap"
        >
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
          </svg>
          診断開始
        </button>
      </div>
      
      {/* 基本情報 */}
      {activeTab === 'basic' && (
        <div className="glass-card rounded-xl p-6 animate-in">
          <h3 className="text-lg font-bold text-gray-800 mb-5">
            基本情報
          </h3>
          <div className="grid grid-cols-2 gap-5">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">企業名 *</label>
              <input
                type="text"
                value={data.companyName || ''}
                onChange={(e) => onChange({ ...data, companyName: e.target.value })}
                className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                placeholder="株式会社○○○"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">担当者名</label>
              <input
                type="text"
                value={data.contactName || ''}
                onChange={(e) => onChange({ ...data, contactName: e.target.value })}
                className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                placeholder="山田太郎"
              />
              <label className="flex items-center gap-2 mt-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={data.isDecisionMaker || false}
                  onChange={(e) => onChange({ ...data, isDecisionMaker: e.target.checked })}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                />
                <span className="text-sm text-gray-600">担当者が決裁者を兼ねる</span>
                <span className="text-xs text-gray-400">（上層部問診の基礎力質問を省略）</span>
              </label>
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">業種</label>
              <select
                value={data.industry || ''}
                onChange={(e) => onChange({ ...data, industry: e.target.value })}
                className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
              >
                <option value="">選択してください</option>
                {INDUSTRY_LIST.map(item => (
                  <option key={item.key} value={item.label}>{item.label}</option>
                ))}
              </select>
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">従業員規模</label>
              <select
                value={data.companySize || ''}
                onChange={(e) => onChange({ ...data, companySize: e.target.value })}
                className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
              >
                <option value="">選択してください</option>
                <option value="50名未満">50名未満</option>
                <option value="50〜100名">50〜100名</option>
                <option value="100〜300名">100〜300名</option>
                <option value="300〜500名">300〜500名</option>
                <option value="500〜1000名">500〜1000名</option>
                <option value="1000名以上">1000名以上</option>
              </select>
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">診断日</label>
              <input
                type="date"
                value={(data.diagnosisDate || '').split(/[\sT]/)[0] || new Date().toISOString().split('T')[0]}
                onChange={(e) => onChange({ ...data, diagnosisDate: e.target.value })}
                className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">問い合わせ番号</label>
              <div className="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl font-mono text-lg tracking-wider text-gray-700">
                {data.inquiryNo || '-------------'}
              </div>
            </div>
          </div>
          
          {/* 事前問診パネル */}
          {data.inquiryNo && (
            <div className="mt-6 pt-6 border-t border-gray-200">
              <h4 className="text-md font-bold text-gray-800 mb-4 flex items-center gap-2">
                <svg className="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                事前問診（顧客用）
                {data._preInputStatus && (
                  <span className={`text-xs px-2 py-0.5 rounded-full font-normal ${
                    data._preInputStatus === '完了' 
                      ? 'bg-green-100 text-green-700' 
                      : 'bg-amber-100 text-amber-700'
                  }`}>
                    {data._preInputStatus === '完了' ? '回答済み' : '入力中'}
                  </span>
                )}
              </h4>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                {/* URL発行・コピー */}
                <div className="p-4 bg-indigo-50 border border-indigo-200 rounded-xl">
                  <p className="text-xs text-indigo-700 mb-3">
                    顧客に送付する事前問診フォームのURLを生成します。
                  </p>
                  <button
                    onClick={() => {
                      const url = 'https://gakusapo-andm.github.io/bb-shindan/customer/?id=' + encodeURIComponent(data.inquiryNo);
                      navigator.clipboard.writeText(url).then(() => {
                        alert('URLをコピーしました。\n\n' + url);
                      }).catch(() => {
                        prompt('以下のURLをコピーしてください:', url);
                      });
                    }}
                    className="w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-medium text-sm transition flex items-center justify-center gap-2 shadow"
                  >
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
                    </svg>
                    URL発行・コピー
                  </button>
                </div>
                
                {/* 事前データ取込 */}
                <div className="p-4 bg-green-50 border border-green-200 rounded-xl">
                  <p className="text-xs text-green-700 mb-3">
                    顧客が入力した事前問診データを取り込みます。
                  </p>
                  <button
                    onClick={() => onImportPreInput && onImportPreInput(data.inquiryNo)}
                    className="w-full px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl font-medium text-sm transition flex items-center justify-center gap-2 shadow"
                  >
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                    </svg>
                    事前データ取込
                  </button>
                </div>
              </div>
            </div>
          )}
          
          {/* 今日解決したいこと・過去に挑戦してきたこと */}
          <div className="mt-6 pt-6 border-t border-gray-200">
            <h4 className="text-md font-bold text-gray-800 mb-4 flex items-center gap-2">
              <svg className="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
              採用課題の整理
            </h4>
            
            <div className="space-y-5">
              {/* 今日解決したいこと */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2">
                  <span className="w-6 h-6 bg-red-100 rounded-full flex items-center justify-center">
                    <span className="text-red-600 text-xs font-bold">!</span>
                  </span>
                  今日解決したいこと
                </label>
                <p className="text-xs text-gray-500 mb-2">今回の診断で最も解決したい課題や相談事項を記入してください</p>
                <textarea
                  value={data.todayChallenge || ''}
                  onChange={(e) => onChange({ ...data, todayChallenge: e.target.value })}
                  placeholder="例：&#10;・応募は来るが、ターゲット層（理系上位層）からの応募が少ない&#10;・内定を出しても辞退されることが多く、承諾率が低い&#10;・新たに考えている採用媒体や施策：○○（理由：△△）"
                  rows={4}
                  className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none"
                />
              </div>
              
              {/* 過去に挑戦してきたこと */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2">
                  <span className="w-6 h-6 bg-purple-100 rounded-full flex items-center justify-center">
                    <svg className="w-3.5 h-3.5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                  </span>
                  過去に挑戦してきたこと
                </label>
                <p className="text-xs text-gray-500 mb-2">過去の採用活動で経験した課題や失敗、うまくいったことを記入してください</p>
                <textarea
                  value={data.pastChallenges || ''}
                  onChange={(e) => onChange({ ...data, pastChallenges: e.target.value })}
                  placeholder="例：&#10;・昨年は内定辞退が3名発生し、目標未達となった&#10;・説明会の集客が伸び悩み、母集団が不足していた&#10;・マイナビからの応募は多いが、ターゲット層とのミスマッチが多かった"
                  rows={4}
                  className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none"
                />
              </div>
            </div>
          </div>
        </div>
      )}
      
      {/* ターゲット学生属性 */}
      {activeTab === 'target' && (
        <div className="glass-card rounded-xl p-6 animate-in">
          <div className="flex items-start justify-between mb-4">
            <div>
              <h3 className="text-lg font-bold text-gray-800">
                ターゲット学生属性（マトリクスA〜H層）
              </h3>
              <p className="text-sm text-gray-500 mt-1">
                採用ターゲットとする学生層を選択し、それぞれの比率を入力してください（合計100%）
              </p>
            </div>
            <div className="flex items-center gap-2 bg-green-50 border border-green-200 rounded-xl px-4 py-3">
              <label className="text-sm font-bold text-green-800 whitespace-nowrap">目標人数:</label>
              <input
                type="number"
                min="0"
                value={(() => {
                  const selectedYear = data.funnelData?.selectedYear || '27卒';
                  return data.funnelData?.yearData?.[selectedYear]?.targetHires || '';
                })()}
                onChange={(e) => {
                  const selectedYear = data.funnelData?.selectedYear || '27卒';
                  onChange({
                    ...data,
                    funnelData: {
                      ...data.funnelData,
                      yearData: {
                        ...data.funnelData?.yearData,
                        [selectedYear]: {
                          ...data.funnelData?.yearData?.[selectedYear],
                          targetHires: e.target.value ? parseInt(e.target.value) : 0
                        }
                      }
                    }
                  });
                }}
                placeholder="例: 5"
                className="w-20 px-3 py-2 text-center text-lg font-bold border border-green-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
              />
              <span className="text-sm text-green-700 font-medium">人</span>
            </div>
          </div>
          
          <div className="space-y-3">
            {Object.entries(STUDENT_MATRIX).map(([key, layer]) => (
              <div key={key} className="flex items-center gap-4 p-3 bg-gray-50 rounded-xl hover:bg-gray-100 transition">
                <label className="flex items-center gap-3 cursor-pointer flex-1">
                  <input
                    type="checkbox"
                    checked={data.targetLayers?.[key]?.enabled || false}
                    onChange={(e) => onChange({
                      ...data,
                      targetLayers: {
                        ...data.targetLayers,
                        [key]: { ...data.targetLayers?.[key], enabled: e.target.checked }
                      }
                    })}
                    className="w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"
                  />
                  <div 
                    className="w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold text-lg"
                    style={{ backgroundColor: layer.color }}
                  >
                    {key}
                  </div>
                  <div className="flex-1">
                    <div className="font-bold text-gray-800">{layer.name}</div>
                    <div className="text-xs text-gray-500">{layer.description}</div>
                  </div>
                </label>
                <div className="flex items-center gap-2">
                  <input
                    type="number"
                    min="0"
                    max="100"
                    value={data.targetLayers?.[key]?.ratio ?? ''}
                    placeholder="0"
                    disabled={!data.targetLayers?.[key]?.enabled}
                    onChange={(e) => onChange({
                      ...data,
                      targetLayers: {
                        ...data.targetLayers,
                        [key]: { ...data.targetLayers?.[key], ratio: e.target.value === '' ? '' : (parseInt(e.target.value) || 0) }
                      }
                    })}
                    className="w-20 px-3 py-2 border border-gray-200 rounded-lg text-center text-lg font-bold disabled:bg-gray-100 disabled:text-gray-400"
                  />
                  <span className="text-gray-500 font-medium">%</span>
                </div>
              </div>
            ))}
          </div>
          
          {/* 合計表示 */}
          <div className="mt-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200">
            <div className="flex justify-between items-center">
              <span className="font-bold text-gray-700">合計比率</span>
              <span className={`text-2xl font-black ${
                Object.values(data.targetLayers || {}).reduce((sum, l) => sum + (l.enabled ? (l.ratio || 0) : 0), 0) === 100
                  ? 'text-green-600' 
                  : 'text-red-500'
              }`}>
                {Object.values(data.targetLayers || {}).reduce((sum, l) => sum + (l.enabled ? (l.ratio || 0) : 0), 0)}%
              </span>
            </div>
            {Object.values(data.targetLayers || {}).reduce((sum, l) => sum + (l.enabled ? (l.ratio || 0) : 0), 0) !== 100 && (
              <div className="text-xs text-red-500 mt-1">※ 合計が100%になるように調整してください</div>
            )}
          </div>
          
          {/* 特性一覧 */}
          <div className="mt-6 border-t border-gray-200 pt-4">
            <h4 className="text-sm font-bold text-gray-700 mb-3">選択した層の特性</h4>
            <div className="space-y-2 text-xs">
              {Object.entries(STUDENT_MATRIX)
                .filter(([key]) => data.targetLayers?.[key]?.enabled)
                .map(([key, layer]) => (
                  <div key={key} className="flex gap-2 items-start p-2 bg-gray-50 rounded">
                    <span className="font-bold text-white px-2 py-0.5 rounded" style={{ backgroundColor: layer.color }}>{key}層</span>
                    <span className="text-gray-600">{layer.characteristics}</span>
                  </div>
                ))}
            </div>
          </div>
          
          {/* 改善目標 */}
          <div className="mt-6 border-t border-gray-200 pt-4">
            <div className="flex items-center gap-2 mb-3">
              <div className="w-6 h-6 bg-green-100 rounded-full flex items-center justify-center">
                <svg className="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <div>
                <h4 className="text-sm font-bold text-gray-700">改善目標（現状実績との比較）</h4>
                <p className="text-xs text-gray-500">ターゲット学生層ごとの現状実績を入力してください</p>
              </div>
            </div>
            
            {/* ターゲット学生が選択されていない場合 */}
            {Object.entries(data.targetLayers || {}).filter(([_, l]) => l.enabled).length === 0 ? (
              <div className="p-4 bg-gray-50 border border-gray-200 rounded-xl text-center">
                <p className="text-sm text-gray-500">ターゲット学生を選択すると、改善目標を設定できます</p>
              </div>
            ) : (
              <div className="space-y-2">
                {/* 目標人数の表示 */}
                {(() => {
                  const selectedYear = data.funnelData?.selectedYear || '27卒';
                  const targetHires = data.funnelData?.yearData?.[selectedYear]?.targetHires || 0;
                  return targetHires > 0 ? (
                    <div className="p-2 bg-green-50 border border-green-200 rounded-lg mb-2">
                      <span className="text-xs text-green-700">
                        目標採用人数: <strong className="text-sm">{targetHires}名</strong>
                      </span>
                    </div>
                  ) : (
                    <div className="p-2 bg-amber-50 border border-amber-200 rounded-lg mb-2">
                      <span className="text-xs text-amber-700">
                        ※ 目標人数が未設定です（上部で設定してください）
                      </span>
                    </div>
                  );
                })()}
                
                {/* ヘッダー */}
                <div className="grid grid-cols-12 gap-2 px-2 py-1.5 bg-gray-100 rounded text-xs font-bold text-gray-600">
                  <div className="col-span-4">学生層</div>
                  <div className="col-span-2 text-center">目標</div>
                  <div className="col-span-3 text-center">現状</div>
                  <div className="col-span-3 text-center">ギャップ</div>
                </div>
                
                {/* 選択された層の一覧 */}
                {Object.entries(STUDENT_MATRIX)
                  .filter(([key]) => data.targetLayers?.[key]?.enabled)
                  .map(([key, layer]) => {
                    const selectedYear = data.funnelData?.selectedYear || '27卒';
                    const totalTargetHires = data.funnelData?.yearData?.[selectedYear]?.targetHires || 0;
                    const targetRatio = data.targetLayers?.[key]?.ratio || 0;
                    const targetCount = Math.round(totalTargetHires * targetRatio / 100);
                    const currentCount = data.improvementGoals?.[key]?.currentCount || 0;
                    const gap = targetCount - currentCount;
                    
                    return (
                      <div key={key} className="grid grid-cols-12 gap-2 items-center p-2 bg-gray-50 rounded hover:bg-gray-100 transition">
                        {/* 学生層 */}
                        <div className="col-span-4 flex items-center gap-1.5">
                          <div 
                            className="w-6 h-6 rounded flex items-center justify-center text-white font-bold text-xs"
                            style={{ backgroundColor: layer.color }}
                          >
                            {key}
                          </div>
                          <div className="flex-1 min-w-0">
                            <div className="font-medium text-gray-800 text-xs truncate">{layer.name}</div>
                            <div className="text-xs text-gray-400">{targetRatio}%</div>
                          </div>
                        </div>
                        
                        {/* 目標人数 */}
                        <div className="col-span-2 text-center">
                          <span className="text-xs font-bold text-blue-700">{targetCount}名</span>
                        </div>
                        
                        {/* 現状実績 */}
                        <div className="col-span-3 flex justify-center">
                          <div className="flex items-center gap-0.5">
                            <input
                              type="number"
                              min="0"
                              value={currentCount || ''}
                              placeholder="0"
                              onChange={(e) => onChange({
                                ...data,
                                improvementGoals: {
                                  ...data.improvementGoals,
                                  [key]: {
                                    ...data.improvementGoals?.[key],
                                    currentCount: e.target.value === '' ? 0 : (parseInt(e.target.value) || 0)
                                  }
                                }
                              })}
                              className="w-12 px-1 py-1 border border-gray-200 rounded text-center text-xs font-bold focus:ring-1 focus:ring-green-500 focus:border-green-500"
                            />
                            <span className="text-gray-500 text-xs">名</span>
                          </div>
                        </div>
                        
                        {/* ギャップ */}
                        <div className="col-span-3 text-center">
                          <span className={`text-xs font-bold ${
                            gap > 0 ? 'text-red-600' :
                            gap < 0 ? 'text-green-600' :
                            'text-gray-500'
                          }`}>
                            {gap > 0 ? `${gap}名不足` : gap < 0 ? `${Math.abs(gap)}名超` : '達成'}
                          </span>
                        </div>
                      </div>
                    );
                  })}
                
                {/* 合計行 */}
                <div className="grid grid-cols-12 gap-2 items-center p-2 bg-blue-50 rounded border border-blue-200">
                  <div className="col-span-4 font-bold text-gray-700 text-xs">合計</div>
                  <div className="col-span-2 text-center">
                    <span className="font-bold text-blue-700 text-xs">
                      {(() => {
                        const selectedYear = data.funnelData?.selectedYear || '27卒';
                        return data.funnelData?.yearData?.[selectedYear]?.targetHires || 0;
                      })()}名
                    </span>
                  </div>
                  <div className="col-span-3 text-center">
                    <span className="font-bold text-gray-600 text-xs">
                      {Object.entries(data.targetLayers || {})
                        .filter(([key, l]) => l.enabled)
                        .reduce((sum, [key]) => sum + (data.improvementGoals?.[key]?.currentCount || 0), 0)}名
                    </span>
                  </div>
                  <div className="col-span-3"></div>
                </div>
              </div>
            )}
          </div>
          
          {/* 特記事項メモ */}
          <div className="mt-6 border-t border-gray-200 pt-4">
            <div className="flex items-center gap-2 mb-3">
              <div className="w-6 h-6 bg-amber-100 rounded-full flex items-center justify-center">
                <svg className="w-4 h-4 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
              </div>
              <div>
                <h4 className="text-sm font-bold text-gray-700">特記事項</h4>
                <p className="text-xs text-gray-500">ターゲット学生に関するメモや補足情報</p>
              </div>
            </div>
            <textarea
              value={data.targetNotes || ''}
              onChange={(e) => onChange({ ...data, targetNotes: e.target.value })}
              placeholder="例：&#10;・A層（上位国立理系）は昨年0名だったため、研究室訪問を強化する&#10;・C層は応募数は多いが内定辞退率が高い（昨年3名中2名辞退）&#10;・来期からE層（体育会系）もターゲットに追加検討中"
              rows={4}
              className="w-full px-3 py-2 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500 resize-none placeholder-gray-400"
            />
          </div>
        </div>
      )}
      
      {/* 採用手法 */}
      {activeTab === 'method' && (
        <div className="glass-card rounded-xl p-6 animate-in">
          <h3 className="text-lg font-bold text-gray-800 mb-2">
            採用手法・ツール投資配分
          </h3>
          <p className="text-sm text-gray-500 mb-5">
            各採用手法にかけている予算と人工（工数）の比率を入力してください
          </p>
          
          {(() => {
            // マスターデータを取得（カスタムまたはデフォルト、空オブジェクトもフォールバック対象）
            const RECRUITMENT_METHODS = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
            
            // カテゴリ一覧を動的に取得
            const categories = [...new Set(Object.values(RECRUITMENT_METHODS).map(m => m.category))].sort();
            
            return (
              <>
                {/* カテゴリごとにグループ化 */}
                {categories.map(category => {
                  const methods = Object.entries(RECRUITMENT_METHODS).filter(([_, m]) => m.category === category);
                  if (methods.length === 0) return null;
            
            return (
              <div key={category} className="mb-6">
                <h4 className="text-sm font-bold text-gray-700 mb-3 flex items-center gap-2">
                  <span className="w-1.5 h-1.5 bg-blue-500 rounded-full"></span>
                  {category}
                </h4>
                <div className="space-y-2">
                  {methods.map(([key, method]) => (
                    <div key={key} className="bg-gray-50 rounded-xl overflow-hidden">
                      <div className="grid grid-cols-12 gap-3 items-center p-3">
                        {/* チェックボックス（左側） */}
                        <div className="col-span-1 flex justify-center">
                          <input
                            type="checkbox"
                            checked={data.recruitmentMethods?.[key]?.active || false}
                            onChange={(e) => onChange({
                              ...data,
                              recruitmentMethods: {
                                ...data.recruitmentMethods,
                                [key]: { ...data.recruitmentMethods?.[key], active: e.target.checked }
                              }
                            })}
                            className="w-5 h-5 rounded border-gray-300 text-blue-600 cursor-pointer"
                            title="利用中"
                          />
                        </div>
                        {/* ツール名・説明 */}
                        <div className="col-span-5">
                          <div className="font-medium text-gray-800 text-sm">{method.name}</div>
                          <div className="text-[10px] text-gray-500">{method.description}</div>
                        </div>
                        {/* 投資予算額 */}
                        <div className="col-span-3">
                          <label className="block text-[10px] text-gray-500 mb-1">投資予算額</label>
                          <div className="flex items-center gap-1">
                            <input
                              type="number"
                              min="0"
                              value={data.recruitmentMethods?.[key]?.budget ?? ''}
                              placeholder="0"
                              onChange={(e) => onChange({
                                ...data,
                                recruitmentMethods: {
                                  ...data.recruitmentMethods,
                                  [key]: { ...data.recruitmentMethods?.[key], budget: e.target.value === '' ? '' : (parseInt(e.target.value) || 0) }
                                }
                              })}
                              className="w-16 px-2 py-1.5 border border-gray-200 rounded text-center text-sm"
                            />
                            <span className="text-xs text-gray-400">万円</span>
                          </div>
                        </div>
                        {/* 注力順位 */}
                        <div className="col-span-3">
                          <label className="block text-[10px] text-gray-500 mb-1">注力順位</label>
                          <div className="flex items-center gap-1">
                            <input
                              type="number"
                              min="1"
                              max="99"
                              value={data.recruitmentMethods?.[key]?.priority ?? ''}
                              placeholder="-"
                              onChange={(e) => onChange({
                                ...data,
                                recruitmentMethods: {
                                  ...data.recruitmentMethods,
                                  [key]: { ...data.recruitmentMethods?.[key], priority: e.target.value === '' ? '' : (parseInt(e.target.value) || 0) }
                                }
                              })}
                              className="w-16 px-2 py-1.5 border border-gray-200 rounded text-center text-sm"
                            />
                            <span className="text-xs text-gray-400">位</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            );
          })}
          
          {/* 合計表示 */}
          <div className="mt-4 p-4 bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl border border-amber-200">
            <div>
              <div className="text-sm font-bold text-gray-700 mb-1">投資予算額 合計</div>
              <span className="text-xl font-black text-amber-600">
                {Object.values(data.recruitmentMethods || {}).filter(m => m.active).reduce((sum, m) => sum + (parseInt(m.budget) || 0), 0).toLocaleString()}万円
              </span>
            </div>
            <div className="text-xs text-gray-500 mt-2">※ 各手法に投資している概算予算額と、力を入れている順番を入力してください</div>
          </div>
              </>
            );
          })()}
          
        </div>
      )}
      
      {/* 診断質問（担当者/上層部/学生で共通フォーム） */}
      {['staff', 'executive', 'student'].includes(activeTab) && (
        <div className="glass-card rounded-xl p-6 animate-in">
          <h3 className="text-lg font-bold text-gray-800 mb-2">
            {{ staff: '採用担当者', executive: '上層部', student: '学生' }[activeTab]}への診断質問
          </h3>
          <p className="text-sm text-gray-500 mb-4">
            {activeTab === 'student' 
              ? 'ギャップチェック対象の質問について、学生視点での回答を入力してください。企業側との認識差がギャップ係数に反映されます。'
              : '各質問に回答してください。回答内容から自動的にスコアが算出されます。'
            }
          </p>
          
          {/* 決裁者モードの通知（上層部問診時のみ） */}
          {activeTab === 'executive' && data.isDecisionMaker && (
            <div className="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
              <div className="flex items-center gap-2 text-sm text-blue-700">
                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span className="font-medium">決裁者モード</span>
              </div>
              <p className="text-xs text-blue-600 mt-1">
                担当者が決裁者を兼ねているため、採用基礎力に関する質問は省略されています。担当者問診の回答が適用されます。
              </p>
            </div>
          )}
          
          {/* 表示設定トグル（折りたたみ） */}
          <details className="mb-6">
            <summary className="cursor-pointer text-xs text-gray-500 hover:text-gray-700 flex items-center gap-1">
              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              表示設定
            </summary>
            <div className="flex flex-wrap gap-4 mt-2 p-3 bg-gray-50 rounded-lg border border-gray-200">
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={showAxisInfo}
                  onChange={(e) => setShowAxisInfo(e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                />
                <span className="text-xs text-gray-600">軸情報を表示</span>
              </label>
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={showCorrectAnswer}
                  onChange={(e) => setShowCorrectAnswer(e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                />
                <span className="text-xs text-gray-600">正解/不正解を表示</span>
              </label>
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={showAnswerSummary}
                  onChange={(e) => setShowAnswerSummary(e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                />
                <span className="text-xs text-gray-600">回答サマリーを表示</span>
              </label>
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={showCategoryBadge}
                  onChange={(e) => setShowCategoryBadge(e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                />
                <span className="text-xs text-gray-600">カテゴリバッジを表示</span>
              </label>
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={showGapBadge}
                  onChange={(e) => setShowGapBadge(e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-blue-500"
                />
                <span className="text-xs text-gray-600">ギャップバッジを表示</span>
              </label>
              <button
                onClick={() => {
                  if (confirm('質問マスターをデフォルトに戻しますか？\n質問が重複・欠落している場合はこれで修正できます。')) {
                    localStorage.removeItem('gakusapo_question_master');
                    alert('質問マスターをリセットしました。ページを再読み込みしてください。');
                    window.location.reload();
                  }
                }}
                className="px-2 py-1 text-xs text-red-600 hover:bg-red-50 rounded border border-red-200"
              >
                質問マスターをリセット
              </button>
            </div>
          </details>
          
          {/* 質問を取得・表示 */}
          {(() => {
            const sizeCategory = getCompanySizeCategory(data.companySize);
            const master = getEffectiveQuestionMaster(data);
            const roleKey = activeTab;
            
            // 学生問診の場合は、担当者・上層部の質問からギャップチェック対象を取得
            const sourceRoles = roleKey === 'student' ? ['staff', 'executive'] : [roleKey];
            
            // ベース質問を取得
            const baseQuestions = sourceRoles.flatMap(role => 
              (master.base?.[sizeCategory]?.[role] || []).map(q => ({ ...q, sourceRole: role }))
            );
            
            // 業種別質問を取得
            const industryQuestions = sourceRoles.flatMap(role =>
              (master.industry?.[data.industry]?.[sizeCategory]?.[role] || []).map(q => ({ ...q, sourceRole: role }))
            );
            
            // ターゲット層別質問を取得
            const targetLayers = Object.keys(data.targetLayers || {}).filter(k => data.targetLayers[k]?.enabled);
            const targetQuestions = targetLayers.flatMap(layer => 
              sourceRoles.flatMap(role =>
                (master.targetLayer?.[layer]?.[role] || []).map(q => ({ ...q, layer, sourceRole: role }))
              )
            );
            
            // 注力タイプ質問を取得（表層部・中層部・深層部）
            const depthQuestions = sourceRoles.flatMap(role => [
              ...(master.depth?.surface?.[role] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'surface', sourceRole: role })),
              ...(master.depth?.middle?.[role] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'middle', sourceRole: role })),
              ...(master.depth?.deep?.[role] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'deep', sourceRole: role }))
            ]);
            
            // 採用手法別質問を取得（activeな手法のカテゴリ単位でユニーク化）
            const methodMasterRef = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
            const activeCategories = getActiveMethodCategories(data);
            if (DEBUG_MODE) {
              debugLog('=== 採用手法別質問デバッグ ===');
              debugLog('1. activeなカテゴリ:', activeCategories);
              debugLog('2. 質問マスター.recruitmentMethod:', master.recruitmentMethod);
              debugLog('3. 質問マスター.recruitmentMethodのキー:', Object.keys(master.recruitmentMethod || {}));
              debugLog('4. 現在の対象者(roleKey):', roleKey);
            }
            
            const recruitmentMethodQuestions = activeCategories.flatMap(cat => {
              return sourceRoles.flatMap(role => {
                const questions = getMethodQuestionsByCategory(master, cat, methodMasterRef, role);
                if (DEBUG_MODE) {
                  debugLog(`5. カテゴリ「${cat}」の${role}向け質問:`, questions);
                }
                return questions.map(q => ({ ...q, category: 'recruitmentMethod', methodCategory: cat, sourceRole: role }));
              });
            });
            if (DEBUG_MODE) {
              debugLog('6. 取得した採用手法別質問の合計:', recruitmentMethodQuestions.length);
              debugLog('=== デバッグ終了 ===');
            }
            
            // 全質問を結合
            const rawQuestions = [
              ...baseQuestions.map(q => ({ ...q, category: q.category || 'base' })),
              ...industryQuestions.map(q => ({ ...q, category: 'industry' })),
              ...targetQuestions.map(q => ({ ...q, category: 'target' })),
              ...depthQuestions,
              ...recruitmentMethodQuestions
            ];
            
            // 重複を除去（質問IDでユニーク化）
            const seenIds = new Set();
            let allQuestions = rawQuestions.filter(q => {
              if (seenIds.has(q.id)) {
                console.warn('重複した質問を除去:', q.id);
                return false;
              }
              seenIds.add(q.id);
              return true;
            });
            
            // 決裁者フラグがONの場合、上層部問診から基礎力（マインドセット軸）の質問を除外
            if (roleKey === 'executive' && data.isDecisionMaker) {
              const beforeCount = allQuestions.length;
              allQuestions = allQuestions.filter(q => {
                // マインドセット軸の質問を除外（担当者問診で回答済みのため）
                const isMindset = q.axisType === 'mindset' || q.axisType?.includes('マインドセット');
                if (DEBUG_MODE && isMindset) {
                  debugLog('決裁者モード: 基礎力質問を除外:', q.id);
                }
                return !isMindset;
              });
              if (DEBUG_MODE) {
                debugLog(`決裁者モード: 基礎力質問を${beforeCount - allQuestions.length}件除外`);
              }
            }
            
            // 学生問診の場合、ギャップチェック対象の質問のみを表示
            if (roleKey === 'student') {
              const beforeCount = allQuestions.length;
              allQuestions = allQuestions.filter(q => q.gapCheck === true || q.gapCheck === 'true');
              if (DEBUG_MODE) {
                debugLog(`学生問診: ギャップチェック対象質問のみに絞り込み（${beforeCount}件→${allQuestions.length}件）`);
              }
            }
            
            if (allQuestions.length === 0) {
              return (
                <div className="text-center py-8 text-gray-400">
                  {roleKey === 'student' ? (
                    <>
                      <p>ギャップチェック対象の質問がありません。</p>
                      <p className="text-sm mt-2">質問項目設定でギャップチェックを有効にしてください。</p>
                    </>
                  ) : (
                    <>
                      <p>質問がありません。</p>
                      <p className="text-sm mt-2">ヘッダーの設定アイコン→「質問項目設定」から質問を設定してください。</p>
                    </>
                  )}
                </div>
              );
            }
            
            // 質問IDをコンソールに出力（デバッグ用）
            if (DEBUG_MODE && allQuestions.length > 0) {
              debugLog('=== 問診画面 質問IDデバッグ ===');
              debugLog('activeTab:', activeTab);
              debugLog('answersKey:', `${activeTab}Answers`);
              debugLog('質問ID一覧:', allQuestions.map(q => q.id));
              debugLog('現在の回答:', data[`${activeTab}Answers`]);
              
              // axisTypeの分布を確認
              const axisTypeDist = allQuestions.reduce((acc, q) => {
                acc[q.axisType || 'undefined'] = (acc[q.axisType || 'undefined'] || 0) + 1;
                return acc;
              }, {});
              debugLog('axisTypeの分布:', axisTypeDist);
              
              // axisKeyの分布を確認
              const axisKeyDist = allQuestions.reduce((acc, q) => {
                acc[q.axisKey || 'undefined'] = (acc[q.axisKey || 'undefined'] || 0) + 1;
                return acc;
              }, {});
              debugLog('axisKeyの分布:', axisKeyDist);
              
              // 最初の5件の詳細
              debugLog('最初の5件の質問詳細:', allQuestions.slice(0, 5).map(q => ({
                id: q.id,
                axisType: q.axisType,
                axisKey: q.axisKey,
                scoreType: q.scoreType,
                points: q.points
              })));
              debugLog('=== デバッグ終了 ===');
            }
            
            return (
              <div className="space-y-4">
                {allQuestions.map((q, idx) => {
                  const answersKey = `${activeTab}Answers`;
                  const currentAnswer = data[answersKey]?.[q.id];
                  const isCorrect = currentAnswer === q.correctAnswer;
                  const isWrong = currentAnswer && !isCorrect;
                  
                  return (
                    <div key={q.id} className={`p-4 rounded-xl border-2 transition ${
                      showCorrectAnswer
                        ? (isWrong ? 'border-red-300 bg-red-50' : 
                           isCorrect ? 'border-green-300 bg-green-50' : 
                           'border-gray-200 bg-gray-50')
                        : (currentAnswer ? 'border-blue-300 bg-blue-50' : 'border-gray-200 bg-gray-50')
                    }`}>
                      <div className="flex justify-between items-start mb-3">
                        <div className="flex items-center gap-2">
                          <span className="text-xs font-bold text-white px-2 py-0.5 rounded bg-gray-400">
                            Q{idx + 1}
                          </span>
                          {showCategoryBadge && (
                            <span className={`text-[10px] px-2 py-0.5 rounded ${
                              q.category === 'base' ? 'bg-blue-100 text-blue-600' :
                              q.category === 'industry' ? 'bg-purple-100 text-purple-600' :
                              q.category === 'depth' ? 'bg-green-100 text-green-600' :
                              q.category === 'recruitmentMethod' ? 'bg-teal-100 text-teal-600' :
                              'bg-amber-100 text-amber-600'
                            }`}>
                              {q.category === 'base' ? 'ベース' : 
                               q.category === 'industry' ? '業種別' : 
                               q.category === 'depth' ? (
                                 q.depthPhase === 'surface' ? '表層部' :
                                 q.depthPhase === 'middle' ? '中層部' : '深層部'
                               ) :
                               q.category === 'recruitmentMethod' ? (
                                 q.methodCategory || '採用手法'
                               ) :
                               `${q.layer}層`}
                            </span>
                          )}
                          {showAxisInfo && (
                            <span className="text-[10px] text-gray-400">
                              {(q.axisType === 'mindset' || q.axisType?.includes('マインドセット')) ? '基礎力' : 
                               (q.axisType === 'depth' || q.axisType?.includes('注力タイプ')) ? '注力タイプ' : '伝達力'}: {
                                (q.axisType === 'mindset' || q.axisType?.includes('マインドセット'))
                                  ? (MINDSET_AXES[q.axisKey]?.name || q.axisKey)
                                  : (q.axisType === 'depth' || q.axisType?.includes('注力タイプ'))
                                  ? (DEPTH_PHASES[q.depthKey]?.name || q.depthKey)
                                  : (EVALUATION_AXES[q.axisKey]?.name || q.axisKey)
                              }
                            </span>
                          )}
                          {showGapBadge && (q.gapCheck === true || q.gapCheck === 'true') && (
                            <span className="text-[10px] px-1.5 py-0.5 rounded bg-orange-100 text-orange-600">
                              ギャップ
                            </span>
                          )}
                        </div>
                        {showCorrectAnswer && isWrong && (
                          <span className="text-xs text-red-500 font-bold">-{q.points || q.penaltyPoints || 2}点</span>
                        )}
                      </div>
                      
                      <div className="text-sm font-medium text-gray-800 mb-3 flex items-start gap-1" style={{ whiteSpace: 'pre-line' }}>
                        <span className="flex-1">
                          {/* 学生タブの場合は studentQuestion を優先、なければ question を使用 */}
                          {activeTab === 'student' && q.studentQuestion ? q.studentQuestion : q.question}
                        </span>
                        {q.hint && (
                          <InfoTooltip content={q.hint} position="left" />
                        )}
                      </div>
                      
                      {/* 学生タブで学生向け質問がある場合、企業向け質問との連動を表示 */}
                      {activeTab === 'student' && q.studentQuestion && (q.gapCheck === true || q.gapCheck === 'true') && (
                        <div className="mb-3 -mt-1 px-2.5 py-1.5 bg-gray-50 border border-gray-200 rounded-lg flex items-start gap-1.5">
                          <svg className="w-3.5 h-3.5 text-gray-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
                          </svg>
                          <div className="text-[11px] text-gray-500">
                            <span className="text-gray-400">企業側質問：</span>
                            <span className="text-gray-600">{q.question}</span>
                          </div>
                        </div>
                      )}
                      
                      <div className="grid grid-cols-2 gap-3">
                        <button
                          onClick={() => {
                            const newData = {
                              ...data,
                              [answersKey]: { ...data[answersKey], [q.id]: 'A' }
                            };
                            if (DEBUG_MODE) {
                              debugLog('=== 回答保存デバッグ ===');
                              debugLog('質問ID:', q.id);
                              debugLog('回答:', 'A');
                              debugLog('answersKey:', answersKey);
                              debugLog('更新後の回答オブジェクト:', newData[answersKey]);
                              debugLog('=== デバッグ終了 ===');
                            }
                            onChange(newData);
                          }}
                          className={`p-3 rounded-lg text-sm text-left transition border-2 ${
                            currentAnswer === 'A'
                              ? showCorrectAnswer
                                ? (q.correctAnswer === 'A'
                                    ? 'border-green-500 bg-green-100 text-green-800'
                                    : 'border-red-500 bg-red-100 text-red-800')
                                : 'border-blue-500 bg-blue-100 text-blue-800'
                              : 'border-gray-200 bg-white hover:border-blue-300'
                          }`}
                        >
                          <span className="font-bold mr-2">A.</span>
                          {/* 学生タブの場合は studentChoiceA を優先 */}
                          {activeTab === 'student' && q.studentChoiceA ? q.studentChoiceA : q.choiceA}
                        </button>
                        <button
                          onClick={() => {
                            const newData = {
                              ...data,
                              [answersKey]: { ...data[answersKey], [q.id]: 'B' }
                            };
                            if (DEBUG_MODE) {
                              debugLog('=== 回答保存デバッグ ===');
                              debugLog('質問ID:', q.id);
                              debugLog('回答:', 'B');
                              debugLog('answersKey:', answersKey);
                              debugLog('更新後の回答オブジェクト:', newData[answersKey]);
                              debugLog('=== デバッグ終了 ===');
                            }
                            onChange(newData);
                          }}
                          className={`p-3 rounded-lg text-sm text-left transition border-2 ${
                            currentAnswer === 'B'
                              ? showCorrectAnswer
                                ? (q.correctAnswer === 'B'
                                    ? 'border-green-500 bg-green-100 text-green-800'
                                    : 'border-red-500 bg-red-100 text-red-800')
                                : 'border-blue-500 bg-blue-100 text-blue-800'
                              : 'border-gray-200 bg-white hover:border-blue-300'
                          }`}
                        >
                          <span className="font-bold mr-2">B.</span>
                          {/* 学生タブの場合は studentChoiceB を優先 */}
                          {activeTab === 'student' && q.studentChoiceB ? q.studentChoiceB : q.choiceB}
                        </button>
                      </div>
                    </div>
                  );
                })}
                
                {/* スコアサマリー（表示設定に応じて） */}
                {showAnswerSummary && (
                  <div className="mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200">
                    <h4 className="text-sm font-bold text-gray-700 mb-3">回答サマリー</h4>
                    <div className="grid grid-cols-3 gap-4 text-center">
                      <div>
                        <div className="text-2xl font-black text-blue-600">
                          {allQuestions.filter(q => data[`${activeTab}Answers`]?.[q.id]).length}
                        </div>
                        <div className="text-xs text-gray-500">回答済み / {allQuestions.length}</div>
                      </div>
                      <div>
                        <div className="text-2xl font-black text-green-600">
                          {allQuestions.filter(q => data[`${activeTab}Answers`]?.[q.id] === q.correctAnswer).length}
                        </div>
                        <div className="text-xs text-gray-500">正解</div>
                      </div>
                      <div>
                        <div className="text-2xl font-black text-red-600">
                          -{allQuestions.reduce((sum, q) => {
                            const ans = data[`${activeTab}Answers`]?.[q.id];
                            return sum + (ans && ans !== q.correctAnswer ? (q.points || q.penaltyPoints || 2) : 0);
                          }, 0)}
                      </div>
                      <div className="text-xs text-gray-500">減点合計</div>
                    </div>
                  </div>
                </div>
                )}
              </div>
            );
          })()}
        </div>
      )}
      
      {/* 追随バナー（回答進捗） - 問診票タブ時のみ表示、枠外右上に固定 */}
      {['staff', 'executive'].includes(activeTab) && (() => {
        const sizeCategory = getCompanySizeCategory(data.companySize);
        const master = getEffectiveQuestionMaster(data);
        const roleKey = activeTab;
        const baseQuestions = master.base?.[sizeCategory]?.[roleKey] || [];
        const industryQuestions = master.industry?.[data.industry]?.[sizeCategory]?.[roleKey] || [];
        const targetLayers = Object.keys(data.targetLayers || {}).filter(k => data.targetLayers[k]?.enabled);
        const targetQuestions = targetLayers.flatMap(layer => 
          (master.targetLayer?.[layer]?.[roleKey] || []).map(q => ({ ...q, layer }))
        );
        
        // 注力タイプ質問を取得（表層部・中層部・深層部）
        const depthQuestions = [
          ...(master.depth?.surface?.[roleKey] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'surface' })),
          ...(master.depth?.middle?.[roleKey] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'middle' })),
          ...(master.depth?.deep?.[roleKey] || []).map(q => ({ ...q, category: 'depth', depthPhase: 'deep' }))
        ];
        
        // 採用手法別質問を取得（activeな手法のカテゴリ単位でユニーク化）
        const methodMasterForStudent = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
        const activeCategoriesForStudent = getActiveMethodCategories(data);
        const recruitmentMethodQuestions = activeCategoriesForStudent.flatMap(cat => {
          const questions = getMethodQuestionsByCategory(master, cat, methodMasterForStudent, roleKey);
          return questions.map(q => ({ ...q, category: 'recruitmentMethod', methodCategory: cat }));
        });
        
        // 全質問を結合
        const rawQuestions = [
          ...baseQuestions.map(q => ({ ...q, category: q.category || 'base' })),
          ...industryQuestions.map(q => ({ ...q, category: 'industry' })),
          ...targetQuestions.map(q => ({ ...q, category: 'target' })),
          ...depthQuestions,
          ...recruitmentMethodQuestions
        ];
        
        // 重複を除去（質問IDでユニーク化）
        const seenIds = new Set();
        let allQuestions = rawQuestions.filter(q => {
          if (seenIds.has(q.id)) return false;
          seenIds.add(q.id);
          return true;
        });
        
        // 決裁者フラグがONの場合、上層部問診から基礎力（マインドセット軸）の質問を除外
        if (roleKey === 'executive' && data.isDecisionMaker) {
          allQuestions = allQuestions.filter(q => {
            const isMindset = q.axisType === 'mindset' || q.axisType?.includes('マインドセット');
            return !isMindset;
          });
        }
        
        if (allQuestions.length === 0) return null;
        
        const answeredCount = allQuestions.filter(q => data[`${activeTab}Answers`]?.[q.id]).length;
        const totalCount = allQuestions.length;
        const progress = (answeredCount / totalCount) * 100;
        const isComplete = answeredCount === totalCount;
        
        return (
          <div 
            style={{ 
              position: 'fixed', 
              top: '100px', 
              right: '20px', 
              zIndex: 9999 
            }}
          >
            <div className={`px-5 py-3 rounded-full shadow-lg border-2 transition-all duration-300 ${
              isComplete 
                ? 'bg-gradient-to-r from-green-500 to-emerald-500 border-green-400 text-white' 
                : 'bg-white border-blue-200'
            }`}>
              <div className="flex items-center gap-3">
                {/* 進捗サークル */}
                <div className="relative w-10 h-10">
                  <svg className="w-10 h-10 transform -rotate-90">
                    <circle
                      cx="20"
                      cy="20"
                      r="16"
                      stroke={isComplete ? 'rgba(255,255,255,0.3)' : '#e5e7eb'}
                      strokeWidth="4"
                      fill="none"
                    />
                    <circle
                      cx="20"
                      cy="20"
                      r="16"
                      stroke={isComplete ? '#ffffff' : '#3b82f6'}
                      strokeWidth="4"
                      fill="none"
                      strokeDasharray={`${progress * 1.005} 100.5`}
                      strokeLinecap="round"
                      style={{ transition: 'stroke-dasharray 0.3s ease' }}
                    />
                  </svg>
                  <div className={`absolute inset-0 flex items-center justify-center text-xs font-bold ${
                    isComplete ? 'text-white' : 'text-blue-600'
                  }`}>
                    {isComplete ? '✓' : `${Math.round(progress)}%`}
                  </div>
                </div>
                
                {/* テキスト */}
                <div className="flex flex-col">
                  <span className={`text-sm font-bold ${isComplete ? 'text-white' : 'text-gray-800'}`}>
                    {isComplete ? '回答完了！' : '回答中...'}
                  </span>
                  <span className={`text-xs ${isComplete ? 'text-green-100' : 'text-gray-500'}`}>
                    {answeredCount} / {totalCount} 問
                  </span>
                </div>
                
                {/* 完了アイコン */}
                {isComplete && (
                  <svg className="w-6 h-6 text-white animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                )}
              </div>
            </div>
          </div>
        );
      })()}
      
      {/* ファネル数値 */}
      {activeTab === 'funnel' && (
        <div className="glass-card rounded-xl p-6 animate-in">
          {/* 採用目標人数セクション */}
          <div className="mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl">
            <div className="flex items-center gap-2 mb-3">
              <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <h4 className="text-sm font-bold text-green-800">採用目標人数（承諾目標）</h4>
            </div>
            <p className="text-xs text-green-600 mb-3">
              目標人数を入力すると、業界平均歩留まり率から各段階の目標目安が逆算されます
            </p>
            
            {(() => {
              const selectedYear = data.funnelData?.selectedYear || '27卒';
              const enabledLayers = Object.entries(data.targetLayers || {})
                .filter(([_, v]) => v?.enabled)
                .map(([key, v]) => ({ key, ...v }));
              
              // ターゲット層が複数ある場合は層別入力
              if (enabledLayers.length > 1) {
                const layerTargets = data.funnelData?.yearData?.[selectedYear]?.targetHiresByLayer || {};
                const totalTargetHires = data.funnelData?.yearData?.[selectedYear]?.targetHires || 0;
                
                // 比率から自動計算（端数調整付き）
                const calculateLayerTargets = () => {
                  if (totalTargetHires === 0) return {};
                  
                  // 各層の小数値を計算
                  const rawValues = enabledLayers.map(layer => ({
                    key: layer.key,
                    ratio: layer.ratio || 0,
                    raw: totalTargetHires * (layer.ratio || 0) / 100,
                    floor: Math.floor(totalTargetHires * (layer.ratio || 0) / 100)
                  }));
                  
                  // floorの合計
                  const floorSum = rawValues.reduce((sum, v) => sum + v.floor, 0);
                  let remainder = totalTargetHires - floorSum;
                  
                  // 小数部分が大きい順にソート
                  const sorted = [...rawValues].sort((a, b) => (b.raw - b.floor) - (a.raw - a.floor));
                  
                  // 結果を構築（残りを小数部分が大きい順に配分）
                  const result = {};
                  sorted.forEach((v, idx) => {
                    result[v.key] = v.floor + (idx < remainder ? 1 : 0);
                  });
                  
                  return result;
                };
                
                const autoCalculated = calculateLayerTargets();
                
                // 各層の目標人数を取得（layerTargetsに手動入力値があればそれを使用、なければ自動計算）
                const getLayerTarget = (layer) => {
                  if (layerTargets[layer.key] !== undefined && layerTargets[layer.key] !== '') {
                    return layerTargets[layer.key];
                  }
                  return autoCalculated[layer.key] || 0;
                };
                
                const totalTarget = enabledLayers.reduce((sum, layer) => sum + (getLayerTarget(layer) || 0), 0);
                
                return (
                  <div className="space-y-3">
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                      {enabledLayers.map(layer => (
                        <div key={layer.key} className="flex items-center gap-2">
                          <label className="text-xs font-medium text-gray-700 whitespace-nowrap">{layer.key}層:</label>
                          <input
                            type="number"
                            min="0"
                            value={getLayerTarget(layer) || ''}
                            onChange={(e) => {
                              const newLayerTargets = {
                                ...layerTargets,
                                [layer.key]: e.target.value ? parseInt(e.target.value) : 0
                              };
                              // 他の層も現在の計算値で固定
                              enabledLayers.forEach(l => {
                                if (l.key !== layer.key && newLayerTargets[l.key] === undefined) {
                                  newLayerTargets[l.key] = getLayerTarget(l);
                                }
                              });
                              const newTotal = enabledLayers.reduce((sum, l) => sum + (parseInt(newLayerTargets[l.key]) || 0), 0);
                              onChange({
                                ...data,
                                funnelData: {
                                  ...data.funnelData,
                                  yearData: {
                                    ...data.funnelData?.yearData,
                                    [selectedYear]: {
                                      ...data.funnelData?.yearData?.[selectedYear],
                                      targetHiresByLayer: newLayerTargets,
                                      targetHires: newTotal
                                    }
                                  }
                                }
                              });
                            }}
                            placeholder="0"
                            className="w-20 px-2 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                          />
                          <span className="text-xs text-gray-500">人</span>
                        </div>
                      ))}
                    </div>
                    <div className="flex items-center gap-2 pt-2 border-t border-green-200">
                      <span className="text-sm font-bold text-green-800">合計目標:</span>
                      <span className="text-lg font-bold text-green-600">{totalTarget || totalTargetHires}</span>
                      <span className="text-sm text-green-600">人</span>
                    </div>
                  </div>
                );
              } else {
                // ターゲット層が1つ以下の場合は合計のみ
                const targetHires = data.funnelData?.yearData?.[selectedYear]?.targetHires || '';
                return (
                  <div className="flex items-center gap-3">
                    <label className="text-sm font-medium text-gray-700">目標人数:</label>
                    <input
                      type="number"
                      min="0"
                      value={targetHires}
                      onChange={(e) => onChange({
                        ...data,
                        funnelData: {
                          ...data.funnelData,
                          yearData: {
                            ...data.funnelData?.yearData,
                            [selectedYear]: {
                              ...data.funnelData?.yearData?.[selectedYear],
                              targetHires: e.target.value ? parseInt(e.target.value) : 0
                            }
                          }
                        }
                      })}
                      placeholder="例: 5"
                      className="w-24 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                    />
                    <span className="text-sm text-gray-600">人</span>
                  </div>
                );
              }
            })()}
          </div>
          
          <div className="flex items-center justify-between mb-4">
            <div>
              <h3 className="text-lg font-bold text-gray-800">
                採用ファネル数値
              </h3>
              <p className="text-sm text-gray-500 mt-1">
                「採用手法」タブで利用中にチェックしたチャネルが、注力順位順に表示されます
              </p>
            </div>
            
            {/* 年度切り替え */}
            <div className="flex items-center gap-3">
              <label className="text-sm font-medium text-gray-700">年度：</label>
              <div className="flex items-center gap-2">
                <select
                  value={data.funnelData?.selectedYear || '27卒'}
                  onChange={(e) => onChange({
                    ...data,
                    funnelData: { ...data.funnelData, selectedYear: e.target.value }
                  })}
                  className="px-3 py-2 border border-gray-200 rounded-lg text-sm font-bold focus:ring-2 focus:ring-blue-500 bg-white"
                >
                  {['25卒', '26卒', '27卒', '28卒', '29卒', '30卒'].map(year => (
                    <option key={year} value={year}>{year}</option>
                  ))}
                </select>
                
                {/* 年度追加ボタン */}
                <button
                  onClick={() => {
                    const newYear = prompt('追加する年度を入力してください（例：31卒）');
                    if (newYear && newYear.trim()) {
                      const currentYears = data.funnelData?.availableYears || ['25卒', '26卒', '27卒', '28卒', '29卒', '30卒'];
                      if (!currentYears.includes(newYear.trim())) {
                        onChange({
                          ...data,
                          funnelData: {
                            ...data.funnelData,
                            availableYears: [...currentYears, newYear.trim()].sort(),
                            selectedYear: newYear.trim()
                          }
                        });
                      }
                    }
                  }}
                  className="p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition"
                  title="年度を追加"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fillRule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clipRule="evenodd" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
          
          {/* 年度タブ表示 */}
          <div className="flex gap-1 mb-5 p-1 bg-gray-100 rounded-lg overflow-x-auto">
            {(data.funnelData?.availableYears || ['25卒', '26卒', '27卒', '28卒', '29卒', '30卒']).map(year => (
              <button
                key={year}
                onClick={() => onChange({
                  ...data,
                  funnelData: { ...data.funnelData, selectedYear: year }
                })}
                className={`px-4 py-2 text-sm font-medium rounded-md transition whitespace-nowrap ${
                  (data.funnelData?.selectedYear || '27卒') === year
                    ? 'bg-white text-blue-600 shadow-sm'
                    : 'text-gray-600 hover:text-gray-800 hover:bg-gray-50'
                }`}
              >
                {year}
                {data.funnelData?.yearData?.[year]?.channelData && 
                 Object.keys(data.funnelData.yearData[year].channelData).length > 0 && (
                  <span className="ml-1 w-2 h-2 bg-green-500 rounded-full inline-block"></span>
                )}
              </button>
            ))}
          </div>
          
          {(() => {
            // マスターデータを取得（空オブジェクトもフォールバック対象）
            const RECRUITMENT_METHODS = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
            
            // 現在選択中の年度
            const selectedYear = data.funnelData?.selectedYear || '27卒';
            const yearData = data.funnelData?.yearData?.[selectedYear] || {};
            
            // 利用中のチャネルを取得（優先順位順にソート）
            const activeChannels = Object.entries(data.recruitmentMethods || {})
              .filter(([_, m]) => m.active)
              .map(([key, m]) => ({
                key,
                name: RECRUITMENT_METHODS[key]?.name || key,
                shortName: RECRUITMENT_METHODS[key]?.name?.split('（')[0]?.substring(0, 8) || key,
                priority: parseInt(m.priority) || 999
              }))
              .sort((a, b) => a.priority - b.priority);
            
            // フェーズ定義（選考は細分化可能）
            const screeningSteps = yearData.screeningSteps || data.funnelData?.screeningSteps || 1;
            const phases = [
              { key: 'awareness', label: '認知', rowSpan: 1 },
              { key: 'interest', label: '興味', rowSpan: 1 },
              { key: 'contact', label: '接触', rowSpan: 1 },
              { key: 'screening', label: '選考', rowSpan: screeningSteps, subLabels: 
                screeningSteps === 1 ? [''] : 
                Array.from({length: screeningSteps}, (_, i) => `${i + 1}次面接`)
              },
              { key: 'offer', label: '内々定', rowSpan: 1 },
              { key: 'acceptance', label: '承諾', rowSpan: 1 }
            ];
            
            // 採用手法カテゴリ別のプレースホルダー
            // チャネルキー→カテゴリの直接マッピングをDEFAULT_RECRUITMENT_METHODSから構築
            const channelCategoryMap = {};
            Object.entries(DEFAULT_RECRUITMENT_METHODS).forEach(([key, m]) => {
              channelCategoryMap[key] = m.category || 'その他';
            });
            // カスタムマスターからも追加
            Object.entries(RECRUITMENT_METHODS).forEach(([key, m]) => {
              if (m.category) channelCategoryMap[key] = m.category;
            });
            
            // カテゴリごとのデフォルトプレースホルダー定義
            const categoryPlaceholders = {
              'ナビサイト': { awareness: 'PV数', interest: 'エントリー数', contact: '説明会/IS参加数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              'ダイレクトリクルーティング': { awareness: '送信数', interest: '返信数', contact: '面談数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              '大学連携': { awareness: '着座数', interest: '興味喚起数', contact: '接触数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              '合同説明会': { awareness: '着座数', interest: 'エントリー数', contact: '説明会参加数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              '地域特化': { awareness: '着座数', interest: 'エントリー数', contact: '接触数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              'SNS・動画': { awareness: 'リーチ数', interest: '反応数', contact: 'DM/問合せ数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              '口コミ・情報サイト': { awareness: 'PV数', interest: 'エントリー数', contact: '説明会参加数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              '求人サイト': { awareness: '閲覧数', interest: '応募数', contact: '面談数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              '業界特化': { awareness: '閲覧数', interest: '応募数', contact: '面談数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              'インターンシップ': { awareness: '募集数', interest: '応募数', contact: '参加数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
              'その他': { awareness: '紹介数', interest: '興味喚起数', contact: '接触数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' }
            };
            
            // フェーズ名ベースの汎用ラベル（最終フォールバック用）
            const PHASE_LABELS = {
              awareness: '認知数', interest: 'エントリー数', contact: '接触数',
              screening: '選考参加数', offer: '内々定数', acceptance: '承諾数'
            };
            
            const getPlaceholder = (phase, channelKey) => {
              // 1. マスターデータのphaseLabelsを最優先
              const method = RECRUITMENT_METHODS[channelKey] || DEFAULT_RECRUITMENT_METHODS[channelKey];
              if (method?.phaseLabels?.[phase]) return method.phaseLabels[phase];
              
              // 2. カスタム設定があればそれを使用
              const category = channelCategoryMap[channelKey] || 'その他';
              const customLabel = data.channelLabels?.[category]?.[phase];
              if (customLabel && customLabel.trim()) return customLabel;
              
              // 3. カテゴリ別プレースホルダー
              const catPh = categoryPlaceholders[category]?.[phase];
              if (catPh) return catPh;
              
              // 4. 汎用フェーズラベル
              return PHASE_LABELS[phase] || '数値を入力';
            };
            
            // チャネルデータの取得・設定ヘルパー（年度対応）
            const getChannelValue = (phase, subIndex, channelKey) => {
              const dataKey = subIndex !== undefined ? `${phase}_${subIndex}_${channelKey}` : `${phase}_${channelKey}`;
              return yearData.channelData?.[dataKey] ?? '';
            };
            
            const setChannelValue = (phase, subIndex, channelKey, value) => {
              const dataKey = subIndex !== undefined ? `${phase}_${subIndex}_${channelKey}` : `${phase}_${channelKey}`;
              const newChannelData = {
                ...yearData.channelData,
                [dataKey]: value === '' ? '' : (parseInt(value) || 0)
              };
              
              // 新しいchannelDataで合計を再計算
              const calcNewTotal = (p, si) => {
                return activeChannels.reduce((sum, ch) => {
                  const dk = si !== undefined ? `${p}_${si}_${ch.key}` : `${p}_${ch.key}`;
                  const val = newChannelData[dk];
                  return sum + (parseInt(val) || 0);
                }, 0);
              };
              
              // 合計を更新
              const totals = {
                targetAwareness: calcNewTotal('awareness'),
                interest: calcNewTotal('interest'),
                applications: calcNewTotal('contact'),
                screening: screeningSteps > 1 ? calcNewTotal('screening', 0) : calcNewTotal('screening'),
                offers: calcNewTotal('offer'),
                acceptance: calcNewTotal('acceptance')
              };
              
              onChange({
                ...data,
                funnelData: {
                  ...data.funnelData,
                  ...totals, // グラフ表示用に現在の年度の合計も保持
                  yearData: {
                    ...data.funnelData?.yearData,
                    [selectedYear]: {
                      ...yearData,
                      ...totals,
                      channelData: newChannelData
                    }
                  }
                }
              });
            };
            
            // 合計計算
            const calcTotal = (phase, subIndex) => {
              return activeChannels.reduce((sum, ch) => {
                const val = getChannelValue(phase, subIndex, ch.key);
                return sum + (parseInt(val) || 0);
              }, 0);
            };
            
            // 旧データとの互換性（合計をfunnelDataの既存キーにも反映）
            const updateLegacyTotals = () => {
              const totals = {
                targetAwareness: calcTotal('awareness'),
                interest: calcTotal('interest'),
                applications: calcTotal('contact'),
                screening: screeningSteps > 1 
                  ? calcTotal('screening', 0)
                  : calcTotal('screening'),
                offers: calcTotal('offer'),
                acceptance: calcTotal('acceptance')
              };
              return totals;
            };
            
            return (
              <>
                {/* 選考ステップ数の設定 */}
                <div className="mb-4 flex items-center gap-3">
                  <label className="text-sm font-medium text-gray-700">選考ステップ数：</label>
                  <select
                    value={screeningSteps}
                    onChange={(e) => onChange({
                      ...data,
                      funnelData: { 
                        ...data.funnelData, 
                        screeningSteps: parseInt(e.target.value),
                        yearData: {
                          ...data.funnelData?.yearData,
                          [selectedYear]: {
                            ...yearData,
                            screeningSteps: parseInt(e.target.value)
                          }
                        }
                      }
                    })}
                    className="px-3 py-1.5 border border-gray-200 rounded-lg text-sm"
                  >
                    {[1, 2, 3, 4, 5].map(n => (
                      <option key={n} value={n}>{n}段階</option>
                    ))}
                  </select>
                  <span className="text-xs text-gray-500">（1次面接、2次面接など）</span>
                  <span className="ml-auto text-xs text-blue-600 font-medium bg-blue-50 px-2 py-1 rounded">
                    {selectedYear}のデータを編集中
                  </span>
                </div>
                
                {activeChannels.length === 0 ? (
                  <div className="space-y-4">
                    <div className="p-4 bg-amber-50 rounded-xl border border-amber-200">
                      <div className="text-amber-600 font-bold mb-2 flex items-center gap-1">
                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        ヒント
                      </div>
                      <div className="text-sm text-amber-700">
                        「採用手法」タブで利用中のチャネルにチェックを入れると、チャネル別の詳細入力ができます
                      </div>
                    </div>
                    
                    {/* 従来の合計入力フォーム（年度対応） */}
                    <div className="grid grid-cols-2 gap-5">
                      {[
                        { key: 'targetAwareness', label: '認知数', default: '' },
                        { key: 'interest', label: '興味', default: '' },
                        { key: 'applications', label: '接触', default: '' },
                        { key: 'screening', label: '選考', default: '' },
                        { key: 'offers', label: '内々定', default: '' },
                        { key: 'acceptance', label: '承諾', default: '' }
                      ].map(item => (
                        <div key={item.key}>
                          <label className="block text-sm font-medium text-gray-700 mb-2">{item.label}</label>
                          <input
                            type="number"
                            value={yearData[item.key] ?? data.funnelData?.[item.key] ?? item.default}
                            onChange={(e) => {
                              const newValue = e.target.value === '' ? '' : (parseInt(e.target.value) || 0);
                              onChange({
                                ...data,
                                funnelData: { 
                                  ...data.funnelData, 
                                  [item.key]: newValue,
                                  yearData: {
                                    ...data.funnelData?.yearData,
                                    [selectedYear]: {
                                      ...yearData,
                                      [item.key]: newValue
                                    }
                                  }
                                }
                              });
                            }}
                            placeholder="未入力"
                            className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                          />
                        </div>
                      ))}
                    </div>
                  </div>
                ) : (
                  <div className="overflow-x-auto">
                    <table className="w-full border-collapse text-sm">
                      <thead>
                        <tr className="bg-gray-50">
                          <th className="border border-gray-200 px-3 py-2 text-left font-bold text-gray-700 w-28">
                            採用フェーズ
                          </th>
                          <th className="border border-gray-200 px-3 py-2 text-left font-bold text-gray-700 w-20">
                            項目
                          </th>
                          <th className="border border-gray-200 px-3 py-2 text-center font-bold text-gray-700 bg-blue-50 w-20">
                            合計
                          </th>
                          {activeChannels.map(ch => (
                            <th key={ch.key} className="border border-gray-200 px-2 py-2 text-center font-medium text-gray-600 min-w-[100px]">
                              <div className="truncate" title={ch.name}>
                                {ch.priority < 999 && (
                                  <span className="text-[10px] text-purple-500 mr-0.5">{ch.priority}位</span>
                                )}
                                {ch.shortName}
                              </div>
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        {phases.map(phase => (
                          phase.rowSpan === 1 ? (
                            <tr key={phase.key}>
                              <td className="border border-gray-200 px-3 py-2 font-bold text-gray-800 bg-gray-50">
                                {phase.label}
                              </td>
                              <td className="border border-gray-200 px-3 py-2 text-gray-600">
                                -
                              </td>
                              <td className="border border-gray-200 px-2 py-2 text-center font-bold text-blue-600 bg-blue-50">
                                {calcTotal(phase.key)}
                              </td>
                              {activeChannels.map(ch => (
                                <td key={ch.key} className="border border-gray-200 px-1 py-1">
                                  <input
                                    type="number"
                                    min="0"
                                    value={getChannelValue(phase.key, undefined, ch.key)}
                                    onChange={(e) => setChannelValue(phase.key, undefined, ch.key, e.target.value)}
                                    placeholder={getPlaceholder(phase.key, ch.key)}
                                    className="w-full px-2 py-1.5 border border-gray-200 rounded text-center text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent placeholder-gray-300"
                                  />
                                </td>
                              ))}
                            </tr>
                          ) : (
                            phase.subLabels.map((subLabel, subIdx) => (
                              <tr key={`${phase.key}_${subIdx}`}>
                                {subIdx === 0 && (
                                  <td 
                                    className="border border-gray-200 px-3 py-2 font-bold text-gray-800 bg-gray-50"
                                    rowSpan={phase.rowSpan}
                                  >
                                    {phase.label}
                                  </td>
                                )}
                                <td className="border border-gray-200 px-3 py-2 text-gray-600 text-xs">
                                  {subLabel || '-'}
                                </td>
                                <td className="border border-gray-200 px-2 py-2 text-center font-bold text-blue-600 bg-blue-50">
                                  {calcTotal(phase.key, subIdx)}
                                </td>
                                {activeChannels.map(ch => (
                                  <td key={ch.key} className="border border-gray-200 px-1 py-1">
                                    <input
                                      type="number"
                                      min="0"
                                      value={getChannelValue(phase.key, subIdx, ch.key)}
                                      onChange={(e) => setChannelValue(phase.key, subIdx, ch.key, e.target.value)}
                                      placeholder={getPlaceholder(phase.key, ch.key)}
                                      className="w-full px-2 py-1.5 border border-gray-200 rounded text-center text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent placeholder-gray-300"
                                    />
                                  </td>
                                ))}
                              </tr>
                            ))
                          )
                        ))}
                      </tbody>
                    </table>
                  </div>
                )}
                
                {/* 合計サマリー（グラフ用データとして使用） */}
                {activeChannels.length > 0 && (
                  <div className="mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200">
                    <h4 className="text-sm font-bold text-gray-700 mb-3">
                      {selectedYear} フェーズ別合計（グラフ表示用）
                    </h4>
                    <div className="grid grid-cols-6 gap-3 text-center">
                      {[
                        { key: 'awareness', label: '認知' },
                        { key: 'interest', label: '興味' },
                        { key: 'contact', label: '接触' },
                        { key: 'screening', label: '選考', subIdx: screeningSteps > 1 ? 0 : undefined },
                        { key: 'offer', label: '内々定' },
                        { key: 'acceptance', label: '承諾' }
                      ].map(item => (
                        <div key={item.key}>
                          <div className="text-xs text-gray-500 mb-1">{item.label}</div>
                          <div className="text-xl font-black text-blue-600">
                            {item.subIdx !== undefined ? calcTotal(item.key, item.subIdx) : calcTotal(item.key)}
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}
                
                {/* 歩留まり表示対象チャネル選択 */}
                {activeChannels.length > 0 && (
                  <div className="mt-4 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200">
                    <div className="flex items-center gap-2 mb-3">
                      <svg className="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                      </svg>
                      <h4 className="text-sm font-bold text-gray-700">結果画面の歩留まり表示対象</h4>
                      <span className="text-xs text-gray-500">（「結果」タブの歩留まり実績グラフに反映されます）</span>
                    </div>
                    <div className="flex flex-wrap gap-2">
                      {activeChannels.map(ch => {
                        const selected = data.funnelData?.selectedYieldChannel === ch.key;
                        return (
                          <button
                            key={ch.key}
                            onClick={() => {
                              const newVal = selected ? '' : ch.key;
                              onChange({
                                ...data,
                                funnelData: {
                                  ...data.funnelData,
                                  selectedYieldChannel: newVal
                                }
                              });
                            }}
                            className={`px-3 py-1.5 rounded-lg text-sm font-medium transition border ${
                              selected
                                ? 'bg-purple-600 text-white border-purple-600 shadow-sm'
                                : 'bg-white text-gray-700 border-gray-300 hover:border-purple-400 hover:bg-purple-50'
                            }`}
                          >
                            {ch.priority < 999 && (
                              <span className={`mr-1 text-xs ${selected ? 'text-purple-200' : 'text-purple-500'}`}>
                                {ch.priority}位
                              </span>
                            )}
                            {ch.shortName}
                          </button>
                        );
                      })}
                    </div>
                    <div className="mt-2 text-xs text-gray-500">
                      {(() => {
                        const sel = data.funnelData?.selectedYieldChannel;
                        if (sel && activeChannels.some(ch => ch.key === sel)) {
                          const ch = activeChannels.find(c => c.key === sel);
                          return `「${ch.name}」の数値で歩留まりグラフを表示します`;
                        }
                        return `未選択の場合は優先順位1位「${activeChannels[0]?.name || '-'}」の数値で表示します`;
                      })()}
                    </div>
                  </div>
                )}
                
                {/* 年度比較（折りたたみ式） */}
                <details className="mt-4">
                  <summary className="flex items-center gap-2 cursor-pointer text-sm font-medium text-gray-600 hover:text-gray-800">
                    <span className="text-gray-400 group-open:rotate-90 transition-transform">▶</span>
                    年度比較を表示
                  </summary>
                  <div className="mt-3 p-4 bg-gray-50 rounded-xl border border-gray-200">
                    <div className="overflow-x-auto">
                      <table className="w-full text-sm">
                        <thead>
                          <tr className="border-b border-gray-200">
                            <th className="text-left py-2 px-3 font-medium text-gray-600">年度</th>
                            <th className="text-center py-2 px-2 font-medium text-gray-600">認知</th>
                            <th className="text-center py-2 px-2 font-medium text-gray-600">興味</th>
                            <th className="text-center py-2 px-2 font-medium text-gray-600">接触</th>
                            <th className="text-center py-2 px-2 font-medium text-gray-600">選考</th>
                            <th className="text-center py-2 px-2 font-medium text-gray-600">内々定</th>
                            <th className="text-center py-2 px-2 font-medium text-gray-600">承諾</th>
                          </tr>
                        </thead>
                        <tbody>
                          {(data.funnelData?.availableYears || ['25卒', '26卒', '27卒', '28卒', '29卒', '30卒']).map(year => {
                            const yd = data.funnelData?.yearData?.[year] || {};
                            const hasData = yd.channelData && Object.keys(yd.channelData).length > 0;
                            return (
                              <tr 
                                key={year} 
                                className={`border-b border-gray-100 ${year === selectedYear ? 'bg-blue-50' : ''}`}
                              >
                                <td className={`py-2 px-3 font-medium ${year === selectedYear ? 'text-blue-600' : 'text-gray-700'}`}>
                                  {year}
                                  {year === selectedYear && <span className="ml-1 text-xs">（編集中）</span>}
                                </td>
                                <td className="text-center py-2 px-2">{hasData ? (yd.targetAwareness || 0) : '-'}</td>
                                <td className="text-center py-2 px-2">{hasData ? (yd.interest || 0) : '-'}</td>
                                <td className="text-center py-2 px-2">{hasData ? (yd.applications || 0) : '-'}</td>
                                <td className="text-center py-2 px-2">{hasData ? (yd.screening || 0) : '-'}</td>
                                <td className="text-center py-2 px-2">{hasData ? (yd.offers || 0) : '-'}</td>
                                <td className="text-center py-2 px-2">{hasData ? (yd.acceptance || 0) : '-'}</td>
                              </tr>
                            );
                          })}
                        </tbody>
                      </table>
                    </div>
                    <p className="text-xs text-gray-500 mt-2">
                      ※ 「-」はデータ未入力の年度です
                    </p>
                  </div>
                </details>
              </>
            );
          })()}
          
          {/* 採用手法の呼び名設定（折りたたみ式） */}
          <div className="mt-8 border-t border-gray-200 pt-6">
            <details className="group">
              <summary className="flex items-center justify-between cursor-pointer list-none">
                <h4 className="text-sm font-bold text-gray-700 flex items-center gap-2">
                  <span className="w-1.5 h-1.5 bg-purple-500 rounded-full"></span>
                  採用手法の呼び名設定（プレースホルダー）
                </h4>
                <span className="text-gray-400 group-open:rotate-180 transition-transform">▼</span>
              </summary>
              <div className="mt-4">
                <p className="text-xs text-gray-500 mb-4">
                  採用手法のカテゴリごとに、各フェーズの呼び名を設定できます。空欄の場合はデフォルト値が使用されます。
                </p>
                
                {(() => {
                  const defaultLabels = {
                    'ナビサイト': { awareness: 'PV数', interest: 'エントリー数', contact: '説明会/IS参加数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    'ダイレクトリクルーティング': { awareness: '送信数', interest: '返信数', contact: '面談数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    '大学連携': { awareness: '着座数', interest: '興味喚起数', contact: '接触数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    '合同説明会': { awareness: '着座数', interest: 'エントリー数', contact: '説明会参加数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    '地域特化': { awareness: '着座数', interest: 'エントリー数', contact: '接触数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    'SNS・動画': { awareness: 'リーチ数', interest: '反応数', contact: 'DM/問合せ数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    '口コミ・情報サイト': { awareness: 'PV数', interest: 'エントリー数', contact: '説明会参加数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    '求人サイト': { awareness: '閲覧数', interest: '応募数', contact: '面談数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    '業界特化': { awareness: '閲覧数', interest: '応募数', contact: '面談数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    'インターンシップ': { awareness: '募集数', interest: '応募数', contact: '参加数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' },
                    'その他': { awareness: '紹介数', interest: '興味喚起数', contact: '接触数', screening: '選考参加数', offer: '内々定数', acceptance: '承諾数' }
                  };
                  
                  const categories = Object.keys(defaultLabels);
                  const phases = [
                    { key: 'awareness', label: '認知' },
                    { key: 'interest', label: '興味' },
                    { key: 'contact', label: '接触' },
                    { key: 'screening', label: '選考' },
                    { key: 'offer', label: '内々定' },
                    { key: 'acceptance', label: '承諾' }
                  ];
                  
                  return (
                    <div className="space-y-3">
                      {/* ヘッダー */}
                      <div className="grid grid-cols-7 gap-2 text-xs font-medium text-gray-500 border-b border-gray-200 pb-2">
                        <div className="col-span-1">カテゴリ</div>
                        {phases.map(p => (
                          <div key={p.key} className="text-center">{p.label}</div>
                        ))}
                      </div>
                      
                      {/* 各カテゴリの設定 */}
                      {categories.map(category => (
                        <div key={category} className="grid grid-cols-7 gap-2 items-center">
                          <div className="col-span-1 text-xs font-medium text-gray-700 truncate" title={category}>
                            {category}
                          </div>
                          {phases.map(phase => (
                            <input
                              key={phase.key}
                              type="text"
                              value={data.channelLabels?.[category]?.[phase.key] ?? ''}
                              placeholder={defaultLabels[category][phase.key]}
                              onChange={(e) => onChange({
                                ...data,
                                channelLabels: {
                                  ...data.channelLabels,
                                  [category]: {
                                    ...data.channelLabels?.[category],
                                    [phase.key]: e.target.value
                                  }
                                }
                              })}
                              className="w-full px-2 py-1.5 border border-gray-200 rounded text-xs focus:ring-2 focus:ring-purple-500 focus:border-transparent placeholder-gray-300"
                            />
                          ))}
                        </div>
                      ))}
                      
                      {/* リセットボタン */}
                      {data.channelLabels && Object.keys(data.channelLabels).length > 0 && (
                        <div className="flex justify-end mt-2">
                          <button
                            onClick={() => onChange({ ...data, channelLabels: null })}
                            className="px-3 py-1.5 text-xs bg-red-50 border border-red-200 text-red-600 rounded-lg hover:bg-red-100 transition"
                          >
                            デフォルトに戻す
                          </button>
                        </div>
                      )}
                    </div>
                  );
                })()}
              </div>
            </details>
          </div>
        </div>
      )}
      
      {/* 詳細設定 */}
      {activeTab === 'settings' && (
        <div className="glass-card rounded-xl p-6 animate-in">
          <h3 className="text-lg font-bold text-gray-800 mb-5">
            詳細設定
          </h3>
          
          {/* 地域・業種・人数規模・採用手法選択 */}
          <div className="mb-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100">
            <h4 className="text-sm font-bold text-gray-700 mb-3 flex items-center gap-2">
              <span className="w-1.5 h-1.5 bg-indigo-500 rounded-full"></span>
              地域・業種・人数規模・採用手法から歩留まり率平均値を自動設定
            </h4>
            
            <div className="grid grid-cols-2 gap-3 mb-3">
              <div>
                <label className="block text-xs font-medium text-gray-600 mb-1">地域</label>
                <select
                  value={data.yieldSettings?.region || 'aichi'}
                  onChange={(e) => {
                    const region = e.target.value;
                    const industry = data.yieldSettings?.industry || '';
                    const size = data.yieldSettings?.companySize || '';
                    const methodCat = data.yieldSettings?.methodCategory || 'ナビサイト';
                    const newSettings = { ...data.yieldSettings, region };
                    
                    if (industry && size) {
                      const yieldData = getYieldData(region, industry, size, data.yieldMaster, methodCat);
                      if (yieldData) {
                        onChange({
                          ...data,
                          yieldSettings: newSettings,
                          industryAverages: { ...yieldData }
                        });
                      } else {
                        onChange({ ...data, yieldSettings: newSettings });
                      }
                    } else {
                      onChange({ ...data, yieldSettings: newSettings });
                    }
                  }}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 bg-white"
                >
                  {REGION_LIST.map(item => (
                    <option key={item.key} value={item.key}>{item.label}</option>
                  ))}
                </select>
              </div>
              <div>
                <label className="block text-xs font-medium text-gray-600 mb-1">業種</label>
                <select
                  value={data.yieldSettings?.industry || ''}
                  onChange={(e) => {
                    const industry = e.target.value;
                    const region = data.yieldSettings?.region || 'aichi';
                    const size = data.yieldSettings?.companySize || '';
                    const methodCat = data.yieldSettings?.methodCategory || 'ナビサイト';
                    const newSettings = { ...data.yieldSettings, industry };
                    
                    if (industry && size) {
                      const yieldData = getYieldData(region, industry, size, data.yieldMaster, methodCat);
                      if (yieldData) {
                        onChange({
                          ...data,
                          yieldSettings: newSettings,
                          industryAverages: { ...yieldData }
                        });
                      } else {
                        onChange({ ...data, yieldSettings: newSettings });
                      }
                    } else {
                      onChange({ ...data, yieldSettings: newSettings });
                    }
                  }}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 bg-white"
                >
                  <option value="">選択してください</option>
                  {INDUSTRY_LIST.map(item => (
                    <option key={item.key} value={item.key}>{item.label}</option>
                  ))}
                </select>
              </div>
              <div>
                <label className="block text-xs font-medium text-gray-600 mb-1">従業員数</label>
                <select
                  value={data.yieldSettings?.companySize || ''}
                  onChange={(e) => {
                    const size = e.target.value;
                    const region = data.yieldSettings?.region || 'aichi';
                    const industry = data.yieldSettings?.industry || '';
                    const methodCat = data.yieldSettings?.methodCategory || 'ナビサイト';
                    const newSettings = { ...data.yieldSettings, companySize: size };
                    
                    if (industry && size) {
                      const yieldData = getYieldData(region, industry, size, data.yieldMaster, methodCat);
                      if (yieldData) {
                        onChange({
                          ...data,
                          yieldSettings: newSettings,
                          industryAverages: { ...yieldData }
                        });
                      } else {
                        onChange({ ...data, yieldSettings: newSettings });
                      }
                    } else {
                      onChange({ ...data, yieldSettings: newSettings });
                    }
                  }}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 bg-white"
                >
                  <option value="">選択してください</option>
                  {COMPANY_SIZE_LIST.map(item => (
                    <option key={item.key} value={item.key}>{item.label}</option>
                  ))}
                </select>
              </div>
              <div>
                <label className="block text-xs font-medium text-gray-600 mb-1">採用手法カテゴリ</label>
                <select
                  value={data.yieldSettings?.methodCategory || 'ナビサイト'}
                  onChange={(e) => {
                    const methodCat = e.target.value;
                    const region = data.yieldSettings?.region || 'aichi';
                    const industry = data.yieldSettings?.industry || '';
                    const size = data.yieldSettings?.companySize || '';
                    const newSettings = { ...data.yieldSettings, methodCategory: methodCat };
                    
                    if (industry && size) {
                      const yieldData = getYieldData(region, industry, size, data.yieldMaster, methodCat);
                      if (yieldData) {
                        onChange({
                          ...data,
                          yieldSettings: newSettings,
                          industryAverages: { ...yieldData }
                        });
                      } else {
                        onChange({ ...data, yieldSettings: newSettings });
                      }
                    } else {
                      onChange({ ...data, yieldSettings: newSettings });
                    }
                  }}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 bg-white"
                >
                  {getMethodCategoryList().map(item => (
                    <option key={item.key} value={item.key}>{item.label}</option>
                  ))}
                </select>
              </div>
            </div>
            
            {data.yieldSettings?.industry && data.yieldSettings?.companySize && (
              <div className="text-xs text-indigo-600 bg-white px-3 py-2 rounded-lg">
                ✓ {REGION_LIST.find(r => r.key === (data.yieldSettings?.region || 'aichi'))?.label}の「{INDUSTRY_LIST.find(i => i.key === data.yieldSettings.industry)?.label}」×「{COMPANY_SIZE_LIST.find(s => s.key === data.yieldSettings.companySize)?.label}」×「{getMethodCategoryList().find(m => m.key === (data.yieldSettings?.methodCategory || 'ナビサイト'))?.label}」の平均値が自動設定されました
              </div>
            )}
            
            {/* 手法カテゴリ別特性の説明 */}
            {data.yieldSettings?.methodCategory && data.yieldSettings.methodCategory !== 'ナビサイト' && (
              <div className="mt-2 text-xs text-gray-500 bg-white/60 px-3 py-2 rounded-lg flex items-start gap-2">
                <span className="text-blue-400 mt-0.5">ℹ</span>
                <span>
                  「{getMethodCategoryList().find(m => m.key === data.yieldSettings.methodCategory)?.label}」は
                  {getMethodCategoryList().find(m => m.key === data.yieldSettings.methodCategory)?.description}。
                  手法特性に応じた歩留まり率が適用されています。
                </span>
              </div>
            )}
          </div>
          
          {/* 歩留まり率業界平均値 */}
          <div className="mb-6">
            <h4 className="text-sm font-bold text-gray-700 mb-3 flex items-center gap-2">
              <span className="w-1.5 h-1.5 bg-blue-500 rounded-full"></span>
              歩留まり率業界平均値（%）
              {data.yieldSettings?.methodCategory && data.yieldSettings.methodCategory !== 'ナビサイト' && (
                <span className="text-xs font-normal bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full ml-2">
                  {data.yieldSettings.methodCategory}
                </span>
              )}
            </h4>
            
            {/* ヘッダー */}
            <div className="grid grid-cols-12 gap-3 mb-2 text-xs font-medium text-gray-500">
              <div className="col-span-3"></div>
              <div className="col-span-4 text-center">業界平均値</div>
              <div className="col-span-4 text-center">調整値（優先）</div>
              <div className="col-span-1"></div>
            </div>
            
            {/* 認知→興味 */}
            <div className="grid grid-cols-12 gap-3 items-center mb-3">
              <div className="col-span-3 text-sm font-medium text-gray-700">認知→興味</div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.industryAverages?.awarenessToInterest ?? 22}
                  onChange={(e) => onChange({ 
                    ...data, 
                    industryAverages: { 
                      ...data.industryAverages, 
                      awarenessToInterest: e.target.value === '' ? '' : (parseInt(e.target.value) || 0) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"
                />
              </div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.adjustedAverages?.awarenessToInterest ?? ''}
                  placeholder="未設定"
                  onChange={(e) => onChange({ 
                    ...data, 
                    adjustedAverages: { 
                      ...data.adjustedAverages, 
                      awarenessToInterest: e.target.value === '' ? null : parseInt(e.target.value) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-amber-50"
                />
              </div>
              <div className="col-span-1 text-xs text-gray-400">%</div>
            </div>
            
            {/* 興味→応募 */}
            <div className="grid grid-cols-12 gap-3 items-center mb-3">
              <div className="col-span-3 text-sm font-medium text-gray-700">興味→応募</div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.industryAverages?.interestToApplication ?? 25}
                  onChange={(e) => onChange({ 
                    ...data, 
                    industryAverages: { 
                      ...data.industryAverages, 
                      interestToApplication: e.target.value === '' ? '' : (parseInt(e.target.value) || 0) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"
                />
              </div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.adjustedAverages?.interestToApplication ?? ''}
                  placeholder="未設定"
                  onChange={(e) => onChange({ 
                    ...data, 
                    adjustedAverages: { 
                      ...data.adjustedAverages, 
                      interestToApplication: e.target.value === '' ? null : parseInt(e.target.value) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-amber-50"
                />
              </div>
              <div className="col-span-1 text-xs text-gray-400">%</div>
            </div>
            
            {/* 応募→選考 */}
            <div className="grid grid-cols-12 gap-3 items-center mb-3">
              <div className="col-span-3 text-sm font-medium text-gray-700">応募→選考</div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.industryAverages?.applicationToScreening ?? 25}
                  onChange={(e) => onChange({ 
                    ...data, 
                    industryAverages: { 
                      ...data.industryAverages, 
                      applicationToScreening: e.target.value === '' ? '' : (parseInt(e.target.value) || 0) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"
                />
              </div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.adjustedAverages?.applicationToScreening ?? ''}
                  placeholder="未設定"
                  onChange={(e) => onChange({ 
                    ...data, 
                    adjustedAverages: { 
                      ...data.adjustedAverages, 
                      applicationToScreening: e.target.value === '' ? null : parseInt(e.target.value) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-amber-50"
                />
              </div>
              <div className="col-span-1 text-xs text-gray-400">%</div>
            </div>
            
            {/* 選考→内定 */}
            <div className="grid grid-cols-12 gap-3 items-center mb-3">
              <div className="col-span-3 text-sm font-medium text-gray-700">選考→内定</div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.industryAverages?.screeningToOffer ?? 41}
                  onChange={(e) => onChange({ 
                    ...data, 
                    industryAverages: { 
                      ...data.industryAverages, 
                      screeningToOffer: e.target.value === '' ? '' : (parseInt(e.target.value) || 0) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"
                />
              </div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.adjustedAverages?.screeningToOffer ?? ''}
                  placeholder="未設定"
                  onChange={(e) => onChange({ 
                    ...data, 
                    adjustedAverages: { 
                      ...data.adjustedAverages, 
                      screeningToOffer: e.target.value === '' ? null : parseInt(e.target.value) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-amber-50"
                />
              </div>
              <div className="col-span-1 text-xs text-gray-400">%</div>
            </div>
            
            {/* 内々定→承諾 */}
            <div className="grid grid-cols-12 gap-3 items-center mb-3">
              <div className="col-span-3 text-sm font-medium text-gray-700">内々定→承諾</div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.industryAverages?.offerToAcceptance ?? 80}
                  onChange={(e) => onChange({ 
                    ...data, 
                    industryAverages: { 
                      ...data.industryAverages, 
                      offerToAcceptance: e.target.value === '' ? '' : (parseInt(e.target.value) || 0) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"
                />
              </div>
              <div className="col-span-4">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value={data.adjustedAverages?.offerToAcceptance ?? ''}
                  placeholder="未設定"
                  onChange={(e) => onChange({ 
                    ...data, 
                    adjustedAverages: { 
                      ...data.adjustedAverages, 
                      offerToAcceptance: e.target.value === '' ? null : parseInt(e.target.value) 
                    } 
                  })}
                  className="w-full px-3 py-2 border border-amber-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 bg-amber-50"
                />
              </div>
              <div className="col-span-1 text-xs text-gray-400">%</div>
            </div>
            
            <div className="text-xs text-gray-500 mt-2 bg-gray-50 p-2 rounded">
              ※ 調整値が入力されている場合、その値が優先的に使用されます
            </div>
          </div>
          
          {/* 計算ロジック表示 */}
          <div className="border-t border-gray-200 pt-5">
            <h4 className="text-sm font-bold text-gray-700 mb-3 flex items-center gap-2">
              <span className="w-1.5 h-1.5 bg-green-500 rounded-full"></span>
              計算ロジック・スコア詳細
            </h4>
            
            <ScoreCalculationDetails data={effectiveData} />
          </div>
        </div>
      )}
      
      {/* メモ */}
      <div className="glass-card rounded-xl p-6">
        <h3 className="text-lg font-bold text-gray-800 mb-4">
          メモ・特記事項
        </h3>
        <textarea
          value={data.notes || ''}
          onChange={(e) => onChange({ ...data, notes: e.target.value })}
          className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition min-h-[100px]"
          placeholder="商談時のメモや特記事項を入力..."
        />
      </div>
    </div>
  );
};

// ========================================
// 診断シート
// ========================================

const DiagnosisSheet = forwardRef(({ data, aiSettings, aiAdvice, onGenerateAI, isGeneratingAI, aiError }, ref) => {
  // タブ状態管理
  const [activeTab, setActiveTab] = useState('result'); // 'result', 'advice', 'simulation'
  const [aiProgress, setAiProgress] = useState(0);
  
  // デバッグ: dataの内容を詳細に確認
  if (DEBUG_MODE) {
    debugLog('==========================================');
    debugLog('=== DiagnosisSheet デバッグ（詳細） ===');
    debugLog('==========================================');
    debugLog('1. data全体のキー:', Object.keys(data));
    debugLog('2. data.companySize:', data.companySize);
    debugLog('3. data.staffAnswers:', JSON.stringify(data.staffAnswers));
    debugLog('4. data.executiveAnswers:', JSON.stringify(data.executiveAnswers));
    debugLog('5. data.studentAnswers:', JSON.stringify(data.studentAnswers));
    debugLog('6. staffAnswersの型:', typeof data.staffAnswers);
    debugLog('7. staffAnswersの回答数:', Object.keys(data.staffAnswers || {}).length);
    if (data.staffAnswers && Object.keys(data.staffAnswers).length > 0) {
      debugLog('8. staffAnswersの中身:', data.staffAnswers);
    }
    debugLog('==========================================');
  }
  
  // 【inventory 10-A #5】effectiveData構築（共通関数を使用）
  // ScoreCalculationDetailsでは個別effective変数を詳細表示に使用する
  const {
    effectiveData,
    calculatedScores,
    finalScore,
    rank,
    diagType,
    typeDef,
    rankDef,
    effectiveMindsetScores,
    effectiveStaffMindsetScores,
    effectiveExecMindsetScores,
    effectiveStaffScores,
    effectiveExecScores,
    effectiveStudentScores,
    effectiveDepthScores
  } = buildEffectiveData(data);
  
  if (DEBUG_MODE) {
    debugLog('9. calculatedScores:', calculatedScores);
    debugLog('10. calculatedScores.staffScores:', calculatedScores.staffScores);
    debugLog('=== デバッグ終了 ===');
  }
  
  const mindsetCoef = calcMindsetCoefficient(effectiveMindsetScores);
  // 内部摩擦ペナルティは無効化
  // const frictionPenalty = calcFrictionPenalty(effectiveStaffScores, effectiveExecScores);
  const marketCoef = calcMarketBlindCoefficient(effectiveStaffScores, effectiveExecScores, effectiveStudentScores);
  
  // 担当者・上層部の両方にマインドセットスコアがあるかチェック
  const hasStaffMindset = Object.values(effectiveStaffMindsetScores || {}).some(v => v !== null && v !== undefined && v > 0);
  const hasExecMindset = Object.values(effectiveExecMindsetScores || {}).some(v => v !== null && v !== undefined && v > 0);
  const hasBothMindsetScores = hasStaffMindset && hasExecMindset;
  
  // ギャップ係数を計算（gapCheck対象質問のみ）
  const gapResult = calcGapCoefficient(data);
  
  // 【強化】係数を計算
  const yieldInvestmentPenalty = calcYieldInvestmentPenalty(data);
  const phaseInvestment = calcPhaseInvestmentRatio(data);
  
  // レーダーチャート用データ
  const axisKeys = Object.keys(EVALUATION_AXES);
  const axisLabels = axisKeys.map(k => EVALUATION_AXES[k].name);
  const staffRadar = axisKeys.map(k => effectiveStaffScores[k] ?? 0);
  const execRadar = axisKeys.map(k => effectiveExecScores[k] ?? 0);
  
  // 担当者と上層部の平均スコアを計算
  const avgRadar = axisKeys.map(k => {
    const staff = effectiveStaffScores[k] ?? 0;
    const exec = effectiveExecScores[k] ?? 0;
    return (staff + exec) / 2;
  });
  
  // フェーズ別スコアを計算（担当者・上層部の平均スコアから PHASE_AXIS_WEIGHT を使用）
  const phaseScores = calcPhaseScores(avgRadar.reduce((obj, val, i) => ({ ...obj, [axisKeys[i]]: val }), {}), effectiveDepthScores);
  const calculatedDepthScores = {
    surface: phaseScores.surface.score,
    middle: phaseScores.middle.score,
    deep: phaseScores.deep.score
  };
  
  // 最低スコアの項目を特定（担当者・上層部の平均から）
  const lowestIdx = avgRadar.indexOf(Math.min(...avgRadar));
  const lowestAxisName = axisLabels[lowestIdx];
  
  return (
    <div ref={ref} className="diagnosis-sheet p-6">
      {/* ヘッダー */}
      <div className="flex justify-between items-start mb-5">
        <div>
          <h1 className="text-2xl font-bold text-gray-800 mb-1">採用ブラックボックス診断</h1>
          <p className="text-sm text-gray-500">Gakusapo</p>
        </div>
        <div className="text-right">
          <div className="text-lg font-bold text-gray-800">{data.companyName || '企業名未設定'}</div>
          <div className="text-xs text-gray-500">
            分析年月日：{data.diagnosisDate ? new Date(data.diagnosisDate).toLocaleDateString('ja-JP', { year: 'numeric', month: '2-digit', day: '2-digit' }).replace(/\//g, '年').replace(/年(\d+)$/, '月$1日') : '---'}
          </div>
          <div className="text-xs text-gray-500">問い合わせ番号：{data.inquiryNo || '-------------'}</div>
        </div>
      </div>
      
      {/* タブコンテンツ */}
      {activeTab === 'result' && (
        <>
          <div className="grid grid-cols-12 gap-4 items-stretch">
            {/* 左カラム: タイプ診断 + 歩留まり実績 */}
            <div className="col-span-5 flex flex-col gap-4">
              {/* ボックス1: 採用タイプ診断 */}
              <div className="section-card p-4" style={{ flex: '4', minHeight: 0, overflow: 'hidden' }}>
                <div className="section-label"><span className="section-label-dot"><svg width="8" height="8" viewBox="0 0 8 8"><circle cx="4" cy="4" r="4" fill="#64748b"/></svg></span><span className="section-label-text">今の御社の採用タイプ</span></div>
                
                {/* ランク */}
                <div className="mb-2">
                  <div className="flex items-baseline gap-2 mb-1">
                    <span className="text-xs text-gray-500">ランク</span>
                    <span 
                      className="text-3xl font-black font-outfit"
                      style={{ color: rankDef.color }}
                    >
                      {rank}
                    </span>
                    <span className="text-sm font-bold" style={{ color: rankDef.color }}>
                      {rankDef.name}
                    </span>
                  </div>
                  <div className="text-xs text-gray-600 leading-relaxed">{rankDef.description}</div>
                </div>
                
                {/* 区切り線 */}
                <div className="border-t border-gray-200 my-2"></div>
                
                {/* 認識ギャップ */}
                <div>
                  <div className="flex items-center gap-2 mb-2">
                    <span className="text-xs font-bold text-gray-700">認識ギャップ</span>
                    {gapResult.gapQuestionCount > 0 && (
                      <span className="text-[9px] text-gray-400">（対象{gapResult.gapQuestionCount}問）</span>
                    )}
                  </div>
                  {gapResult.gapQuestionCount === 0 ? (
                    <div className="text-[10px] text-gray-400 italic">
                      ギャップチェック対象の質問がありません
                    </div>
                  ) : gapResult.companyRate === null || gapResult.studentRate === null ? (
                    <div className="text-[10px] text-gray-400 italic">
                      企業側または学生側の回答がありません
                    </div>
                  ) : (
                    <div>
                      <div className="flex items-center justify-between bg-blue-50 rounded-lg p-2">
                        <div className="text-center" style={{ flex: '1 1 0' }}>
                          <div className="text-[9px] text-gray-500 mb-0.5">企業側</div>
                          <div className="text-[10px] text-gray-600">「知りたい」に応えている率</div>
                          <div className="text-lg font-black text-blue-600">{gapResult.companyRate ?? '-'}%</div>
                        </div>
                        <div className="text-center border-l border-r border-gray-200 mx-1 px-1" style={{ flex: '1 1 0' }}>
                          <div className="text-[9px] text-gray-500 mb-0.5">学生側</div>
                          <div className="text-[10px] text-gray-600">「伝わった」</div>
                          <div className="text-lg font-black text-green-600">{gapResult.studentRate ?? '-'}%</div>
                        </div>
                        <div className="text-center" style={{ flex: '1 1 0' }}>
                          <div className="text-[9px] text-gray-500 mb-0.5">ギャップ</div>
                          <div className="text-[10px] text-gray-600">「知りたいことが伝わった」</div>
                          <div className={`text-lg font-black ${gapResult.combinedRate !== null && gapResult.combinedRate <= 30 ? 'text-red-600' : gapResult.combinedRate !== null && gapResult.combinedRate <= 50 ? 'text-orange-500' : 'text-gray-600'}`}>
                            {gapResult.combinedRate ?? '-'}%
                          </div>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              </div>
              
              {/* ボックス2: 歩留まり実績 */}
              <div className="section-card p-4 flex flex-col" style={{ flex: '6', minHeight: 0, overflow: 'hidden' }}>
                {(() => {
                  // 選択チャネルまたは優先順位1位のチャネルを特定
                  const METHODS = data.methodMaster || DEFAULT_RECRUITMENT_METHODS;
                  const activeChList = Object.entries(data.recruitmentMethods || {})
                    .filter(([_, m]) => m.active)
                    .map(([key, m]) => ({
                      key,
                      name: METHODS[key]?.name || key,
                      category: METHODS[key]?.category || 'ナビサイト',
                      priority: parseInt(m.priority) || 999
                    }))
                    .sort((a, b) => a.priority - b.priority);
                  
                  const selectedYear = data.funnelData?.selectedYear || '27卒';
                  const yearData = data.funnelData?.yearData?.[selectedYear] || {};
                  const cd = yearData.channelData || {};
                  const screeningSteps = yearData.screeningSteps || data.funnelData?.screeningSteps || 1;
                  
                  // 選択チャネルを決定（未選択 or 存在しない場合は優先順位1位）
                  const selKey = data.funnelData?.selectedYieldChannel;
                  const validSel = selKey && activeChList.some(ch => ch.key === selKey);
                  const targetChannel = validSel 
                    ? activeChList.find(ch => ch.key === selKey)
                    : activeChList[0] || null;
                  
                  // チャネルが特定できた場合、そのチャネルの数値でfunnelDataを構築
                  let channelFunnelData = data.funnelData;
                  let channelLabel = '';
                  let channelCategory = '';
                  
                  if (targetChannel && Object.keys(cd).length > 0) {
                    const ck = targetChannel.key;
                    const screeningKey = screeningSteps > 1 
                      ? `screening_0_${ck}` 
                      : `screening_${ck}`;
                    channelFunnelData = {
                      ...data.funnelData,
                      targetAwareness: parseInt(cd[`awareness_${ck}`]) || 0,
                      interest: parseInt(cd[`interest_${ck}`]) || 0,
                      applications: parseInt(cd[`contact_${ck}`]) || 0,
                      screening: parseInt(cd[screeningKey]) || 0,
                      offers: parseInt(cd[`offer_${ck}`]) || 0,
                      acceptance: parseInt(cd[`acceptance_${ck}`]) || 0
                    };
                    channelLabel = targetChannel.name;
                    channelCategory = targetChannel.category;
                  }
                  
                  // チャネルのカテゴリに基づいて手法別業界平均値を算出
                  // チャネル選択時: そのチャネルのカテゴリで業界平均を自動計算
                  // 未選択時: 設定画面で選択されたカテゴリの業界平均を使用
                  const effectiveMethodCategory = channelCategory || data.yieldSettings?.methodCategory || 'ナビサイト';
                  let channelIndustryAverages = data.industryAverages;
                  
                  if (channelCategory && data.yieldSettings?.industry && data.yieldSettings?.companySize) {
                    const methodYieldData = getYieldData(
                      data.yieldSettings?.region || 'aichi',
                      data.yieldSettings.industry,
                      data.yieldSettings.companySize,
                      data.yieldMaster,
                      channelCategory
                    );
                    if (methodYieldData) {
                      channelIndustryAverages = methodYieldData;
                    }
                  }
                  
                  return (
                    <>
                      <div className="section-label flex items-center gap-2 flex-wrap">
                        <span className="section-label-dot"><svg width="8" height="8" viewBox="0 0 8 8"><circle cx="4" cy="4" r="4" fill="#64748b"/></svg></span>
                        <span className="section-label-text">歩留まり実績</span>
                        {channelLabel && (
                          <span className="text-[10px] bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded font-medium">
                            {channelLabel}
                          </span>
                        )}
                        {channelCategory && channelCategory !== (data.yieldSettings?.methodCategory || 'ナビサイト') && (
                          <span className="text-[10px] bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded font-medium">
                            平均値: {channelCategory}
                          </span>
                        )}
                      </div>
                      <div className="flex-1 min-h-0">
                        <YieldPerformanceChart 
                          funnelData={channelFunnelData} 
                          savedIndustryAverages={channelIndustryAverages} 
                          adjustedAverages={data.adjustedAverages}
                          targetHires={data.funnelData?.yearData?.[data.funnelData?.selectedYear || '27卒']?.targetHires || 0}
                        />
                      </div>
                    </>
                  );
                })()}
              </div>
            </div>
            
            {/* 右カラム */}
            <div className="col-span-7" style={{ minHeight: '650px' }}>
          {/* 統合ボックス：説明図 + タイプ名 + 採用基礎力 + 魅力伝達力 */}
          <div className="section-card overflow-hidden h-full flex flex-col">
            {/* 上段：説明図 + タイプ名・深度 (4) */}
            <div className="grid grid-cols-12 border-b border-gray-200" style={{ flex: '4 0 0' }}>
              {/* 説明図 */}
              <div className="col-span-5 pt-4 pl-6 px-3 pb-3 border-r border-gray-200 flex flex-col">
                <div className="section-label"><span className="section-label-dot"><svg width="8" height="8" viewBox="0 0 8 8"><circle cx="4" cy="4" r="4" fill="#64748b"/></svg></span><span className="section-label-text">採用プロセスの解説</span></div>
                <div className="flex-1 flex items-center justify-center">
                  <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI3LjUuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuODrOOCpOODpOODvF8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiCgkgeT0iMHB4IiB2aWV3Qm94PSIwIDAgOTE1IDc2My4yIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA5MTUgNzYzLjI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7b3BhY2l0eTowLjU7ZmlsbDp1cmwoI1NWR0lEXzFfKTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KCS5zdDF7b3BhY2l0eTowLjU7ZmlsbDp1cmwoI1NWR0lEXzAwMDAwMTM4NTM2MjY5NTg4NDQ2MzQxNTEwMDAwMDE3OTAzOTEwODg5Mjg1ODYwNzY1Xyk7ZW5hYmxlLWJhY2tncm91bmQ6bmV3ICAgIDt9Cgkuc3Qye29wYWNpdHk6MC41O2ZpbGw6dXJsKCNTVkdJRF8wMDAwMDA0OTIwMTM4Mzk3NDMyMzIzMzIzMDAwMDAwMTU3MjU3MzExNDUyODMyNzM1M18pO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7fQoJLnN0M3tlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgO30KCS5zdDR7ZmlsbDojMjMxODE1O30KCS5zdDV7ZmlsbDojNzlBRUQ1O30KCS5zdDZ7ZmlsbDojQTdEQUU3O30KCS5zdDd7ZmlsbDojRkZGRkZGO30KCS5zdDh7ZmlsbDojRURFREVDO30KCS5zdDl7ZmlsbDojREVFNkYwO30KCS5zdDEwe2ZpbGw6I0VBNUY5Mzt9Cgkuc3QxMXtmaWxsOiM0RTY0OUI7fQoJLnN0MTJ7ZmlsbDojRUJBN0JEO30KCS5zdDEze2ZpbGw6I0Q2RTRFRDt9Cgkuc3QxNHtmaWxsOiNBNTMzM0M7fQoJLnN0MTV7ZmlsbDojQjZDNEU0O30KCS5zdDE2e2ZpbGw6IzQ2NTM5MTt9Cgkuc3QxN3tmaWxsOiM2MDdDQkQ7fQoJLnN0MTh7ZmlsbDojM0E0Mzc2O30KCS5zdDE5e2ZpbGw6I0EzQkZENDt9Cgkuc3QyMHtmaWxsOiNEMTQxNzc7fQoJLnN0MjF7ZmlsbDojMjIyOTQxO30KCS5zdDIye2ZpbGw6IzFFMjY0Qzt9Cgkuc3QyM3tmaWxsOiMyQTMzNUE7fQoJLnN0MjR7ZmlsbDojOTJDNEU5O30KCS5zdDI1e2ZpbGw6IzU1ODZBOTt9Cgkuc3QyNntmaWxsOiNGQkZDRkU7fQoJLnN0Mjd7ZmlsbDojRDREOEREO30KCS5zdDI4e2ZpbGw6I0U0OTdCMDt9Cgkuc3QyOXtmaWxsOiMzMTNBNUI7fQoJLnN0MzB7ZmlsbDojMkU0MzYyO30KPC9zdHlsZT4KPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8xXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSIxNDguOSIgeTE9Ii0yNTQuMDgiIHgyPSI5MTUiIHkyPSItMjU0LjA4IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAgLTE0Ni44OCkiPgoJPHN0b3AgIG9mZnNldD0iMC41OTk2IiBzdHlsZT0ic3RvcC1jb2xvcjojMDA5M0QzIi8+Cgk8c3RvcCAgb2Zmc2V0PSIwLjk0MTIiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkZGRkYiLz4KCTxzdG9wICBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNGOEZCRkQiLz4KPC9saW5lYXJHcmFkaWVudD4KPHBvbHlnb24gY2xhc3M9InN0MCIgcG9pbnRzPSI5MTUsMjE0LjQgMjE4LjMsMjE0LjQgMTQ4LjksMCA5MTUsMCAiLz4KPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8wMDAwMDAwMDkyNjUwMTk0MzM2NDk2ODY4MDAwMDAwNjI3MjEwNjY2MDUwMTMwNTAxMl8iIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iMjIzLjUiIHkxPSItNDg0LjI4IiB4Mj0iOTE1IiB5Mj0iLTQ4NC4yOCIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIC0xNDYuODgpIj4KCTxzdG9wICBvZmZzZXQ9IjAuNTgzOCIgc3R5bGU9InN0b3AtY29sb3I6Izc5ODdDMiIvPgoJPHN0b3AgIG9mZnNldD0iMC45MjExIiBzdHlsZT0ic3RvcC1jb2xvcjojRkZGRkZGIi8+CjwvbGluZWFyR3JhZGllbnQ+Cjxwb2x5Z29uIHN0eWxlPSJvcGFjaXR5OjAuNTtmaWxsOnVybCgjU1ZHSURfMDAwMDAwMDA5MjY1MDE5NDMzNjQ5Njg2ODAwMDAwMDYyNzIxMDY2NjA1MDEzMDUwMTJfKTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgOyIgcG9pbnRzPSIKCTkxNSw0NDQuNiAyOTIuNSw0NDQuNiAyMjMuNSwyMzAuMiA5MTUsMjMwLjIgIi8+CjxsaW5lYXJHcmFkaWVudCBpZD0iU1ZHSURfMDAwMDAwNzA4Mzc4MjQ2MDU4MTUzMzIzNzAwMDAwMDkzNjAwNDgzNDIwMjIwNTczNzNfIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjI5Ny42IiB5MT0iLTcxNC40OCIgeDI9IjkxNSIgeTI9Ii03MTQuNDgiIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCAtMTQ2Ljg4KSI+Cgk8c3RvcCAgb2Zmc2V0PSIwLjU0MjEiIHN0eWxlPSJzdG9wLWNvbG9yOiNBNDkwQzEiLz4KCTxzdG9wICBvZmZzZXQ9IjAuOTMyIiBzdHlsZT0ic3RvcC1jb2xvcjojRkZGRkZGIi8+CjwvbGluZWFyR3JhZGllbnQ+Cjxwb2x5Z29uIHN0eWxlPSJvcGFjaXR5OjAuNTtmaWxsOnVybCgjU1ZHSURfMDAwMDAwNzA4Mzc4MjQ2MDU4MTUzMzIzNzAwMDAwMDkzNjAwNDgzNDIwMjIwNTczNzNfKTtlbmFibGUtYmFja2dyb3VuZDpuZXcgICAgOyIgcG9pbnRzPSIKCTkxNSw2NzQuOCAzNjYuOSw2NzQuOCAyOTcuNiw0NjAuNCA5MTUsNDYwLjQgIi8+CjxnIGNsYXNzPSJzdDMiPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQwNS44LDUwMi41YzAsMTAuOS04LjEsMTkuNy0xOC4xLDE5LjdzLTE4LjEtOC44LTE4LjEtMTkuN2MwLTEwLjgsOC4xLTE5LjcsMTguMS0xOS43CgkJUzQwNS44LDQ5MS42LDQwNS44LDUwMi41eiBNMzcwLjksNTAyLjVjMCwxMC4xLDcuNSwxOC4yLDE2LjcsMTguMnMxNi43LTguMSwxNi43LTE4LjJjMC0xMC03LjUtMTguMi0xNi43LTE4LjIKCQlTMzcwLjksNDkyLjUsMzcwLjksNTAyLjV6IE0zODMuNSw1MDcuOGMwLjIsMC45LDAuMywxLjQsMC44LDJjMC44LDAuOSwyLDEuNCwzLjMsMS40YzIuMiwwLDMuNi0xLjMsMy42LTMuMmMwLTIuMS0xLjMtMy4xLTQtMy4xCgkJYy0xLjQsMC0yLjYsMC00LDAuMnYtNS44YzAuOSwwLjEsMi4xLDAuMiwzLjEsMC4yYzEuNSwwLDIuNi0wLjIsMy4zLTAuN2MwLjctMC41LDEuMS0xLjMsMS4xLTIuM2MwLTEuOC0xLjEtMi44LTMuMS0yLjgKCQljLTIuMSwwLTMuMSwwLjgtMy40LDIuOWwtNi44LTFjMC42LTIsMS0yLjksMS45LTRjMS44LTIuMyw0LjgtMy41LDguNy0zLjVjNCwwLDcuMiwxLjUsOC43LDRjMC42LDEsMC44LDIuMSwwLjgsMy41CgkJYzAsMi4yLTAuOCw0LTIuMiw1LjFjLTAuOSwwLjctMS44LDEuMS0zLjcsMS41YzIuMywwLjMsMy40LDAuNyw0LjUsMS43YzEuMywxLjIsMiwyLjksMiw1YzAsMi0wLjYsMy43LTEuOCw1CgkJYy0xLjgsMS45LTQuOCwyLjktOC41LDIuOWMtNC4yLDAtNy4yLTEuMi05LTMuNmMtMC45LTEuMi0xLjMtMi4xLTEuOS00LjNMMzgzLjUsNTA3Ljh6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDEwLjQsNDkzLjRjMi44LDEuNyw0LjMsMi43LDcsNS4xbC0zLjMsNS4yYy0yLjgtMi41LTQuMi0zLjYtNy4xLTUuNUw0MTAuNCw0OTMuNHogTTQxNi43LDUwOAoJCWMtMS4yLDUtMS45LDcuMS0zLjUsMTFjLTAuNiwxLjMtMC42LDEuMy0wLjgsMS43Yy0wLjIsMC40LTAuMiwwLjQtMC40LDAuOWwtNC45LTQuN2MwLjUtMC42LDAuOS0xLjMsMS40LTIuMwoJCWMxLjUtMywyLjQtNS44LDMuNS0xMC4zTDQxNi43LDUwOHogTTQyMi41LDQ4OS44djRINDE3YzAuMi0wLjksMC4yLTEuOCwwLjItM3YtMS4zbC0yLjUsMy43Yy0yLjUtMi41LTMuOC0zLjctNi42LTUuNmwzLjYtNC42CgkJYzIuMiwxLjUsMy43LDIuNyw1LjUsNC4zVjQ4N2MwLTEuMiwwLTIuMS0wLjItM2MwLjIsMCwwLjQsMCwwLjUsMGMwLjksMC4xLDEuNywwLjEsMy41LDAuMWgxNy40YzIuMSwwLDMuMSwwLDQuMS0wLjIKCQljLTAuMSwwLjktMC4xLDEuNy0wLjEsM3YzYzAsMS4xLDAsMi4xLDAuMiwzSDQzN3YtMy4yaC0xLjV2NWMwLDAuNywwLjIsMC45LDEuMiwwLjljMS4xLDAsMS4zLTAuMywxLjMtMi4xYzAsMCwwLTAuMiwwLTAuNAoJCWMxLjksMC43LDIuNywwLjksNC44LDEuM2MtMC4yLDUuNy0wLjksNi4zLTYuNSw2LjNjLTIuMSwwLTMuMS0wLjEtNC0wLjRjMCwwLjUsMCwwLjcsMCwxLjN2MC45aDYuMWMxLjMsMCwyLjgtMC4xLDQuMy0wLjJ2NgoJCWMtMS40LTAuMi0yLjktMC4yLTQuMy0wLjJoLTRjMi4yLDIuNyw1LjYsNC45LDkuMyw2LjFjLTEuMSwyLTEuNiwzLjMtMi4zLDYuM2MtMy45LTEuOS02LjktNC40LTkuMS03LjhjMCwwLjksMC4xLDEuNywwLjEsMi4ydjIuNgoJCWMwLDEuOSwwLDIuOSwwLjIsNC4xaC01LjljMC4yLTEuMiwwLjItMi4yLDAuMi00LjFWNTE1YzAtMC42LDAtMS4yLDAuMS0yLjJjLTIuNiwzLjctNC44LDUuOC04LjUsNy44Yy0xLTIuNC0xLjYtMy42LTMuMS01LjUKCQljMi41LTEsNC4xLTIsNi0zLjdjMS4zLTEuMSwyLTEuOSwzLTMuMmgtMy4xYy0xLjUsMC0yLjksMC4xLTQuMywwLjJ2LTZjMS4zLDAuMSwyLjcsMC4yLDQuMywwLjJoNS42di0wLjljMC0xLjIsMC0xLjktMC4xLTIuNWg0LjMKCQljLTAuMi0wLjUtMC4zLTAuOC0wLjMtMS41di04aC0xLjRjLTAuMSwzLjEtMC41LDUuMS0xLjQsNi44Yy0xLjMsMi40LTMuNiw0LjItNy4zLDUuOWMtMC45LTIuNC0xLjYtMy42LTMtNS4zCgkJYzIuNC0wLjcsNC0xLjUsNS4xLTIuNmMxLjItMS4yLDEuNi0yLjQsMS43LTQuOGgtMlY0ODkuOHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00NTguOCw0OTUuNGMtMC4zLTAuNy0wLjQtMC45LTAuNy0xLjRINDU0Yy0wLjIsMTAuNC0wLjUsMTQuOC0xLjUsMTkuN2MtMC43LDMuNS0xLjUsNS45LTIuOSw4LjMKCQljLTEuNi0yLjUtMi43LTMuOC00LjYtNS41YzIuOC00LjcsMy42LTEwLjcsMy42LTI4YzAtMi0wLjEtMy4yLTAuMi00LjdjMS41LDAuMiwzLDAuMiw1LjQsMC4yaDIxLjZjMiwwLDMuNSwwLDQuOC0wLjIKCQljLTAuMSwxLjMtMC4yLDItMC4yLDMuNnYzYzAsMS43LDAsMi42LDAuMiwzLjdjLTEuMi0wLjEtMi43LTAuMS00LjUtMC4xaC0wLjNjLTAuMywwLjYtMC40LDAuNy0wLjcsMS40aDEuOWMxLjQsMCwyLjIsMCwyLjktMC4xCgkJYy0wLjEsMC45LTAuMSwxLjgtMC4xLDN2Ni4zYzAsMS40LDAsMi4xLDAuMSwzYy0wLjktMC4xLTEuNy0wLjEtMi45LTAuMWgtMTguMWMtMi40LDAtMi42LDAtMy40LDAuMWMwLjEtMS41LDAuMS0xLjUsMC4xLTMuNXYtNS41CgkJYzAtMS44LDAtMi4zLTAuMS0zLjJjMC45LDAuMSwxLjQsMC4xLDMuMiwwLjFMNDU4LjgsNDk1LjRMNDU4LjgsNDk1LjR6IE00NzQuNCw0OTB2LTEuM2gtMjAuM3YxLjNINDc0LjR6IE00NzMuOSw1MDguNAoJCWMyLjMsMCwyLjksMCw0LjEtMC4xYy0wLjIsMS4xLTAuMiwyLTAuMiwzLjd2NmMwLDEuNywwLDIuNSwwLjIsMy44aC01Ljd2LTEuMmgtMTF2MS4yaC01LjZjMC4xLTEuMiwwLjEtMS44LDAuMS00di01LjYKCQljMC0yLjIsMC0yLjctMC4yLTMuOWMxLDAuMSwxLjgsMC4xLDQsMC4xTDQ3My45LDUwOC40TDQ3My45LDUwOC40eiBNNDYwLjUsNDk5LjloMy43di0xLjJoLTMuN1Y0OTkuOXogTTQ2MC41LDUwNC4xaDMuN3YtMS4zaC0zLjcKCQlWNTA0LjF6IE00NjEuMyw1MTNoMTF2LTEuMmgtMTFWNTEzeiBNNDYxLjMsNTE3aDExdi0xLjJoLTExVjUxN3ogTTQ2OC42LDQ5NS40YzAuMy0wLjUsMC40LTAuNywwLjYtMS40aC01CgkJYzAuMywwLjYsMC40LDAuNywwLjcsMS40SDQ2OC42eiBNNDY5LjUsNDk5LjloNC4ydi0xLjJoLTQuMlY0OTkuOXogTTQ2OS41LDUwNC4xaDQuMnYtMS4zaC00LjJWNTA0LjF6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDk5LjEsNDg2LjZjMS42LDAsMi40LDAsMy4zLTAuMnY2Yy0wLjUtMC4xLTAuOS0wLjEtMS43LTAuMmMtMC4zLDEuNi0wLjYsMy0xLjEsNC40YzEuNiwwLDIuMywwLDMtMC4ydjYuMgoJCWMtMC44LTAuMS0xLjctMC4yLTIuNy0wLjJoLTEyLjZjLTIsMC0yLjksMC00LDAuMnYtNi4zYzEsMC4yLDEuNiwwLjIsMy43LDAuMmMtMC4yLTEuMy0wLjctMy4zLTEtNC40Yy0wLjksMC0xLjQsMC4xLTIsMC4ydi02LjEKCQljMC45LDAuMiwxLjcsMC4yLDMuNiwwLjJoMy4xdi0wLjdjMC0xLDAtMS44LTAuMi0yLjdoNi4yYy0wLjIsMC44LTAuMiwxLjYtMC4yLDIuNnYwLjhoMi42VjQ4Ni42eiBNNDkwLjksNTIxLjhoLTUuNwoJCWMwLjItMS4zLDAuMi0yLjQsMC4yLTR2LTEwYzAtMS40LDAtMi41LTAuMi0zLjNjMC45LDAuMSwxLjcsMC4xLDMuMSwwLjFoMTAuNWMxLjcsMCwyLjIsMCwyLjctMC4xYy0wLjEsMC42LTAuMSwxLjItMC4xLDIuNnYxMS43CgkJYzAsMS4zLDAsMiwwLjIsMi45aC01Ljd2LTIuMWgtNVY1MjEuOHogTTQ5MC45LDUxNGg1di0zLjhoLTVWNTE0eiBNNDk0LjIsNDk2LjhjMC40LTEuMiwwLjYtMi40LDAuOS00LjRoLTMuNQoJCWMwLjUsMS42LDAuNywyLjgsMC45LDQuNEg0OTQuMnogTTUxOS4yLDQ4OGMtMC4zLDAuNi0wLjMsMC42LTEuMiwzLjVjLTAuNywyLjItMS44LDUuMS0zLDcuOGMxLjcsMi41LDIuNCwzLjgsMy4xLDUuOAoJCWMwLjYsMS43LDAuOSwzLjUsMC45LDUuMmMwLDIuOC0xLjEsNC44LTMsNS43Yy0xLDAuNS0yLjQsMC43LTQuMSwwLjdjLTAuMiwwLTAuNiwwLTEuMiwwYy0wLjEtMy4xLTAuMy00LjItMS4zLTYuMgoJCWMwLjksMC4xLDEuMiwwLjEsMS42LDAuMWMxLjYsMCwyLjItMC40LDIuMi0xLjZjMC0xLjQtMC4zLTMtMC45LTQuNWMtMC42LTEuNi0xLjItMi43LTIuNy00LjZjMS41LTMuMywyLjQtNi4yLDMuMS05LjdoLTMuM3YyNi43CgkJYzAsMi40LDAuMSwzLjgsMC4yLDVoLTZjMC4xLTEuNiwwLjItMy4yLDAuMi00Ljh2LTI5LjhjMC0xLjMsMC0yLjEtMC4xLTMuMWMxLjEsMC4xLDEuOSwwLjIsMy4xLDAuMmg3YzEuNiwwLDIuMiwwLDMuMS0wLjIKCQlMNTE5LjIsNDg4eiIvPgo8L2c+CjxnIGNsYXNzPSJzdDMiPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTMyMi4xLDI3MS41YzAsMTAuOS04LjEsMTkuNy0xOC4xLDE5LjdzLTE4LjEtOC44LTE4LjEtMTkuN2MwLTEwLjgsOC4xLTE5LjcsMTguMS0xOS43CgkJUzMyMi4xLDI2MC42LDMyMi4xLDI3MS41eiBNMjg3LjIsMjcxLjVjMCwxMC4xLDcuNSwxOC4yLDE2LjcsMTguMnMxNi43LTguMSwxNi43LTE4LjJjMC0xMC03LjUtMTguMi0xNi43LTE4LjIKCQlDMjk0LjcsMjUzLjQsMjg3LjIsMjYxLjUsMjg3LjIsMjcxLjV6IE0yOTguMywyODUuMWMtMi42LDAtMy4zLDAtNC42LDAuMWMwLjMtMi43LDAuOS00LjgsMi4xLTcuMWMxLjItMi4zLDMuMS00LjYsNS4xLTYuMmw0LTMuMgoJCWMxLjctMS40LDIuMi0yLjEsMi4yLTMuMmMwLTEuNi0xLjItMi42LTMtMi42Yy0xLjMsMC0yLjQsMC42LTMsMS42Yy0wLjQsMC43LTAuNiwxLjMtMC44LDIuNmwtNi43LTAuN2MwLjUtMywxLjEtNC40LDIuMi01LjkKCQljMS44LTIuMyw0LjUtMy40LDguMS0zLjRjNiwwLDkuOCwzLjEsOS44LDguMWMwLDIuNS0xLDQuOC0yLjgsNi40Yy0wLjgsMC42LTAuOSwwLjgtNCwzYy0yLjQsMS44LTMuNiwzLTQuMiw0LjVoNi42CgkJYzIuMiwwLDMuNCwwLDQuOC0wLjJ2Ni40Yy0xLjgtMC4yLTMuNC0wLjItNS4xLTAuMkwyOTguMywyODUuMUwyOTguMywyODUuMXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0zMzguNywyNTYuOWMwLTIuMywwLTMuMi0wLjItNC42aDYuNGMtMC4yLDEuMy0wLjIsMi4zLTAuMiw0LjR2MS45aDkuN2MyLDAsMi44LDAsNC0wLjIKCQljLTAuMSwxLjMtMC4yLDIuMS0wLjIsMy45djEzLjZjMCwyLjMsMCwzLjIsMC4yLDQuNWgtNnYtMi4xaC03LjZ2Ny4yYzAsMi42LDAuMSw0LDAuMyw1LjVoLTYuNWMwLjItMS43LDAuMy0zLDAuMy01LjV2LTcuMmgtNy4zCgkJdjIuMWgtNmMwLjItMS4yLDAuMi0yLjUsMC4yLTQuNXYtMTMuNmMwLTEuNywwLTIuNy0wLjItMy45YzEuNCwwLjEsMi4yLDAuMiwzLjksMC4yaDkuNHYtMS43SDMzOC43eiBNMzMxLjQsMjY0LjV2Ny43aDcuM3YtNy43CgkJSDMzMS40eiBNMzUyLjMsMjcyLjJ2LTcuN2gtNy42djcuN0gzNTIuM3oiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0zNzUuMSwyNjQuNGMtMC4zLTAuNy0wLjQtMC45LTAuNy0xLjRoLTQuMWMtMC4yLDEwLjQtMC41LDE0LjgtMS41LDE5LjdjLTAuNywzLjUtMS41LDUuOS0yLjksOC4zCgkJYy0xLjYtMi41LTIuNy0zLjgtNC42LTUuNWMyLjgtNC43LDMuNi0xMC43LDMuNi0yOGMwLTItMC4xLTMuMi0wLjItNC43YzEuNSwwLjIsMywwLjIsNS40LDAuMmgyMS42YzIsMCwzLjUsMCw0LjgtMC4yCgkJYy0wLjEsMS4zLTAuMiwyLTAuMiwzLjZ2M2MwLDEuNywwLDIuNiwwLjIsMy43Yy0xLjItMC4xLTIuNy0wLjEtNC41LTAuMWgtMC4zYy0wLjMsMC42LTAuNCwwLjctMC43LDEuNGgxLjljMS40LDAsMi4yLDAsMi45LTAuMQoJCWMtMC4xLDAuOS0wLjEsMS44LTAuMSwzdjYuM2MwLDEuNCwwLDIuMSwwLjEsM2MtMC45LTAuMS0xLjctMC4xLTIuOS0wLjFoLTE4LjFjLTIuNCwwLTIuNiwwLTMuNCwwLjFjMC4xLTEuNSwwLjEtMS41LDAuMS0zLjV2LTUuNQoJCWMwLTEuOCwwLTIuMy0wLjEtMy4yYzAuOSwwLjEsMS40LDAuMSwzLjMsMC4xTDM3NS4xLDI2NC40TDM3NS4xLDI2NC40eiBNMzkwLjcsMjU5di0xLjNoLTIwLjN2MS4zSDM5MC43eiBNMzkwLjIsMjc3LjUKCQljMi4zLDAsMi45LDAsNC4xLTAuMWMtMC4yLDEuMS0wLjIsMi0wLjIsMy43djZjMCwxLjcsMCwyLjUsMC4yLDMuOGgtNS43di0xLjJoLTExdjEuMkgzNzJjMC4xLTEuMiwwLjEtMS44LDAuMS00di01LjYKCQljMC0yLjIsMC0yLjctMC4yLTMuOWMxLDAuMSwxLjgsMC4xLDQsMC4xSDM5MC4yeiBNMzc2LjgsMjY5aDMuN3YtMS4yaC0zLjdWMjY5eiBNMzc2LjgsMjczLjJoMy43di0xLjNoLTMuN1YyNzMuMnogTTM3Ny42LDI4MmgxMQoJCXYtMS4yaC0xMVYyODJ6IE0zNzcuNiwyODZoMTF2LTEuMmgtMTFWMjg2eiBNMzg0LjksMjY0LjRjMC4zLTAuNSwwLjQtMC43LDAuNi0xLjRoLTVjMC4zLDAuNiwwLjQsMC43LDAuNywxLjRIMzg0Ljl6IE0zODUuOCwyNjkKCQloNC4ydi0xLjJoLTQuMlYyNjl6IE0zODUuOCwyNzMuMmg0LjJ2LTEuM2gtNC4yVjI3My4yeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQxNS40LDI1NS43YzEuNiwwLDIuNCwwLDMuMy0wLjJ2NmMtMC41LTAuMS0wLjktMC4xLTEuNy0wLjJjLTAuMywxLjYtMC42LDMtMS4xLDQuNGMxLjYsMCwyLjMsMCwzLTAuMnY2LjIKCQljLTAuOC0wLjEtMS43LTAuMi0yLjctMC4yaC0xMi42Yy0yLDAtMi45LDAtNCwwLjJ2LTYuM2MxLDAuMiwxLjYsMC4yLDMuNywwLjJjLTAuMi0xLjMtMC43LTMuMy0xLTQuNGMtMC45LDAtMS40LDAuMS0yLDAuMnYtNi4xCgkJYzAuOSwwLjIsMS43LDAuMiwzLjYsMC4yaDMuMXYtMC43YzAtMSwwLTEuOC0wLjItMi43aDYuMmMtMC4yLDAuOC0wLjIsMS42LTAuMiwyLjZ2MC44aDIuNlYyNTUuN3ogTTQwNy4yLDI5MC44aC01LjcKCQljMC4yLTEuMywwLjItMi40LDAuMi00di0xMGMwLTEuNCwwLTIuNS0wLjItMy4zYzAuOSwwLjEsMS43LDAuMSwzLjEsMC4xaDEwLjVjMS43LDAsMi4yLDAsMi43LTAuMWMtMC4xLDAuNi0wLjEsMS4yLTAuMSwyLjZ2MTEuNwoJCWMwLDEuMywwLDIsMC4yLDIuOWgtNS43di0yLjFoLTVWMjkwLjh6IE00MDcuMiwyODMuMWg1di0zLjhoLTVWMjgzLjF6IE00MTAuNSwyNjUuOGMwLjQtMS4yLDAuNi0yLjQsMC45LTQuNEg0MDgKCQljMC41LDEuNiwwLjcsMi44LDAuOSw0LjRINDEwLjV6IE00MzUuNSwyNTcuMWMtMC4zLDAuNi0wLjMsMC42LTEuMiwzLjVjLTAuNywyLjItMS44LDUuMS0zLDcuOGMxLjcsMi41LDIuNCwzLjgsMy4xLDUuOAoJCWMwLjYsMS43LDAuOSwzLjUsMC45LDUuMmMwLDIuOC0xLjEsNC44LTMsNS43Yy0xLDAuNS0yLjQsMC43LTQuMSwwLjdjLTAuMiwwLTAuNiwwLTEuMiwwYy0wLjEtMy4xLTAuMy00LjItMS4zLTYuMgoJCWMwLjksMC4xLDEuMiwwLjEsMS42LDAuMWMxLjYsMCwyLjItMC40LDIuMi0xLjZjMC0xLjQtMC4zLTMtMC45LTQuNWMtMC42LTEuNi0xLjItMi43LTIuNy00LjZjMS41LTMuMywyLjQtNi4yLDMuMS05LjdoLTMuM1YyODYKCQljMCwyLjQsMC4xLDMuOCwwLjIsNWgtNmMwLjEtMS42LDAuMi0zLjIsMC4yLTQuOHYtMjkuOGMwLTEuMywwLTIuMS0wLjEtMy4xYzEuMSwwLjEsMS45LDAuMiwzLjEsMC4yaDdjMS42LDAsMi4yLDAsMy4xLTAuMgoJCUw0MzUuNSwyNTcuMXoiLz4KPC9nPgo8ZyBjbGFzcz0ic3QzIj4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0yMzguNSw0MC44YzAsMTAuOS04LjEsMTkuNy0xOC4xLDE5LjdzLTE4LjEtOC44LTE4LjEtMTkuN2MwLTEwLjgsOC4xLTE5LjcsMTguMS0xOS43UzIzOC41LDMwLDIzOC41LDQwLjh6CgkJIE0yMDMuNyw0MC44YzAsMTAuMSw3LjUsMTguMiwxNi43LDE4LjJzMTYuNy04LjEsMTYuNy0xOC4yYzAtMTAtNy41LTE4LjItMTYuNy0xOC4yQzIxMS4xLDIyLjcsMjAzLjcsMzAuOCwyMDMuNyw0MC44egoJCSBNMjEzLjEsMjcuM2MxLjEsMC4yLDIuMSwwLjIsMy43LDAuMmgzLjljMiwwLDIuNiwwLDMuOC0wLjJjLTAuMiwxLjUtMC4yLDMuMS0wLjIsNS4zdjE3LjJjMCwyLjEsMC4xLDMuNSwwLjIsNWgtNi44CgkJYzAuMi0xLjYsMC4yLTIuOSwwLjItNVYzMy40aC0xLjFjLTEuMiwwLTIuNiwwLjEtMy43LDAuMkwyMTMuMSwyNy4zTDIxMy4xLDI3LjN6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMjYzLjMsNTcuMWMtNC41LDEuMS04LjcsMS45LTE0LjksMi44Yy0wLjcsMC4xLTEuMiwwLjItMS44LDAuM2wtMS4yLTYuMmMxLjUsMCwxLjktMC4xLDQuOS0wLjRWNTAKCQljLTIuMywxLjUtNC4yLDIuNS03LjIsMy44Yy0xLjEtMi44LTEuNS0zLjctMy01LjhjMy44LTEsNy45LTMsMTAuNi01LjJoLTUuMmMtMS44LDAtMy4zLDAuMS00LjYsMC4ydi01LjhjMS4yLDAuMiwyLjIsMC4yLDQuNSwwLjIKCQloOS43di0xLjZoLTdjLTIuMiwwLTMuMSwwLTQuNCwwLjJ2LTVjMS4xLDAuMSwyLjIsMC4yLDQuNCwwLjJoN3YtMS42aC04LjVjLTIuMiwwLTMuNCwwLTQuNCwwLjJ2LTUuNmMxLjIsMC4yLDIuOCwwLjIsNC43LDAuMmg4LjIKCQljMC0xLjQtMC4xLTEuOC0wLjItMi44aDYuM2MtMC4yLDAuOS0wLjIsMS41LTAuMiwyLjhoOC43YzIuMSwwLDMuNi0wLjEsNC44LTAuMnY1LjZjLTEtMC4yLTIuMi0wLjItNC40LTAuMkgyNjF2MS42aDcuNgoJCWMyLjMsMCwzLjMsMCw0LjQtMC4ydjVjLTEuMy0wLjEtMi4yLTAuMi00LjQtMC4ySDI2MXYxLjZoMTBjMi4zLDAsMy40LDAsNC41LTAuMlY0M2MtMS4zLTAuMi0yLjgtMC4yLTQuNS0wLjJoLTEuNWw0LjksMy4yCgkJYy0wLjIsMC4zLTAuMiwwLjMtMC45LDFjLTAuOCwwLjktMi4zLDIuNC0zLjYsMy42YzIuMiwxLjYsMy44LDIuNCw2LjgsMy4zYy0xLjQsMS45LTIsMy0zLjIsNmMtNC41LTIuMS03LjMtNC4xLTEwLjEtNy40CgkJTDI2My4zLDU3LjFMMjYzLjMsNTcuMXogTTI1NS45LDUyLjhjMy4zLTAuNiwzLjYtMC43LDYuNi0xLjRjLTEuOC0yLjQtMy4zLTUuNC00LjMtOC40Yy0wLjcsMC44LTEuMSwxLjMtMi4zLDIuNEwyNTUuOSw1Mi44CgkJTDI1NS45LDUyLjh6IE0yNjMuNyw0Mi43YzAuNiwxLjMsMS4yLDIuNCwyLjEsMy44YzEuNC0xLjMsMi45LTIuOSwzLjQtMy44SDI2My43eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTI5MS42LDMzLjdjLTAuMy0wLjctMC40LTAuOS0wLjctMS40aC00LjFjLTAuMiwxMC40LTAuNSwxNC44LTEuNSwxOS43Yy0wLjcsMy41LTEuNSw1LjktMi45LDguMwoJCWMtMS42LTIuNS0yLjctMy44LTQuNi01LjVjMi44LTQuNywzLjYtMTAuNywzLjYtMjhjMC0yLTAuMS0zLjItMC4yLTQuN2MxLjUsMC4yLDMsMC4yLDUuNCwwLjJIMzA4YzIsMCwzLjUsMCw0LjgtMC4yCgkJYy0wLjEsMS4zLTAuMiwyLTAuMiwzLjZ2M2MwLDEuNywwLDIuNiwwLjIsMy43Yy0xLjItMC4xLTIuNy0wLjEtNC41LTAuMUgzMDhjLTAuMywwLjYtMC40LDAuNy0wLjcsMS40aDEuOWMxLjQsMCwyLjIsMCwyLjktMC4xCgkJYy0wLjEsMC45LTAuMSwxLjgtMC4xLDN2Ni4zYzAsMS40LDAsMi4xLDAuMSwzYy0wLjktMC4xLTEuNy0wLjEtMi45LTAuMUgyOTFjLTIuNCwwLTIuNiwwLTMuNCwwLjFjMC4xLTEuNSwwLjEtMS41LDAuMS0zLjV2LTUuNQoJCWMwLTEuOCwwLTIuMy0wLjEtMy4yYzAuOSwwLjEsMS40LDAuMSwzLjMsMC4xTDI5MS42LDMzLjdMMjkxLjYsMzMuN3ogTTMwNy4xLDI4LjRWMjdoLTIwLjN2MS4zaDIwLjNWMjguNHogTTMwNi43LDQ2LjgKCQljMi4zLDAsMi45LDAsNC4xLTAuMWMtMC4yLDEuMS0wLjIsMi0wLjIsMy43djZjMCwxLjcsMCwyLjUsMC4yLDMuOGgtNS43VjU5aC0xMXYxLjJoLTUuNmMwLjEtMS4yLDAuMS0xLjgsMC4xLTR2LTUuNgoJCWMwLTIuMiwwLTIuNy0wLjItMy45YzEsMC4xLDEuOCwwLjEsNCwwLjFIMzA2Ljd6IE0yOTMuMiwzOC4zaDMuN3YtMS4yaC0zLjdWMzguM3ogTTI5My4yLDQyLjVoMy43di0xLjNoLTMuN1Y0Mi41eiBNMjk0LjEsNTEuNGgxMQoJCXYtMS4yaC0xMVY1MS40eiBNMjk0LjEsNTUuM2gxMXYtMS4yaC0xMVY1NS4zeiBNMzAxLjMsMzMuN2MwLjMtMC41LDAuNC0wLjcsMC42LTEuNGgtNWMwLjMsMC42LDAuNCwwLjcsMC43LDEuNEgzMDEuM3oKCQkgTTMwMi4yLDM4LjNoNC4ydi0xLjJoLTQuMlYzOC4zeiBNMzAyLjIsNDIuNWg0LjJ2LTEuM2gtNC4yVjQyLjV6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMzMxLjksMjVjMS42LDAsMi40LDAsMy4zLTAuMnY2Yy0wLjUtMC4xLTAuOS0wLjEtMS43LTAuMmMtMC4zLDEuNi0wLjYsMy0xLjEsNC40YzEuNiwwLDIuMywwLDMtMC4yVjQxCgkJYy0wLjgtMC4xLTEuNy0wLjItMi43LTAuMmgtMTIuNmMtMiwwLTIuOSwwLTQsMC4ydi02LjNjMSwwLjIsMS42LDAuMiwzLjcsMC4yYy0wLjItMS4zLTAuNy0zLjMtMS00LjRjLTAuOSwwLTEuNCwwLjEtMiwwLjJ2LTYuMQoJCWMwLjksMC4yLDEuNywwLjIsMy42LDAuMmgzLjF2LTAuN2MwLTEsMC0xLjgtMC4yLTIuN2g2LjJjLTAuMiwwLjgtMC4yLDEuNi0wLjIsMi42djFIMzMxLjl6IE0zMjMuNiw2MC4xaC01LjcKCQljMC4yLTEuMywwLjItMi40LDAuMi00di0xMGMwLTEuNCwwLTIuNS0wLjItMy4zYzAuOSwwLjEsMS43LDAuMSwzLjEsMC4xaDEwLjVjMS43LDAsMi4yLDAsMi43LTAuMWMtMC4xLDAuNi0wLjEsMS4yLTAuMSwyLjZ2MTEuNwoJCWMwLDEuMywwLDIsMC4yLDIuOWgtNS43di0yaC01VjYwLjF6IE0zMjMuNiw1Mi40aDV2LTMuOGgtNVY1Mi40eiBNMzI3LDM1LjFjMC40LTEuMiwwLjYtMi40LDAuOS00LjRoLTMuNWMwLjUsMS42LDAuNywyLjgsMC45LDQuNAoJCUgzMjd6IE0zNTEuOSwyNi40Yy0wLjMsMC42LTAuMywwLjYtMS4yLDMuNWMtMC43LDIuMi0xLjgsNS4xLTMsNy44YzEuNywyLjUsMi40LDMuOCwzLjEsNS44YzAuNiwxLjcsMC45LDMuNSwwLjksNS4yCgkJYzAsMi44LTEuMSw0LjgtMyw1LjdjLTEsMC41LTIuNCwwLjctNC4xLDAuN2MtMC4yLDAtMC42LDAtMS4yLDBjLTAuMS0zLjEtMC4zLTQuMi0xLjMtNi4yYzAuOSwwLjEsMS4yLDAuMSwxLjYsMC4xCgkJYzEuNiwwLDIuMi0wLjQsMi4yLTEuNmMwLTEuNC0wLjMtMy0wLjktNC41Yy0wLjYtMS42LTEuMi0yLjctMi43LTQuNmMxLjUtMy4zLDIuNC02LjIsMy4xLTkuN2gtMy4zdjI2LjdjMCwyLjQsMC4xLDMuOCwwLjIsNWgtNgoJCWMwLjEtMS42LDAuMi0zLjIsMC4yLTQuOFYyNS42YzAtMS4zLDAtMi4xLTAuMS0zLjFjMS4xLDAuMSwxLjksMC4yLDMuMSwwLjJoN2MxLjYsMCwyLjIsMCwzLjEtMC4yTDM1MS45LDI2LjR6Ii8+CjwvZz4KPGc+Cgk8Zz4KCQk8Zz4KCQkJPGc+CgkJCQk8cGF0aCBjbGFzcz0ic3Q1IiBkPSJNMjUuMSw2NTUuMmMtMS41LDEtMi41LDIuNy0yLjUsNC43YzAsMSwwLjUsMiwxLjMsMi41TDE4MC44LDc2MWM3LjgsMy4zLDE2LjksMi45LDIyLjktMC44bDE4Ny44LTExNy42CgkJCQkJYzYtMy44LDYuOS0xMi4xLDEuOC0xNS4zTDIzMC41LDUyNkwyNS4xLDY1NS4yeiIvPgoJCQkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTI1LjMsNjU1LjRjLTEsMC42LTEsMi4yLDAsMi44TDE4Mi40LDc1N2M1LjIsMy4yLDE0LjIsMi44LDIwLjItMC45bDE4Ny44LTExNy42YzUuMi0zLjIsNi40LTcuOSwzLjItMTEuMgoJCQkJCWwwLDBjLTAuNS0wLjUtMS4xLTEtMS44LTEuNEwyMzMuNCw1MjQuNUwyMzEsNTI2TDI1LjMsNjU1LjRMMjUuMyw2NTUuNHoiLz4KCQkJPC9nPgoJCQk8Zz4KCQkJCTxnPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjUwLjMsNTYxLjggMjU4LjIsNTU2LjggMjU0LjIsNTU0LjMgMjQ2LjMsNTU5LjMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjIzOCw1NjkuNSAyNDUuOSw1NjQuNSAyNDEuOSw1NjIgMjM0LDU2NyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjI1LjcsNTc3LjEgMjMzLjYsNTcyLjEgMjI5LjcsNTY5LjcgMjIxLjcsNTc0LjYgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjIxMy40LDU4NC44IDIyMS40LDU3OS44IDIxNy40LDU3Ny4zIDIwOS41LDU4Mi4zIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyMDEuMiw1OTIuNSAyMDkuMSw1ODcuNSAyMDUuMSw1ODUgMTk3LjIsNTkwIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxODguOSw2MDAuMSAxOTYuOCw1OTUuMiAxOTIuOSw1OTIuNyAxODQuOSw1OTcuNiAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTc2LjYsNjA3LjggMTg0LjYsNjAyLjggMTgwLjYsNjAwLjQgMTcyLjYsNjA1LjMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE2NC4zLDYxNS41IDE3Mi4zLDYxMC41IDE2OC4zLDYwOCAxNjAuNCw2MTMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE1Mi4xLDYyMy4xIDE2MCw2MTguMiAxNTYsNjE1LjcgMTQ4LjEsNjIwLjYgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjEzOS44LDYzMC44IDE0Ny43LDYyNS44IDE0My44LDYyMy40IDEzNS44LDYyOC4zIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxMjcuNSw2MzguNSAxMzUuNSw2MzMuNSAxMzEuNSw2MzEgMTIzLjUsNjM2IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxMTUuMiw2NDYuMSAxMjMuMiw2NDEuMiAxMTkuMiw2MzguNyAxMTEuMyw2NDMuNyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTAzLDY1My44IDExMC45LDY0OC45IDEwNi45LDY0Ni40IDk5LDY1MS4zIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSI5MC43LDY2MS41IDk4LjYsNjU2LjUgOTQuNyw2NTQgODYuNyw2NTkgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9Ijc4LjQsNjY5LjEgODYuNCw2NjQuMiA4Mi40LDY2MS43IDc0LjQsNjY2LjcgCQkJCQkiLz4KCQkJCTwvZz4KCQkJCTxnPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjYyLjcsNTY5LjYgMjcwLjcsNTY0LjYgMjYyLjcsNTU5LjYgMjU0LjgsNTY0LjYgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjI1MC40LDU3Ny4yIDI1OC40LDU3Mi4zIDI1MC40LDU2Ny4zIDI0Mi41LDU3Mi4zIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyMzguMiw1ODQuOSAyNDYuMSw1NzkuOSAyMzguMiw1NzUgMjMwLjIsNTc5LjkgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjIyNS45LDU5Mi42IDIzMy44LDU4Ny42IDIyNS45LDU4Mi42IDIxNy45LDU4Ny42IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyMTMuNiw2MDAuMiAyMjEuNiw1OTUuMyAyMTMuNiw1OTAuMyAyMDUuNyw1OTUuMyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjAxLjQsNjA3LjkgMjA5LjMsNjAzIDIwMS40LDU5OCAxOTMuNCw2MDMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE4OS4xLDYxNS42IDE5Nyw2MTAuNiAxODkuMSw2MDUuNyAxODEuMSw2MTAuNiAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTc2LjgsNjIzLjIgMTg0LjcsNjE4LjMgMTc2LjgsNjEzLjMgMTY4LjksNjE4LjMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE2NC41LDYzMC45IDE3Mi41LDYyNiAxNjQuNSw2MjEgMTU2LjYsNjI2IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNTIuMiw2MzguNiAxNjAuMiw2MzMuNiAxNTIuMiw2MjguNyAxNDQuMyw2MzMuNiAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTQwLDY0Ni4zIDE0Ny45LDY0MS4zIDE0MCw2MzYuMyAxMzIsNjQxLjMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjEyNy43LDY1My45IDEzNS42LDY0OSAxMjcuNyw2NDQgMTE5LjgsNjQ5IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxMTUuNCw2NjEuNiAxMjMuNCw2NTYuNiAxMTUuNCw2NTEuNyAxMDcuNSw2NTYuNiAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTAzLjIsNjY5LjMgMTExLjEsNjY0LjMgMTAzLjIsNjU5LjMgOTUuMiw2NjQuMyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iOTAuOSw2NzYuOSA5OC44LDY3MiA5MC45LDY2NyA4Mi45LDY3MiAJCQkJCSIvPgoJCQkJPC9nPgoJCQkJPGc+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyNzAsNTgwLjYgMjgzLjEsNTcyLjQgMjc1LjIsNTY3LjQgMjYyLDU3NS43IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyNTcuNyw1ODguMyAyNjUuNiw1ODMuMyAyNTcuNyw1NzguNCAyNDkuNyw1ODMuMyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjQ1LjQsNTk2IDI1My40LDU5MSAyNDUuNCw1ODYgMjM3LjUsNTkxIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyMzMuMSw2MDMuNiAyNDEuMSw1OTguNyAyMzMuMSw1OTMuNyAyMjUuMiw1OTguNyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjIwLjksNjExLjMgMjI4LjgsNjA2LjMgMjIwLjksNjAxLjQgMjEyLjksNjA2LjMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjIwOC42LDYxOSAyMTYuNSw2MTQgMjA4LjYsNjA5IDIwMC42LDYxNCAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTk2LjMsNjI2LjYgMjA0LjMsNjIxLjcgMTk2LjMsNjE2LjcgMTg4LjQsNjIxLjcgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE4NCw2MzQuMyAxOTIsNjI5LjMgMTg0LDYyNC40IDE3Ni4xLDYyOS4zIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNzEuOCw2NDIgMTc5LjcsNjM3IDE3MS44LDYzMiAxNjMuOCw2MzcgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE1OS41LDY0OS42IDE2Ny40LDY0NC43IDE1OS41LDYzOS43IDE1MS41LDY0NC43IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNDcuMiw2NTcuMyAxNTUuMiw2NTIuNCAxNDcuMiw2NDcuNCAxMzkuMyw2NTIuNCAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTM0LjksNjY1IDE0Mi45LDY2MCAxMzQuOSw2NTUuMSAxMjcsNjYwIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxMjIuNyw2NzIuNyAxMzAuNiw2NjcuNyAxMjIuNyw2NjIuNyAxMTQuNyw2NjcuNyAJCQkJCSIvPgoJCQkJPC9nPgoJCQkJPGc+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyODcuNiw1NzUuMiAyOTUuNiw1ODAuMiAyNzUuNCw1OTIuOCAyNjcuNCw1ODcuOSAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjYzLjEsNjAwLjUgMjcxLDU5NS41IDI2My4xLDU5MC41IDI1NS4xLDU5NS41IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyNTAuOCw2MDguMSAyNTguOCw2MDMuMiAyNTAuOCw1OTguMiAyNDIuOSw2MDMuMiAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjM4LjYsNjE1LjggMjQ2LjUsNjEwLjkgMjM4LjYsNjA1LjkgMjMwLjYsNjEwLjkgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjIyNi4zLDYyMy41IDIzNC4yLDYxOC41IDIyNi4zLDYxMy42IDIxOC4zLDYxOC41IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyMTQsNjMxLjIgMjIxLjksNjI2LjIgMjE0LDYyMS4yIDIwNi4xLDYyNi4yIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyMDEuNyw2MzguOCAyMDkuNyw2MzMuOSAyMDEuNyw2MjguOSAxOTMuOCw2MzMuOSAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTg5LjQsNjQ2LjUgMTk3LjQsNjQxLjUgMTg5LjQsNjM2LjYgMTgxLjUsNjQxLjUgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE3Ny4yLDY1NC4yIDE4NS4xLDY0OS4yIDE3Ny4yLDY0NC4yIDE2OS4yLDY0OS4yIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNjQuOSw2NjEuOCAxNzIuOSw2NTYuOSAxNjQuOSw2NTEuOSAxNTcsNjU2LjkgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE1Mi42LDY2OS41IDE2MC42LDY2NC41IDE1Mi42LDY1OS42IDE0NC43LDY2NC41IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNDAuNCw2NzcuMiAxNDguMyw2NzIuMiAxNDAuNCw2NjcuMiAxMzIuNCw2NzIuMiAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTI4LjEsNjg0LjkgMTM2LDY3OS45IDEyOC4xLDY3NC45IDEyMC4xLDY3OS45IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxMTAuNCw2NzAuNCAxMTguMyw2NzUuNCAxMTMuMiw2NzguNiAxMjUuNiw2ODYuNCAxMTUuOCw2OTIuNSA5NS40LDY3OS44IAkJCQkJIi8+CgkJCQk8L2c+CgkJCQk8Zz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjMwMC4xLDU4MyAzMDguMSw1ODggMjg3LjgsNjAwLjYgMjc5LjksNTk1LjYgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjI3NS42LDYwOC4zIDI4My41LDYwMy4zIDI3NS42LDU5OC4zIDI2Ny42LDYwMy4zIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyNjMuMyw2MTUuOSAyNzEuMiw2MTEgMjYzLjMsNjA2IDI1NS4zLDYxMSAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjUxLDYyMy42IDI1OSw2MTguNiAyNTEsNjEzLjcgMjQzLjEsNjE4LjYgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjIzOC43LDYzMS4zIDI0Ni43LDYyNi4zIDIzOC43LDYyMS40IDIzMC44LDYyNi4zIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyMjYuNSw2MzkgMjM0LjQsNjM0IDIyNi41LDYyOSAyMTguNSw2MzQgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjIxNC4yLDY0Ni42IDIyMi4xLDY0MS42IDIxNC4yLDYzNi43IDIwNi4yLDY0MS42IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyMDEuOSw2NTQuMyAyMDkuOSw2NDkuMyAyMDEuOSw2NDQuNCAxOTQsNjQ5LjMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE4OS42LDY2MiAxOTcuNiw2NTcgMTg5LjYsNjUyIDE4MS43LDY1NyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTc3LjQsNjY5LjYgMTg1LjMsNjY0LjcgMTc3LjQsNjU5LjcgMTY5LjQsNjY0LjcgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE2NS4xLDY3Ny4zIDE3Myw2NzIuMyAxNjUuMSw2NjcuNCAxNTcuMSw2NzIuMyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTUyLjgsNjg1IDE2MC44LDY4MCAxNTIuOCw2NzUgMTQ0LjksNjgwIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNDAuNSw2ODIuNyAxNDguNSw2ODcuNyAxMjguMyw3MDAuMyAxMjAuMyw2OTUuMyAJCQkJCSIvPgoJCQkJPC9nPgoJCQkJPGc+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIzMTIuNiw2MDAuNyAzMjAuNSw1OTUuNyAzMTIuNiw1OTAuOCAzMDQuNiw1OTUuNyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMzAwLjMsNjA4LjQgMzA4LjIsNjAzLjQgMzAwLjMsNTk4LjUgMjkyLjQsNjAzLjQgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjI4OCw2MTYuMSAyOTYsNjExLjEgMjg4LDYwNi4xIDI4MC4xLDYxMS4xIAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyNzUuOCw2MjMuNyAyODMuNyw2MTguOCAyNzUuOCw2MTMuOCAyNjcuOCw2MTguOCAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMjYzLjUsNjMxLjQgMjcxLjQsNjI2LjQgMjYzLjUsNjIxLjUgMjU1LjUsNjI2LjQgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjI1MS4yLDYyOS4xIDI1OS4xLDYzNC4xIDIwMi4xLDY2OS43IDE5NC4yLDY2NC44IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxODkuOCw2NzcuNCAxOTcuOCw2NzIuNSAxODkuOCw2NjcuNSAxODEuOSw2NzIuNSAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTc3LjYsNjg1LjEgMTg1LjUsNjgwLjEgMTc3LjYsNjc1LjEgMTY5LjYsNjgwLjEgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjE2NS4zLDY5Mi43IDE3My4yLDY4Ny44IDE2NS4zLDY4Mi44IDE1Ny4zLDY4Ny44IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNTMsNzAwLjQgMTYwLjksNjk1LjUgMTUzLDY5MC41IDE0NS4xLDY5NS41IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIxNDAuNyw3MDguMSAxNDguNyw3MDMuMSAxNDAuNyw2OTguMiAxMzIuOCw3MDMuMSAJCQkJCSIvPgoJCQkJPC9nPgoJCQk8L2c+CgkJPC9nPgoJCTxnPgoJCQk8cGF0aCBjbGFzcz0ic3Q1IiBkPSJNMTkuMSw0NTYuM3YxOTIuMmMwLDYuNiw1LDguOSwxMS4xLDUuMWwxOTIuMi0xMjAuMWM2LjEtMy44LDExLjEtMTIuMywxMS4xLTE4LjlsMy40LTE5Mi4xCgkJCQljMC02LjYtOC4zLTguOS0xNC40LTUuMWwtMTkyLjMsMTIwQzI0LDQ0MS4zLDE5LjEsNDQ5LjcsMTkuMSw0NTYuM0wxOS4xLDQ1Ni4zeiIvPgoJCQk8cGF0aCBjbGFzcz0ic3Q2IiBkPSJNMjIuOSw0NTguNXYxOTIuMWMwLDYuNiw1LDguOSwxMS4xLDUuMWwxOTIuMi0xMjAuMWM2LjEtMy44LDExLjEtMTIuMywxMS4xLTE4LjlWMzI0LjYKCQkJCWMwLTYuNi01LTguOS0xMS4xLTUuMUwzMy45LDQzOS42QzI3LjgsNDQzLjQsMjIuOSw0NTEuOSwyMi45LDQ1OC41TDIyLjksNDU4LjV6Ii8+CgkJCTxwYXRoIGNsYXNzPSJzdDgiIGQ9Ik00MS4xLDY0NC43bDk1LTU5LjNsODQuMy01Mi43YzUuNy0zLjYsMTAuMy0xMS41LDEwLjMtMTcuN1YzMzUuN2MwLTYuMi00LjYtOC4zLTEwLjMtNC43TDQxLjEsNDQzCgkJCQljLTUuNywzLjYtMTAuMywxMS41LTEwLjMsMTcuN1Y2NDBDMzAuNyw2NDYuMiwzNS4zLDY0OC4zLDQxLjEsNjQ0LjdMNDEuMSw2NDQuN3oiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPGc+CgkJCQk8cGF0aCBjbGFzcz0ic3Q2IiBkPSJNOTguMyw0MjQuNmwtMTcuOSwxMS4yYy0wLjksMC41LTEuNiwwLjItMS42LTAuN3YtOC45YzAtMC45LDAuNy0yLjIsMS42LTIuN2wxNy45LTExLjIKCQkJCQljMC45LTAuNSwxLjYtMC4yLDEuNiwwLjd2OC45Qzk5LjksNDIyLjgsOTkuMiw0MjQsOTguMyw0MjQuNkw5OC4zLDQyNC42eiIvPgoJCQkJPHBhdGggY2xhc3M9InN0OSIgZD0iTTI4LjIsNTYxLjZsODQuMS01Mi42YzEtMC42LDEuNi0xLjgsMS42LTN2LTkwYzAtMi43LTIuNy00LjMtNC44LTNMMjUsNDY1LjZjLTEsMC42LTEuNiwxLjgtMS42LDN2OTAKCQkJCQlDMjMuNCw1NjEuMywyNi4xLDU2Mi45LDI4LjIsNTYxLjZMMjguMiw1NjEuNnoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDYiIGQ9Ik0yNC43LDU2Mi4xYy0xLjItMC43LTEuOS0yLTEuOS0zLjV2LTkwYzAtMS40LDAuNy0yLjgsMS45LTMuNWw4NC4xLTUyLjZjMS4yLTAuNywyLjYtMC43LDMuNywwCgkJCQkJYzEuMiwwLjcsMS45LDIsMS45LDMuNXY5MGMwLDEuNC0wLjcsMi44LTEuOSwzLjVsLTg0LjEsNTIuNmMtMC42LDAuNC0xLjIsMC42LTEuOSwwLjZTMjUuMyw1NjIuNSwyNC43LDU2Mi4xTDI0LjcsNTYyLjF6CgkJCQkJIE0xMTIuMSw1MDguNWMwLjgtMC41LDEuMy0xLjUsMS4zLTIuNXYtOTBjMC0xLjEtMC41LTItMS4zLTIuNXMtMS45LTAuNS0yLjcsMGwtODQuMSw1Mi42Yy0wLjgsMC41LTEuNCwxLjUtMS40LDIuNXY5MAoJCQkJCWMwLDEuMSwwLjUsMiwxLjQsMi41czEuOSwwLjUsMi43LDBMMTEyLjEsNTA4LjVMMTEyLjEsNTA4LjV6Ii8+CgkJCQk8cGF0aCBjbGFzcz0ic3Q5IiBkPSJNOTcuNSw0MjUuN2wtMTYuMywxMC4yYy0wLjgsMC41LTEuNCwwLjItMS40LTAuN3YtOC4xYzAtMC45LDAuNi0yLDEuNC0yLjVsMTYuMy0xMC4yCgkJCQkJYzAuOC0wLjUsMS40LTAuMiwxLjQsMC43djguMUM5OC45LDQyNC4xLDk4LjMsNDI1LjIsOTcuNSw0MjUuN0w5Ny41LDQyNS43eiIvPgoJCQk8L2c+CgkJCTxnPgoJCQkJPGc+CgkJCQkJPHBhdGggY2xhc3M9InN0OCIgZD0iTTYxLjksNDc4bC0xNS43LDkuOGMtMS4zLDAuOC0yLjMsMC4zLTIuMy0xLjF2LTE3YzAtMS40LDEtMy4yLDIuMy00bDE1LjctOS44YzEuMy0wLjgsMi4zLTAuMywyLjMsMS4xdjE3CgkJCQkJCUM2NC4yLDQ3NS4zLDYzLjIsNDc3LjEsNjEuOSw0Nzh6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTAiIGQ9Ik00NC4yLDQ4OC40Yy0wLjUtMC4zLTAuOC0wLjktMC44LTEuN3YtMTdjMC0xLjYsMS4xLTMuNSwyLjYtNC40bDE1LjctOS44YzAuOC0wLjUsMS42LTAuNiwyLjItMC4yCgkJCQkJCWMwLjUsMC4zLDAuOCwwLjksMC44LDEuN3YxN2MwLDEuNi0xLjEsMy41LTIuNiw0LjRsLTE1LjcsOS44Yy0wLjUsMC4zLTEsMC41LTEuNCwwLjVDNDQuNyw0ODguNiw0NC41LDQ4OC41LDQ0LjIsNDg4LjQKCQkJCQkJTDQ0LjIsNDg4LjR6IE02Mi4xLDQ1Ni4zbC0xNS43LDkuOGMtMS4yLDAuNy0yLjEsMi40LTIuMSwzLjZ2MTdjMCwwLjMsMC4xLDAuNywwLjQsMC45YzAuMywwLjIsMC44LDAuMSwxLjMtMC4ybDIuNS0xLjYKCQkJCQkJbDEzLjItOC4yYzEuMi0wLjcsMi4xLTIuNCwyLjEtMy42di0xN2MwLTAuMy0wLjEtMC43LTAuNC0wLjljLTAuMS0wLjEtMC4yLTAuMS0wLjQtMC4xQzYyLjgsNDU2LDYyLjUsNDU2LjEsNjIuMSw0NTYuMwoJCQkJCQlMNjIuMSw0NTYuM3oiLz4KCQkJCTwvZz4KCQkJCTxnPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDExIiBkPSJNNTguMiw0NjcuOWMwLDAtMi40LDMuOC00LjIsNS4xYy0yLjMsMS43LTUuMi0zLjEtNS4yLTMuMXMwLjctNS4zLDMuNy02LjMKCQkJCQkJQzU4LjUsNDYxLjcsNTguMiw0NjcuOSw1OC4yLDQ2Ny45TDU4LjIsNDY3Ljl6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik00OS42LDQ3OC42bDIuMy0zLjZjMS4yLTIsMy4xLTMuMiw0LjItMi43bDIuOSwxLjNjMS42LDEsMS44LDIuNywyLjMsNC4xbC0xMi45LDguMQoJCQkJCQlDNDguNSw0ODUuOCw0Ny43LDQ4MS44LDQ5LjYsNDc4LjZMNDkuNiw0NzguNnoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTU3LjMsNDY4LjZjMCwyLTAuNyw0LjQtMi42LDUuNWMtMS44LDEuMi00LjMtMC44LTQuMy0yLjhzMS43LTMuMSwzLjUtNC4yCgkJCQkJCUM1NS44LDQ2NS45LDU3LjMsNDY2LjYsNTcuMyw0NjguNkw1Ny4zLDQ2OC42eiIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDExIiBwb2ludHM9IjU3LDQ2OC41IDUwLjgsNDcwLjkgNDkuNSw0NjkuNCA1Ni43LDQ2NS4zIAkJCQkJIi8+CgkJCQk8L2c+CgkJCQk8Zz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMSIgZD0iTTQ2LjEsNDk0LjJjMC4xLDAsMC4yLDAsMC4zLTAuMWw1Ni40LTM1LjJjMC4zLTAuMiwwLjQtMC42LDAuMi0wLjljLTAuMi0wLjMtMC42LTAuNC0wLjktMC4zTDQ1LjgsNDkzCgkJCQkJCWMtMC4zLDAuMi0wLjQsMC42LTAuMiwwLjlDNDUuNyw0OTQuMSw0NS45LDQ5NC4yLDQ2LjEsNDk0LjJ6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik00Ni4xLDUwMC42YzAuMSwwLDAuMiwwLDAuMy0wLjFsNTYuNC0zNS4yYzAuMy0wLjIsMC40LTAuNiwwLjItMC45Yy0wLjItMC4zLTAuNi0wLjQtMC45LTAuM2wtNTYuNCwzNS4yCgkJCQkJCWMtMC4zLDAuMi0wLjQsMC42LTAuMiwwLjlDNDUuNyw1MDAuNSw0NS45LDUwMC42LDQ2LjEsNTAwLjZ6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik00Ni4xLDUwOC42YzAuMSwwLDAuMiwwLDAuMy0wLjFsMzguNC0yNGMwLjMtMC4yLDAuNC0wLjYsMC4yLTAuOWMtMC4yLTAuMy0wLjYtMC40LTAuOS0wLjNsLTM4LjQsMjQKCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjYtMC4yLDAuOUM0NS43LDUwOC40LDQ1LjksNTA4LjYsNDYuMSw1MDguNnoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMSIgZD0iTTQ2LjEsNTE2LjVjMC4xLDAsMC4yLDAsMC4zLTAuMWwzOC40LTI0YzAuMy0wLjIsMC40LTAuNiwwLjItMC45Yy0wLjItMC4zLTAuNi0wLjQtMC45LTAuM2wtMzguNCwyNAoJCQkJCQljLTAuMywwLjItMC40LDAuNi0wLjIsMC45QzQ1LjcsNTE2LjQsNDUuOSw1MTYuNSw0Ni4xLDUxNi41eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDExIiBkPSJNNDYuMSw1MjQuNGMwLjEsMCwwLjIsMCwwLjMtMC4xbDM4LjQtMjRjMC4zLTAuMiwwLjQtMC42LDAuMi0wLjljLTAuMi0wLjMtMC42LTAuNC0wLjktMC4zbC0zOC40LDI0CgkJCQkJCWMtMC4zLDAuMi0wLjQsMC42LTAuMiwwLjlDNDUuNyw1MjQuMyw0NS45LDUyNC40LDQ2LjEsNTI0LjR6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik00Ni4xLDUzMi4zYzAuMSwwLDAuMiwwLDAuMy0wLjFsMzguNC0yNGMwLjMtMC4yLDAuNC0wLjYsMC4yLTAuOWMtMC4yLTAuMy0wLjYtMC40LTAuOS0wLjNsLTM4LjQsMjQKCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjYtMC4yLDAuOUM0NS43LDUzMi4yLDQ1LjksNTMyLjMsNDYuMSw1MzIuM3oiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMSIgZD0iTTQ2LjEsNTQwLjJjMC4xLDAsMC4yLDAsMC4zLTAuMWwzOC40LTI0YzAuMy0wLjIsMC40LTAuNiwwLjItMC45Yy0wLjItMC4zLTAuNi0wLjQtMC45LTAuM2wtMzguNCwyNAoJCQkJCQljLTAuMywwLjItMC40LDAuNi0wLjIsMC45QzQ1LjcsNTQwLjEsNDUuOSw1NDAuMiw0Ni4xLDU0MC4yeiIvPgoJCQkJPC9nPgoJCQk8L2c+CgkJPC9nPgoJCTxnPgoJCQk8cGF0aCBjbGFzcz0ic3QxMyIgZD0iTTE5LjEsNTE5Ljl2ODYuNGw1NC43LTM0LjFjMC45LTAuNiwxLjQtMS42LDEuNC0yLjd2LTc5LjNjMC0yLjQtMi40LTMuOC00LjMtMi43TDE5LjEsNTE5LjlMMTkuMSw1MTkuOXoiCgkJCQkvPgoJCQk8Zz4KCQkJCTxnPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik0xLjUsNTM3LjNsNTAuMy0zMS40di02LjdjMC0xLDAuNy0yLjMsMS43LTIuOGwxOC45LTExLjhjMC45LTAuNiwxLjctMC4yLDEuNywwLjh2Ni43bDYuNy00LjIKCQkJCQkJYzItMS4zLDQuNSwwLjMsNC41LDIuOHY4NC43YzAsMS4yLTAuNiwyLjItMS41LDIuOEw0LjUsNjI3LjdjLTIsMS4zLTQuNS0wLjMtNC41LTIuOHYtODQuN0MwLDUzOSwwLjYsNTM3LjksMS41LDUzNy4zCgkJCQkJCUwxLjUsNTM3LjN6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0OSIgZD0iTTIuNCw1MzhsNTAuNy0zMS43di02LjVjMC0wLjksMC43LTIsMS41LTIuNWwxNi45LTEwLjVjMC44LTAuNSwxLjUtMC4yLDEuNSwwLjd2Ni41bDguNi01LjQKCQkJCQkJYzItMS4zLDQuNSwwLjMsNC41LDIuOFY1NzZjMCwxLjItMC42LDIuMi0xLjUsMi44TDUuNSw2MjguNGMtMiwxLjMtNC41LTAuMy00LjUtMi44di04NC43QzAuOSw1MzkuNiwxLjUsNTM4LjUsMi40LDUzOAoJCQkJCQlMMi40LDUzOHoiLz4KCQkJCTwvZz4KCQkJCTxnPgoJCQkJCTxnPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3Q1IiBkPSJNMjQuNiw1NTguOWMwLjEsMCwwLjIsMCwwLjMtMC4xTDc4LDUyNS42YzAuMy0wLjIsMC40LTAuNiwwLjItMC45Yy0wLjItMC4zLTAuNS0wLjQtMC44LTAuMmwtNTMuMSwzMy4yCgkJCQkJCQljLTAuMywwLjItMC40LDAuNi0wLjIsMC45QzI0LjIsNTU4LjcsMjQuNCw1NTguOSwyNC42LDU1OC45eiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3Q1IiBkPSJNMjQuNiw1NjQuOGMwLjEsMCwwLjIsMCwwLjMtMC4xTDc4LDUzMS42YzAuMy0wLjIsMC40LTAuNiwwLjItMC45Yy0wLjItMC4zLTAuNS0wLjQtMC44LTAuMmwtNTMuMSwzMy4yCgkJCQkJCQljLTAuMywwLjItMC40LDAuNi0wLjIsMC45QzI0LjIsNTY0LjcsMjQuNCw1NjQuOCwyNC42LDU2NC44eiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3Q1IiBkPSJNMjQuNiw1NzIuM2MwLjEsMCwwLjIsMCwwLjMtMC4xbDM2LjItMjIuNmMwLjMtMC4yLDAuNC0wLjYsMC4yLTAuOWMtMC4yLTAuMy0wLjUtMC40LTAuOC0wLjJsLTM2LjIsMjIuNgoJCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjYtMC4yLDAuOUMyNC4yLDU3Mi4yLDI0LjQsNTcyLjMsMjQuNiw1NzIuM3oiLz4KCQkJCQkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTI0LjYsNTc5LjhjMC4xLDAsMC4yLDAsMC4zLTAuMWwzNi4yLTIyLjZjMC4zLTAuMiwwLjQtMC42LDAuMi0wLjljLTAuMi0wLjMtMC41LTAuNC0wLjgtMC4ybC0zNi4yLDIyLjYKCQkJCQkJCWMtMC4zLDAuMi0wLjQsMC42LTAuMiwwLjlDMjQuMiw1NzkuNywyNC40LDU3OS44LDI0LjYsNTc5Ljh6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik0yNC42LDU4Ny4yYzAuMSwwLDAuMiwwLDAuMy0wLjFsMzYuMi0yMi42YzAuMy0wLjIsMC40LTAuNiwwLjItMC45Yy0wLjItMC4zLTAuNS0wLjQtMC44LTAuMkwyNC4zLDU4NgoJCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjYtMC4yLDAuOUMyNC4yLDU4Ny4xLDI0LjQsNTg3LjIsMjQuNiw1ODcuMnoiLz4KCQkJCQkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTI0LjYsNTk0LjdjMC4xLDAsMC4yLDAsMC4zLTAuMUw2MS4xLDU3MmMwLjMtMC4yLDAuNC0wLjYsMC4yLTAuOWMtMC4yLTAuMy0wLjUtMC40LTAuOC0wLjJsLTM2LjIsMjIuNgoJCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjYtMC4yLDAuOUMyNC4yLDU5NC42LDI0LjQsNTk0LjcsMjQuNiw1OTQuN3oiLz4KCQkJCQkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTI0LjYsNjAyLjFjMC4xLDAsMC4yLDAsMC4zLTAuMWwzNi4yLTIyLjZjMC4zLTAuMiwwLjQtMC42LDAuMi0wLjljLTAuMi0wLjMtMC41LTAuNC0wLjgtMC4ybC0zNi4yLDIyLjYKCQkJCQkJCWMtMC4zLDAuMi0wLjQsMC42LTAuMiwwLjlDMjQuMiw2MDIsMjQuNCw2MDIuMSwyNC42LDYwMi4xeiIvPgoJCQkJCTwvZz4KCQkJCQk8Zz4KCQkJCQkJPGc+CgkJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMCIgZD0iTTIxLjgsNTU1LjFMNDEuMiw1NDNjMC42LTAuNCwxLjEtMS4yLDEuMS0xLjl2LTE5LjRjMC0wLjctMC41LTAuOS0xLjEtMC41bC0xOS40LDEyLjEKCQkJCQkJCQljLTAuNiwwLjQtMS4xLDEuMi0xLjEsMS45djE5LjRDMjAuNyw1NTUuMywyMS4yLDU1NS41LDIxLjgsNTU1LjF6Ii8+CgkJCQkJCQk8cGF0aCBjbGFzcz0ic3Q3IiBkPSJNMjEuOSw1MzUuNXYxNy40YzAsMC42LDAuNSwwLjgsMSwwLjVsNC40LTIuOGw5LjgtNi4ybDMuMS0xLjljMC41LTAuMywxLTEuMSwxLTEuN3YtMTcuNAoJCQkJCQkJCWMwLTAuNi0wLjUtMC44LTEtMC41bC0xNy40LDEwLjlDMjIuMyw1MzQuMiwyMS45LDUzNSwyMS45LDUzNS41eiIvPgoJCQkJCQk8L2c+CgkJCQkJCTxnPgoJCQkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik0zNC4yLDUzMy4zYy0wLjQsMC43LDAuMyw0LjgsMC43LDQuNGMwLDAtMS43LDEuNi0yLjgsMi40Yy0xLjUsMS4xLTMsMC41LTMsMC41CgkJCQkJCQkJYzAuNCwwLjEtMC42LTIuNi0wLjgtNS44Yy0wLjItMi42LDAuNS00LjcsMi4zLTUuMmMwLjktMC4yLDEuNy0wLjIsMi40LDAuM0MzNCw1MzAuOCwzNC43LDUzMi41LDM0LjIsNTMzLjNMMzQuMiw1MzMuM3oiLz4KCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDYiIGQ9Ik0yNy4zLDU1MC42bDkuOC02LjJjLTAuNi00LjQtMC40LTcuOS00LjctNy43bDAsMGMtMC43LDAuMS0yLjEsMC42LTIuMSwwLjZjLTEuOCwxLjYtMi4zLDIuMS0yLjUsMy43CgkJCQkJCQkJQzI3LjcsNTQyLjcsMjcuNCw1NDcsMjcuMyw1NTAuNkwyNy4zLDU1MC42eiIvPgoJCQkJCQkJPGc+CgkJCQkJCQkJPGc+CgkJCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDgiIGQ9Ik0zMC41LDUzNy4xYzAsMCwwLjYtMC44LDEuNC0wLjhjMC43LDAsMS42LDAuMiwxLjgsMC40YzAsMC4yLTAuNCwxLjEtMC42LDEuM2MtMC4yLDAuMi0xLDAuMy0xLjksMC4yCgkJCQkJCQkJCQlDMzAuMyw1MzguMSwzMC41LDUzNy4xLDMwLjUsNTM3LjFMMzAuNSw1MzcuMXoiLz4KCQkJCQkJCQkJPHBhdGggY2xhc3M9InN0OCIgZD0iTTMyLjcsNTM3LjVjMC4xLTAuMSwwLjItMC41LDAuMi0wLjZsMC44LTAuMWMwLjEsMC45LTAuOSwyLjItMS4yLDIuMWMtMC4zLDAtMC42LTAuNi0wLjYtMC42CgkJCQkJCQkJCQljMC0wLjEsMC0wLjMsMC0wLjRDMzEuOSw1MzcuOSwzMi41LDUzNy42LDMyLjcsNTM3LjVMMzIuNyw1MzcuNXoiLz4KCQkJCQkJCQkJPHBhdGggY2xhc3M9InN0OCIgZD0iTTMwLDUzOC4xYzAuMywwLjIsMS4yLDEuMiwxLjQsMC45YzAuMy0wLjIsMC43LTAuOSwwLjYtMS4yYy0wLjIsMC0xLjMtMC4zLTEuNS0wLjcKCQkJCQkJCQkJCUMzMC40LDUzNy4yLDMwLDUzOCwzMCw1MzguMUwzMCw1MzguMXoiLz4KCQkJCQkJCQk8L2c+CgkJCQkJCQkJPGc+CgkJCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMzIuNSw1MzZjMC4yLDAuMSwwLjUsMC4zLDAuNCwwLjZjLTAuMSwwLjQtMC40LDAuNy0wLjcsMC45Yy0wLjIsMC4yLTAuNSwwLjMtMC44LDAuMwoJCQkJCQkJCQkJYy0wLjIsMC0wLjQsMC4xLTAuNiwwcy0wLjMtMC4zLTAuMy0wLjZjMC4xLTAuNSwwLjYtMC45LDEtMS4xQzMxLjksNTM2LjEsMzIuMiw1MzYsMzIuNSw1MzZMMzIuNSw1MzZ6Ii8+CgkJCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMzMuNyw1MzMuOGMwLDEuMy0wLjUsMy4yLTIsMy4yYy0wLjgsMC4xLTEuOC0wLjQtMi4xLTEuN2MtMC4yLTAuNy0wLjMtMC44LDAtMS40CgkJCQkJCQkJCQljMC40LTAuOCwxLjMtMS4zLDItMS43QzMyLjgsNTMxLjYsMzMuNyw1MzIuNSwzMy43LDUzMy44eiIvPgoJCQkJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMSIgZD0iTTMzLjUsNTMyLjNjLTAuNywxLjYtMS42LDIuMS0zLjIsMC44Yy0wLjQsMS4xLTAuNiwxLjgtMSwxLjZsMC4zLTEuNmwzLjMtMkwzMy41LDUzMi4zTDMzLjUsNTMyLjN6IgoJCQkJCQkJCQkJLz4KCQkJCQkJCQkJPHBhdGggY2xhc3M9InN0MTIiIGQ9Ik0yOC45LDUzNS40YzAuMiwwLjUsMC42LDAuOCwwLjksMC42cy0wLjMtMS45LTAuNy0xLjhDMjguOSw1MzQuNCwyOC44LDUzNC45LDI4LjksNTM1LjR6Ii8+CgkJCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMzMuNCw1MzUuMmMwLjMsMC4xLDAuNy0wLjMsMC44LTAuOHMtMC4xLTEtMC41LTEuMUMzMy4zLDUzMy4yLDMzLDUzNS4yLDMzLjQsNTM1LjJMMzMuNCw1MzUuMnoiLz4KCQkJCQkJCQk8L2c+CgkJCQkJCQk8L2c+CgkJCQkJCTwvZz4KCQkJCQk8L2c+CgkJCQk8L2c+CgkJCTwvZz4KCQk8L2c+CgkJPGc+CgkJCTxnPgoJCQkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTU3LjcsNDY3LjlsNTYuNS0zNS4zVjQyNWMwLTEuMSwwLjgtMi41LDEuOS0zLjJsMjEuMi0xMy4yYzEtMC42LDEuOS0wLjMsMS45LDAuOHY3LjVsNy42LTQuNwoJCQkJCWMyLjMtMS40LDUuMSwwLjMsNS4xLDMuMnY5NS4yYzAsMS4zLTAuNiwyLjUtMS43LDMuMmwtODksNTUuNmMtMi4zLDEuNC01LjEtMC4zLTUuMS0zLjJWNDcxQzU2LDQ2OS43LDU2LjcsNDY4LjUsNTcuNyw0NjcuOQoJCQkJCUw1Ny43LDQ2Ny45eiIvPgoJCQkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTU4LjcsNDY4LjZsNTctMzUuNnYtNy4zYzAtMSwwLjgtMi4zLDEuNy0yLjhsMTguOS0xMS44YzAuOS0wLjYsMS43LTAuMiwxLjcsMC44djcuM2w5LjctNi4xCgkJCQkJYzIuMy0xLjQsNS4xLDAuMyw1LjEsMy4ydjk1LjJjMCwxLjMtMC42LDIuNS0xLjcsMy4ybC04OSw1NS42Yy0yLjMsMS40LTUuMS0wLjMtNS4xLTMuMnYtOTUuMkM1Nyw0NzAuNSw1Ny43LDQ2OS4zLDU4LjcsNDY4LjYKCQkJCQlMNTguNyw0NjguNnoiLz4KCQkJPC9nPgoJCQk8Zz4KCQkJCTxnPgoJCQkJCTxnPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3Q4IiBkPSJNOTYsNDgxLjlsLTE2LjYsMTAuNGMtMS40LDAuOS0yLjUsMC4zLTIuNS0xLjF2LTE3LjljMC0xLjUsMS4xLTMuNCwyLjUtNC4yTDk2LDQ1OC42CgkJCQkJCQljMS40LTAuOSwyLjUtMC4zLDIuNSwxLjF2MTcuOUM5OC41LDQ3OS4xLDk3LjQsNDgxLDk2LDQ4MS45eiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMCIgZD0iTTc3LjMsNDkzYy0wLjUtMC4zLTAuOC0xLTAuOC0xLjh2LTE3LjljMC0xLjcsMS4yLTMuNywyLjctNC43bDE2LjYtMTAuNGMwLjktMC41LDEuNy0wLjYsMi4zLTAuMgoJCQkJCQkJYzAuNSwwLjMsMC44LDEsMC44LDEuOHYxNy45YzAsMS43LTEuMiwzLjctMi43LDQuN2wtMTYuNiwxMC40Yy0wLjUsMC4zLTEsMC41LTEuNSwwLjVDNzcuOSw0OTMuMiw3Ny42LDQ5My4xLDc3LjMsNDkzCgkJCQkJCQlMNzcuMyw0OTN6IE05NS44LDQ4MS41YzEuMi0wLjgsMi4zLTIuNSwyLjMtMy44di0xNy45YzAtMC4zLTAuMS0wLjgtMC40LTFzLTAuOS0wLjEtMS40LDAuMmwtMTYuNiwxMC40CgkJCQkJCQljLTEuMiwwLjgtMi4zLDIuNS0yLjMsMy44djE3LjljMCwwLjMsMC4xLDAuOCwwLjQsMXMwLjksMC4xLDEuNC0wLjJMOTUuOCw0ODEuNUw5NS44LDQ4MS41eiIvPgoJCQkJCTwvZz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxNCIgZD0iTTkyLjIsNDY5LjdjMCwwLjQsMS40LDAuNiwxLjIsMS42Yy0wLjIsMS0wLjksMC45LTEsMS40Yy0wLjIsMS4xLDEuNSwwLjUsMC45LDIuM3MtMy45LDEuNy01LjgsMwoJCQkJCQljLTIuNSwxLjgtNyw0LjgtNi4zLDEuMmMwLjEtMC42LDEuMS0xLjEsMS4zLTEuOGMwLjItMC43LTAuMy0xLjYtMC4zLTEuOGMwLTMuMiwxLjQtNy4yLDQuMy05CgkJCQkJCUM4OS42LDQ2NC43LDkyLjIsNDY2LjUsOTIuMiw0NjkuN0w5Mi4yLDQ2OS43eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDExIiBkPSJNODEuNiw0ODUuM2wzLjgtNi42YzEuMi0yLjEsMy4yLTMuNCw0LjUtMi44bDMuOCwxLjhjMiwwLjksMC42LDUuNS0yLjIsNy4zbC03LjcsNC44CgkJCQkJCUM4MSw0OTEuNSw3OS42LDQ4OC43LDgxLjYsNDg1LjNMODEuNiw0ODUuM3oiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTkxLjIsNDcyYzAsMi4xLTEuNiw0LjgtMy41LDZzLTMuNSwwLjUtMy41LTEuNnMxLjYtNC44LDMuNS02Qzg5LjYsNDY5LjIsOTEuMiw0NjkuOSw5MS4yLDQ3MnoiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3QxNCIgcG9pbnRzPSI5MC45LDQ3MCA4NC42LDQ3My45IDg0LjYsNDcxLjkgOTAuOSw0NjggCQkJCQkiLz4KCQkJCTwvZz4KCQkJCTxnPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDExIiBkPSJNNzkuMyw0OTkuMWMwLjEsMCwwLjIsMCwwLjMtMC4xbDU5LjctMzcuM2MwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM0w3OSw0OTcuOAoJCQkJCQljLTAuMywwLjItMC40LDAuNy0wLjIsMUM3OC45LDQ5OSw3OS4xLDQ5OS4xLDc5LjMsNDk5LjF6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik03OS4zLDUwNS45YzAuMSwwLDAuMiwwLDAuMy0wLjFsNTkuNy0zNy4zYzAuMy0wLjIsMC40LTAuNywwLjItMXMtMC42LTAuNS0wLjktMC4zTDc5LDUwNC41CgkJCQkJCWMtMC4zLDAuMi0wLjQsMC43LTAuMiwxQzc4LjksNTA1LjcsNzkuMSw1MDUuOSw3OS4zLDUwNS45eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDExIiBkPSJNNzkuMyw1MTQuM2MwLjEsMCwwLjIsMCwwLjMtMC4xbDQwLjYtMjUuNGMwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM0w3OSw1MTIuOQoJCQkJCQljLTAuMywwLjItMC40LDAuNy0wLjIsMUM3OC45LDUxNC4yLDc5LjEsNTE0LjMsNzkuMyw1MTQuM3oiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMSIgZD0iTTc5LjMsNTIyLjdjMC4xLDAsMC4yLDAsMC4zLTAuMWw0MC42LTI1LjRjMC4zLTAuMiwwLjQtMC43LDAuMi0xcy0wLjYtMC41LTAuOS0wLjNMNzksNTIxLjMKCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjctMC4yLDFDNzguOSw1MjIuNSw3OS4xLDUyMi43LDc5LjMsNTIyLjd6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik03OS4zLDUzMWMwLjEsMCwwLjIsMCwwLjMtMC4xbDQwLjYtMjUuNGMwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM0w3OSw1MjkuNwoJCQkJCQljLTAuMywwLjItMC40LDAuNy0wLjIsMUM3OC45LDUzMC45LDc5LjEsNTMxLDc5LjMsNTMxeiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDExIiBkPSJNNzkuMyw1MzkuNGMwLjEsMCwwLjIsMCwwLjMtMC4xbDQwLjYtMjUuNGMwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM0w3OSw1MzgKCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjctMC4yLDFDNzguOSw1MzkuMyw3OS4xLDUzOS40LDc5LjMsNTM5LjR6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik03OS4zLDU0Ny44YzAuMSwwLDAuMiwwLDAuMy0wLjFsNDAuNi0yNS40YzAuMy0wLjIsMC40LTAuNywwLjItMXMtMC42LTAuNS0wLjktMC4zTDc5LDU0Ni40CgkJCQkJCWMtMC4zLDAuMi0wLjQsMC43LTAuMiwxQzc4LjksNTQ3LjcsNzkuMSw1NDcuOCw3OS4zLDU0Ny44eiIvPgoJCQkJPC9nPgoJCQk8L2c+CgkJPC9nPgoJCTxnPgoJCQk8cGF0aCBjbGFzcz0ic3QxMyIgZD0iTTUzLjEsNjA5bDkwLTU2LjNjMS4xLTAuNywxLjctMS45LDEuNy0zLjJ2LTk2LjNjMC0yLjktMi45LTQuNy01LjItMy4ybC05MCw1Ni4zYy0xLjEsMC43LTEuNywxLjktMS43LDMuMgoJCQkJdjk2LjNDNDgsNjA4LjYsNTAuOCw2MTAuNCw1My4xLDYwOXoiLz4KCQkJPGc+CgkJCQk8cGF0aCBjbGFzcz0ic3Q1IiBkPSJNNTIuMyw0OTguMWw1Ni41LTM1LjN2LTcuNWMwLTEuMSwwLjgtMi41LDEuOS0zLjJsMjEuMi0xMy4yYzEtMC42LDEuOS0wLjMsMS45LDAuOHY3LjVsNy42LTQuNwoJCQkJCWMyLjMtMS40LDUuMSwwLjMsNS4xLDMuMnY5NS4yYzAsMS4zLTAuNiwyLjUtMS43LDMuMmwtODksNTUuNmMtMi4zLDEuNC01LjEtMC4zLTUuMS0zLjJ2LTk1LjJDNTAuNyw1MDAsNTEuMyw0OTguOCw1Mi4zLDQ5OC4xCgkJCQkJTDUyLjMsNDk4LjF6Ii8+CgkJCQk8cGF0aCBjbGFzcz0ic3Q3IiBkPSJNNTMuNCw0OTguOWw1Ni41LTM1LjNWNDU2YzAtMSwwLjgtMi4zLDEuNy0yLjhsMTguOS0xMS44YzAuNC0wLjIsMC43LTAuMywxLTAuMmMwLjctMC4yLDEuMiwwLjIsMS4yLDF2Ny4zCgkJCQkJbDkuNy02LjFjMi4zLTEuNCw1LjEsMC4zLDUuMSwzLjJ2OTUuMmMwLDEuMy0wLjYsMi41LTEuNywzLjJsLTg5LDU1LjZjLTIuMywxLjQtNS4xLTAuMy01LjEtMy4yVjUwMgoJCQkJCUM1MS43LDUwMC43LDUyLjMsNDk5LjUsNTMuNCw0OTguOUw1My40LDQ5OC45eiIvPgoJCQk8L2c+CgkJCTxnPgoJCQkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTEzNS45LDQ3OS4xbC0zMy42LDIxYy0xLjYsMS0zLDAuNC0zLTEuM1Y0ODJjMC0xLjgsMS4zLTQsMy01LjFsMzMuNi0yMWMxLjYtMSwzLTAuNCwzLDEuM3YxNi43CgkJCQkJQzEzOC45LDQ3NS45LDEzNy42LDQ3OC4xLDEzNS45LDQ3OS4xeiIvPgoJCQkJPGc+CgkJCQkJPGc+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDgiIGQ9Ik05NC40LDUwNS4xbC0xNi42LDEwLjRjLTEuNCwwLjktMi41LDAuMy0yLjUtMS4xdi0xNy45YzAtMS41LDEuMS0zLjQsMi41LTQuMmwxNi42LTEwLjQKCQkJCQkJCWMxLjQtMC45LDIuNS0wLjMsMi41LDEuMXYxNy45Qzk2LjksNTAyLjMsOTUuOCw1MDQuMiw5NC40LDUwNS4xeiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMCIgZD0iTTc1LjcsNTE2LjFjLTAuNS0wLjMtMC44LTEtMC44LTEuOHYtMTcuOWMwLTEuNywxLjItMy43LDIuNy00LjdsMTYuNi0xMC40YzAuOS0wLjUsMS43LTAuNiwyLjMtMC4yCgkJCQkJCQljMC41LDAuMywwLjgsMSwwLjgsMS44djE3LjljMCwxLjctMS4yLDMuNy0yLjcsNC43TDc4LDUxNS45Yy0wLjUsMC4zLTEsMC41LTEuNSwwLjVDNzYuMyw1MTYuNCw3Niw1MTYuMyw3NS43LDUxNi4xCgkJCQkJCQlMNzUuNyw1MTYuMXogTTk0LjIsNTA0LjdjMS4yLTAuOCwyLjMtMi41LDIuMy0zLjhWNDgzYzAtMC4zLTAuMS0wLjgtMC40LTFzLTAuOS0wLjEtMS40LDAuMmwtMTYuNiwxMC40CgkJCQkJCQljLTEuMiwwLjgtMi4zLDIuNS0yLjMsMy44djE3LjljMCwwLjMsMC4xLDAuOCwwLjQsMXMwLjksMC4xLDEuNC0wLjJMOTQuMiw1MDQuN0w5NC4yLDUwNC43eiIvPgoJCQkJCTwvZz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMSIgZD0iTTkwLjUsNDkzLjhjMCwwLjQtMS40LDUuNS0zLjMsNS44Yy0zLjUsMC42LTMuNy0yLjQtNC4zLTQuNmMtMC42LTIuMiwwLjQtMi4zLDIuOS0zLjkKCQkJCQkJQzg4LjIsNDg5LjYsOTAuNSw0OTEuMSw5MC41LDQ5My44TDkwLjUsNDkzLjh6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTEiIGQ9Ik04MC41LDUwNC4zbDMuOC00LjdjMS4xLTEuOCwzLjEtMS43LDQuMi0xLjJsMy41LDAuOGwxLjMsNi43bC0xMi40LDcuNUw4MC41LDUwNC4zTDgwLjUsNTA0LjN6Ii8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0MTUiIHBvaW50cz0iODQuOCw1MTAuNCA4OS43LDUwNy40IDg4LjIsNDk4LjMgODQuNSw0OTkuOCAJCQkJCSIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDEwIiBkPSJNODUuNCw1MDAuOWMwLjQtMC4zLDItMC45LDItMWMtMC4xLDAuNS0wLjIsMS40LTAuNSwxLjljMC4yLDEuMSwyLDYsMiw2bC0yLjcsMS42YzAsMCwwLjEtNi4zLDAuMS03LjQKCQkJCQkJQzg2LDUwMiw4NS4yLDUwMS4xLDg1LjQsNTAwLjlMODUuNCw1MDAuOXoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTg5LDQ5Mi45YzAuOSwxLjcsMC42LDQuNC0wLjcsNi4xYy0xLjMsMS43LTMuMSwxLjYtNC0wLjFjLTAuNS0xLTAuOS0yLjMtMC43LTMuNgoJCQkJCQljMC4yLTAuOSwwLjgtMS44LDEuMy0yLjVDODYuMyw0OTEuMiw4OC4xLDQ5MS4yLDg5LDQ5Mi45TDg5LDQ5Mi45eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDExIiBkPSJNODkuNCw0OTMuNGMwLDAtMS45LDEtNS40LDFjMC4xLDAuNS0wLjYsMS40LTAuNiwxLjhjMCwwLjgsMC41LDAuOCwwLjUsMC44bC0wLjMsMC44YzAsMC0xLjktNC4yLTEuMS01CgkJCQkJCWMwLDAtMC4xLTEuMiwyLjQtMi42YzIuNC0xLjQsMy42LDAuNCwzLjYsMC40TDg5LjQsNDkzLjRMODkuNCw0OTMuNHoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTgzLjMsNDk4Yy0wLjMtMC4yLTAuNi0wLjgtMC42LTEuM3MwLjMtMC43LDAuNi0wLjVjMC4zLDAuMiwwLjYsMC44LDAuNiwxLjNTODMuNyw0OTguMiw4My4zLDQ5OHoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTg5LjEsNDk2LjljLTAuMi0wLjQtMC4xLTEsMC4xLTEuNHMwLjYtMC40LDAuOC0wLjFjMC4yLDAuNCwwLjEsMS0wLjEsMS40Uzg5LjMsNDk3LjMsODkuMSw0OTYuOXoiLz4KCQkJCTwvZz4KCQkJCTxnPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik03Ny43LDUyMi4zYzAuMSwwLDAuMiwwLDAuMy0wLjFsNTkuNy0zNy4zYzAuMy0wLjIsMC40LTAuNywwLjItMXMtMC42LTAuNS0wLjktMC4zTDc3LjQsNTIxCgkJCQkJCWMtMC4zLDAuMi0wLjQsMC43LTAuMiwxQzc3LjMsNTIyLjIsNzcuNSw1MjIuMyw3Ny43LDUyMi4zeiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik03Ny43LDUyOS4xYzAuMSwwLDAuMiwwLDAuMy0wLjFsNTkuNy0zNy4zYzAuMy0wLjIsMC40LTAuNywwLjItMXMtMC42LTAuNS0wLjktMC4zbC01OS43LDM3LjMKCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjctMC4yLDFDNzcuMyw1MjguOSw3Ny41LDUyOS4xLDc3LjcsNTI5LjF6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTc3LjcsNTM3LjVjMC4xLDAsMC4yLDAsMC4zLTAuMWw0MC42LTI1LjRjMC4zLTAuMiwwLjQtMC43LDAuMi0xcy0wLjYtMC41LTAuOS0wLjNsLTQwLjYsMjUuNAoJCQkJCQljLTAuMywwLjItMC40LDAuNy0wLjIsMVM3Ny41LDUzNy41LDc3LjcsNTM3LjV6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0NSIgZD0iTTc3LjcsNTQ1LjljMC4xLDAsMC4yLDAsMC4zLTAuMWw0MC42LTI1LjRjMC4zLTAuMiwwLjQtMC43LDAuMi0xcy0wLjYtMC41LTAuOS0wLjNsLTQwLjYsMjUuNAoJCQkJCQljLTAuMywwLjItMC40LDAuNy0wLjIsMUM3Ny4zLDU0NS43LDc3LjUsNTQ1LjksNzcuNyw1NDUuOXoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3Q1IiBkPSJNNzcuNyw1NTQuMmMwLjEsMCwwLjIsMCwwLjMtMC4xbDQwLjYtMjUuNGMwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM2wtNDAuNiwyNS40CgkJCQkJCWMtMC4zLDAuMi0wLjQsMC43LTAuMiwxQzc3LjMsNTU0LjEsNzcuNSw1NTQuMiw3Ny43LDU1NC4yeiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik03Ny43LDU2Mi42YzAuMSwwLDAuMiwwLDAuMy0wLjFsNDAuNi0yNS40YzAuMy0wLjIsMC40LTAuNywwLjItMXMtMC42LTAuNS0wLjktMC4zbC00MC42LDI1LjQKCQkJCQkJYy0wLjMsMC4yLTAuNCwwLjctMC4yLDFTNzcuNSw1NjIuNiw3Ny43LDU2Mi42eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik03Ny43LDU3MWMwLjEsMCwwLjIsMCwwLjMtMC4xbDQwLjYtMjUuNGMwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM2wtNDAuNiwyNS40CgkJCQkJCWMtMC4zLDAuMi0wLjQsMC43LTAuMiwxQzc3LjMsNTcwLjgsNzcuNSw1NzEsNzcuNyw1NzF6Ii8+CgkJCQk8L2c+CgkJCTwvZz4KCQk8L2c+CgkJPGc+CgkJCTxnPgoJCQkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTE0NS43LDU3Ny4xYzEuMSwwLDIuMS0wLjMsMy0wLjlsODktNTUuNmMxLjktMS4yLDMtMy4zLDMtNS43di05NS4yYzAtMy42LTIuNy02LjYtNi4xLTYuNgoJCQkJCWMtMS4xLDAtMi4xLDAuMy0zLDAuOWwtNS43LDMuNnYtMi4zYzAtMi4yLTEuNS0zLjktMy41LTMuOWMtMC43LDAtMS41LDAuMi0yLjIsMC43bC0xOC45LDExLjhjLTEuNywxLjEtMywzLjMtMyw1LjN2NS43CgkJCQkJbC01NS43LDM0LjhjLTEuOSwxLjItMywzLjMtMyw1Ljd2OTUuMmMwLDEuOCwwLjcsMy41LDEuOSw0LjdDMTQyLjYsNTc2LjUsMTQ0LjEsNTc3LjEsMTQ1LjcsNTc3LjFMMTQ1LjcsNTc3LjFMMTQ1LjcsNTc3LjF6Ii8+CgkJCQk8cGF0aCBjbGFzcz0ic3Q3IiBkPSJNMTQ0LDQ3Mi4ybDU3LTM1LjZ2LTcuM2MwLTEsMC44LTIuMywxLjctMi44bDE4LjktMTEuOGMwLjktMC42LDEuNy0wLjIsMS43LDAuOHY3LjNsOS43LTYuMQoJCQkJCWMyLjMtMS40LDUuMSwwLjMsNS4xLDMuMnY5NS4yYzAsMS4zLTAuNiwyLjUtMS43LDMuMmwtODksNTUuNmMtMi4zLDEuNC01LjEtMC4zLTUuMS0zLjJ2LTk1LjJDMTQyLjMsNDc0LDE0Mi45LDQ3Mi44LDE0NCw0NzIuMgoJCQkJCUwxNDQsNDcyLjJ6Ii8+CgkJCTwvZz4KCQkJPHBhdGggY2xhc3M9InN0NyIgZD0iTTE0NS40LDQ3My43bDU3LTM1LjZ2LTcuM2MwLTEsMC44LTIuMywxLjctMi44bDE4LjktMTEuOGMwLjktMC42LDEuNy0wLjIsMS43LDAuOHY3LjNsOS43LTYuMQoJCQkJYzIuMy0xLjQsNS4xLDAuMyw1LjEsMy4ydjk1LjJjMCwxLjMtMC42LDIuNS0xLjcsMy4ybC04OSw1NS42Yy0yLjMsMS40LTUuMS0wLjMtNS4xLTMuMlY0NzcKCQkJCUMxNDMuNyw0NzUuNSwxNDQuMyw0NzQuMywxNDUuNCw0NzMuN0wxNDUuNCw0NzMuN3oiLz4KCQkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTIyNi41LDQ1Mi41bC0zMy42LDIxYy0xLjYsMS0zLDAuNC0zLTEuM3YtMTYuN2MwLTEuOCwxLjMtNCwzLTUuMWwzMy42LTIxYzEuNi0xLDMtMC40LDMsMS4zdjE2LjcKCQkJCUMyMjkuNSw0NDkuMiwyMjguMSw0NTEuNSwyMjYuNSw0NTIuNXoiLz4KCQkJPGc+CgkJCQk8cGF0aCBjbGFzcz0ic3Q2IiBkPSJNMTY4LjMsNDk1LjZjMC4xLDAsMC4yLDAsMC4zLTAuMWw1OS43LTM3LjNjMC4zLTAuMiwwLjQtMC43LDAuMi0xcy0wLjYtMC41LTAuOS0wLjNMMTY4LDQ5NC4zCgkJCQkJYy0wLjMsMC4yLTAuNCwwLjctMC4yLDFDMTY3LjksNDk1LjUsMTY4LjEsNDk1LjYsMTY4LjMsNDk1LjZ6Ii8+CgkJCQk8cGF0aCBjbGFzcz0ic3Q2IiBkPSJNMTY4LjMsNTAyLjRjMC4xLDAsMC4yLDAsMC4zLTAuMWw1OS43LTM3LjNjMC4zLTAuMiwwLjQtMC43LDAuMi0xcy0wLjYtMC41LTAuOS0wLjNMMTY4LDUwMQoJCQkJCWMtMC4zLDAuMi0wLjQsMC43LTAuMiwxQzE2Ny45LDUwMi4yLDE2OC4xLDUwMi40LDE2OC4zLDUwMi40eiIvPgoJCQkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTE2OC4zLDUxMC44YzAuMSwwLDAuMiwwLDAuMy0wLjFsNDAuNi0yNS40YzAuMy0wLjIsMC40LTAuNywwLjItMXMtMC42LTAuNS0wLjktMC4zTDE2OCw1MDkuNAoJCQkJCWMtMC4zLDAuMi0wLjQsMC43LTAuMiwxQzE2Ny45LDUxMC43LDE2OC4xLDUxMC44LDE2OC4zLDUxMC44eiIvPgoJCQkJPHBhdGggY2xhc3M9InN0NiIgZD0iTTE2OC4zLDUxOS4yYzAuMSwwLDAuMiwwLDAuMy0wLjFsNDAuNi0yNS40YzAuMy0wLjIsMC40LTAuNywwLjItMXMtMC42LTAuNS0wLjktMC4zTDE2OCw1MTcuOAoJCQkJCWMtMC4zLDAuMi0wLjQsMC43LTAuMiwxQzE2Ny45LDUxOSwxNjguMSw1MTkuMiwxNjguMyw1MTkuMnoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDYiIGQ9Ik0xNjguMyw1MjcuNWMwLjEsMCwwLjIsMCwwLjMtMC4xbDQwLjYtMjUuNGMwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM0wxNjgsNTI2LjEKCQkJCQljLTAuMywwLjItMC40LDAuNy0wLjIsMUMxNjcuOSw1MjcuNCwxNjguMSw1MjcuNSwxNjguMyw1MjcuNXoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDYiIGQ9Ik0xNjguMyw1MzUuOWMwLjEsMCwwLjIsMCwwLjMtMC4xbDQwLjYtMjUuNGMwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM0wxNjgsNTM0LjUKCQkJCQljLTAuMywwLjItMC40LDAuNy0wLjIsMUMxNjcuOSw1MzUuOCwxNjguMSw1MzUuOSwxNjguMyw1MzUuOXoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDYiIGQ9Ik0xNjguMyw1NDQuM2MwLjEsMCwwLjIsMCwwLjMtMC4xbDQwLjYtMjUuNGMwLjMtMC4yLDAuNC0wLjcsMC4yLTFzLTAuNi0wLjUtMC45LTAuM0wxNjgsNTQyLjkKCQkJCQljLTAuMywwLjItMC40LDAuNy0wLjIsMUMxNjcuOSw1NDQuMSwxNjguMSw1NDQuMywxNjguMyw1NDQuM3oiLz4KCQkJPC9nPgoJCQk8cGF0aCBjbGFzcz0ic3Q3IiBkPSJNMjIxLDQyNy42bC0xOC45LDExLjhjLTAuOSwwLjYtMS43LDAuMi0xLjctMC44di05LjRjMC0xLDAuOC0yLjMsMS43LTIuOGwxOC45LTExLjgKCQkJCWMwLjktMC42LDEuNy0wLjIsMS43LDAuOHY5LjRDMjIyLjcsNDI1LjgsMjIyLDQyNywyMjEsNDI3LjZ6Ii8+CgkJPC9nPgoJCTxnPgoJCQk8Zz4KCQkJCTxwYXRoIGNsYXNzPSJzdDUiIGQ9Ik0xMjQuMyw1NTkuM0wxODQsNTIyYzEuOS0xLjIsMy40LTMuOCwzLjQtNS45di01OS43YzAtMi4xLTEuNS0yLjgtMy40LTEuNmwtNTkuNywzNy4zCgkJCQkJYy0xLjksMS4yLTMuNCwzLjgtMy44LDYuN2MwLDAsMC4xLDU4LjksMC4xLDU5LjlzMS41LDIuMiwyLjYsMi4yQzEyMy43LDU2MC45LDEyNC4yLDU2MC4xLDEyNC4zLDU1OS4zTDEyNC4zLDU1OS4zeiIvPgoJCQkJPHBhdGggY2xhc3M9InN0MTMiIGQ9Ik0xMTcuOCw1NTUuM2w1NS43LTM0LjhjMS44LTEuMSwzLjItMy42LDMuMi01LjV2LTU1LjdjMC0xLjktMS40LTIuNi0zLjItMS41bC01NS43LDM0LjgKCQkJCQljLTEuOCwxLjEtMy4yLDMuNi0zLjIsNS41djU1LjdDMTE0LjYsNTU1LjgsMTE2LDU1Ni40LDExNy44LDU1NS4zeiIvPgoJCQkJPHBhdGggY2xhc3M9InN0MTAiIGQ9Ik0xMjUuMSw1NjAuNGw1OS43LTM3LjNjMS45LTEuMiwzLjQtMy44LDMuNC01Ljl2LTU5LjdjMC0yLjEtMS41LTIuOC0zLjQtMS42bC01OS43LDM3LjMKCQkJCQljLTEuOSwxLjItMy40LDMuOC0zLjQsNS45djU5LjdDMTIxLjcsNTYwLjksMTIzLjIsNTYxLjYsMTI1LjEsNTYwLjR6Ii8+CgkJCQk8cGF0aCBjbGFzcz0ic3Q3IiBkPSJNMTI3LjIsNTU2LjlsNTUuNy0zNC44YzEuOC0xLjEsMy4yLTMuNiwzLjItNS41di01NS43YzAtMS45LTEuNC0yLjYtMy4yLTEuNWwtNTUuNywzNC44CgkJCQkJYy0xLjgsMS4xLTMuMiwzLjYtMy4yLDUuNXY1NS43QzEyNCw1NTcuNCwxMjUuNSw1NTgsMTI3LjIsNTU2Ljl6Ii8+CgkJCTwvZz4KCQkJPGc+CgkJCQk8Zz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxNiIgZD0iTTE0Ni44LDQ5NS4yYzAsMS0wLjEsMy4xLDEsNmMwLjcsMS44LDIuMiw0LjMsMy4yLDYuMWMwLjEsMC4yLDAuMiwwLjQsMC40LDAuNmMwLjEsMC4xLDAuMiwwLjMsMC4yLDAuNAoJCQkJCQljMC4zLDAuNSwwLjUsMC44LDAuNiwwLjlsMCwwYzAsMCwwLjItMC4xLDAuNi0wLjJjMC4yLTAuMSwwLjUtMC4yLDAuOC0wLjJjMC4zLTAuMSwwLjYtMC4yLDAuOS0wLjNsMCwwCgkJCQkJCWMwLjgtMC4yLDEuNy0wLjUsMi42LTAuOWMxLjItMC40LDIuNC0wLjgsMy40LTEuMmMwLjUtMC4yLDAuOS0wLjMsMS4yLTAuNWMwLjItMC4xLDAuMy0wLjIsMC41LTAuMmwwLDAKCQkJCQkJYzAuNS0wLjIsMC44LTAuNCwwLjgtMC41YzAuMS0wLjMsMC4yLTAuNSwwLjMtMC44YzAuNy0yLjEsMS40LTQuMywxLjYtNy42YzAuMS0xLjktMC4xLTIuOC0wLjUtMy41bDAsMAoJCQkJCQljLTAuMy0wLjYtMC44LTAuOS0xLTEuNGMtMC4xLTAuMS0wLjgtMS4yLTEuOC0yLjZsMCwwYy0xLjYtMS45LTQtNC4yLTYuMy00LjFjLTMuOCwwLjEtNy4zLDYuOC03LjcsNy4yCgkJCQkJCWMtMC4xLDAuMS0wLjEsMC4yLTAuMiwwLjJjLTAuMywwLjUtMC41LDEuMS0wLjYsMS43QzE0Ni44LDQ5NC43LDE0Ni44LDQ5NC45LDE0Ni44LDQ5NS4yTDE0Ni44LDQ5NS4yeiIvPgoJCQkJCTxnPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QxNyIgZD0iTTE0Miw1NDcuN2w1LjktMy43bDAuMS0wLjFsOS01LjZjLTItMTAuMy00LjMtMjUuNy00LjgtMjkuMmMtMC4xLTAuMS0wLjItMC40LTAuNi0wLjlsLTAuMy0wLjIKCQkJCQkJCWMwLDAsMC0wLjEsMC4xLTAuMmMtMC4xLTAuMi0wLjItMC40LTAuNC0wLjZjLTIuMiwxLjctMy45LDMuMy0zLjksMy4zcy0yLjUsMi42LTMuNCw2LjVDMTQzLjIsNTE5LjcsMTQyLjUsNTM2LjIsMTQyLDU0Ny43CgkJCQkJCQlMMTQyLDU0Ny43eiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QxNyIgZD0iTTE1MS40LDUwNy45YzAsMC4xLTAuMSwwLjItMC4xLDAuMmwwLjMsMC4yYzAuMywwLjUsMC41LDAuOCwwLjYsMC45YzAuNSwzLjUsMi45LDE4LjksNC44LDI5LjJsMy4yLTIKCQkJCQkJCWMwLjUtOS42LDEuMS0yMi42LDEuNC0yOC4yYzAuMS0wLjEsMC4xLTAuMSwwLjEtMC4yYzAuMi0wLjMsMC40LTEuOCwwLjUtMi4zYzAuNS0wLjIsMC44LTAuNCwwLjgtMC41CgkJCQkJCQljMC4xLTAuMywwLjItMC41LDAuMy0wLjhjLTEuMS0wLjMtMi4zLTAuNS0zLjQtMC42Yy0wLjEsMC0wLjEsMC0wLjEsMGMtMC43LDAtMS4zLTAuMS0xLjksMGwwLDBjLTAuNSwwLjEtMSwwLjItMS40LDAuMwoJCQkJCQkJYy0wLjMsMC4xLTAuNiwwLjMtMC45LDAuNGwwLDBjLTAuNSwwLjMtMS4xLDAuNi0xLjYsMC45Yy0wLjIsMC4xLTAuNCwwLjItMC42LDAuM2MtMC4yLDAuMi0wLjUsMC4zLTAuNywwLjVzLTAuNSwwLjQtMC44LDAuNgoJCQkJCQkJbDAsMGMtMC4yLDAuMi0wLjUsMC40LTAuNywwLjVDMTUxLjIsNTA3LjUsMTUxLjMsNTA3LjcsMTUxLjQsNTA3LjlMMTUxLjQsNTA3Ljl6Ii8+CgkJCQkJPC9nPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMTYxLjcsNDg5LjdjMC40LDEuNywwLjYsNC40LDAuMiw2LjJjLTAuNCwyLTAuNiwzLjQtMS41LDUuM2MtMC44LDEuNi0yLjYsMi45LTQuMywzLjMKCQkJCQkJYy0xLjEsMC4zLTItMC4yLTIuOS0wLjljLTAuOS0wLjctMS44LTEuOS0yLjUtMi45Yy0xLjItMS43LTIuNC0zLjItMy01LjNzLTAuNi00LjMsMC4yLTYuM3MyLjEtNC40LDQtNC44CgkJCQkJCWMxLjYtMC40LDMuOC0wLjYsNy43LDEuNkMxNjAuNCw0ODYuMSwxNjEuNSw0ODguOCwxNjEuNyw0ODkuN0wxNjEuNyw0ODkuN3oiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTE2My41LDQ5NC41Yy0wLjEsMS4xLTAuNiwyLjctMS4xLDMuMnMtMS4xLDAuNi0xLjQsMGMtMC4zLTAuNi0wLjMtMi41LDAuMS0zLjJjMC4xLTAuMiwwLjktMS42LDEuNS0xLjYKCQkJCQkJQzE2My4yLDQ5Mi45LDE2My41LDQ5NC40LDE2My41LDQ5NC41TDE2My41LDQ5NC41eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMTQ3LjcsNDk3LjJjMC4zLDEuMSwwLjcsMiwxLjYsMi44YzAuMiwwLjIsMC42LDAuNCwwLjksMC40YzAuMiwwLDAuNC0wLjIsMC40LTAuNAoJCQkJCQljMC4xLTAuMiwwLjEtMi44LTAuNS0zLjdjLTAuMi0wLjMtMC42LTEuMi0xLjYtMS4yQzE0Ny41LDQ5NS4zLDE0Ny42LDQ5NywxNDcuNyw0OTcuMkwxNDcuNyw0OTcuMnoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3Q4IiBkPSJNMTUyLjYsNTA1LjFjMCwwLDEuOS0yLjYsNC4zLTIuNmMyLjEsMCw0LjgsMi40LDUuNCwzYy0wLjEsMC41LTEuMSwxLjktMS44LDIuNGMtMC42LDAuNS0yLjksMC44LTUuNywwLjUKCQkJCQkJUzE1Mi42LDUwNS4xLDE1Mi42LDUwNS4xTDE1Mi42LDUwNS4xeiIvPgoJCQkJCTxnPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTE1OS4zLDUwMS4xYzAtMC4xLDAtMC4xLDAuMS0wLjJDMTU5LjQsNTAxLDE1OS40LDUwMSwxNTkuMyw1MDEuMUwxNTkuMyw1MDEuMUwxNTkuMyw1MDEuMUwxNTkuMyw1MDEuMQoJCQkJCQkJeiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTE1My4zLDUwMi43YzIuMSwwLjEsNi4xLTEuNSw2LjEtMS41czAuNCw0LjMsMS41LDUuOGMtMSwxLTIuNCwwLjktMy43LDEuMmMtMS4yLDAuMy0yLjQsMS4xLTMuNSwwLjYKCQkJCQkJCUMxNTQsNTA3LjcsMTUzLjgsNTAzLjYsMTUzLjMsNTAyLjdMMTUzLjMsNTAyLjd6Ii8+CgkJCQkJPC9nPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDE2IiBkPSJNMTYyLjcsNDg0LjdjLTEuMi0xLjgtNC45LTMuNi03LjItMy4zYy0yLjQsMC4zLTUuNywyLjUtNi44LDQuM2MtMi45LDQuOC0yLjEsOS42LTAuOSwxMwoJCQkJCQljMC43LTAuNCwxLjItMS4yLDEuNS0yYzAuNC0xLjIsMC4yLTIuNywwLjktMy43YzAuNS0wLjgsMS40LTEsMi4zLTAuOWMzLjIsMC4yLDYuMS0yLjIsNi40LTMuMWMtMC41LDMuMiwwLjgsNC40LDEuOCw1CgkJCQkJCWMwLjYsMC4zLDEuMywwLjUsMS43LDFjMC40LDAuNCwwLjUsMS43LDEsMS44YzEuMywwLjEsMC44LTMuMywwLjktMy45QzE2NC45LDQ5MC4zLDE2NC4yLDQ4Ni45LDE2Mi43LDQ4NC43TDE2Mi43LDQ4NC43eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDgiIGQ9Ik0xNTcuMiw1MDcuM3YwLjJ2MC4xdjAuNnYwLjNsMC4xLDAuMmwxLjMsMS45YzAsMCwyLjEtMSwzLTIuM2MwLjEtMC4xLDAuMS0wLjEsMC4xLTAuMgoJCQkJCQljMC4yLTAuMywwLjQtMS44LDAuNS0yLjNjMC0wLjEsMC0wLjEsMC0wLjFsLTIuMy0xLjNjMCwwLDAsMC4yLDAsMC40Yy0wLjEsMC41LTAuMiwxLjMtMC42LDEuNgoJCQkJCQlDMTU4LjcsNTA2LjcsMTU3LjIsNTA3LjMsMTU3LjIsNTA3LjNMMTU3LjIsNTA3LjN6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0OCIgZD0iTTE1MS40LDUwOC4xbDAuMywwLjJsMC41LDAuM2wwLjcsMC40bDMuNiwyLjFsMC43LTIuNWwwLjEtMC4ydi0wLjN2LTAuNnYtMC4xdi0wLjJjMCwwLTIuMy0wLjQtMy0wLjgKCQkJCQkJYy0wLjEsMC0wLjItMC4xLTAuNC0wLjNjLTAuMi0wLjEtMC40LTAuMy0wLjYtMC41Yy0wLjQtMC4zLTAuNy0wLjYtMC43LTAuNmMtMC4yLDAuMS0wLjUsMC45LTAuOCwxLjZsMCwwCgkJCQkJCWMtMC4xLDAuNC0wLjMsMC45LTAuMywxLjFDMTUxLjQsNTA4LDE1MS40LDUwOCwxNTEuNCw1MDguMUwxNTEuNCw1MDguMXoiLz4KCQkJCTwvZz4KCQkJCTxwYXRoIGNsYXNzPSJzdDgiIGQ9Ik0xNTIuMSw1MDguNEMxNTIuMSw1MDguNCwxNTIuMSw1MDguNSwxNTIuMSw1MDguNGMwLDAuMiwwLjEsMC40LDAuMSwwLjdjMC41LDMuNSwyLjksMTguOSw0LjgsMjkuMmwzLjItMgoJCQkJCWMwLjUtOS42LDEuMS0yMi42LDEuNC0yOC4yYzAtMC42LDAuMS0xLjIsMC4xLTEuNmwwLDBjMC0wLjMsMC0wLjUsMC0wLjdjMC0wLjMsMC0wLjUsMC0wLjVsLTEuNCwwLjZsLTMuMiwxLjRIMTU3bC0zLjMsMC42CgkJCQkJaC0wLjFMMTUyLjEsNTA4LjRMMTUyLjEsNTA4LjR6Ii8+CgkJCQk8cGF0aCBjbGFzcz0ic3QxNyIgZD0iTTE2MC4zLDUzNi4zbDYuNS00LjFsMS4yLTAuOGw0LjUtMi44Yy0wLjctNy0yLjEtMTQuOC0yLjYtMTYuNGMtMC42LTIuMy0xLjgtNS4zLTIuNy02cy0yLjEtMS40LTQtMS45CgkJCQkJYy0wLjEsMC4zLTAuMiwwLjYtMC4zLDAuOGMwLDAuMS0wLjMsMC4zLTAuOCwwLjVjLTAuMSwwLjUtMC4zLDItMC41LDIuM2MwLDAuMS0wLjEsMC4xLTAuMSwwLjIKCQkJCQlDMTYxLjQsNTEzLjcsMTYwLjgsNTI2LjcsMTYwLjMsNTM2LjNMMTYwLjMsNTM2LjN6Ii8+CgkJCTwvZz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPGc+CgkJCQk8cGF0aCBjbGFzcz0ic3QxOCIgZD0iTTI4MS44LDYzOS4yYy0xLjQtMC44LTQuMS0wLjktNCwyYzAuMSwxLjUsMS44LDMuNSwzLjcsNC42YzIuMSwxLjEsNi43LDMsNy44LDNzMS4xLDAsMS44LTAuNwoJCQkJCXMtMC4yLTMuOS0wLjYtNC4zQzI5MC4xLDY0My4zLDI4My4xLDY0MCwyODEuOCw2MzkuMkwyODEuOCw2MzkuMnoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjg2LjcsNjIyLjhjMCwwLTAuOCwxLjItMC41LDhjMC4yLDUuNSwwLDEwLjQtMC4zLDEwLjNjLTIuNC0wLjctMy40LDEuMi0zLjIsMS40YzAsMCw2LjIsMy4yLDcuNSwzLjIKCQkJCQlzMC4zLTMuOSwwLjMtNS4yczIuNi0xNi40LDIuNi0xNi40TDI4Ni43LDYyMi44TDI4Ni43LDYyMi44eiIvPgoJCQk8L2c+CgkJCTxnPgoJCQkJPHBhdGggY2xhc3M9InN0MTkiIGQ9Ik0zMTMuOCw2NzYuNmMtMC42LDAtMS0wLjUtMS0xLjF2LTI4LjNjMC0wLjYsMC41LTEuMSwxLTEuMXMxLDAuNSwxLDEuMXYyOC4zCgkJCQkJQzMxNC44LDY3Ni4xLDMxNC4zLDY3Ni42LDMxMy44LDY3Ni42eiIvPgoJCQkJPHBhdGggY2xhc3M9InN0MTkiIGQ9Ik0yOTMuNSw2NjMuNGMtMC42LDAtMS0wLjUtMS0xLjF2LTI3LjVjMC0wLjYsMC41LTEuMSwxLTEuMXMxLDAuNSwxLDEuMXYyNy41CgkJCQkJQzI5NC42LDY2Mi45LDI5NC4xLDY2My40LDI5My41LDY2My40eiIvPgoJCQkJPHBhdGggY2xhc3M9InN0MTkiIGQ9Ik0zMzQuMSw2NjMuN2MtMC42LDAtMS0wLjUtMS0xLjF2LTI3LjJjMC0wLjYsMC41LTEuMSwxLTEuMXMxLDAuNSwxLDEuMXYyNy4yCgkJCQkJQzMzNS4xLDY2My4yLDMzNC42LDY2My43LDMzNC4xLDY2My43eiIvPgoJCQkJPHBhdGggY2xhc3M9InN0MjAiIGQ9Ik0zMzQuOCw2MzUuMWwtMjAsMTIuNmMtMC4zLDAuMi0wLjgsMC4yLTEuMSwwbC0yMC4xLTEyLjZjLTAuNy0wLjQtMC43LTEuNiwwLTJsMjAtMTIuNgoJCQkJCWMwLjMtMC4yLDAuOC0wLjIsMS4xLDBsMjAuMSwxMi42QzMzNS41LDYzMy42LDMzNS41LDYzNC43LDMzNC44LDYzNS4xTDMzNC44LDYzNS4xeiIvPgoJCQk8L2c+CgkJCTxnPgoJCQkJPGc+CgkJCQkJPHBhdGggY2xhc3M9InN0MTgiIGQ9Ik0yNzUsNjQ1LjVjLTIuNi0xLjMtNS4zLDAuMS00LjUsMi41YzAuOSwyLjQsMi44LDIuOSw0LjUsMy44YzEuOCwxLDUuNSwyLjcsNi41LDIuN3MxLjYtMC40LDIuMy0xCgkJCQkJCWMwLjctMC42LDAuNS0xLjYsMC4zLTIuM2MtMC4zLTEtMi0yLjUtNC4xLTMuNEMyNzcuNyw2NDYuOCwyNzUuNiw2NDUuOCwyNzUsNjQ1LjVMMjc1LDY0NS41eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjc4LjksNjE5LjJjLTAuNiwxLjcsMC40LDI1LjEtMC4zLDI2LjRzLTAuOSwxLTAuOSwxYy0xLjcsMC4zLTIuMywxLjEtMS41LDMuMWMwLDAsNC40LDIuNSw0LjgsMi43CgkJCQkJCWMxLjUsMC43LDMuNC0wLjksMi44LTIuN2MtMC4zLTMuNC0wLjQtNS4zLTAuMy02LjNjMC4xLTEuMywyLjMtMjAuNywxLjgtMjIuOUMyODQuOCw2MTguMSwyNzkuNSw2MTcuNCwyNzguOSw2MTkuMgoJCQkJCQlMMjc4LjksNjE5LjJ6Ii8+CgkJCQk8L2c+CgkJCQk8Zz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QyMSIgZD0iTTMxOS43LDYxOC4zYzEuNCwzLjMsNC4yLDYuOSwzLjQsMTAuOGMtMC43LDMuMS0xLjcsMTAuMy01LjksMTIuNGMtMS4xLDAuNi00LjYsMS04LjQsMC40CgkJCQkJCXMtMTUtNy40LTE1LTcuNGwyLjUtMTNjMCwwLDUuMy0wLjgsOS4yLTIuMUMzMTIuOSw2MTcuMSwzMTkuMiw2MTguOCwzMTkuNyw2MTguM0wzMTkuNyw2MTguM3oiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QyMSIgZD0iTTMyMC43LDYyMy4xYy05LjQtNS4yLTI3LjUtOS44LTMxLjItMTAuNGMtMy43LTAuNy03LjUsMS44LTkuMiwzLjFjLTEuNiwxLjQtMS40LDUuMy0yLjIsOC41CgkJCQkJCWMtMC44LDMuMiw5LjUsNi44LDE1LjcsMTAuMmM0LjUsMi41LDEyLjEsNS4xLDEzLjMsNmMyLjYsMiw3LjIsMi4yLDExLDAuMkMzMjMuNSw2MzcuNywzMjUuNCw2MjUuNywzMjAuNyw2MjMuMUwzMjAuNyw2MjMuMXoiCgkJCQkJCS8+CgkJCQk8L2c+CgkJCTwvZz4KCQk8L2c+CgkJPGc+CgkJCTxnPgoJCQkJPGc+CgkJCQkJPHBhdGggY2xhc3M9InN0MjIiIGQ9Ik0yMDMuOSw2ODIuNmMtMS40LTAuOC02LjEtMC44LTYsMi4yYzAuMSwxLjYsMy42LDMuMiw1LjUsNC4zYzIuMSwxLjEsNi44LDIuOSw4LDIuOXMyLjMtMC41LDMuMS0xLjIKCQkJCQkJcy0wLjItMy4xLTAuNi0zLjVjLTAuMy0wLjMtNC4yLTItNy4yLTMuM0MyMDUuNSw2ODMuNCwyMDQuNCw2ODIuOSwyMDMuOSw2ODIuNkwyMDMuOSw2ODIuNnoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxNSIgZD0iTTIxMC40LDY3Ni4zbC0wLjksNy4xYzAsMC0zLjUsMS43LTMuMywxLjljMCwwLDQuNSwyLjIsNS44LDIuMnMxLjYtMS40LDEuOC0yLjhjMC4yLTEuNCwwLjQtNi42LDAuNC02LjYKCQkJCQkJTDIxMC40LDY3Ni4zTDIxMC40LDY3Ni4zeiIvPgoJCQkJPC9nPgoJCQkJPHBhdGggY2xhc3M9InN0MjIiIGQ9Ik0yMzcuNSw2NzMuNWMtMS45LDIuMi0yMC42LTkuNC0yMC42LTkuNGwtMi40LDE5LjNjMCwwLTEsMi0yLjksMS44Yy0xLjgtMC4yLTMuNi0yLjItMy42LTIuMgoJCQkJCXMxLjQtMjUuNSwxLjctMjcuMnMxLjUtMS43LDMuNC0yLjFjMS45LTAuNCwyNC4yLDguMSwyNC4yLDguMVMyMzkuNSw2NzEuMywyMzcuNSw2NzMuNUwyMzcuNSw2NzMuNXoiLz4KCQkJPC9nPgoJCQk8Zz4KCQkJCTxwYXRoIGNsYXNzPSJzdDE5IiBkPSJNMjM0LjQsNzIzLjFjLTAuNiwwLTEtMC41LTEtMS4xdi0yOC4zYzAtMC42LDAuNS0xLjEsMS0xLjFzMSwwLjUsMSwxLjFWNzIyCgkJCQkJQzIzNS41LDcyMi42LDIzNSw3MjMuMSwyMzQuNCw3MjMuMXoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDE5IiBkPSJNMjE0LjIsNzA5LjljLTAuNiwwLTEtMC41LTEtMS4xdi0yNy41YzAtMC42LDAuNS0xLjEsMS0xLjFzMSwwLjUsMSwxLjF2MjcuNQoJCQkJCUMyMTUuMiw3MDkuNCwyMTQuOCw3MDkuOSwyMTQuMiw3MDkuOXoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDE5IiBkPSJNMjU0LjgsNzEwLjJjLTAuNiwwLTEtMC41LTEtMS4xdi0yNy4yYzAtMC42LDAuNS0xLjEsMS0xLjFzMSwwLjUsMSwxLjF2MjcuMgoJCQkJCUMyNTUuOCw3MDkuNywyNTUuMyw3MTAuMiwyNTQuOCw3MTAuMnoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDIwIiBkPSJNMjU1LjUsNjgxLjdsLTIwLDEyLjZjLTAuMywwLjItMC44LDAuMi0xLjEsMGwtMjAuMS0xMi42Yy0wLjctMC40LTAuNy0xLjYsMC0ybDIwLTEyLjYKCQkJCQljMC4zLTAuMiwwLjgtMC4yLDEuMSwwbDIwLjEsMTIuNkMyNTYuMiw2ODAuMSwyNTYuMiw2ODEuMiwyNTUuNSw2ODEuN0wyNTUuNSw2ODEuN3oiLz4KCQkJPC9nPgoJCQk8Zz4KCQkJCTxnPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDIyIiBkPSJNMTkzLjcsNjkwYy0zLjUtMi41LTcuOCwxLjktNi41LDQuNGMxLjIsMi4yLDMuNSwzLDUuNCw0YzIsMS4xLDYuOSwyLjYsOCwyLjZzMi0wLjQsMi43LTEuMQoJCQkJCQlzMC43LTQuNSwwLjUtNS4zYy0wLjMtMS4yLTIuNS0wLjQtNC45LTEuNUMxOTYuNSw2OTIsMTk0LjMsNjkwLjUsMTkzLjcsNjkwTDE5My43LDY5MHoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxNSIgZD0iTTE5OC4zLDY4OC44YzAsMCwwLDIuOC0wLjIsM2MtMC43LDEuMi0xLjQsMC42LTEuNCwwLjZjLTEuNywwLjMsMS41LDIuMSwzLjUsMi44CgkJCQkJCWMxLjksMC43LDMuOCwwLjUsMy4yLTEuMmMtMS4zLTMuMy0wLjctMy44LTAuNy0zLjhMMTk4LjMsNjg4LjhMMTk4LjMsNjg4Ljh6Ii8+CgkJCQk8L2c+CgkJCQk8cGF0aCBjbGFzcz0ic3QyMyIgZD0iTTIwMi40LDY1OS40Yy0wLjQsMi4xLTUuNCwzMC4zLTUuMiwzMS4yczIuNSwyLjMsNC4yLDIuNXMyLjYtMS42LDIuNi0xLjZsNC43LTIzLjRjMS45LTEuOSwzLTQuMywxLjItNy43CgkJCQkJQzIxMS41LDY1NiwyMDIuOCw2NTcuMiwyMDIuNCw2NTkuNEwyMDIuNCw2NTkuNHoiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDIzIiBkPSJNMjQ4LjcsNjYzYzEuMSwyLjYsMS40LDExLjUsMC44LDE0LjZjLTAuNywzLjEtMTEuMyw2LjctMTUuMSw3LjRzLTExLTQuNC0xMS00LjRsNS40LTExCgkJCQkJYzAsMCwyLjEtMi42LDUuMi0zLjZDMjM5LjcsNjY0LjIsMjQ4LjMsNjYzLjQsMjQ4LjcsNjYzTDI0OC43LDY2M3oiLz4KCQkJCTxwYXRoIGNsYXNzPSJzdDIzIiBkPSJNMjM2LjksNjcxLjZjMCwwLTI3LTEzLjctMjguNi0xMy45YzAsMC0yLjksMC4yLTMuNiwyLjhjLTAuNiwyLjUsMS41LDYuMywxLjUsNi4zczE0LjMsMTMuNCwxNy4xLDEzLjkKCQkJCQljMS42LDAuMyw3LjEsMS43LDEwLDAuMUMyMzcuNyw2NzguMywyMzYuOSw2NzEuNiwyMzYuOSw2NzEuNkwyMzYuOSw2NzEuNnoiLz4KCQkJPC9nPgoJCTwvZz4KCQk8Zz4KCQkJPHBvbHlnb24gY2xhc3M9InN0MTMiIHBvaW50cz0iMTkzLjYsNjM2LjUgMjY4LjEsNTg5LjcgMzI1LjQsNjI1LjcgMTgxLjEsNzIyIDExOSw2ODMuNCAJCQkiLz4KCQkJPGc+CgkJCQk8cGF0aCBjbGFzcz0ic3QxOSIgZD0iTTE4Mi40LDcyMmMtMC45LDAtMS42LTAuOC0xLjYtMS44VjY3MGMwLTEsMC43LTEuOCwxLjYtMS44czEuNiwwLjgsMS42LDEuOHY1MC4yCgkJCQkJQzE4NCw3MjEuMiwxODMuMyw3MjIsMTgyLjQsNzIyeiIvPgoJCQkJPHBhdGggY2xhc3M9InN0MTkiIGQ9Ik0xNDMuOSw2OTguM2MtMC45LDAtMS42LTAuOC0xLjYtMS44di00OC45YzAtMSwwLjctMS44LDEuNi0xLjhzMS42LDAuOCwxLjYsMS44djQ4LjkKCQkJCQlDMTQ1LjYsNjk3LjUsMTQ0LjgsNjk4LjMsMTQzLjksNjk4LjN6Ii8+CgkJCTwvZz4KCQkJPHBvbHlnb24gY2xhc3M9InN0MjQiIHBvaW50cz0iMjU3LjcsNjIzLjMgMjU3LjcsNjI1LjggMTgzLjEsNjcyLjcgMTgzLjIsNjcwLjIgCQkJIi8+CgkJCTxwb2x5Z29uIGNsYXNzPSJzdDI0IiBwb2ludHM9IjE4My4yLDY3MC4yIDE4My4xLDY3Mi43IDE0MS42LDY0Ni43IDE0MS42LDY0NC4yIAkJCSIvPgoJCQk8cG9seWdvbiBjbGFzcz0ic3Q3IiBwb2ludHM9IjIxNi4xLDU5Ny4zIDI5MC43LDU1MC41IDMzMi4yLDU3Ni40IDI1Ny43LDYyMy4zIDE4My4yLDY3MC4yIDE0MS42LDY0NC4yIAkJCSIvPgoJCTwvZz4KCQk8Zz4KCQkJPGc+CgkJCQk8cG9seWdvbiBjbGFzcz0ic3Q2IiBwb2ludHM9IjE5Mi45LDYyOC45IDIwMy40LDYyMi40IDIxOC4xLDYzMS42IDIwNy43LDYzOC4xIAkJCQkiLz4KCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDciIHBvaW50cz0iMTk0LjYsNjI5LjEgMjAzLjksNjIzLjMgMjE2LjcsNjMxLjQgMjA3LjQsNjM3LjIgCQkJCSIvPgoJCQkJPGc+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NiIgcG9pbnRzPSIyMDQuOCw2MzMuMiAyMTAuOCw2MjkuNSAyMTEsNjI5LjYgMjA0LjksNjMzLjQgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q2IiBwb2ludHM9IjIwMy42LDYzMi41IDIwOS42LDYyOC43IDIwOS44LDYyOC45IDIwMy44LDYzMi42IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NiIgcG9pbnRzPSIyMDIuNCw2MzEuNyAyMDguNCw2MjggMjA4LjYsNjI4LjEgMjAyLjYsNjMxLjkgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q2IiBwb2ludHM9IjIwMS4yLDYzMSAyMDcuMiw2MjcuMiAyMDcuNCw2MjcuMyAyMDEuNCw2MzEuMSAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDYiIHBvaW50cz0iMjA3LjQsNjM1LjEgMjEzLjUsNjMxLjQgMjEzLjcsNjMxLjUgMjA3LjcsNjM1LjMgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q2IiBwb2ludHM9IjIwNi4xLDYzNC4yIDIxMi4xLDYzMC41IDIxMi4zLDYzMC42IDIwNi4zLDYzNC40IAkJCQkJIi8+CgkJCQk8L2c+CgkJCQk8cG9seWdvbiBjbGFzcz0ic3Q2IiBwb2ludHM9IjIwMS42LDYyNC4xIDIwMyw2MjUgMTk4LjQsNjI3LjggMTk3LDYyNi45IAkJCQkiLz4KCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDYiIHBvaW50cz0iMTk4LjQsNjI5IDIwMC4xLDYzMC4xIDIwMS43LDYyOSAyMDAuMSw2MjggCQkJCSIvPgoJCQk8L2c+CgkJCTxnPgoJCQkJPHBvbHlnb24gY2xhc3M9InN0NiIgcG9pbnRzPSIyNTkuOSw1OTIuMiAyNzAuNCw1ODUuNyAyODUuMSw1OTUgMjc0LjcsNjAxLjUgCQkJCSIvPgoJCQkJPHBvbHlnb24gY2xhc3M9InN0NyIgcG9pbnRzPSIyNjEuNyw1OTIuNCAyNzEsNTg2LjYgMjgzLjcsNTk0LjcgMjc0LjUsNjAwLjUgCQkJCSIvPgoJCQkJPGc+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NiIgcG9pbnRzPSIyNzEuOCw1OTYuNiAyNzcuOCw1OTIuOCAyNzgsNTkzIDI3Miw1OTYuNyAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDYiIHBvaW50cz0iMjcwLjYsNTk1LjggMjc2LjYsNTkyLjEgMjc2LjgsNTkyLjIgMjcwLjgsNTk2IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NiIgcG9pbnRzPSIyNjkuNCw1OTUuMSAyNzUuNCw1OTEuMyAyNzUuNiw1OTEuNCAyNjkuNiw1OTUuMiAJCQkJCSIvPgoJCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDYiIHBvaW50cz0iMjY4LjIsNTk0LjMgMjc0LjIsNTkwLjUgMjc0LjQsNTkwLjcgMjY4LjQsNTk0LjQgCQkJCQkiLz4KCQkJCQk8cG9seWdvbiBjbGFzcz0ic3Q2IiBwb2ludHM9IjI3NC41LDU5OC41IDI4MC41LDU5NC43IDI4MC43LDU5NC44IDI3NC43LDU5OC42IAkJCQkJIi8+CgkJCQkJPHBvbHlnb24gY2xhc3M9InN0NiIgcG9pbnRzPSIyNzMuMSw1OTcuNiAyNzkuMSw1OTMuOCAyNzkuMyw1OTMuOSAyNzMuMyw1OTcuNyAJCQkJCSIvPgoJCQkJPC9nPgoJCQkJPHBvbHlnb24gY2xhc3M9InN0NiIgcG9pbnRzPSIyNjguNiw1ODcuNCAyNzAsNTg4LjMgMjY1LjUsNTkxLjIgMjY0LDU5MC4zIAkJCQkiLz4KCQkJCTxwb2x5Z29uIGNsYXNzPSJzdDYiIHBvaW50cz0iMjY1LjUsNTkyLjQgMjY3LjEsNTkzLjQgMjY4LjgsNTkyLjQgMjY3LjEsNTkxLjQgCQkJCSIvPgoJCQk8L2c+CgkJCTxnPgoJCQkJPGc+CgkJCQkJPHBhdGggY2xhc3M9InN0MjUiIGQ9Ik0xOTQuNyw2NDdjMS41LTIuNSwzLjktMy43LDYuNy00LjJ2LTAuMmwtOS40LTUuN2MtMi41LDAuNC00LjcsMS45LTYuNyw0LjJMMTk0LjcsNjQ3eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDI2IiBkPSJNMTk0LjcsNjQ2LjhjMS41LTIuNSwzLjktMy42LDYuNy00LjJsLTkuNC01LjljLTIuNSwwLjQtNC43LDEuOS02LjcsNC4yTDE5NC43LDY0Ni44eiIvPgoJCQkJCTxnPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QyNSIgZD0iTTE4Ny4yLDY0MWMxLjgtMi4yLDMuNC0yLjgsNS40LTMuM3YtMC4xYy0xLjIsMC4yLTIuMSwwLjYtMi45LDFDMTg4LjgsNjM5LjIsMTg4LDYzOS45LDE4Ny4yLDY0MQoJCQkJCQkJTDE4Ny4yLDY0MUwxODcuMiw2NDF6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDI1IiBkPSJNMTg4LjMsNjQxLjhjMS44LTIuMiwzLjMtMi44LDUuNS0zLjN2LTAuMWMtMS4zLDAuMy0yLjEsMC42LTIuOSwxQzE4OS45LDYzOS45LDE4OS4xLDY0MC43LDE4OC4zLDY0MS44CgkJCQkJCQlMMTg4LjMsNjQxLjhMMTg4LjMsNjQxLjh6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDI1IiBkPSJNMTg5LjYsNjQyLjdjMS42LTIsMy4yLTMuMSw1LjQtMy41di0wLjFjLTEuMSwwLjItMi4xLDAuNi0zLDEuMkMxOTEuMSw2NDAuOSwxOTAuMyw2NDEuNiwxODkuNiw2NDIuNwoJCQkJCQkJTDE4OS42LDY0Mi43TDE4OS42LDY0Mi43eiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QyNSIgZD0iTTE5MC42LDY0My42YzEuNS0yLjEsMy4yLTMuMiw1LjctMy43di0wLjFjLTEuMiwwLjItMi4yLDAuNi0zLjEsMS4yCgkJCQkJCQlDMTkyLjIsNjQxLjcsMTkxLjMsNjQyLjUsMTkwLjYsNjQzLjZMMTkwLjYsNjQzLjZMMTkwLjYsNjQzLjZ6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDI1IiBkPSJNMTkxLjcsNjQ0LjJjMS45LTIsMy42LTMuMSw1LjYtMy41di0wLjFjLTEuMSwwLjItMi4xLDAuNi0zLDEuMkMxOTMuNCw2NDIuNCwxOTIuNiw2NDMuMiwxOTEuNyw2NDQuMgoJCQkJCQkJTDE5MS43LDY0NC4yTDE5MS43LDY0NC4yeiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QyNSIgZD0iTTE5My4xLDY0NS4zYzEuNi0xLjcsMy4yLTMuMyw1LjUtMy44di0wLjFjLTEsMC4yLTIsMC43LTMsMS40QzE5NC43LDY0My41LDE5My44LDY0NC40LDE5My4xLDY0NS4zCgkJCQkJCQlMMTkzLjEsNjQ1LjNMMTkzLjEsNjQ1LjN6Ii8+CgkJCQkJPC9nPgoJCQkJPC9nPgoJCQkJPGc+CgkJCQkJPHBhdGggY2xhc3M9InN0MjUiIGQ9Ik0xODguMSw2NTEuMmMxLjUtMi41LDMuOC0zLjYsNi42LTQuMnYtMC4ybC05LjQtNS43Yy0yLjUsMC40LTQuNywxLjktNi43LDQuMkwxODguMSw2NTEuMkwxODguMSw2NTEuMnoiCgkJCQkJCS8+CgkJCQkJPHBhdGggY2xhc3M9InN0MjYiIGQ9Ik0xODgsNjUwLjljMS41LTIuNSwzLjktMy42LDYuNy00LjJsLTkuNC01LjljLTIuNSwwLjQtNC43LDEuOS02LjcsNC4yTDE4OCw2NTAuOXoiLz4KCQkJCQk8Zz4KCQkJCQkJPHBhdGggY2xhc3M9InN0MjUiIGQ9Ik0xODAuNCw2NDUuNWMxLjgtMS45LDMuOC0zLjEsNS45LTMuNnYtMC4xYy0xLjEsMC4yLTIuMSwwLjctMy4xLDEuMwoJCQkJCQkJQzE4Mi4yLDY0My43LDE4MS4yLDY0NC41LDE4MC40LDY0NS41TDE4MC40LDY0NS41TDE4MC40LDY0NS41eiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QyNSIgZD0iTTE4MS42LDY0Ni4yYzEuOC0xLjksMy44LTMuMSw1LjktMy42di0wLjFjLTEuMSwwLjItMi4xLDAuNy0zLjEsMS4zUzE4Mi40LDY0NS4yLDE4MS42LDY0Ni4yCgkJCQkJCQlMMTgxLjYsNjQ2LjJMMTgxLjYsNjQ2LjJ6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDI1IiBkPSJNMTgyLjgsNjQ2LjljMS44LTEuOSwzLjgtMy4xLDUuOS0zLjZ2LTAuMWMtMS4xLDAuMi0yLjEsMC43LTMuMSwxLjMKCQkJCQkJCUMxODQuNiw2NDUuMSwxODMuNiw2NDUuOSwxODIuOCw2NDYuOUwxODIuOCw2NDYuOUwxODIuOCw2NDYuOXoiLz4KCQkJCQkJPHBhdGggY2xhc3M9InN0MjUiIGQ9Ik0xODQsNjQ3LjdjMS44LTEuOSwzLjgtMy4xLDUuOS0zLjZWNjQ0Yy0xLjEsMC4yLTIuMSwwLjctMy4xLDEuM0MxODUuOCw2NDUuOSwxODQuOSw2NDYuNywxODQsNjQ3LjcKCQkJCQkJCUwxODQsNjQ3LjdMMTg0LDY0Ny43eiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QyNSIgZD0iTTE4NS4xLDY0OC41YzEuOC0xLjksMy44LTMuMSw1LjktMy42di0wLjFjLTEuMSwwLjItMi4xLDAuNy0zLjEsMS4zUzE4NS45LDY0Ny41LDE4NS4xLDY0OC41CgkJCQkJCQlMMTg1LjEsNjQ4LjVMMTg1LjEsNjQ4LjV6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDI1IiBkPSJNMTg2LjQsNjQ5LjNjMS44LTEuOSwzLjgtMy4xLDUuOS0zLjZ2LTAuMWMtMS4xLDAuMi0yLjEsMC43LTMuMSwxLjMKCQkJCQkJCUMxODguMSw2NDcuNSwxODcuMiw2NDguMywxODYuNCw2NDkuM0wxODYuNCw2NDkuM0wxODYuNCw2NDkuM3oiLz4KCQkJCQk8L2c+CgkJCQk8L2c+CgkJCTwvZz4KCQk8L2c+CgkJPGc+CgkJCTxnPgoJCQkJPGc+CgkJCQkJPHBhdGggY2xhc3M9InN0MjciIGQ9Ik0yMTcuNiw2MjcuMWMwLjYsMC4xLDIuNSwxLjYsMi42LDEuM2MwLTAuMS0wLjMtMC40LTAuOC0wLjhjLTAuMy0wLjMtMC42LTAuNS0wLjYtMC41cy0wLjUtMC4zLTAuNy0wLjUKCQkJCQkJcy0wLjYtMC42LTAuMi0wLjdzMS4yLDAuNCwxLjYsMC43YzAuNywwLjUsMS40LDEuMiwxLjYsMS4yYzAuMSwwLjEsMC0wLjQsMC4zLTAuNHMwLjcsMC4zLDAuNywwLjNjLTAuMS0wLjUsMC4yLTAuNywwLjUtMC42CgkJCQkJCWMwLjcsMC41LDEuOCwxLjIsMi4xLDEuNWMxLjEsMC44LDEuNSwxLjEsMi40LDEuOWMwLjcsMC43LDYuMyw1LjYsNi4zLDUuNmwtMS42LDJsLTYuMy02LjFjMCwwLTIuNCwwLjQtNC41LTAuNgoJCQkJCQljLTAuNS0wLjMtMS45LTAuNy0xLjgtMS4xYzAuMS0wLjIsMS4yLDAsMS41LDBjMC4xLDAsMC40LDAuMiwwLjUsMC4yYy0wLjMtMC4yLTAuMy0wLjYtMC42LTAuOWMtMS4xLTAuOS0yLjgtMS44LTIuOS0xLjkKCQkJCQkJQzIxNy4zLDYyNy41LDIxNy4xLDYyNy4xLDIxNy42LDYyNy4xTDIxNy42LDYyNy4xeiIvPgoJCQkJCTxnPgoJCQkJCQk8Zz4KCQkJCQkJCTxnPgoJCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjE5LjksNjI1LjNjMC42LDAuMSwxLjQsMC4yLDEuOSwwLjZjMC44LDAuNywxLjUsMS4yLDEuNSwxLjJjMC43LDAuNi0wLjksMC45LTEuMywwLjQKCQkJCQkJCQkJYy0wLjItMC4yLTIuNi0xLjUtMi45LTIuMUMyMTksNjI1LjEsMjE5LjQsNjI1LjIsMjE5LjksNjI1LjN6Ii8+CgkJCQkJCQkJPHBhdGggY2xhc3M9InN0MTIiIGQ9Ik0yMjAuNCw2MjUuNGMwLTAuMywwLjgtMC4xLDEuNS0wLjFjMC40LDAuMiwxLjQsMC43LDIsMS4xYy0wLjEsMC40LTAuNSwwLjgtMC45LDAuNgoJCQkJCQkJCQlDMjIyLjgsNjI2LjcsMjIwLjQsNjI1LjcsMjIwLjQsNjI1LjRMMjIwLjQsNjI1LjR6Ii8+CgkJCQkJCQkJPHBhdGggY2xhc3M9InN0MTIiIGQ9Ik0yMTguMiw2MjYuNmMwLjYsMC4xLDIuNiwxLjYsMi43LDEuM2MwLTAuMS0wLjMtMC41LTAuOC0wLjljLTAuNC0wLjMtMC44LTAuNS0wLjgtMC41cy0xLTAuMy0xLjMtMC41CgkJCQkJCQkJCXMtMC40LTAuNCwwLTAuNXMxLjcsMC4xLDIuMSwwLjRjMC44LDAuNiwxLjYsMS4zLDEuNywxLjRjMC4xLDAuMSwwLTAuNSwwLjMtMC41czAuOCwwLjMsMC44LDAuM2MtMC4xLTAuNiwwLjYtMC45LDEtMC44CgkJCQkJCQkJCWMwLjgsMC42LDEuOSwxLjMsMi4zLDEuNmMxLjIsMC45LDEuMywxLjQsMi4zLDIuNGMwLjgsMC43LDMsMi40LDMsMi40bC0yLjEsMmwtMi44LTIuN2MwLDAtMi4zLDAtMy0wLjIKCQkJCQkJCQkJYy0wLjQtMC4xLTEuNy0xLTMuMS0yLjJjLTAuMy0wLjItMC41LTAuNy0wLjgtMC45Yy0xLTAuOC0xLjktMS41LTItMS42QzIxNy40LDYyNi45LDIxNy42LDYyNi42LDIxOC4yLDYyNi42TDIxOC4yLDYyNi42eiIKCQkJCQkJCQkJLz4KCQkJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTIyMy44LDYzMS45Yy0wLjQtMC4xLTEuNy0wLjItMi4yLTAuNGMtMC42LTAuMi0yLjgtMC42LTIuNi0xLjFjMC4xLTAuMiwwLjgtMC4zLDEuNC0wLjQKCQkJCQkJCQkJYzAuMywwLDAuNywwLjIsMS4xLDAuMmMwLjUsMCwwLjktMC4yLDEuMS0wLjJjMC41LDAsMS4xLTAuNSwxLjYtMC4yUzIyNC43LDYzMi4xLDIyMy44LDYzMS45TDIyMy44LDYzMS45eiIvPgoJCQkJCQkJPC9nPgoJCQkJCQkJPHBvbHlnb24gY2xhc3M9InN0MjYiIHBvaW50cz0iMjMwLjksNjMyIDIyOS40LDYzMSAyMjcuNSw2MzIuOSAyMjguNiw2MzQuMyAJCQkJCQkJIi8+CgkJCQkJCTwvZz4KCQkJCQkJPHBhdGggY2xhc3M9InN0MTYiIGQ9Ik0yNDYuNCw2MzEuNGMtMi42LDIuNy0yLjQsMi4zLTYuMSw1LjhsLTEwLjEtNS44bC0yLjEsMi41YzAsMCw5LjMsMTAuOSwxMS43LDEyYzAuOCwwLjQsNy41LTUuNCwxMi05LjgKCQkJCQkJCUMyNTQsNjM0LjEsMjQ4LjMsNjI5LjQsMjQ2LjQsNjMxLjRMMjQ2LjQsNjMxLjR6Ii8+CgkJCQkJPC9nPgoJCQkJPC9nPgoJCQkJPGc+CgkJCQkJPHBhdGggY2xhc3M9InN0MTYiIGQ9Ik0yNTMsNjYxLjdjMC4zLTUuMyw1LjktMjQuMywzLjMtMjkuOWMtMS4yLTIuNS02LjYtNS4xLTYuNi01LjFsLTE2LjEsNy42bDIuMywyMC42CgkJCQkJCWMwLjQsNC40LTcuMiw3LjUtOC4xLDExLjhjLTAuMiwxLDIuNyw3LjksOC4xLDkuMWM1LjQsMS4yLDEzLjctNS43LDEzLjctNS43UzI1Mi45LDY2My42LDI1Myw2NjEuN0wyNTMsNjYxLjd6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTgiIGQ9Ik0yMzMuNSw2NDVjMC4zLTAuOSwxLjQtMiwxLjktMi44YzAuNS0wLjcsNC44LTQuMyw1LjMtMy41YzAuNiwwLjEtMC4xLDUuNi0wLjgsNy4zCgkJCQkJCWMtMS4xLDIuNC00LjUsNS40LTQuNSw1LjRTMjMzLjEsNjQ2LjQsMjMzLjUsNjQ1TDIzMy41LDY0NXoiLz4KCQkJCTwvZz4KCQkJCTxnPgoJCQkJCTxnPgoJCQkJCQk8Zz4KCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjM5LjQsNjA0LjVjMi0xLjcsNi4yLTEsOC41LDAuMmMyLDEuMSwzLjMsMy4yLDMuNiw0LjhjMC4zLDEuNy0wLjEsMy42LTAuOCw2LjNjLTAuMywxLjEtMSwyLjgtMSwyLjgKCQkJCQkJCQlzLTIuNiwxLjgtMS4zLDYuNWMwLjQsMS42LTYsMy02LjQsMi4ybC0wLjMtMi4xYzAsMC0yLjItMC4zLTMuNi0yLjJjLTAuNy0wLjktMS4yLTMuMy0xLjMtNC4yYy0wLjEtMS4xLTAuOS01LjMtMC43LTcKCQkJCQkJCQlDMjM2LjIsNjA5LDIzNy40LDYwNi4zLDIzOS40LDYwNC41TDIzOS40LDYwNC41eiIvPgoJCQkJCQkJPHBhdGggY2xhc3M9InN0MjgiIGQ9Ik0yNDAuNiw2MTMuNWMxLjIsMC4yLDEuNSwxLjYsMS4xLDIuN3MtMS42LDEuNy0yLjIsMS41TDI0MC42LDYxMy41TDI0MC42LDYxMy41eiIvPgoJCQkJCQk8L2c+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDI5IiBkPSJNMjM3LjMsNjEwLjRDMjM3LjMsNjEwLjQsMjM3LjMsNjEwLjMsMjM3LjMsNjEwLjRjMC0wLjEtMS45LTAuMS0yLjYtMS44Yy0wLjMtMC44LTAuMi0yLjktMC4yLTIuOQoJCQkJCQkJczIuMywwLjIsMy4yLTAuMmMtMS4yLTEuMiwxLjQtMi41LDIuNy0yLjhjMi4yLTAuNiw3LjEsMC45LDcuMSwwLjljMS4xLDAuMiwyLDAuOCwyLjcsMS42YzIuOCwxLjksMi4xLDUuNSwxLjYsOC42CgkJCQkJCQljLTAuNSwyLjktMy42LDYuMi0zLjUsOS4yYy0wLjgtMC41LTMuOSwwLjktMy45LDAuOWMtMC42LTEuMi0xLjYtMi44LTEuOS00LjJjLTAuMS0wLjMtMS0xLjUtMS4xLTMuM2MtMC4xLTEsMC43LTIuNi0wLjEtMy4xCgkJCQkJCQljLTAuNS0wLjMtMC44LDAuMS0xLjIsMC41Yy0wLjIsMC4zLTAuNywyLjEtMC43LDIuNWMtMC4yLTAuNSwwLjEtMi4zLTAuMi0zLjFjLTAuMS0wLjQtMS40LTAuMi0xLjQtMC4yczAtMiwwLjEtMi43CgkJCQkJCQlMMjM3LjMsNjEwLjRDMjM3LjMsNjEwLjMsMjM3LjMsNjEwLjMsMjM3LjMsNjEwLjRMMjM3LjMsNjEwLjR6Ii8+CgkJCQkJPC9nPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDI2IiBkPSJNMjQ5LDYyNWMtMS0xLjMtNC42LDAuNS03LjUsMi42YzAsMCwwLjQsMS45LDAuNiwxLjhjMCwwLDIuOS0wLjUsNC4yLTAuOGMwLjctMC4yLDEuNS0wLjUsMi4yLTAuOQoJCQkJCQljMC4yLTAuMiwxLjMtMC44LDEuMy0wLjhTMjQ5LjIsNjI1LjEsMjQ5LDYyNUwyNDksNjI1eiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDE2IiBkPSJNMjQ5LjcsNjI2LjRjLTIuMSwxLjktNC42LDIuNi04LjEsMi4xYzAsMC0wLjQsMS45LTAuNSwyLjhjNS4yLDAuNSw4LjgtMC41LDkuNi0zLjlMMjQ5LjcsNjI2LjQKCQkJCQkJTDI0OS43LDYyNi40eiIvPgoJCQkJPC9nPgoJCQkJPGc+CgkJCQkJPHBhdGggY2xhc3M9InN0MTYiIGQ9Ik0yMzIuNCw2MzUuNWMyLjItMS4yLDkuNC0wLjUsOC44LDQuMWMtMC42LDQuNi0xOC44LDE4LjEtMjIsMTguM2wtMS41LTcuMQoJCQkJCQlDMjIwLjQsNjUwLjcsMjMwLjIsNjM2LjcsMjMyLjQsNjM1LjVMMjMyLjQsNjM1LjV6Ii8+CgkJCQkJPGc+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjEwLjUsNjMzLjZjLTAuMS0wLjUtMC42LTEuNC0wLjgtMi4xYy0wLjItMC43LTEuOS0xLjgtMi4zLTEuNmMtMC41LDAuMywxLjEsMi4xLDEuMSwyLjYKCQkJCQkJCWMwLjEsMC42LTAuNCwxLjQtMC4xLDEuOVMyMTAuOCw2MzQuNiwyMTAuNSw2MzMuNkwyMTAuNSw2MzMuNnoiLz4KCQkJCQkJPHBhdGggY2xhc3M9InN0MjUiIGQ9Ik0yMDYuNyw2MzQuOGMwLjEsMCwwLjItMC4xLDAuMi0wLjJsMy44LTkuNWMwLjEtMC4xLDAtMC4zLTAuMS0wLjNjLTAuMS0wLjEtMC4zLDAtMC4zLDAuMWwtMy44LDkuNQoJCQkJCQkJYy0wLjEsMC4xLDAsMC4zLDAuMSwwLjNDMjA2LjYsNjM0LjgsMjA2LjcsNjM0LjgsMjA2LjcsNjM0Ljh6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjA2LjYsNjMwLjFjMC4yLDAuMiwwLjgsMS43LDIsMi45YzAsMC0xLjcsMC43LTEuOCwwLjVjLTAuMi0wLjgtMS4yLTItMS4yLTIuNgoJCQkJCQkJQzIwNS43LDYzMC4zLDIwNi4yLDYyOS44LDIwNi42LDYzMC4xTDIwNi42LDYzMC4xeiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTIwNy40LDYyOS4zYzAuMiwwLjIsMC44LDEuNywyLDIuOWMwLDAtMS43LDAuNy0xLjgsMC41Yy0wLjItMC44LTEuMi0yLTEuMi0yLjYKCQkJCQkJCUMyMDYuNSw2MjkuNSwyMDcsNjI5LDIwNy40LDYyOS4zTDIwNy40LDYyOS4zeiIvPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTIwNi45LDYzMWMwLjMtMC4xLDEuNSwxLjIsMS41LDEuMnMxLjcsMC43LDIsMS41czAsNC4xLDAuMyw1LjNzMS44LDMuMywxLjgsMy4zbC0yLjUsMi40CgkJCQkJCQljMCwwLTEuMy0zLjEtMi00LjFjLTEtMS41LTEuOC0xLjktMi41LTMuNGMtMC4zLTAuNi0xLjMtNC44LTAuMi01LjFDMjA1LjQsNjMwLjcsMjA2LjcsNjMxLjIsMjA2LjksNjMxTDIwNi45LDYzMXoiLz4KCQkJCQk8L2c+CgkJCQkJPHBhdGggY2xhc3M9InN0MjYiIGQ9Ik0yMTIuOSw2NDEuOGwtMS40LTEuNmMtMS4yLDAuMi0yLDAuNi0yLjgsMS45bDAuNCwxLjdMMjEyLjksNjQxLjh6Ii8+CgkJCQkJPHBhdGggY2xhc3M9InN0MTYiIGQ9Ik0yMTIuMSw2NDAuN2MwLjYsMC4zLDcuOCw4LjksMTAsMTAuOGMwLDAtMC4xLDYuMS0zLDYuNXMtMTAuNC0xNC4xLTEwLjQtMTQuNgoJCQkJCQlDMjA4LjcsNjQyLjksMjExLjUsNjQwLjQsMjEyLjEsNjQwLjd6Ii8+CgkJCQk8L2c+CgkJCTwvZz4KCQkJPHBhdGggY2xhc3M9InN0MTAiIGQ9Ik0yMzkuNyw2NTkuNmMtMS42LDUuOC01LjksMzMuNC01LjMsMzQuN2MxLjMsMi44LDIzLjctMTEsMjUtMTQuMmMyLjctNi40LDYuMy0yNS41LDUuMy0yOC41CgkJCQlDMjYyLjcsNjQ1LjUsMjQxLjUsNjUzLjIsMjM5LjcsNjU5LjZ6Ii8+CgkJPC9nPgoJCTxnPgoJCQk8cG9seWdvbiBjbGFzcz0ic3QyNCIgcG9pbnRzPSIzMzIuMiw1NzYuNCAzMzIuMiw1NzkgMjU3LjcsNjI1LjggMjU3LjcsNjIzLjMgCQkJIi8+CgkJCTxnPgoJCQkJPGc+CgkJCQkJPGc+CgkJCQkJCTxnPgoJCQkJCQkJPHBhdGggY2xhc3M9InN0MTIiIGQ9Ik0yOTcuMiw1NzguOGMwLjYsMC4xLDEuNCwwLjIsMS44LDAuNmMwLjgsMC43LDEuNCwxLjIsMS40LDEuMmMwLjcsMC42LTAuOCwwLjgtMS4yLDAuNAoJCQkJCQkJCWMtMC4yLTAuMi0wLjQtMC43LTAuOS0xLjFjLTAuMi0wLjItMC43LTAuNC0wLjctMC40cy0wLjksMC4xLTEuMi0wLjVDMjk2LjMsNTc4LjYsMjk2LjYsNTc4LjcsMjk3LjIsNTc4LjhMMjk3LjIsNTc4Ljh6Ii8+CgkJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTI5Ny40LDU3OC45YzAtMC4zLDAuOC0wLjEsMS41LTAuMWMwLjQsMC4yLDEuMywwLjYsMS45LDFjMCwwLjQtMC41LDAuNy0wLjksMC41CgkJCQkJCQkJYy0wLjItMC4yLTEuMy0xLjEtMS4zLTEuMVMyOTcuNCw1NzkuMSwyOTcuNCw1NzguOUwyOTcuNCw1NzguOXoiLz4KCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjk1LjUsNTc5LjhjMC42LDAuMSwyLjYsMS42LDIuNywxLjRjMC0wLjEtMC4zLTAuNC0wLjgtMC44Yy0wLjQtMC4zLTAuOC0wLjYtMC44LTAuNgoJCQkJCQkJCXMtMC45LTAuMi0xLjItMC4zYy0wLjMtMC4yLTAuNC0wLjQsMC0wLjVzMS42LDAuMSwyLDAuM2MwLjcsMC41LDEuNSwxLjIsMS42LDEuM3MwLTAuNCwwLjMtMC41YzAuMywwLDAuOCwwLjMsMC44LDAuMwoJCQkJCQkJCWMtMC4xLTAuNiwwLjItMC43LDAuNS0wLjZjMC43LDAuNSwxLjksMS4zLDIuMiwxLjZjMS4xLDAuOSwxLjYsMS4xLDIuNSwyYzAuOCwwLjcsMi45LDIuMiwyLjksMi4ybC0xLjksMS44bC0yLjctMi41CgkJCQkJCQkJYzAsMC0yLjIsMC0yLjktMC4yYy0wLjQtMC4xLTEuMy0xLjItMi42LTIuM2MtMS4yLTAuOS0yLjYtMi0yLjgtMi4xQzI5NS4xLDU4MC4xLDI5NSw1NzkuNywyOTUuNSw1NzkuOEwyOTUuNSw1NzkuOHoiLz4KCQkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMzAwLjcsNTg0LjljLTAuNC0wLjEtMS4yLTAuNC0xLjctMC41Yy0wLjYtMC4yLTIuNS0wLjQtMi4zLTAuOGMwLjEtMC4yLDAuNC0wLjMsMS0wLjMKCQkJCQkJCQljMC4zLDAsMC43LDAuMiwxLDAuMmMwLjUsMCwwLjktMC4yLDEtMC4yYzAuNSwwLDEuMS0wLjUsMS41LTAuMkMzMDEuNiw1ODMuMywzMDEuNSw1ODUsMzAwLjcsNTg0LjlMMzAwLjcsNTg0Ljl6Ii8+CgkJCQkJCTwvZz4KCQkJCQkJPHBvbHlnb24gY2xhc3M9InN0MjYiIHBvaW50cz0iMzA3LjcsNTg1IDMwNi40LDU4NCAzMDQuNSw1ODUuOCAzMDUuNiw1ODcuMSAJCQkJCQkiLz4KCQkJCQk8L2c+CgkJCQkJPHBhdGggY2xhc3M9InN0MTgiIGQ9Ik0zMTYuNyw1ODkuOWwtOS41LTUuNGwtMiwyLjRjMCwwLDguOSwxMC4yLDExLjEsMTEuMkMzMTcsNTk4LjQsMzIwLjIsNTg2LjYsMzE2LjcsNTg5LjlMMzE2LjcsNTg5Ljl6Ii8+CgkJCQk8L2c+CgkJCQk8Zz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxNiIgZD0iTTMxOS4zLDYxMy4zYzAuNy01LjQsMy42LTIwLjMsMy0yNS41Yy0wLjMtMy01LjQtNC4yLTUuNC00LjJzLTguMywwLjktOSwxLjJjLTEuMSwwLjUtNC45LDMuMy02LjMsNC42CgkJCQkJCWMtMS40LDEuNCwwLjYsNiwwLjcsNi44bDMsMTQuN2MwLjYsNC0xLjEsNi43LTEuNywxMC42Yy0wLjEsMC45LDEuNCw3LjUsNi41LDguNGM1LjEsMC44LDEyLjItNS41LDEyLjItNS41CgkJCQkJCVMzMTkuMiw2MTQuNSwzMTkuMyw2MTMuM0wzMTkuMyw2MTMuM3oiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxOCIgZD0iTTMwNC44LDYxMWMwLjUsMy40LTEuNCw5LjItMS40LDEwLjJjMC4xLDIuNSwwLjcsOC44LDcuNCw4LjhjNC45LDAsMTAuNi0zLjksMTEuNS01LjcKCQkJCQkJcy0yLjgtMTIuOS0yLjgtMTIuOXMtNS43LDEzLjItMTEuNCw0LjNjLTIuNC0zLjgtMy04LjktMi44LTEyLjhjMC0wLjksNC40LTkuOCw0LjMtMTBjLTAuNC0wLjctNi44LDQtNy40LDMuNQoJCQkJCQljLTAuMi0wLjItMC40LTAuMi0wLjYsMC4xcy0wLjEsMC42LDAsMC45YzAuNSwxLjctMC4xLDMuMSwwLjEsNS40QzMwMi4xLDYwNS4yLDMwNC4zLDYwNy40LDMwNC44LDYxMUwzMDQuOCw2MTF6Ii8+CgkJCQkJPGc+CgkJCQkJCTxnPgoJCQkJCQkJPHBhdGggY2xhc3M9InN0MTIiIGQ9Ik0zMDcuMSw1ODAuNWw3LjQtMy42Yy0wLjUsMC42LTAuNywyLjcsMCw2Yy0xLjcsMS4zLTYuNCwxLjUtNi40LDEuNQoJCQkJCQkJCUMzMDguNCw1ODIuOCwzMDgsNTgxLjUsMzA3LjEsNTgwLjVMMzA3LjEsNTgwLjV6Ii8+CgkJCQkJCQk8cGF0aCBjbGFzcz0ic3QxMiIgZD0iTTMwMS45LDU3Mi41Yy0wLjEtMi43LTAuMS01LjcsMS42LThjMS42LTIuMSw2LjUtMy4yLDguOS0yLjNjMi4xLDAuOCw0LjEsMy41LDQuNiw1LjEKCQkJCQkJCQljMC42LDEuOSwwLjksNC0wLjIsNi4zYy0wLjUsMS0yLjIsMy4zLTIuMiwzLjNjLTIuNSwxLjgtNC43LDIuNy02LjEsMy4yYzAsMC0yLjgsMS42LTMuNSwxCgkJCQkJCQkJQzMwMi40LDU3OS4xLDMwMS45LDU3NC4yLDMwMS45LDU3Mi41TDMwMS45LDU3Mi41eiIvPgoJCQkJCQkJPHBhdGggY2xhc3M9InN0MTIiIGQ9Ik0zMDguMSw1NzMuMWMwLTAuMywwLjMtMC40LDAuNi0wLjNjMC42LDAuMywwLjksMS4yLDAuNywyLjFjLTAuMiwxLTEuMiwxLjYtMS44LDEuNUwzMDguMSw1NzMuMQoJCQkJCQkJCUwzMDguMSw1NzMuMXoiLz4KCQkJCQkJPC9nPgoJCQkJCQk8cGF0aCBjbGFzcz0ic3QyNiIgZD0iTTMxNC44LDU4MS4xYzAsMS4xLTYuMiwzLjMtNy41LDIuN2wtMC42LDEuN2MwLDAsNi41LDAuOSw5LjUtMkMzMTYuMiw1ODMuNSwzMTUsNTgxLjIsMzE0LjgsNTgxLjEKCQkJCQkJCUwzMTQuOCw1ODEuMXoiLz4KCQkJCQkJPHBhdGggY2xhc3M9InN0MzAiIGQ9Ik0zMDEuMiw1NjguOWMtMC44LTEuNi0wLjUtNC4yLDEuMS01Yy0xLjEtMy4zLDkuMS00LjgsMTIuMi0xLjhjMywxLjYsNC44LDguOSwyLjUsMTIuMgoJCQkJCQkJYy0wLjYsMC44LTEuNCwyLjktMC45LDMuMWMyLjEsMC44LDMuMywyLjIsNCw0LjhzLTAuMiwyLjktMC4yLDIuOXMxLjcsMy40LTAuOSw1LjdjLTEuMSwxLTUuMiwxLjMtNS44LTMuMQoJCQkJCQkJYy0zLjEsMC00LjctMi4yLTIuNi0zLjljMS44LTEtMC45LTAuNS0xLjUtMy4xYy0wLjMtMS41LDAuNS0xLjksMS4yLTNjMC44LTEuMy0wLjMtMi4zLTAuMy0yLjZjMC4xLTEuMy0wLjMtMi4xLTEuMi0yLjUKCQkJCQkJCWMtMC41LTAuMi0xLjMtMC4xLTEuMywwLjZjMCwwLjQtMC43LDIuNC0wLjcsMi43Yy0wLjItMC40LTAuNS0xLjktMC4yLTIuOWMwLjEtMC40LTEuNCwwLTEuNCwwcy0wLjEtMS4xLTAuMS0xLjgKCQkJCQkJCUMzMDUuMSw1NzEuMSwzMDIsNTcwLjUsMzAxLjIsNTY4LjlMMzAxLjIsNTY4Ljl6Ii8+CgkJCQkJPC9nPgoJCQkJPC9nPgoJCQkJPGc+CgkJCQkJPGc+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjczLjIsNTk4LjZjLTAuMy0wLjMtMC45LTAuOS0xLjMtMS4zYy0wLjQtMC40LTEuNy0xLjYtMS45LTEuMmMtMC4zLDAuNSwxLjIsMi4xLDEuNCwyLjQKCQkJCQkJCWMwLjMsMC40LDAuMiwxLjIsMC42LDEuNUMyNzIuNCw2MDAuMiwyNzMuOCw1OTkuMiwyNzMuMiw1OTguNkwyNzMuMiw1OTguNnoiLz4KCQkJCQkJPHBhdGggY2xhc3M9InN0MTIiIGQ9Ik0yNjcuMSw1OTYuMWMwLjIsMCwxLjgsMCwzLjEsMC42bC0wLjMsMS4xYzAsMC0wLjEtMC4xLTAuMi0wLjJjLTAuNi0wLjQtMi44LTAuNS0zLjEtMC45CgkJCQkJCQlDMjY2LjIsNTk2LjIsMjY2LjcsNTk2LjEsMjY3LjEsNTk2LjFMMjY3LjEsNTk2LjF6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjY1LjMsNTk3LjRjMC0wLjIsMC4xLTAuNCwwLjQtMC40YzAuMy0wLjEsMC44LDAsMS4xLDBjMC42LTAuMSwzLDAuNywzLDAuN2wtMC40LDEKCQkJCQkJCWMtMC4yLTAuMS0xLjktMC45LTEuOS0wLjlTMjY1LjIsNTk3LjgsMjY1LjMsNTk3LjRMMjY1LjMsNTk3LjR6Ii8+CgkJCQkJCTxwYXRoIGNsYXNzPSJzdDEyIiBkPSJNMjY1LjgsNTk3LjljMC44LDAuMSwyLjgsMC41LDMuNSwwLjdjMCwwLDAsMCwwLjEsMGMwLTAuMS0wLjItMC43LTAuMS0wLjlzMC41LDAsMC41LDAKCQkJCQkJCXMtMC4yLTAuNy0wLjEtMC45czAuNi0wLjEsMC42LTAuMWMxLjUsMC43LDMsMS44LDMuMiwyLjFjMC41LDAuNSwxLjQsMS43LDIuMSwyLjNjMC44LDAuNiwyLjksMS4xLDIuOSwxLjFsLTAuNCwzCgkJCQkJCQljMCwwLTIuNC0xLjItMy40LTEuNWMtMS40LTAuNC0yLjEtMC4yLTMuNC0wLjhjLTAuNS0wLjItMS45LTEuMS0yLjgtMi4yYy0wLjQtMC41LTEtMC44LTEuNS0xYy0wLjQtMC4yLTAuNy0wLjQtMC44LTAuNQoJCQkJCQkJYy0wLjMtMC4xLTAuMi0wLjYsMC4yLTAuNGMwLjYsMC4zLDEuOSwwLjgsMi41LDAuOWMtMC4zLTAuMi0wLjctMC40LTAuNy0wLjRzLTIuMi0wLjgtMi41LTAuOFMyNjUuNSw1OTcuOSwyNjUuOCw1OTcuOQoJCQkJCQkJTDI2NS44LDU5Ny45eiIvPgoJCQkJCTwvZz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QyNiIgZD0iTTI3OC40LDYwMS42bC0xLjctMC4yYy0wLjcsMC44LTEsMS42LTAuOCwyLjlsMS4xLDAuOUwyNzguNCw2MDEuNkwyNzguNCw2MDEuNnoiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxNiIgZD0iTTMwMS45LDU4OS41Yy0xLjksMS0xMC4yLDEzLTEyLjYsMTMuMXMtMTEuNS0xLjQtMTItMS4ycy0xLjEsMy40LTAuOSwzLjhjMC4yLDAuMywxMS41LDMuNywxNC4yLDMuNAoJCQkJCQljMi43LTAuMiwxOC4zLTExLjcsMTguOC0xNS42UzMwMy44LDU4OC40LDMwMS45LDU4OS41TDMwMS45LDU4OS41eiIvPgoJCQkJPC9nPgoJCQk8L2c+CgkJCTxwYXRoIGNsYXNzPSJzdDEwIiBkPSJNMzE0LjIsNjEyLjdjLTEuNiw1LjgtMS4xLDMzLjgtMC41LDM1YzEuMywyLjgsMjAuNC0xMCwyMS44LTEzLjJjMi4xLTQuOCwxLjgtMjEuOCwxLjUtMjkuOQoJCQkJYy0wLjEtMi4yLTIuMS0zLjgtNC0zLjFDMzI2LjksNjAzLjYsMzE1LjUsNjA4LjEsMzE0LjIsNjEyLjd6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTI0OC40LDkwLjhjMC0xLjMsMC4xLTIuOCwwLjMtNC4zYy0wLjYsMS4yLTEuMiwyLjQtMiwzLjNjLTAuMywwLjQtMC43LDAuNi0xLjEsMC42Yy0wLjMsMC0wLjUtMC4xLTAuNy0wLjMKCQljLTAuMy0wLjItMC41LTAuNi0wLjUtMWMwLTAuMywwLjEtMC41LDAuMy0wLjhjMi43LTMuNSw0LjktOC4zLDYuMS0xMy4xYzAuMi0wLjYsMC42LTAuOSwxLjEtMC45YzAuMSwwLDAuMywwLDAuNCwwLjEKCQljMC42LDAuMiwxLDAuNSwxLDFjMCwwLjEsMCwwLjItMC4xLDAuNGMtMC42LDIuMy0xLjUsNC41LTIuNSw2Ljd2MjIuMmMwLDAuNi0wLjUsMS0xLjIsMXMtMS4yLTAuMy0xLjItMUwyNDguNCw5MC44TDI0OC40LDkwLjh6CgkJIE0yNTUuNiw5OS42YzAsMC42LTAuNCwxLTEuMSwxcy0xLjEtMC4zLTEuMS0xVjgxLjFjMC0wLjYsMC41LTAuOSwxLjEtMC45czEuMSwwLjMsMS4xLDAuOVY5OS42eiBNMjY3LjIsOTZjMS41LDMuMiw0LjIsNS41LDcuOSw3CgkJYzAuNSwwLjIsMC43LDAuNiwwLjcsMWMwLDAuMiwwLDAuNC0wLjEsMC42Yy0wLjIsMC42LTAuNiwwLjktMS4xLDAuOWMtMC4yLDAtMC40LDAtMC42LTAuMWMtMy43LTEuNS02LjYtNC4zLTguNC04CgkJYy0xLjUsMy45LTQuNCw2LjUtOSw4LjFjLTAuMiwwLTAuMywwLjEtMC41LDAuMWMtMC41LDAtMC45LTAuMy0xLjEtMC44Yy0wLjEtMC4yLTAuMS0wLjQtMC4xLTAuNmMwLTAuNSwwLjMtMC45LDAuOC0xCgkJYzQuNC0xLjUsNi45LTMuNiw4LTcuMWgtNmMtMC42LDAtMC45LTAuNC0wLjktMS4xczAuMy0xLjEsMC45LTEuMWg2LjZjMC4yLTEuNCwwLjMtMi44LDAuMy00LjJIMjYxYy0wLjUsMS0xLjIsMS45LTEuOSwyLjcKCQljLTAuMywwLjMtMC42LDAuNS0wLjksMC41cy0wLjUtMC4xLTAuOC0wLjNjLTAuMi0wLjItMC40LTAuNS0wLjQtMC44czAuMS0wLjYsMC40LTAuOWMxLjUtMS41LDIuNy0zLjYsMy40LTUuNgoJCWMwLjItMC41LDAuNS0wLjcsMC45LTAuN2MwLjEsMCwwLjMsMCwwLjQsMGMwLjUsMC4xLDAuOSwwLjUsMC45LDFjMCwwLjEsMCwwLjMtMC4xLDAuNGMtMC4yLDAuNS0wLjQsMS0wLjcsMS41aDExLjEKCQljMC41LDAsMC45LDAuNCwwLjksMS4xcy0wLjMsMS4yLTAuOSwxLjJIMjY3YzAsMS40LTAuMSwyLjgtMC4zLDQuMmg4LjFjMC42LDAsMC45LDAuNCwwLjksMS4xcy0wLjMsMS4xLTAuOSwxLjFMMjY3LjIsOTZMMjY3LjIsOTYKCQl6IE0yNzQuNiw4MS44YzAuNiwwLDAuOSwwLjQsMC45LDEuMXMtMC4zLDEuMi0wLjksMS4yaC0xNy4yYy0wLjYsMC0wLjktMC41LTAuOS0xLjJzMC4zLTEuMSwwLjktMS4xaDEwLjhjMC4zLTEuMSwwLjQtMi4yLDAuNS0zCgkJdi0wLjJjMC0wLjUtMC4zLTAuNi0wLjktMC42aC04LjVjLTAuNiwwLTAuOS0wLjUtMC45LTEuMnMwLjMtMS4xLDAuOS0xLjFoOS4zYzEuNywwLDIuNSwwLjYsMi41LDIuMWMwLDAuMiwwLDAuMywwLDAuNQoJCWMtMC4xLDEtMC4zLDIuMy0wLjYsMy40TDI3NC42LDgxLjhMMjc0LjYsODEuOHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0yODUuOSw4MC4zYzEuMSwwLDEuOSwwLjcsMS45LDEuOWMwLDAuNC0wLjEsMC44LTAuMywxLjNjLTAuOCwxLjgtMS45LDMuNy0zLjIsNS42YzAuMywwLjUsMC42LDAuOSwwLjksMS4zCgkJYzAuNi0wLjgsMS4yLTEuOCwxLjYtMi42YzAuMi0wLjQsMC41LTAuNiwwLjgtMC42YzAuMiwwLDAuNCwwLjEsMC41LDAuMmMwLjMsMC4yLDAuNSwwLjUsMC41LDAuOGMwLDAuMSwwLDAuMy0wLjEsMC40CgkJYy0wLjYsMS4xLTEuMywyLjItMi4xLDMuMmMwLjUsMC42LDEuMSwxLjEsMS43LDEuNmMwLjIsMC4yLDAuNCwwLjUsMC40LDAuOHMtMC4xLDAuNi0wLjMsMC44Yy0wLjIsMC4yLTAuNSwwLjQtMC44LDAuNAoJCXMtMC41LTAuMS0wLjgtMC4zYy0wLjktMC44LTEuOS0yLTIuNy0zLjRjMC4xLDEuMSwwLjIsMi4yLDAuMiwzLjJ2MTBjMCwwLjYtMC41LDEtMS4yLDFzLTEuMi0wLjMtMS4yLTF2LTEwYzAtMSwwLjEtMi4xLDAuMi0zLjIKCQljLTAuOCwxLTEuNiwyLjEtMi41LDIuOWMtMC4zLDAuMy0wLjUsMC40LTAuOSwwLjRzLTAuNi0wLjEtMC44LTAuNGMtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjhzMC4xLTAuNiwwLjQtMC45YzMtMi42LDUuOC02LDcuMi05LjUKCQljMC4xLTAuMiwwLjEtMC4zLDAuMS0wLjRjMC0wLjItMC4yLTAuMy0wLjUtMC4zaC02Yy0wLjYsMC0wLjktMC41LTAuOS0xLjJzMC4zLTEuMSwwLjktMS4xaDN2LTQuOGMwLTAuNiwwLjUtMSwxLjItMQoJCXMxLjIsMC4zLDEuMiwxdjQuOEwyODUuOSw4MC4zTDI4NS45LDgwLjN6IE0yOTEuNSw5OC4ydjYuOGMwLDAuNi0wLjUsMS0xLjIsMXMtMS4yLTAuMy0xLjItMVY4Ni42YzAtMS45LDAuOS0yLjcsMi43LTIuN2g0LjZ2LTMuMgoJCUgyODljLTAuNiwwLTAuOS0wLjUtMC45LTEuMnMwLjMtMS4yLDAuOS0xLjJoNy40di0zYzAtMC42LDAuNC0xLDEuMi0xczEuMSwwLjMsMS4xLDF2M2g4LjNjMC42LDAsMC45LDAuNSwwLjksMS4yCgkJcy0wLjMsMS4yLTAuOSwxLjJoLTguM3YzLjJoNS4zYzEuOSwwLDIuNywwLjcsMi43LDIuN3YxNi4zYzAsMi0xLDIuNy0zLDIuN2MtMSwwLTEuOS0wLjEtMi40LTAuM2MtMC40LTAuMS0wLjctMC41LTAuNy0xCgkJYzAtMC4xLDAtMC4yLDAtMC40YzAuMi0wLjUsMC41LTAuOSwxLTAuOWMwLjEsMCwwLjIsMCwwLjMsMGMwLjUsMC4xLDEuMSwwLjIsMS42LDAuMmMwLjYsMCwwLjktMC4xLDAuOS0xdi00LjFoLTUuN3Y2LjUKCQljMCwwLjYtMC40LDEtMS4xLDFzLTEuMi0wLjMtMS4yLTF2LTYuNUwyOTEuNSw5OC4yTDI5MS41LDk4LjJ6IE0yOTYuNSw4Ni4xaC00LjFjLTAuNiwwLTAuOSwwLjItMC45LDAuOHYyLjloNVY4Ni4xeiBNMjk2LjUsOTIuMQoJCWgtNXY0aDVWOTIuMXogTTMwNC41LDg5LjlWODdjMC0wLjctMC4zLTAuOC0wLjktMC44aC00LjhWOTBMMzA0LjUsODkuOUwzMDQuNSw4OS45eiBNMzA0LjUsOTZ2LTRoLTUuN3Y0SDMwNC41eiBNMzA1LjIsNzYuMgoJCWMwLjMsMC4yLDAuNSwwLjUsMC41LDAuOGMwLDAuMiwwLDAuMy0wLjEsMC41Yy0wLjIsMC40LTAuNSwwLjYtMC45LDAuNmMtMC4yLDAtMC4zLDAtMC41LTAuMWMtMC44LTAuNS0yLjEtMS0zLTEuNQoJCWMtMC40LTAuMi0wLjYtMC41LTAuNi0wLjljMC0wLjIsMC4xLTAuNCwwLjItMC42YzAuMi0wLjQsMC41LTAuNSwwLjktMC41YzAuMSwwLDAuMywwLDAuNCwwLjFDMzAzLDc1LDMwNC4zLDc1LjYsMzA1LjIsNzYuMgoJCUwzMDUuMiw3Ni4yeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTMyOC40LDg1YzMuMS0yLjQsNS42LTUuMiw3LjgtOC4zYzAuMy0wLjMsMC42LTAuNSwxLTAuNWMwLjIsMCwwLjUsMC4xLDAuNywwLjJjMC40LDAuMiwwLjYsMC42LDAuNiwxCgkJYzAsMC4zLTAuMSwwLjYtMC4zLDAuOGMtMiwyLjUtNCw0LjctNi4zLDYuOGg3LjRjMC42LDAsMC45LDAuNSwwLjksMS4ycy0wLjQsMS4yLTAuOSwxLjJIMzI5Yy0xLjgsMS4zLTMuOCwyLjUtNS45LDMuNAoJCWMxLjItMC4yLDIuMy0wLjIsMy41LTAuMmg2LjljMiwwLDIuOSwwLjcsMi45LDIuNnY5LjRjMCwxLjgtMC45LDIuNi0yLjksMi42aC0xMy4zYy0yLDAtMi45LTAuNy0yLjktMi42di00LjljMC0xLDAuMS0yLjMsMC4zLTMuNQoJCWMtMS45LDEtMy43LDEuOC01LjYsMi41Yy0wLjIsMC4xLTAuNCwwLjEtMC41LDAuMWMtMC41LDAtMC45LTAuMy0xLjEtMC45Yy0wLjEtMC4yLTAuMS0wLjMtMC4xLTAuNWMwLTAuNSwwLjMtMSwwLjktMS4yCgkJYzMuOS0xLjIsOS40LTMuOCwxMy45LTYuOGgtMTMuM2MtMC42LDAtMC45LTAuNS0wLjktMS4yczAuNC0xLjIsMC45LTEuMkgzMjN2LTRoLTguMWMtMC41LDAtMC45LTAuNC0wLjktMS4yczAuNC0xLjIsMC45LTEuMmg4LjEKCQl2LTMuM2MwLTAuNiwwLjUtMSwxLjItMXMxLjIsMC40LDEuMiwxdjMuM2g1LjdjMC41LDAsMC45LDAuNSwwLjksMS4ycy0wLjQsMS4xLTEsMS4xaC01LjZ2NEwzMjguNCw4NUwzMjguNCw4NXogTTMzNCw5Ni40di0yLjkKCQljMC0wLjctMC4zLTAuOC0wLjktMC44aC0xMi4zYy0wLjYsMC0wLjksMC4yLTAuOSwwLjh2Mi45SDMzNEwzMzQsOTYuNHogTTMxOS44LDEwMmMwLDAuNywwLjMsMC45LDAuOSwwLjlIMzMzCgkJYzAuNiwwLDAuOS0wLjIsMC45LTAuOXYtMy4zaC0xNC4xVjEwMkwzMTkuOCwxMDJ6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMzU4LjksOTUuNGgxMi45YzAuNSwwLDAuOSwwLjQsMC45LDFzLTAuMywxLjEtMC45LDEuMWgtMTAuOWMyLjksMi42LDYuOSw0LjQsMTEuMSw1LjIKCQljMC42LDAuMSwwLjksMC41LDAuOSwxLjFjMCwwLjEsMCwwLjMtMC4xLDAuNGMtMC4yLDAuNy0wLjUsMS0xLjEsMWMtMC4yLDAtMC4zLDAtMC41LTAuMWMtNC42LTEuMS05LjItMy4zLTEyLjYtNi45CgkJYzAuMSwwLjgsMC4yLDIsMC4yLDIuOXYzLjljMCwwLjYtMC41LDEtMS4yLDFzLTEuMS0wLjQtMS4xLTF2LTMuOWMwLTAuOCwwLjEtMiwwLjItMi45Yy0zLjMsMy43LTcuNSw1LjYtMTIuMSw2LjkKCQljLTAuMiwwLTAuMywwLjEtMC40LDAuMWMtMC41LDAtMS0wLjMtMS4xLTFjMC0wLjItMC4xLTAuMy0wLjEtMC41YzAtMC41LDAuMy0xLDAuOS0xLjFjMy45LTAuOSw3LjctMi42LDEwLjctNS4zaC0xMC43CgkJYy0wLjUsMC0wLjktMC41LTAuOS0xLjFzMC4zLTEsMC45LTFoMTIuNlY5M2gtN2MtMS44LDAtMi42LTAuNy0yLjYtMi41di01LjJjMC0xLDAuMS0yLjIsMC4yLTMuMmMtMC44LDAuOS0xLjUsMS43LTIuNCwyLjQKCQljLTAuMywwLjItMC41LDAuMy0wLjksMC4zYy0wLjMsMC0wLjYtMC4xLTAuOS0wLjRjLTAuMi0wLjItMC4zLTAuNS0wLjQtMC43di0wLjFjMC0wLjMsMC4yLTAuNywwLjUtMWMyLjQtMiw0LjktNC45LDYuMy03LjcKCQljMC4zLTAuNSwwLjYtMC43LDEuMS0wLjdjMC4yLDAsMC40LDAsMC41LDAuMWMwLjUsMC4yLDAuOCwwLjUsMC44LDAuOWMwLDAuMi0wLjEsMC40LTAuMiwwLjZjLTAuMywwLjUtMC43LDEuMi0xLjMsMgoJCWMwLjYtMC4xLDEuMy0wLjEsMS44LTAuMWg1LjJjMC42LTEsMS4yLTIsMS42LTIuOGMwLjItMC40LDAuNi0wLjYsMS0wLjZjMC4yLDAsMC4zLDAsMC41LDAuMWMwLjUsMC4xLDAuOSwwLjQsMC45LDAuOAoJCWMwLDAuMSwwLDAuMy0wLjEsMC40Yy0wLjMsMC43LTAuOCwxLjUtMS4yLDIuMWgxMC4yYzAuNiwwLDAuOSwwLjQsMC45LDFzLTAuMywxLTAuOSwxaC0xMC44djIuNWg5LjNjMC41LDAsMC44LDAuNCwwLjgsMQoJCXMtMC4zLDEtMC44LDFoLTkuM3YyLjVoOS4zYzAuNSwwLDAuOCwwLjQsMC44LDFjMCwwLjUtMC4zLDEtMC44LDFoLTkuM3YyLjZoMTAuOGMwLjUsMCwwLjksMC40LDAuOSwxcy0wLjMsMS0wLjksMWgtMTEuNQoJCUwzNTguOSw5NS40TDM1OC45LDk1LjR6IE0zNTcuMyw4Mi4ydi0yLjVoLTdjLTAuNiwwLTEsMC4yLTEsMC44djEuNkwzNTcuMyw4Mi4yTDM1Ny4zLDgyLjJ6IE0zNDkuMyw4Ni42aDh2LTIuNWgtOFY4Ni42egoJCSBNMzQ5LjMsOTAuM2MwLDAuNywwLjQsMC45LDEsMC45aDd2LTIuNmgtOFY5MC4zTDM0OS4zLDkwLjN6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMzgxLjgsMTAxLjZjLTIuOSwwLTUuMS0yLjQtNS4xLTYuOHMyLTcuOSw1LjUtMTAuNmMtMC40LTEuOS0wLjgtMy44LTEtNS44di0wLjJjMC0wLjcsMC40LTEuMiwxLTEuMwoJCWMwLjEsMCwwLjIsMCwwLjMsMGMwLjYsMCwxLDAuNCwxLjEsMS4xYzAuMiwxLjYsMC41LDMuMywwLjgsNC45YzIuMi0xLjIsNC44LTEuOSw3LjktMS45YzAuMy0xLjQsMC41LTIuOCwwLjYtNAoJCWMwLjEtMC44LDAuNS0xLjIsMS4yLTEuMmMwLjEsMCwwLjIsMCwwLjMsMGMwLjcsMC4xLDEuMSwwLjYsMS4xLDEuMmMwLDAuMSwwLDAuMiwwLDAuM2MtMC4yLDEuMi0wLjQsMi41LTAuNiwzLjkKCQljMS45LDAuMywzLjQsMC45LDQuNiwxLjhjMi44LDEuOSw0LjUsNC45LDQuNSw5YzAsNi43LTQuOCwxMS4xLTEyLjQsMTIuMWMtMC4xLDAtMC4yLDAtMC4zLDBjLTAuOCwwLTEuMi0wLjQtMS4zLTEuMQoJCWMwLTAuMSwwLTAuMiwwLTAuM2MwLTAuNiwwLjQtMS4yLDEuMi0xLjNjNi4xLTAuOCwxMC4yLTQuMywxMC4yLTkuNGMwLTMtMS4zLTUuNS0zLjMtN2MtMS4xLTAuOC0yLjMtMS4yLTMuNy0xLjUKCQljLTAuNCwxLjctMC44LDMuMi0xLjMsNC43Yy0xLDIuOC0yLjMsNS43LTMuNiw3LjljMC4zLDAuNSwwLjYsMC45LDAuOSwxLjRjMC4yLDAuMywwLjMsMC42LDAuMywxcy0wLjEsMC43LTAuNSwxCgkJYy0wLjIsMC4yLTAuNSwwLjMtMC45LDAuM3MtMC42LTAuMS0wLjgtMC40Yy0wLjMtMC4zLTAuNS0wLjYtMC43LTFDMzg1LjgsMTAwLjgsMzgzLjcsMTAxLjYsMzgxLjgsMTAxLjZMMzgxLjgsMTAxLjZ6IE0zODIuOCw4Ni44CgkJYy0yLjMsMi0zLjYsNC45LTMuNiw3LjdjMCwyLjYsMS4yLDQuMywyLjcsNC4zYzEuMiwwLDIuOC0wLjYsNC40LTIuOEMzODQuOSw5My41LDM4My43LDkwLjMsMzgyLjgsODYuOEwzODIuOCw4Ni44eiBNMzkwLjcsODcuNAoJCWMwLjQtMS4zLDAuOC0yLjYsMS4xLTQuMWMtMi40LDAtNC45LDAuNy02LjksMS45YzAuNywzLjEsMS44LDYuMiwzLDguN0MzODguOSw5MiwzODkuOSw4OS43LDM5MC43LDg3LjRMMzkwLjcsODcuNHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00MTAsOTYuNmMwLjQsMCwwLjcsMC4xLDEsMC40YzEuOCwxLjUsNC4xLDQsNS40LDZjMC4yLDAuMywwLjMsMC43LDAuMywxYzAsMC40LTAuMiwwLjgtMC42LDEuMQoJCWMtMC4zLDAuMi0wLjYsMC40LTEsMC40Yy0wLjUsMC0wLjktMC4yLTEuMi0wLjdjLTEuMi0xLjgtMy4yLTQuMi01LjEtNS45Yy0wLjItMC4yLTAuNC0wLjUtMC40LTAuOGMwLTAuNCwwLjItMC44LDAuNS0xLjEKCQlDNDA5LjMsOTYuNyw0MDkuNiw5Ni42LDQxMCw5Ni42TDQxMCw5Ni42eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ0NSwxMDAuOGMtMS42LDAtMi41LTAuOS0yLjUtMi4zYzAtMC4zLDAtMC42LDAuMS0xYzAuNy0yLjUsMS4zLTUuNCwxLjgtOC4zSDQ0MWMtMC42LDAtMC45LTAuNS0wLjktMS4yCgkJczAuMy0xLjIsMC45LTEuMmgzLjhjMC41LTIuOCwwLjgtNS42LDEtOGMwLjItMiwwLjktMi45LDMtMi45aDE1LjVjMi4xLDAsMywwLjksMywyLjhjMCwyLjUtMC4yLDUuMy0wLjQsOC4xaDMuMQoJCWMwLjYsMCwwLjksMC41LDAuOSwxLjJzLTAuMywxLjItMC45LDEuMmgtMy4zYy0wLjMsMy0wLjcsNi4xLTEuMiw5LjFoMy41YzAuNiwwLDAuOSwwLjUsMC45LDEuMnMtMC4zLDEuMi0wLjksMS4yaC00CgkJYy0wLjEsMC41LTAuMiwxLTAuMywxLjRjLTAuNSwyLjMtMS45LDMuMi00LjQsMy4yYy0xLDAtMi4yLTAuMS0zLjItMC4yYy0wLjYtMC4xLTEtMC41LTEtMS4ydi0wLjJjMC4xLTAuNywwLjUtMS4xLDEuMS0xLjEKCQljMC4xLDAsMC4yLDAsMC4yLDBjMC44LDAuMSwxLjgsMC4zLDIuOCwwLjNjMS4yLDAsMS44LTAuNCwyLTEuNGMwLjEtMC4yLDAuMS0wLjUsMC4yLTAuN0g0NDVMNDQ1LDEwMC44eiBNNDYyLjgsOTguNAoJCWMwLjYtMywxLTYuMSwxLjMtOS4xSDQ0N2MtMC41LDMtMS4xLDUuOC0xLjcsOC4yYzAsMC4xLTAuMSwwLjItMC4xLDAuM2MwLDAuNCwwLjMsMC42LDEsMC42SDQ2Mi44TDQ2Mi44LDk4LjR6IE00NjQuMyw4Ni45CgkJYzAuMi0yLjYsMC40LTUuMywwLjQtNy42YzAtMC43LTAuNC0wLjktMS0wLjloLTE0LjNjLTAuNiwwLTAuOSwwLjItMSwwLjljLTAuMiwyLjMtMC41LDQuOS0xLDcuNkg0NjQuM3ogTTQ1OCw5NC43CgkJYzAuMiwwLjIsMC40LDAuNSwwLjQsMC45YzAsMC4zLTAuMSwwLjYtMC40LDAuOXMtMC42LDAuNC0xLDAuNGMtMC4zLDAtMC42LTAuMS0wLjgtMC4zYy0xLjItMS4zLTIuOC0zLTQuNC00LjMKCQljLTAuMi0wLjItMC40LTAuNS0wLjQtMC44YzAtMC4yLDAuMS0wLjUsMC40LTAuOHMwLjYtMC40LDEtMC40YzAuMywwLDAuNSwwLjEsMC44LDAuMkM0NTQuOSw5MS42LDQ1Ni43LDkzLjIsNDU4LDk0LjdMNDU4LDk0Ljd6CgkJIE00NTksODMuN2MwLjMsMC4yLDAuNCwwLjYsMC40LDAuOXMtMC4xLDAuNi0wLjQsMC45cy0wLjYsMC40LTEsMC40Yy0wLjMsMC0wLjYtMC4xLTAuOC0wLjNjLTEuMi0xLjQtMi44LTIuOS00LjItNAoJCWMtMC4zLTAuMi0wLjQtMC41LTAuNC0wLjhzMC4xLTAuNSwwLjQtMC44czAuNi0wLjQsMC45LTAuNGMwLjIsMCwwLjUsMC4xLDAuNywwLjJDNDU2LjEsODAuOCw0NTcuOCw4Mi4zLDQ1OSw4My43TDQ1OSw4My43eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ4OSw5NS40aDEyLjljMC41LDAsMC45LDAuNCwwLjksMXMtMC4zLDEuMS0wLjksMS4xSDQ5MWMyLjksMi42LDYuOSw0LjQsMTEuMSw1LjJjMC42LDAuMSwwLjksMC41LDAuOSwxLjEKCQljMCwwLjEsMCwwLjMtMC4xLDAuNGMtMC4yLDAuNy0wLjUsMS0xLjEsMWMtMC4yLDAtMC4zLDAtMC41LTAuMWMtNC42LTEuMS05LjItMy4zLTEyLjYtNi45YzAuMSwwLjgsMC4yLDIsMC4yLDIuOXYzLjkKCQljMCwwLjYtMC41LDEtMS4yLDFzLTEuMS0wLjQtMS4xLTF2LTMuOWMwLTAuOCwwLjEtMiwwLjItMi45Yy0zLjMsMy43LTcuNSw1LjYtMTIuMSw2LjljLTAuMiwwLTAuMywwLjEtMC40LDAuMWMtMC41LDAtMS0wLjMtMS4xLTEKCQljMC0wLjItMC4xLTAuMy0wLjEtMC41YzAtMC41LDAuMy0xLDAuOS0xLjFjMy45LTAuOSw3LjctMi42LDEwLjctNS4zSDQ3NGMtMC41LDAtMC45LTAuNS0wLjktMS4xczAuMy0xLDAuOS0xaDEyLjZWOTNoLTcKCQljLTEuOCwwLTIuNi0wLjctMi42LTIuNXYtNS4yYzAtMSwwLjEtMi4yLDAuMi0zLjJjLTAuOCwwLjktMS41LDEuNy0yLjQsMi40Yy0wLjMsMC4yLTAuNSwwLjMtMC45LDAuM2MtMC4zLDAtMC42LTAuMS0wLjktMC40CgkJYy0wLjItMC4yLTAuMy0wLjUtMC40LTAuN3YtMC4xYzAtMC4zLDAuMi0wLjcsMC41LTFjMi40LTIsNC45LTQuOSw2LjMtNy43YzAuMy0wLjUsMC42LTAuNywxLjEtMC43YzAuMiwwLDAuNCwwLDAuNSwwLjEKCQljMC41LDAuMiwwLjgsMC41LDAuOCwwLjljMCwwLjItMC4xLDAuNC0wLjIsMC42Yy0wLjMsMC41LTAuNywxLjItMS4zLDJjMC42LTAuMSwxLjMtMC4xLDEuOC0wLjFoNS4yYzAuNi0xLDEuMi0yLDEuNi0yLjgKCQljMC4yLTAuNCwwLjYtMC42LDEtMC42YzAuMiwwLDAuMywwLDAuNSwwLjFjMC41LDAuMSwwLjksMC40LDAuOSwwLjhjMCwwLjEsMCwwLjMtMC4xLDAuNGMtMC4zLDAuNy0wLjgsMS41LTEuMiwyLjFoMTAuMgoJCWMwLjYsMCwwLjksMC40LDAuOSwxcy0wLjMsMS0wLjksMWgtMTAuOHYyLjVoOS4zYzAuNSwwLDAuOCwwLjQsMC44LDFzLTAuMywxLTAuOCwxaC05LjN2Mi41aDkuM2MwLjUsMCwwLjgsMC40LDAuOCwxCgkJYzAsMC41LTAuMywxLTAuOCwxaC05LjN2Mi42aDEwLjhjMC41LDAsMC45LDAuNCwwLjksMXMtMC4zLDEtMC45LDFINDg5Vjk1LjRMNDg5LDk1LjR6IE00ODcuNCw4Mi4ydi0yLjVoLTdjLTAuNiwwLTEsMC4yLTEsMC44CgkJdjEuNkw0ODcuNCw4Mi4yTDQ4Ny40LDgyLjJ6IE00NzkuNSw4Ni42aDh2LTIuNWgtOFY4Ni42eiBNNDc5LjUsOTAuM2MwLDAuNywwLjQsMC45LDEsMC45aDd2LTIuNmgtOFY5MC4zTDQ3OS41LDkwLjN6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNTM0LjUsMTAxLjVjMCwyLjEtMSwzLjEtMy4xLDMuMWgtMjEuN2MtMiwwLTMuMS0xLTMuMS0zLjFWNzguOGMwLTIuMSwxLTMuMSwzLjEtMy4xaDIxLjdjMiwwLDMuMSwxLDMuMSwzLjEKCQlWMTAxLjV6IE01MzAuNSwxMDIuMmMxLjEsMCwxLjUtMC43LDEuNS0xLjdWNzkuNGMwLTEtMC40LTEuMy0xLjUtMS4zaC0xOS44Yy0xLjEsMC0xLjUsMC40LTEuNSwxLjN2MjEuNWMwLDEsMC40LDEuMywxLjUsMS4zCgkJQzUxMC43LDEwMi4yLDUzMC41LDEwMi4yLDUzMC41LDEwMi4yeiBNNTExLjYsODYuMmMtMC42LDAtMC45LTAuNS0wLjktMS4yczAuMy0xLjIsMC45LTEuMmgxMi4ydi0zLjVjMC0wLjYsMC41LTEsMS4yLTEKCQlzMS4yLDAuMywxLjIsMXYzLjVoMy41YzAuNiwwLDAuOSwwLjUsMC45LDEuMnMtMC40LDEuMi0wLjksMS4yaC0zLjV2MTEuMmMwLDIuMi0wLjksMy0zLjUsM2MtMS4yLDAtMi41LTAuMS0zLjItMC4yCgkJYy0wLjYtMC4xLTAuOS0wLjUtMC45LTEuMWMwLTAuMSwwLTAuMiwwLTAuNGMwLjEtMC42LDAuNS0wLjksMS0wLjljMC4xLDAsMC4yLDAsMC4zLDBjMC43LDAuMiwxLjcsMC4zLDIuNCwwLjMKCQljMS4zLDAsMS40LTAuMywxLjQtMS4yVjg2LjJINTExLjZMNTExLjYsODYuMnogTTUxNS40LDg3LjljMC40LDAsMC44LDAuMiwxLDAuNWMxLjIsMS40LDIuNSwzLjMsMy40LDQuOGMwLjEsMC4yLDAuMiwwLjUsMC4yLDAuNwoJCWMwLDAuNC0wLjIsMC44LTAuNiwxYy0wLjMsMC4yLTAuNSwwLjItMC44LDAuMmMtMC40LDAtMC44LTAuMi0xLTAuN2MtMC44LTEuNS0yLTMuMy0zLjEtNC43Yy0wLjItMC4yLTAuMy0wLjUtMC4zLTAuNwoJCWMwLTAuMywwLjItMC43LDAuNS0wLjlDNTE1LDg4LDUxNS4yLDg3LjksNTE1LjQsODcuOUw1MTUuNCw4Ny45eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTUzOSw4OWMtMC42LDAtMC45LTAuNS0wLjktMS4yczAuNC0xLjIsMC45LTEuMmgzLjN2LTguMmgtMi44Yy0wLjYsMC0wLjktMC41LTAuOS0xLjNjMC0wLjcsMC4zLTEuMiwwLjktMS4yCgkJaDE0LjljMC42LDAsMSwwLjUsMSwxLjJzLTAuNCwxLjMtMSwxLjNINTUydjguMmgyLjhjMC41LDAsMC45LDAuNSwwLjksMS4yYzAsMC44LTAuNCwxLjItMC45LDEuMkg1NTJ2MTUuNWMwLDAuNi0wLjQsMS0xLjIsMQoJCWMtMC43LDAtMS4yLTAuNC0xLjItMVY4OWgtNC44Yy0wLjEsNC41LTAuNyw3LjktMS43LDEwLjVjLTAuNywxLjktMS44LDQuMS0yLjksNS40Yy0wLjMsMC40LTAuNywwLjYtMS4xLDAuNgoJCWMtMC4zLDAtMC41LTAuMS0wLjgtMC4zYy0wLjQtMC4zLTAuNS0wLjctMC41LTFzMC4xLTAuNiwwLjMtMC45YzAuOS0xLjIsMi0zLDIuNi00LjdjMS0yLjQsMS41LTUuNSwxLjYtOS42SDUzOUw1MzksODl6CgkJIE01NDkuNSw3OC40aC00Ljd2OC4yaDQuN1Y3OC40eiBNNTY4LjMsOTQuMmMwLDAuMy0wLjEsMC42LTAuMywwLjljLTIuOCw0LTgsOC4xLTEyLjIsMTAuMWMtMC4yLDAuMS0wLjUsMC4yLTAuNywwLjIKCQljLTAuNSwwLTAuOS0wLjMtMS4xLTAuOGMtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjZjMC0wLjUsMC4zLTEsMC44LTEuMmM0LjEtMS45LDguOC01LjYsMTEuMy05LjNjMC4zLTAuNCwwLjYtMC42LDAuOS0wLjYKCQljMC4zLDAsMC41LDAuMSwwLjgsMC4zQzU2OC4xLDkzLjQsNTY4LjMsOTMuOCw1NjguMyw5NC4yTDU2OC4zLDk0LjJ6IE01NjYuMSw3Ni4zYzAsMC4zLTAuMSwwLjUtMC4zLDAuOGMtMi40LDIuOS01LjgsNS41LTksNy4xCgkJYy0wLjIsMC4xLTAuNSwwLjItMC43LDAuMmMtMC40LDAtMC44LTAuMy0xLTAuN2MtMC4xLTAuMi0wLjItMC41LTAuMi0wLjdjMC0wLjUsMC4zLTAuOSwwLjgtMS4yYzIuOC0xLjQsNi4yLTMuOSw4LjEtNi40CgkJYzAuMi0wLjMsMC41LTAuNCwwLjktMC40YzAuMywwLDAuNiwwLjEsMC44LDAuM0M1NjUuOSw3NS42LDU2Ni4xLDc2LDU2Ni4xLDc2LjNMNTY2LjEsNzYuM3ogTTU2Ny4zLDg1LjFjMCwwLjMtMC4xLDAuNi0wLjMsMC44CgkJYy0yLjUsMy4xLTYuNiw2LjItMTAsOGMtMC4zLDAuMS0wLjUsMC4yLTAuOCwwLjJjLTAuNSwwLTAuOC0wLjMtMS0wLjhjLTAuMS0wLjItMC4yLTAuNS0wLjItMC43YzAtMC41LDAuMy0wLjksMC44LTEuMQoJCWMzLjItMS42LDcuMS00LjYsOS4yLTcuNGMwLjMtMC4zLDAuNi0wLjUsMC45LTAuNWMwLjMsMCwwLjYsMC4xLDAuOSwwLjNDNTY3LjEsODQuNCw1NjcuMyw4NC43LDU2Ny4zLDg1LjFMNTY3LjMsODUuMXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01ODkuNiw4Mi4yYzAuMiw0LDAuNyw3LjUsMS41LDEwLjRjMC4yLDAuNiwwLjMsMS4yLDAuNSwxLjdjMS42LTIuNSwyLjktNS4yLDMuOC04LjNjMC4yLTAuNSwwLjUtMC43LDAuOS0wLjcKCQljMC4yLDAsMC40LDAsMC42LDAuMWMwLjUsMC4yLDAuOCwwLjUsMC44LDFjMCwwLjIsMCwwLjMtMC4xLDAuNWMtMS4xLDMuNy0yLjksNy4xLTUsMTBjMSwyLjEsMi4yLDMuOCwzLjUsNC44CgkJYzAuNCwwLjMsMC43LDAuNCwwLjksMC40YzAuMywwLDAuNS0wLjIsMC43LTAuNmMwLjItMC42LDAuNS0xLjksMC42LTMuMmMwLjEtMC43LDAuNS0xLDEuMi0xaDAuMWMwLjcsMCwxLjEsMC41LDEuMSwxLjF2MC4xCgkJYy0wLjEsMS45LTAuNiw0LTEuMyw1LjJjLTAuNSwxLTEuMywxLjQtMi4xLDEuNGMtMC43LDAtMS41LTAuNC0yLjQtMWMtMS40LTEuMS0yLjctMi45LTMuOS01Yy0yLjMsMi41LTUsNC42LTgsNi4xCgkJYy0wLjMsMC4xLTAuNSwwLjItMC44LDAuMmMtMC40LDAtMC44LTAuMi0xLTAuNmMtMC4yLTAuMy0wLjItMC41LTAuMi0wLjhjMC0wLjQsMC4yLTAuOCwwLjctMWMzLjItMS41LDUuOS0zLjcsOC4yLTYuMwoJCWMtMC40LTAuOS0wLjctMS45LTEtMi45Yy0wLjktMy4xLTEuNC02LjktMS43LTExLjVINTc3Yy0wLjksMC0xLjIsMC40LTEuMiwxLjN2NGg2YzEuOCwwLDIuNywwLjksMi43LDIuOGMwLDIuNS0wLjQsNS45LTAuOCw3LjcKCQljLTAuNSwyLjEtMS42LDIuNi0zLjYsMi42Yy0wLjgsMC0yLjEtMC4xLTIuOS0wLjNjLTAuNS0wLjItMC45LTAuNS0wLjktMS4xYzAtMC4xLDAtMC4zLDAuMS0wLjRjMC4xLTAuNiwwLjUtMC44LDAuOS0wLjgKCQljMC4xLDAsMC4zLDAsMC40LDAuMWMwLjYsMC4xLDEuNSwwLjIsMi4yLDAuMmMxLjEsMCwxLjQtMC4yLDEuNi0xYzAuNC0xLjcsMC42LTQuMiwwLjYtNi40YzAtMC43LTAuMy0wLjktMS0wLjloLTUuMwoJCWMtMC4xLDUuOS0xLDEwLjYtMywxNC43Yy0wLjIsMC42LTAuNiwwLjgtMS4xLDAuOGMtMC4zLDAtMC41LTAuMS0wLjgtMC4yYy0wLjQtMC4yLTAuNy0wLjUtMC43LTFjMC0wLjIsMC4xLTAuNSwwLjItMC44CgkJYzIuMi00LjQsMi45LTkuMiwyLjktMTYuNXYtMy45YzAtMi4xLDEtMy4xLDMtMy4xaDEwLjhjMC0xLjMtMC4xLTIuNy0wLjEtNC4yYzAtMC42LDAuNS0xLDEuMi0xczEuMiwwLjMsMS4yLDEKCQljMCwxLjUsMCwyLjksMC4xLDQuMmg5LjljMC42LDAsMC45LDAuNSwwLjksMS4ycy0wLjMsMS4yLTAuOSwxLjJMNTg5LjYsODIuMkw1ODkuNiw4Mi4yeiBNNTk3LjMsNzcuM2MwLjMsMC4zLDAuNSwwLjYsMC41LDAuOQoJCXMtMC4xLDAuNS0wLjMsMC43Yy0wLjIsMC4zLTAuNiwwLjUtMC45LDAuNWMtMC4zLDAtMC41LTAuMS0wLjgtMC4zYy0xLTAuOC0yLjMtMS44LTMuMy0yLjRjLTAuNC0wLjItMC41LTAuNS0wLjUtMC45CgkJYzAtMC4yLDAuMS0wLjUsMC4yLTAuN2MwLjItMC4zLDAuNS0wLjUsMC45LTAuNWMwLjIsMCwwLjQsMC4xLDAuNiwwLjJDNTk0LjgsNzUuNCw1OTYuMyw3Ni40LDU5Ny4zLDc3LjNMNTk3LjMsNzcuM3oiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik02MTMuOCwxMDAuM2MwLDIuOS0yLjMsNS4zLTUuMSw1LjNzLTUuMS0yLjQtNS4xLTUuM3MyLjMtNS4zLDUuMS01LjNTNjEzLjgsOTcuMyw2MTMuOCwxMDAuM3ogTTYwNS43LDEwMC4zCgkJYzAsMS43LDEuNCwzLjEsMywzLjFzMy0xLjUsMy0zLjFzLTEuNC0zLjEtMy0zLjFTNjA1LjcsOTguNiw2MDUuNywxMDAuM3oiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0yNTQuOSwxNDMuNWMwLDAuOSwwLjIsMS4yLDEuNCwxLjRjMS4yLDAuMiwzLjMsMC4zLDcuMiwwLjNjMy42LDAsNS43LTAuMSw3LTAuMmMxLjQtMC4xLDEuOS0wLjQsMi4yLTEuMQoJCWMwLjItMC41LDAuNC0xLjIsMC41LTIuNGMwLTAuNiwwLjQtMSwxLjEtMWMwLjEsMCwwLjIsMCwwLjMsMGMwLjgsMC4xLDEsMC41LDEsMS4xdjAuMmMtMC4yLDEuNS0wLjQsMi41LTAuNywzLjMKCQljLTAuNSwxLjItMS40LDEuOC0zLjIsMmMtMS42LDAuMi00LDAuMy04LjIsMC4zYy0zLjcsMC02LjEtMC4xLTcuOC0wLjNjLTIuNC0wLjMtMy0xLjItMy0zLjN2LTEwLjNoLTEuOGMwLDcuMi0xLjEsMTEuMS0zLjcsMTQuMQoJCWMtMC4yLDAuMy0wLjUsMC40LTAuOSwwLjRjLTAuMywwLTAuNi0wLjEtMC45LTAuNGMtMC4zLTAuMi0wLjQtMC42LTAuNC0xYzAtMC4zLDAuMS0wLjYsMC40LTAuOWMyLjQtMi42LDMuMy01LjMsMy4zLTEyLjJoLTAuNQoJCWMtMS42LDAtMi4zLTAuOC0yLjMtMi41di04LjhjMC0xLjgsMC44LTIuNSwyLjMtMi41aDIuNWMwLjMtMC43LDAuNi0xLjUsMC45LTIuMmMwLjEtMC41LDAuNS0wLjgsMS4xLTAuOGMwLjEsMCwwLjIsMCwwLjQsMAoJCWMwLjYsMC4xLDEsMC40LDEsMC44YzAsMC4xLDAsMC4zLTAuMSwwLjRjLTAuMSwwLjUtMC40LDEuMS0wLjYsMS43aDMuM2MxLjYsMCwyLjQsMC44LDIuNCwyLjV2OC44YzAsMS44LTAuOCwyLjUtMi40LDIuNWgtMS44djcuNgoJCWMwLjEsMCwwLjMsMCwwLjQsMGwwLDBjMC42LTIuMSwxLjEtNC4yLDEuNC02YzAuMS0wLjUsMC40LTAuNiwwLjktMC42aDAuMmMwLjUsMC4xLDAuOCwwLjMsMC44LDAuN3YwLjFjLTAuMywxLjgtMC44LDMuOC0xLjMsNS41CgkJYzAuOC0wLjEsMS42LTAuMywyLjQtMC40Yy0wLjItMC42LTAuNS0xLjItMC43LTEuN2MtMC4xLTAuMS0wLjEtMC4yLTAuMS0wLjNjMC0wLjMsMC4yLTAuNiwwLjYtMC43YzAuMSwwLDAuMi0wLjEsMC4zLTAuMQoJCWMwLjQsMCwwLjYsMC4yLDAuOSwwLjVjMC43LDEuNCwxLjQsMywxLjgsNC4zYzAsMC4xLDAsMC4yLDAsMC4zYzAsMC40LTAuMywwLjgtMC43LDFjLTAuMSwwLTAuMiwwLjEtMC4zLDAuMQoJCWMtMC40LDAtMC43LTAuMi0wLjktMC42Yy0wLjEtMC4zLTAuMi0wLjYtMC4zLTAuOWMtMS44LDAuNC0zLjYsMC43LTUuMywxTDI1NC45LDE0My41TDI1NC45LDE0My41eiBNMjUxLjQsMTI1LjV2LTMuOGgtMi41CgkJYy0wLjUsMC0wLjgsMC4yLTAuOCwwLjh2M0gyNTEuNEwyNTEuNCwxMjUuNXogTTI1MS40LDEyNy41aC0zLjN2My4yYzAsMC42LDAuMywwLjksMC44LDAuOWgyLjVWMTI3LjVMMjUxLjQsMTI3LjV6IE0yNTMuNSwxMjUuNQoJCWgzLjR2LTNjMC0wLjYtMC4zLTAuOC0wLjgtMC44aC0yLjZWMTI1LjVMMjUzLjUsMTI1LjV6IE0yNTMuNSwxMjcuNXY0LjFoMi42YzAuNSwwLDAuOC0wLjIsMC44LTAuOXYtMy4yTDI1My41LDEyNy41TDI1My41LDEyNy41egoJCSBNMjczLjYsMTIxLjFjMC42LDAsMC45LDAuNCwwLjksMXMtMC4zLDEuMS0wLjksMS4xaC01LjR2NC4yaDZjMC42LDAsMC45LDAuNCwwLjksMS4xYzAsMC43LTAuMywxLjEtMC45LDEuMWgtNS43CgkJYzEuOCwzLjIsNCw1LjQsNi41LDdjMC4zLDAuMiwwLjUsMC42LDAuNSwxYzAsMC4zLTAuMSwwLjUtMC4zLDAuOGMtMC4yLDAuMy0wLjYsMC41LTAuOSwwLjVjLTAuMiwwLTAuNC0wLjEtMC42LTAuMgoJCWMtMi4zLTEuNy00LjQtNC4xLTUuOC02LjhjMC4xLDAuNywwLjIsMi4xLDAuMiwzLjR2Ny4zYzAsMC42LTAuNSwwLjktMS4xLDAuOXMtMS4xLTAuMy0xLjEtMC45di03LjFjMC0xLjMsMC4xLTIuNywwLjItMy40CgkJYy0xLjEsMi4yLTIuNyw0LjMtMy44LDUuNGMtMC4zLDAuMi0wLjUsMC4zLTAuOCwwLjNzLTAuNi0wLjEtMC44LTAuNGMtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjhzMC4xLTAuNiwwLjUtMC44CgkJYzEuNC0xLjIsMy4zLTMuNSw0LjgtNi4yaC00LjljLTAuNSwwLTAuOS0wLjQtMC45LTEuMWMwLTAuNywwLjMtMS4xLDAuOS0xLjFoNS4zdi00LjJoLTQuN2MtMC42LDAtMC45LTAuNC0wLjktMS4xczAuMy0xLDAuOS0xCgkJaDQuN3YtMy41YzAtMC42LDAuMy0wLjksMS0wLjlzMS4yLDAuMywxLjIsMC45djMuNUwyNzMuNiwxMjEuMUwyNzMuNiwxMjEuMXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0yOTAuNSwxMjMuOWMwLjEtMS44LDAuMS0zLjcsMC4xLTUuOWMwLTAuOSwwLjQtMS4yLDEuMy0xLjJzMS40LDAuMywxLjQsMS4zYzAsMi4yLTAuMSw0LjEtMC4yLDUuOWg5CgkJYzIuNCwwLDMuNSwxLjEsMy41LDMuM3YwLjZjMCw1LjctMC41LDEyLjEtMS4yLDE1LjhjLTAuNSwyLjQtMiwzLjYtNSwzLjZjLTEuOSwwLTMuNy0wLjItNS4yLTAuNmMtMC43LTAuMi0xLTAuNy0xLTEuMwoJCWMwLTAuMSwwLTAuMywwLjEtMC41YzAuMi0wLjcsMC41LTEuMSwxLjEtMS4xYzAuMiwwLDAuMywwLDAuNSwwLjFjMS4yLDAuMywyLjksMC42LDQuNCwwLjZjMS42LDAsMi4zLTAuNSwyLjYtMS45CgkJYzAuNi0zLjYsMS05LjYsMS4xLTE0LjNjMC0xLjMtMC4zLTEuNi0xLjUtMS42SDI5M2MtMC41LDUuMy0xLjUsOC44LTMuMiwxMS45Yy0yLDMuOC01LjMsNi45LTguNyw4LjdjLTAuMywwLjEtMC42LDAuMi0wLjksMC4yCgkJYy0wLjQsMC0wLjgtMC4yLTEuMS0wLjdjLTAuMi0wLjMtMC4yLTAuNS0wLjItMC44YzAtMC41LDAuMy0xLDAuOC0xLjJjMy0xLjUsNi4xLTQuNCw3LjgtNy41YzEuNi0yLjksMi40LTUuOSwyLjktMTAuNkgyODEKCQljLTAuOCwwLTEuMS0wLjUtMS4xLTEuM3MwLjQtMS4zLDEuMS0xLjNMMjkwLjUsMTIzLjlMMjkwLjUsMTIzLjl6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMzE5LjYsMTIxLjZjMS45LDAsMi43LDAuNywyLjcsMi42djE4LjZjMCwxLjktMC45LDIuNy0yLjcsMi43SDMxNGMtMS45LDAtMi44LTAuOC0yLjgtMi43di0xOC42CgkJYzAtMS45LDAuOS0yLjYsMi44LTIuNmgxLjFjMC41LTEuNCwwLjktMi45LDEuMi00LjFjMC4xLTAuNSwwLjUtMC44LDEuMS0wLjhjMC4xLDAsMC4zLDAsMC40LDBjMC43LDAuMSwxLDAuNSwxLDEKCQljMCwwLjEsMCwwLjIsMCwwLjNjLTAuMywxLjItMC43LDIuNS0xLjIsMy42TDMxOS42LDEyMS42TDMxOS42LDEyMS42eiBNMzE5LjksMTMxLjl2LTcuMWMwLTAuNy0wLjMtMC45LTAuOS0wLjloLTQuMwoJCWMtMC42LDAtMSwwLjItMSwwLjl2Ny4xSDMxOS45TDMxOS45LDEzMS45eiBNMzEzLjcsMTQyLjNjMCwwLjgsMC4zLDEsMSwxaDQuM2MwLjYsMCwwLjktMC4yLDAuOS0xdi04LjJoLTYuMkwzMTMuNywxNDIuMwoJCUwzMTMuNywxNDIuM3ogTTMyNy45LDEyNGMtMC44LDEuNy0xLjcsMy4zLTIuNyw0LjVjLTAuMywwLjMtMC42LDAuNS0xLDAuNWMtMC4zLDAtMC43LTAuMS0wLjktMC4zYy0wLjItMC4yLTAuNC0wLjUtMC40LTAuOQoJCXMwLjEtMC43LDAuNC0xYzEuNy0yLjEsMy40LTUuOCw0LjItOS4zYzAuMi0wLjYsMC42LTAuOSwxLjEtMC45YzAuMSwwLDAuMywwLDAuNCwwYzAuNSwwLjEsMC45LDAuNSwwLjksMS4xYzAsMC4xLDAsMC4yLDAsMC40CgkJYy0wLjMsMS4xLTAuNiwyLjItMSwzLjRoNy44YzIsMCwyLjksMC45LDIuOSwzdjAuN2MwLDkuNy0wLjcsMTUuOC0xLjcsMTkuM2MtMC43LDIuMi0yLjEsMy00LjUsM2MtMS40LDAtMi45LTAuMi00LTAuNQoJCWMtMC41LTAuMS0wLjgtMC42LTAuOC0xLjJjMC0wLjEsMC0wLjMsMC4xLTAuNWMwLjItMC42LDAuNi0wLjksMS4xLTAuOWMwLjEsMCwwLjMsMCwwLjQsMC4xYzAuOCwwLjMsMS45LDAuNCwzLjEsMC40CgkJYzEuNCwwLDItMC4zLDIuNC0xLjljMC44LTIuOSwxLjQtOSwxLjQtMThjMC0wLjgtMC4zLTEtMS4xLTFIMzI3LjlMMzI3LjksMTI0eiBNMzI3LjksMTI4LjVjMC4zLDAsMC42LDAuMSwwLjgsMC40CgkJYzEuNiwyLDMuMiw0LjksNC4yLDcuMWMwLjEsMC4yLDAuMSwwLjQsMC4xLDAuNmMwLDAuNS0wLjIsMC45LTAuNywxLjJjLTAuMiwwLjEtMC41LDAuMi0wLjcsMC4yYy0wLjQsMC0wLjktMC4yLTEuMS0wLjgKCQljLTAuOC0xLjktMi4zLTQuOC0zLjctNi43Yy0wLjItMC4yLTAuMy0wLjUtMC4zLTAuN2MwLTAuMywwLjItMC43LDAuNS0wLjlDMzI3LjMsMTI4LjYsMzI3LjYsMTI4LjUsMzI3LjksMTI4LjVMMzI3LjksMTI4LjV6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMzQ2LjcsMTQwLjljLTAuMywwLjYtMC44LDAuOS0xLjIsMC45Yy0wLjMsMC0wLjYtMC4xLTAuOS0wLjNjLTAuNC0wLjMtMC42LTAuNy0wLjYtMS4xYzAtMC4zLDAuMS0wLjcsMC4zLTEKCQljMi4yLTQsNC40LTguOCw1LjgtMTMuM2MtMS4yLDAuMS0yLjUsMC4xLTMuNywwLjFoLTEuMmMtMC44LDAtMS4xLTAuNS0xLjEtMS4zczAuNS0xLjMsMS4yLTEuM2gxLjRjMS40LDAsMi45LDAsNC4zLTAuMQoJCWMwLjUtMS43LDAuOS0zLjMsMS4yLTUuMWMwLjEtMC43LDAuNS0xLjEsMS4yLTEuMWMwLjEsMCwwLjIsMCwwLjMsMGMwLjcsMC4xLDEuMSwwLjUsMS4xLDEuMmMwLDAuMSwwLDAuMywwLDAuNAoJCWMtMC4zLDEuNC0wLjYsMi44LTEsNC4zYzEuNi0wLjEsMy4xLTAuMyw0LjUtMC41YzAuMSwwLDAuMiwwLDAuMywwYzAuNiwwLDEsMC40LDEuMiwxLjF2MC4yYzAsMC42LTAuNCwxLjItMS4yLDEuMwoJCWMtMS43LDAuMy0zLjYsMC40LTUuNiwwLjZDMzUxLjMsMTMxLjEsMzQ5LjEsMTM2LjUsMzQ2LjcsMTQwLjlMMzQ2LjcsMTQwLjl6IE0zNzEuMywxNDEuN2MwLjMsMC4zLDAuNSwwLjcsMC41LDEuMQoJCWMwLDAuMy0wLjEsMC43LTAuNCwxcy0wLjYsMC41LTAuOSwwLjVzLTAuNy0wLjItMS0wLjRjLTEuMy0xLjMtMi45LTIuNy00LjItMy41YzAuMSwwLjQsMC4xLDAuOCwwLjEsMS4yYy0wLjIsMy43LTIuNCw1LjQtNi45LDUuNAoJCWMtNC4xLDAtNi44LTIuMi02LjgtNS40czIuOC01LjYsNi44LTUuNmMxLjQsMCwyLjcsMC4yLDQsMC42Yy0wLjItMS45LTAuNC00LjYtMC40LTYuOGMwLTEsMC41LTEuNCwxLjMtMS40czEuMywwLjQsMS4zLDEuNAoJCWMwLDIuOSwwLjEsNS4zLDAuNCw3LjdDMzY3LjQsMTM4LjQsMzY5LjcsMTQwLDM3MS4zLDE0MS43TDM3MS4zLDE0MS43eiBNMzU4LjYsMTM4LjJjLTIuNiwwLTQuMywxLjMtNC4zLDMuMXMxLjYsMi45LDQuMywyLjkKCQlzNC4zLTEuMSw0LjMtMy41YzAtMC41LDAtMS0wLjEtMS43QzM2MS41LDEzOC41LDM2MCwxMzguMiwzNTguNiwxMzguMnogTTM3MC45LDEyNS44YzAuNSwwLjMsMC42LDAuOCwwLjYsMS4yCgkJYzAsMC4zLTAuMSwwLjUtMC4yLDAuOGMtMC4zLDAuNC0wLjcsMC42LTEuMSwwLjZjLTAuMywwLTAuNS0wLjEtMC44LTAuM2MtMS45LTEuNC00LjQtMi43LTYuOC0zLjdjLTAuNC0wLjItMC42LTAuNi0wLjYtMQoJCWMwLTAuMywwLjEtMC41LDAuMi0wLjhjMC4zLTAuNSwwLjctMC43LDEuMi0wLjdjMC4yLDAsMC40LDAsMC42LDAuMUMzNjYuNSwxMjMuMSwzNjkuMSwxMjQuNSwzNzAuOSwxMjUuOEwzNzAuOSwxMjUuOHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0zNzguMywxMjQuNHYwLjJjLTAuMiwyLjQtMC42LDUuNS0xLjIsNy45Yy0wLjEsMC40LTAuNSwwLjYtMC45LDAuNmMtMC4xLDAtMC4zLDAtMC40LTAuMQoJCWMtMC40LTAuMS0wLjctMC40LTAuNy0xYzAtMC4xLDAtMC4zLDAuMS0wLjRjMC42LTIsMS01LDEuMi03LjJjMC0wLjYsMC4zLTEsMC45LTFoMC4yQzM3OC4xLDEyMy41LDM3OC4yLDEyMy44LDM3OC4zLDEyNC40CgkJTDM3OC4zLDEyNC40eiBNMzgxLjksMTQ3LjJjMCwwLjYtMC41LDEtMS4yLDFzLTEuMi0wLjMtMS4yLTF2LTI5LjVjMC0wLjYsMC41LTEsMS4yLTFjMC44LDAsMS4yLDAuMywxLjIsMVYxNDcuMnogTTM4My42LDEyMi40CgkJYzAuMywwLDAuNSwwLjIsMC43LDAuNWMwLjUsMSwwLjksMi40LDEuMiwzLjRjMCwwLjEsMC4xLDAuMywwLjEsMC40YzAsMC40LTAuMiwwLjYtMC42LDAuOGMtMC4yLDAuMS0wLjQsMC4xLTAuNSwwLjEKCQljLTAuMywwLTAuNi0wLjItMC43LTAuNmMtMC4zLTEtMC42LTIuMi0xLTMuMWMtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjVjMC0wLjMsMC4yLTAuNiwwLjYtMC43CgkJQzM4My4zLDEyMi40LDM4My40LDEyMi40LDM4My42LDEyMi40TDM4My42LDEyMi40eiBNNDA0LjcsMTI3LjZjMC41LDAsMC44LDAuMywwLjgsMWMwLDAuNy0wLjMsMS0wLjgsMWgtMTkuMQoJCWMtMC41LDAtMC45LTAuNC0wLjktMXMwLjMtMSwwLjktMWg3Ljl2LTIuNGgtNi4zYy0wLjUsMC0wLjgtMC40LTAuOC0xczAuMy0xLDAuOC0xaDYuM3YtMi4xaC03LjNjLTAuNSwwLTAuOC0wLjQtMC44LTEKCQlzMC4zLTEsMC44LTFoNy4zdi0xLjZjMC0wLjYsMC40LTAuOSwxLjEtMC45czEuMSwwLjMsMS4xLDAuOXYxLjZoOC41YzAuNSwwLDAuOCwwLjQsMC44LDFzLTAuMywxLTAuOCwxaC04LjV2Mi4xaDcuMwoJCWMwLjUsMCwwLjgsMC40LDAuOCwxcy0wLjMsMS0wLjgsMWgtNy4zdjIuNEw0MDQuNywxMjcuNkw0MDQuNywxMjcuNnogTTM4OC42LDE0Mi4ydjQuOWMwLDAuNi0wLjUsMC45LTEuMiwwLjlzLTEuMi0wLjMtMS4yLTAuOQoJCVYxMzRjMC0xLjgsMC45LTIuNSwyLjctMi41aDExLjNjMS45LDAsMi44LDAuNywyLjgsMi41djExYzAsMi4xLTEuMywyLjgtMy44LDIuOGMtMS4yLDAtMi4yLTAuMS0zLjItMC40Yy0wLjUtMC4xLTAuOC0wLjUtMC44LTEKCQljMC0wLjEsMC0wLjIsMC0wLjRjMC4xLTAuNiwwLjUtMC44LDAuOS0wLjhjMC4xLDAsMC4yLDAsMC4zLDBjMC43LDAuMiwxLjYsMC40LDIuNCwwLjRjMS41LDAsMS44LTAuMSwxLjgtMXYtMi40TDM4OC42LDE0Mi4yCgkJTDM4OC42LDE0Mi4yeiBNNDAwLjgsMTM0LjRjMC0wLjctMC4zLTAuOC0xLTAuOGgtMTAuMmMtMC42LDAtMC45LDAuMi0wLjksMC44djEuNWgxMi4xVjEzNC40eiBNNDAwLjgsMTM3LjhoLTEyLjF2Mi40aDEyLjFWMTM3Ljh6CgkJIi8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDA5LjYsMTIyLjdjLTAuNSwwLTAuOS0wLjUtMC45LTEuMWMwLTAuNywwLjMtMS4yLDAuOS0xLjJoNC42di0yLjljMC0wLjYsMC40LTAuOSwxLjItMC45CgkJYzAuNywwLDEuMiwwLjMsMS4yLDAuOXYyLjloNC4xYzAuNiwwLDAuOSwwLjQsMC45LDEuMmMwLDAuNi0wLjMsMS4xLTAuOSwxLjFoLTQuMXYzLjJoNWMwLjYsMCwwLjksMC40LDAuOSwxLjFzLTAuMywxLjItMC45LDEuMgoJCWgtMTNjLTAuNiwwLTAuOS0wLjUtMC45LTEuMnMwLjMtMS4xLDAuOS0xLjFoNS42di0zLjJMNDA5LjYsMTIyLjdMNDA5LjYsMTIyLjd6IE00MDguNywxMzZjLTAuNiwwLTAuOS0wLjQtMC45LTEuMQoJCWMwLTAuNywwLjMtMS4yLDAuOS0xLjJoNy44YzAuNy0xLjUsMS4zLTMuMSwxLjYtNC40YzAuMi0wLjUsMC41LTAuOCwxLTAuOGMwLjEsMCwwLjIsMCwwLjQsMC4xYzAuNSwwLjEsMC44LDAuNCwwLjgsMQoJCWMwLDAuMSwwLDAuMy0wLjEsMC40Yy0wLjQsMS4yLTAuOSwyLjUtMS42LDMuOGgzYzAuNiwwLDAuOSwwLjQsMC45LDEuMnMtMC4zLDEuMS0wLjksMS4xaC01djMuMmg0LjVjMC42LDAsMC45LDAuNCwwLjksMS4yCgkJcy0wLjMsMS4yLTAuOSwxLjJoLTQuNXY1LjdjMCwwLjYtMC41LDAuOS0xLjIsMC45cy0xLjItMC4zLTEuMi0wLjl2LTUuN2gtNC45Yy0wLjYsMC0wLjktMC41LTAuOS0xLjJzMC4zLTEuMiwwLjktMS4yaDQuOVYxMzYKCQlINDA4LjdMNDA4LjcsMTM2eiBNNDExLjYsMTI4LjVjMC40LDAsMC43LDAuMiwwLjksMC43YzAuNCwwLjgsMC44LDEuOSwwLjksMi44YzAsMC4xLDAsMC4yLDAsMC4zYzAsMC41LTAuMywwLjgtMC44LDEKCQljLTAuMSwwLTAuMywwLjEtMC40LDAuMWMtMC41LDAtMC44LTAuMi0wLjktMC44Yy0wLjItMC45LTAuNS0yLTAuOS0yLjhjMC0wLjEtMC4xLTAuMy0wLjEtMC40YzAtMC40LDAuMy0wLjgsMC44LTAuOQoJCUM0MTEuNCwxMjguNiw0MTEuNSwxMjguNSw0MTEuNiwxMjguNUw0MTEuNiwxMjguNXogTTQyNS44LDEzMXYxNi4xYzAsMC42LTAuNSwxLTEuMiwxcy0xLjItMC40LTEuMi0xdi0yNi41YzAtMS45LDAuOS0yLjgsMi45LTIuOAoJCWg4LjFjMS44LDAsMi43LDAuNywyLjcsMi4zYzAsMC4yLDAsMC40LDAsMC41Yy0wLjEsMS41LTAuNCwzLTAuOCw0LjJjLTAuNSwxLjMtMS43LDEuNy0zLjQsMS43Yy0xLjEsMC0yLjEtMC4xLTMtMC4zCgkJYy0wLjUtMC4xLTAuOS0wLjYtMC45LTEuMnYtMC4yYzAuMS0wLjYsMC41LTAuOSwxLTAuOWMwLjEsMCwwLjEsMCwwLjIsMGMwLjgsMC4yLDEuNiwwLjMsMi4zLDAuM2MwLjksMCwxLjQtMC4yLDEuNi0wLjgKCQljMC4yLTAuNiwwLjQtMS41LDAuNS0yLjZ2LTAuMWMwLTAuNS0wLjQtMC43LTAuOS0wLjdoLTYuOWMtMC42LDAtMSwwLjItMSwwLjh2Ny44aDguNmMxLjcsMCwyLjQsMC43LDIuNCwyLjFjMCwwLjMsMCwwLjctMC4xLDEuMQoJCWMtMC43LDMuMS0xLjksNi4yLTMuNCw4LjljMS4zLDEuNSwyLjgsMi45LDQuNSw0LjNjMC40LDAuMywwLjUsMC43LDAuNSwxLjFjMCwwLjMtMC4xLDAuNi0wLjMsMC44Yy0wLjMsMC40LTAuNywwLjYtMSwwLjYKCQlzLTAuNS0wLjEtMC44LTAuM2MtMS42LTEuMy0zLTIuOC00LjMtNC40Yy0xLjEsMS42LTIuMywzLTMuNiw0LjNjLTAuMywwLjMtMC42LDAuNC0wLjksMC40cy0wLjUtMC4xLTAuOC0wLjQKCQljLTAuMi0wLjMtMC40LTAuNi0wLjQtMC45YzAtMC40LDAuMS0wLjcsMC40LTAuOWMxLjUtMS4zLDIuOC0yLjgsMy45LTQuNWMtMi0zLTMuMS02LjQtMy44LTEwTDQyNS44LDEzMUw0MjUuOCwxMzF6IE00MjguNywxMzEKCQljMC41LDIuOCwxLjYsNS40LDMuMSw3LjhjMS4yLTIuMiwyLTQuNiwyLjUtN2MwLTAuMiwwLjEtMC4zLDAuMS0wLjRjMC0wLjQtMC4yLTAuNS0wLjYtMC41TDQyOC43LDEzMUw0MjguNywxMzF6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDU0LjMsMTE3LjdjMS41LDAsMi40LDAuNSwyLjksMS41czEuMiwyLDEuOSwyLjhjMS4xLTEsMi4yLTIuMywzLTMuNWMwLjItMC4zLDAuNS0wLjQsMC45LTAuNAoJCWMwLjMsMCwwLjUsMC4xLDAuOCwwLjJjMC40LDAuMiwwLjUsMC42LDAuNSwxYzAsMC4yLTAuMSwwLjQtMC4yLDAuNmMtMSwxLjQtMi4xLDIuNy0zLjUsMy44YzAuOCwwLjksMS43LDEuNywyLjYsMi40CgkJYzEuNC0xLjMsMi43LTIuOCwzLjUtNGMwLjItMC4zLDAuNS0wLjQsMC44LTAuNHMwLjUsMC4xLDAuOCwwLjNjMC4zLDAuMiwwLjUsMC42LDAuNSwxYzAsMC4yLTAuMSwwLjUtMC4yLDAuNwoJCWMtMC45LDEuMy0yLjIsMi42LTMuNiwzLjljMS43LDEuMSwzLjQsMi4xLDUsMi44YzAuNCwwLjIsMC42LDAuNiwwLjYsMS4xYzAsMC4yLTAuMSwwLjUtMC4yLDAuN2MtMC4yLDAuNS0wLjYsMC44LTEuMSwwLjgKCQljLTAuMiwwLTAuNCwwLTAuNS0wLjFjLTIuMS0xLTQuMy0yLjMtNi4yLTMuOWMwLjEsMC4yLDAuMiwwLjQsMC4yLDAuN2MwLDAuNy0wLjMsMS4xLTAuOSwxLjFINDYwdjQuN2g4LjRjMC41LDAsMC45LDAuNSwwLjksMS4yCgkJcy0wLjMsMS4yLTAuOSwxLjJINDYwdjUuOWMwLDEuMiwwLjMsMS40LDMuMywxLjRjMi4xLDAsMy4xLTAuMiwzLjUtMC42YzAuNC0wLjMsMC42LTEuMywwLjgtMi43YzAuMS0wLjcsMC41LTEsMS4xLTFoMC4yCgkJYzAuNiwwLjEsMS4xLDAuNSwxLjEsMS4ydjAuMWMtMC4yLDEuNC0wLjUsMy0xLDMuOGMtMC43LDEuMS0xLjksMS41LTUuMywxLjVjLTIuNiwwLTQuMS0wLjItNC45LTAuNWMtMC45LTAuNC0xLjMtMS4yLTEuMy0yLjMKCQl2LTYuOGgtNS4yYy0wLjQsMi4xLTEuMSwzLjgtMiw1LjFjLTEuNSwyLjItMy44LDMuOC03LDQuOWMtMC4yLDAuMS0wLjMsMC4xLTAuNSwwLjFjLTAuNSwwLTAuOS0wLjMtMS4yLTAuOQoJCWMtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjZjMC0wLjUsMC4zLTAuOSwwLjktMS4xYzIuNS0wLjksNC40LTIuMSw1LjctMy42YzAuOS0xLjEsMS40LTIuMywxLjgtMy45aC03LjNjLTAuNSwwLTAuOS0wLjUtMC45LTEuMgoJCXMwLjMtMS4yLDAuOS0xLjJoNy43YzAuMi0xLjUsMC4yLTMuMSwwLjItNC43SDQ0OWMtMC41LDAtMC45LTAuNC0wLjktMS4xYzAtMC4yLDAtMC41LDAuMS0wLjZjLTIsMS41LTQuMSwyLjktNi4yLDMuOQoJCWMtMC4yLDAuMS0wLjQsMC4xLTAuNiwwLjFjLTAuNSwwLTAuOS0wLjMtMS0wLjhjLTAuMS0wLjItMC4xLTAuNC0wLjEtMC42YzAtMC40LDAuMy0wLjgsMC43LTFjMi4yLTEsNC40LTIuMyw2LjMtMy45CgkJYy0xLjQtMS41LTIuOC0yLjgtNC4yLTMuOWMtMC4yLTAuMi0wLjMtMC40LTAuMy0wLjdzMC4xLTAuNiwwLjQtMC44YzAuMy0wLjMsMC42LTAuNCwwLjktMC40czAuNSwwLjEsMC43LDAuM2MxLjMsMSwyLjgsMi41LDQuMyw0CgkJYzEuNS0xLjQsMi43LTIuOSwzLjctNC40YzAuMS0wLjIsMC4yLTAuNCwwLjItMC41cy0wLjEtMC4yLTAuNS0wLjJoLTYuN2MtMC41LDAtMC45LTAuNS0wLjktMS4xczAuMy0xLjIsMC45LTEuMkw0NTQuMywxMTcuNwoJCUw0NTQuMywxMTcuN3ogTTQ2MS44LDEyOC40YzAuMSwwLDAuMiwwLDAuMywwYy0yLjUtMi00LjctNC41LTYuMy03LjRjLTAuMS0wLjItMC4yLTAuMy0wLjMtMC4zcy0wLjIsMC4xLTAuMywwLjMKCQljLTEuNiwyLjgtMy44LDUuMy02LjMsNy40SDQ2MS44TDQ2MS44LDEyOC40eiBNNDUyLjgsMTMwLjZjMCwxLjUtMC4xLDMuMS0wLjIsNC43aDQuOXYtNC43SDQ1Mi44eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ3Ni40LDEzMy4yYzAtMS40LDAuMi0yLjksMC40LTQuNGMtMC42LDEuMy0xLjMsMi42LTIuMSwzLjZjLTAuMiwwLjMtMC41LDAuNS0wLjksMC41Yy0wLjMsMC0wLjYtMC4xLTEtMC40CgkJYy0wLjMtMC4yLTAuNC0wLjUtMC40LTAuOWMwLTAuMywwLjEtMC42LDAuMy0xYzMuMS0zLjgsNS4xLTguOCw2LjItMTNjMC4yLTAuNiwwLjUtMC45LDEuMS0wLjljMC4yLDAsMC4zLDAsMC41LDAuMQoJCWMwLjYsMC4xLDAuOSwwLjUsMC45LDFjMCwwLjEsMCwwLjMtMC4xLDAuNGMtMC41LDIuMS0xLjQsNC40LTIuNCw2LjdWMTQ3YzAsMC42LTAuNSwxLTEuMywxcy0xLjItMC4zLTEuMi0xVjEzMy4yTDQ3Ni40LDEzMy4yegoJCSBNNDgyLjEsMTI1LjRjLTAuNSwwLTAuOS0wLjUtMC45LTEuMnMwLjMtMS4yLDAuOS0xLjJoMjAuMmMwLjUsMCwwLjksMC41LDAuOSwxLjFjMCwwLjctMC4zLDEuMi0wLjksMS4yTDQ4Mi4xLDEyNS40TDQ4Mi4xLDEyNS40egoJCSBNNDk4LDEzNy41YzEuOSwwLDIuNywwLjgsMi43LDIuNXY0LjZjMCwxLjctMC44LDIuNS0yLjcsMi41aC0xMi4yYy0xLjksMC0yLjctMC44LTIuNy0yLjVWMTQwYzAtMS43LDAuOC0yLjUsMi43LTIuNUg0OTh6CgkJIE00ODQuMiwxMzAuMWMtMC41LDAtMC44LTAuNS0wLjgtMS4xczAuMy0xLjEsMC44LTEuMWgxNS4zYzAuNSwwLDAuOCwwLjUsMC44LDEuMXMtMC4zLDEuMS0wLjgsMS4xSDQ4NC4yeiBNNDg0LjIsMTM0LjkKCQljLTAuNSwwLTAuOC0wLjUtMC44LTEuMXMwLjMtMS4xLDAuOC0xLjFoMTUuNGMwLjUsMCwwLjgsMC41LDAuOCwxLjFzLTAuMywxLjEtMC44LDEuMUg0ODQuMnogTTQ4NC41LDEyMC41Yy0wLjUsMC0wLjktMC41LTAuOS0xLjEKCQljMC0wLjcsMC4zLTEuMiwwLjktMS4yaDE1LjFjMC41LDAsMC45LDAuNSwwLjksMS4ycy0wLjMsMS4xLTAuOSwxLjFINDg0LjV6IE00OTcuMywxNDVjMC42LDAsMC45LTAuMiwwLjktMC44di0zLjcKCQljMC0wLjYtMC4zLTAuOC0wLjktMC44aC0xMC44Yy0wLjYsMC0wLjksMC4yLTAuOSwwLjh2My43YzAsMC43LDAuMywwLjgsMC45LDAuOEg0OTcuM3oiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01MjUuNSwxMjIuN2MtMS42LDAuMy0zLDAuNS00LjEsMC42Yy00LjYsMC40LTkuMiwwLjgtMTMuMywxLjJINTA4Yy0wLjksMC0xLjMtMC41LTEuNC0xLjNWMTIzCgkJYzAtMC43LDAuNS0xLjMsMS4yLTEuNGM3LjktMC42LDE2LjUtMS4yLDI0LjQtMS42aDAuMWMwLjksMCwxLjMsMC41LDEuNCwxLjN2MC4xYzAsMC43LTAuMywxLjMtMS4zLDEuNWMtMC41LDAuMS0xLjEsMC4xLTEuOCwwLjMKCQljLTcsMS4yLTExLjksNi4xLTExLjksMTEuNWMwLDMuNCwxLjgsNS40LDQuMiw2LjVjMS43LDAuOCwzLjksMS4yLDYuMSwxLjJjMC45LDAsMS40LDAuNiwxLjQsMS40djAuMmMtMC4xLDEtMC42LDEuNS0xLjYsMS41CgkJYy0yLjcsMC01LjMtMC41LTcuMy0xLjVjLTMuNC0xLjctNS42LTQuOC01LjYtOWMwLTUuMSwzLjUtOS43LDkuNy0xMi4xTDUyNS41LDEyMi43TDUyNS41LDEyMi43eiBNNTI4LjMsMTI3LjYKCQljMC40LDAsMC42LDAuMSwwLjgsMC40YzEsMSwyLjIsMi43LDIuOCwzLjhjMC4xLDAuMiwwLjIsMC40LDAuMiwwLjlzLTAuNSwxLTEuMSwxYy0wLjQsMC0wLjctMC4yLTAuOC0wLjYKCQljLTAuNy0xLjItMS43LTIuNi0yLjYtMy43Yy0wLjItMC4yLTAuMy0wLjUtMC4zLTAuOEM1MjcuMywxMjguMSw1MjcuNywxMjcuNiw1MjguMywxMjcuNkw1MjguMywxMjcuNnogTTUzMS44LDEyNS40CgkJYzAuNCwwLDAuNiwwLjEsMC45LDAuNGMwLjgsMC44LDIuMSwyLjYsMi43LDMuN2MwLjEsMC4yLDAuMiwwLjUsMC4yLDAuOGMwLDAuNC0wLjQsMS0xLDFjLTAuNCwwLTAuNi0wLjItMC44LTAuNQoJCWMtMC43LTEuMy0xLjYtMi42LTIuNC0zLjZjLTAuMy0wLjMtMC40LTAuNS0wLjQtMC45QzUzMC45LDEyNS45LDUzMS40LDEyNS40LDUzMS44LDEyNS40eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTU1OS42LDExOS4xYzEuMywwLDIuMSwwLjgsMi4xLDEuOGMwLDAuNS0wLjIsMS0wLjYsMS42Yy00LjYsNi40LTEzLjEsMTEuMi0yMC4yLDEzLjVjLTAuMiwwLTAuMywwLjEtMC41LDAuMQoJCWMtMC41LDAtMC45LTAuMy0xLjEtMC45Yy0wLjEtMC4yLTAuMS0wLjMtMC4xLTAuNWMwLTAuNSwwLjMtMC45LDAuOS0xLjFjMy41LTEuMSw3LjItMi43LDEwLjUtNC44Yy0xLTEtMS45LTEuNi0zLTIuNAoJCWMtMC4zLTAuMi0wLjQtMC41LTAuNC0wLjdzMC4xLTAuNiwwLjQtMC44YzAuMi0wLjMsMC41LTAuNCwwLjgtMC40YzAuMiwwLDAuNSwwLjEsMC43LDAuMmMxLjIsMC44LDIuMywxLjcsMy42LDIuNwoJCWMyLjEtMS41LDQtMy4zLDUuNi01LjJjMC4yLTAuMiwwLjMtMC40LDAuMy0wLjVjMC0wLjItMC4yLTAuNC0wLjUtMC40aC04Yy0yLjYsMi42LTUuOCw0LjktOSw2LjVjLTAuMiwwLjEtMC40LDAuMS0wLjUsMC4xCgkJYy0wLjUsMC0wLjktMC4zLTEuMS0wLjhjLTAuMS0wLjItMC4xLTAuMy0wLjEtMC41YzAtMC41LDAuMi0wLjksMC43LTEuMWM0LjItMiw4LjEtNSwxMC43LTguN2MwLjMtMC40LDAuNi0wLjUsMS0wLjUKCQljMC4yLDAsMC41LDAuMSwwLjgsMC4yYzAuNSwwLjEsMC44LDAuNSwwLjgsMC45YzAsMC4yLTAuMSwwLjQtMC4zLDAuNmMtMC4zLDAuNC0wLjYsMC44LTAuOSwxLjJMNTU5LjYsMTE5LjFMNTU5LjYsMTE5LjF6CgkJIE01NTQuOCwxMzMuOGMtMy4xLDIuNy02LjUsNC44LTEwLjMsNi4yYy0wLjIsMC4xLTAuNCwwLjEtMC41LDAuMWMtMC41LDAtMC45LTAuMy0xLjEtMC44Yy0wLjEtMC4xLTAuMS0wLjMtMC4xLTAuNQoJCWMwLTAuNSwwLjMtMC45LDAuOC0xLjFjNS0xLjgsOS40LTQuNywxMi42LTguN2MwLjMtMC40LDAuNy0wLjYsMS4xLTAuNmMwLjIsMCwwLjQsMC4xLDAuNywwLjJjMC40LDAuMiwwLjcsMC41LDAuNywxCgkJYzAsMC4yLTAuMSwwLjQtMC4zLDAuNmMtMC40LDAuNS0wLjgsMS0xLjMsMS41aDcuM2MxLjQsMCwyLjIsMC45LDIuMiwyYzAsMC42LTAuMiwxLjMtMC43LDJjLTUsNi43LTEzLjQsMTEuMi0yMi45LDEyLjhoLTAuMgoJCWMtMC42LDAtMS4xLTAuNC0xLjItMS4xYzAtMC4xLDAtMC4yLDAtMC4zYzAtMC42LDAuNC0xLjEsMS0xLjJjNC43LTAuNyw5LjEtMi4zLDEyLjgtNC41Yy0xLTEtMS44LTEuNy0zLTIuNAoJCWMtMC4zLTAuMi0wLjUtMC41LTAuNS0wLjhzMC4xLTAuNiwwLjMtMC44YzAuMy0wLjIsMC41LTAuNCwwLjgtMC40YzAuMiwwLDAuNSwwLjEsMC44LDAuMmMxLjIsMC44LDIuNCwxLjcsMy43LDIuOAoJCWMyLjMtMS42LDQuMy0zLjQsNS44LTUuM2MwLjItMC4yLDAuMi0wLjMsMC4yLTAuNXMtMC4yLTAuNC0wLjUtMC40SDU1NC44TDU1NC44LDEzMy44eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTU4MCwxMjMuNGMwLjUsMCwwLjksMC40LDAuOSwxLjFzLTAuMywxLjItMC45LDEuMmgtMi40YzAuOCwxLjksMS43LDMuNiwyLjYsNC44YzAuMiwwLjMsMC4zLDAuNiwwLjMsMC45CgkJcy0wLjEsMC42LTAuNCwwLjhjLTAuMiwwLjItMC40LDAuMy0wLjcsMC4zcy0wLjctMC4yLTAuOC0wLjVjLTAuNi0xLTEuMS0yLjItMS42LTMuOWMwLjIsMS45LDAuNCw0LDAuNCw1LjV2MTMuOAoJCWMwLDAuNi0wLjQsMS0xLjIsMXMtMS4yLTAuMy0xLjItMXYtMTEuOGMwLTEuNywwLjItNC4yLDAuNS02LjhjLTAuNiwzLjMtMiw2LjktMy42LDkuNGMtMC4zLDAuNC0wLjYsMC41LTAuOSwwLjUKCQljLTAuMywwLTAuNS0wLjEtMC44LTAuM2MtMC4zLTAuMy0wLjQtMC42LTAuNC0xYzAtMC4zLDAuMS0wLjUsMC4yLTAuOGMxLjktMi44LDMuOC02LjgsNC42LTEwLjhoLTMuMWMtMC42LDAtMC45LTAuNS0wLjktMS4yCgkJczAuMy0xLjEsMC45LTEuMWgzLjR2LTUuOGMwLTAuNiwwLjUtMSwxLjItMXMxLjIsMC4zLDEuMiwxdjUuOEw1ODAsMTIzLjRMNTgwLDEyMy40eiBNNTg4LjYsMTMzLjJoLTYuOGMtMC41LDAtMC45LTAuNS0wLjktMS4xCgkJczAuMy0xLDAuOS0xaDYuOHYtMi45aC01LjljLTAuNSwwLTAuOC0wLjUtMC44LTEuMXMwLjMtMSwwLjgtMWg1Ljl2LTIuN0g1ODJjLTAuNSwwLTAuOC0wLjUtMC44LTFjMC0wLjYsMC4zLTEsMC44LTFoMy42CgkJYy0wLjUtMS4yLTEuMi0yLjQtMS43LTNjLTAuMS0wLjItMC4yLTAuNC0wLjItMC42YzAtMC40LDAuMi0wLjcsMC42LTAuOGMwLjItMC4xLDAuNC0wLjEsMC41LTAuMWMwLjQsMCwwLjgsMC4yLDEsMC41CgkJYzAuNywxLDEuNSwyLjUsMi4xLDRoMy43YzAuOS0xLjUsMS43LTIuOSwyLTMuOGMwLjItMC41LDAuNS0wLjgsMS4xLTAuOGMwLjEsMCwwLjMsMCwwLjQsMGMwLjUsMC4xLDAuOCwwLjUsMC44LDEKCQljMCwwLjEsMCwwLjMtMC4xLDAuNWMtMC40LDAuOC0xLDEuOS0xLjgsMy4xaDQuOGMwLjUsMCwwLjgsMC40LDAuOCwxcy0wLjMsMS0wLjgsMWgtOC4xdjIuN2g3LjJjMC41LDAsMC44LDAuNCwwLjgsMQoJCXMtMC4zLDEuMS0wLjgsMS4xaC03LjJ2Mi45aDguN2MwLjUsMCwwLjgsMC40LDAuOCwxcy0wLjMsMS4xLTAuOCwxLjFINTkxYzAuNywxLjcsMS42LDMuMywyLjYsNC44YzEuMi0xLjEsMi4zLTIuNCwzLjEtMy42CgkJYzAuMi0wLjMsMC41LTAuNSwwLjgtMC41YzAuMiwwLDAuNSwwLjEsMC43LDAuM2MwLjQsMC4yLDAuNSwwLjYsMC41LDAuOWMwLDAuMi0wLjEsMC40LTAuMiwwLjZjLTAuOSwxLjMtMi4zLDIuNy0zLjcsMy45CgkJYzEuNSwxLjcsMy4zLDMuMiw1LjIsNC41YzAuMywwLjIsMC41LDAuNiwwLjUsMWMwLDAuMy0wLjEsMC41LTAuMywwLjhjLTAuMywwLjQtMC41LDAuNS0wLjksMC41Yy0wLjMsMC0wLjUtMC4xLTAuOS0wLjMKCQljLTQuMS0yLjktNi43LTYuMi04LjQtMTAuOWMwLjMsMiwwLjUsNC4xLDAuNSw1LjV2NGMwLDEuOS0wLjcsMy4xLTMuMSwzLjFjLTEsMC0yLjItMC4xLTIuOS0wLjNjLTAuNS0wLjEtMC44LTAuNS0wLjgtMQoJCWMwLTAuMSwwLTAuMiwwLTAuM2MwLjEtMC42LDAuNS0xLDAuOS0xaDAuMmMwLjcsMC4yLDEuNSwwLjMsMi4yLDAuM2MxLDAsMS4zLTAuMywxLjMtMS41di0zLjZjLTIuNSwxLjktNS41LDMuOC03LjcsNC44CgkJYy0wLjIsMC4xLTAuNCwwLjItMC42LDAuMmMtMC41LDAtMC44LTAuMy0xLTAuN2MtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjVjMC0wLjQsMC4yLTAuOCwwLjctMWMyLjYtMSw2LjEtMy4xLDguOC01LjNMNTg4LjYsMTMzLjIKCQlMNTg4LjYsMTMzLjJ6IE01ODEuNiwxMzUuMWMwLTAuMywwLjItMC42LDAuNS0wLjhjMC4yLTAuMiwwLjUtMC4zLDAuNy0wLjNzMC41LDAuMSwwLjcsMC4zYzAuNiwwLjYsMS42LDEuOCwyLjIsMi45CgkJYzAuMSwwLjIsMC4yLDAuNCwwLjIsMC42YzAsMC4zLTAuMSwwLjYtMC40LDAuOGMtMC4zLDAuMi0wLjUsMC4zLTAuOCwwLjNjLTAuNCwwLTAuNy0wLjItMC44LTAuNGMtMC41LTAuOC0xLjMtMS45LTItMi44CgkJQzU4MS43LDEzNS42LDU4MS42LDEzNS40LDU4MS42LDEzNS4xTDU4MS42LDEzNS4xeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTYwNywxNDAuOWMtMC4zLDAuNi0wLjgsMC45LTEuMiwwLjljLTAuMywwLTAuNi0wLjEtMC45LTAuM2MtMC40LTAuMy0wLjYtMC43LTAuNi0xLjFjMC0wLjMsMC4xLTAuNywwLjMtMQoJCWMyLjItNCw0LjQtOC44LDUuOC0xMy4zYy0xLjIsMC4xLTIuNSwwLjEtMy43LDAuMWgtMS4yYy0wLjgsMC0xLjEtMC41LTEuMS0xLjNzMC41LTEuMywxLjItMS4zaDEuNGMxLjQsMCwyLjksMCw0LjMtMC4xCgkJYzAuNS0xLjcsMC44LTMuMywxLjItNS4xYzAuMS0wLjcsMC41LTEuMSwxLjItMS4xYzAuMSwwLDAuMiwwLDAuMywwYzAuNywwLjEsMS4xLDAuNSwxLjEsMS4yYzAsMC4xLDAsMC4zLDAsMC40CgkJYy0wLjMsMS40LTAuNiwyLjgtMSw0LjNjMS42LTAuMSwzLjEtMC4zLDQuNS0wLjVjMC4xLDAsMC4yLDAsMC4zLDBjMC43LDAsMSwwLjQsMS4yLDEuMXYwLjJjMCwwLjYtMC40LDEuMi0xLjIsMS4zCgkJYy0xLjcsMC4zLTMuNiwwLjQtNS42LDAuNkM2MTEuNSwxMzEuMSw2MDkuNCwxMzYuNSw2MDcsMTQwLjlMNjA3LDE0MC45eiBNNjMxLjYsMTQxLjdjMC4zLDAuMywwLjUsMC43LDAuNSwxLjEKCQljMCwwLjMtMC4xLDAuNy0wLjQsMWMtMC4zLDAuMy0wLjYsMC41LTAuOSwwLjVzLTAuNy0wLjItMS0wLjRjLTEuMy0xLjMtMi45LTIuNy00LjItMy41YzAuMSwwLjQsMC4xLDAuOCwwLjEsMS4yCgkJYy0wLjIsMy43LTIuNCw1LjQtNi45LDUuNGMtNC4xLDAtNi44LTIuMi02LjgtNS40czIuOC01LjYsNi44LTUuNmMxLjQsMCwyLjcsMC4yLDQsMC42Yy0wLjItMS45LTAuNC00LjYtMC40LTYuOAoJCWMwLTEsMC41LTEuNCwxLjMtMS40czEuMywwLjQsMS4zLDEuNGMwLDIuOSwwLjEsNS4zLDAuNCw3LjdDNjI3LjYsMTM4LjQsNjMwLDE0MCw2MzEuNiwxNDEuN0w2MzEuNiwxNDEuN3ogTTYxOC45LDEzOC4yCgkJYy0yLjYsMC00LjMsMS4zLTQuMywzLjFzMS42LDIuOSw0LjMsMi45czQuMy0xLjEsNC4zLTMuNWMwLTAuNSwwLTEtMC4xLTEuN0M2MjEuNywxMzguNSw2MjAuMywxMzguMiw2MTguOSwxMzguMkw2MTguOSwxMzguMnoKCQkgTTYzMS4xLDEyNS44YzAuNSwwLjMsMC43LDAuOCwwLjcsMS4yYzAsMC4zLTAuMSwwLjUtMC4yLDAuOGMtMC4zLDAuNC0wLjcsMC42LTEuMSwwLjZjLTAuMywwLTAuNS0wLjEtMC44LTAuMwoJCWMtMS45LTEuNC00LjQtMi43LTYuOC0zLjdjLTAuNC0wLjItMC42LTAuNi0wLjYtMWMwLTAuMywwLjEtMC41LDAuMi0wLjhjMC4zLTAuNSwwLjctMC43LDEuMi0wLjdjMC4yLDAsMC40LDAsMC42LDAuMQoJCUM2MjYuNywxMjMuMSw2MjkuMywxMjQuNSw2MzEuMSwxMjUuOEw2MzEuMSwxMjUuOHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0yNDcuOCwxODkuMWMtMC4zLDAuMi0wLjYsMC4zLTAuOSwwLjNjLTAuNSwwLTAuOS0wLjItMS4yLTAuOGMtMC4yLTAuMy0wLjMtMC42LTAuMy0wLjljMC0wLjUsMC4zLTEsMC44LTEuMgoJCWM0LjQtMi40LDcuNy02LjIsOS42LTEwLjNjMi00LjUsMi45LTguMywyLjktMTUuOGMwLTAuNywwLjYtMS4yLDEuNS0xLjJjMC44LDAsMS40LDAuNCwxLjQsMS4yYzAsNy40LDAuOSwxMSwzLDE1LjUKCQljMS45LDQsNS42LDgsOS45LDEwLjVjMC40LDAuMiwwLjYsMC43LDAuNiwxLjJjMCwwLjMtMC4xLDAuNi0wLjMsMWMtMC4zLDAuNS0wLjgsMC43LTEuMiwwLjdjLTAuMywwLTAuNi0wLjEtMC45LTAuMwoJCWMtNS43LTMuNi0xMC45LTkuOC0xMi40LTE4LjNDMjU4LjYsMTc5LjcsMjU0LDE4NS4xLDI0Ny44LDE4OS4xTDI0Ny44LDE4OS4xeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTI3OS4xLDE2Ny43Yy0wLjYsMC0wLjktMC41LTAuOS0xLjJzMC4zLTEuMiwwLjktMS4yaDQuNnYtNS41YzAtMC42LDAuNS0xLDEuMi0xczEuMiwwLjMsMS4yLDF2NS41aDMuNAoJCWMwLjYsMCwwLjksMC41LDAuOSwxLjJzLTAuNCwxLjItMC45LDEuMmgtMy4zYzEuMSwyLjksMi42LDUsNC4zLDdjMC4yLDAuMiwwLjQsMC42LDAuNCwxYzAsMC4zLTAuMSwwLjYtMC4zLDAuOAoJCWMtMC4zLDAuMy0wLjYsMC40LTAuOSwwLjRzLTAuNi0wLjEtMC45LTAuNGMtMS40LTEuOS0yLjMtMy43LTMuMi02YzAuMiwxLjYsMC40LDMuNywwLjQsNS4ydjEzLjhjMCwwLjYtMC41LDEtMS4yLDEKCQlzLTEuMi0wLjMtMS4yLTF2LTEyLjZjMC0xLjcsMC4yLTMuOSwwLjUtNmMtMSw0LjItMi43LDguMy00LjUsMTAuOWMtMC4zLDAuNC0wLjcsMC42LTEuMSwwLjZjLTAuMywwLTAuNS0wLjEtMC43LTAuMgoJCWMtMC4zLTAuMy0wLjUtMC43LTAuNS0xLjFjMC0wLjMsMC4xLTAuNSwwLjMtMC44YzIuMy0zLDQuMy03LjIsNS42LTEyLjRMMjc5LjEsMTY3LjdMMjc5LjEsMTY3Ljd6IE0yOTIuNiwxNjcuNwoJCWMtMC42LDAtMC45LTAuNS0wLjktMS4yczAuMy0xLjIsMC45LTEuMmg4LjNsLTAuMS01LjVjMC0wLjYsMC41LTEsMS4yLTFzMS4yLDAuMywxLjIsMWwwLjEsNS41aDMuNWMwLjYsMCwwLjksMC41LDAuOSwxLjIKCQlzLTAuNCwxLjItMC45LDEuMmgtMy41bDAuMSwxOC42YzAsMi42LTEsMy41LTMuNywzLjVjLTEuMiwwLTIuNy0wLjEtMy43LTAuNGMtMC41LTAuMS0wLjktMC41LTAuOS0xLjJjMC0wLjEsMC0wLjMsMC0wLjQKCQljMC4yLTAuNywwLjYtMSwxLjEtMWMwLjEsMCwwLjIsMCwwLjMsMGMwLjksMC4yLDIsMC40LDIuOSwwLjRjMS4zLDAsMS42LTAuMiwxLjYtMS4zdi0xMC44YzAtMS44LDAuMy00LDAuNS01LjUKCQljLTIuMSw1LjYtNi4xLDEwLjYtMTAuNiwxNGMtMC4yLDAuMi0wLjUsMC4yLTAuOCwwLjJjLTAuNCwwLTAuOC0wLjItMS0wLjVjLTAuMi0wLjItMC4zLTAuNS0wLjMtMC44YzAtMC40LDAuMi0wLjgsMC41LTEKCQljMy45LTIuNyw4LjUtNy43LDEwLjgtMTMuN2gtNy41VjE2Ny43eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTMxOC40LDE3Mi43YzIuNS0xLjksNC40LTIuOCw2LjQtMi44YzIuMywwLDQuMSwxLDQuNSw0YzIuOS0xLjEsNS44LTIsOC0yLjdjMC4yLDAsMC40LTAuMSwwLjUtMC4xCgkJYzAuNiwwLDEsMC4zLDEuMiwwLjljMCwwLjIsMC4xLDAuNCwwLjEsMC41YzAsMC42LTAuMywxLjEtMSwxLjJjLTIuNCwwLjYtNS40LDEuNS04LjYsMi43YzAuMSwxLjIsMC4xLDIuNCwwLjEsMy42CgkJYzAsMC42LDAsMS4zLDAsMS45YzAsMC44LTAuNSwxLjMtMS4zLDEuM3MtMS4yLTAuNC0xLjItMS4zdi00LjdjLTQuNSwxLjgtNi42LDMuOC02LjYsNnMyLjEsMyw2LjcsM2MzLjEsMCw2LjQtMC4zLDguOC0wLjcKCQljMC4yLDAsMC4zLDAsMC41LDBjMC42LDAsMS4xLDAuMywxLjIsMWMwLDAuMSwwLDAuMiwwLDAuM2MwLDAuNy0wLjUsMS4zLTEuMiwxLjRjLTIuNCwwLjQtNS42LDAuNy05LjEsMC43Yy02LjEsMC05LjYtMS44LTkuNi01LjYKCQljMC0zLjIsMy02LjMsOS04LjZjLTAuMi0yLjEtMS4yLTIuNi0yLjYtMi42Yy0yLjgsMC02LjMsMi4yLTEwLjIsNi4zYy0wLjMsMC4zLTAuNywwLjUtMSwwLjVzLTAuNi0wLjEtMC45LTAuNAoJCWMtMC4zLTAuMy0wLjQtMC42LTAuNC0xczAuMi0wLjgsMC41LTEuMWMyLjgtMi43LDUuNi02LjIsNy43LTkuN2gtMS41Yy0xLjYsMC0zLjUsMC01LTAuMWMtMC43LDAtMS4xLTAuNi0xLjEtMS4ydi0wLjEKCQljMC4xLTAuNywwLjUtMS4yLDEuMi0xLjJoMC4xYzEuNSwwLjEsMy42LDAuMiw1LjgsMC4yaDEuOWMwLjYtMS4yLDEuMi0yLjUsMS42LTMuN2MwLjItMC43LDAuNy0xLDEuMi0xYzAuMiwwLDAuMywwLDAuNSwwLjEKCQljMC42LDAuMSwxLDAuNSwxLDFjMCwwLjIsMCwwLjQtMC4xLDAuNmMtMC40LDEtMC44LDEuOS0xLjMsMi45YzIuOC0wLjEsNi42LTAuNSwxMC4yLTFjMC4xLDAsMC4yLDAsMC4zLDBjMC42LDAsMS4xLDAuNCwxLjIsMS4xCgkJdjAuMmMwLDAuNi0wLjQsMS4xLTEuMSwxLjJjLTQuMSwwLjYtOC4yLDEtMTEuOSwxLjFjLTEuMywyLjItMi44LDQuMy00LjUsNS44TDMxOC40LDE3Mi43TDMxOC40LDE3Mi43eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTM0OS4yLDE3MC40Yy0wLjUsMC0wLjgsMC4yLTAuOSwwLjdjLTAuMiwxLjEtMC41LDIuNC0wLjcsMy4zYzAsMC4xLTAuMSwwLjMtMC4xLDAuNGMwLDAuNCwwLjMsMC42LDAuOSwwLjYKCQloNy42YzIuMiwwLDMsMSwzLDNjMCwzLjItMC41LDYtMS4yLDhjLTAuOCwyLjEtMi4xLDMtNC45LDNjLTEuOCwwLTMuMy0wLjItNC42LTAuNWMtMC42LTAuMS0xLTAuNi0xLTEuMmMwLTAuMSwwLTAuMiwwLTAuNAoJCWMwLjEtMC43LDAuNS0xLjEsMS0xLjFjMC4xLDAsMC4zLDAsMC40LDAuMWMxLjIsMC40LDIuNiwwLjYsNC4xLDAuNnMyLjItMC40LDIuNy0xLjdjMC42LTEuNiwwLjktMy44LDAuOS02LjNjMC0wLjctMC4yLTEtMS4yLTEKCQlIMzQ3Yy0xLjQsMC0yLjItMC42LTIuMi0xLjhjMC0wLjIsMC0wLjUsMC4xLTAuOGMwLjQtMS43LDAuNy0zLjUsMC45LTUuMWMwLjItMS4yLDAuOS0yLjIsMi41LTIuMmg3YzAuNiwwLDAuOS0wLjIsMC45LTAuOHYtMy42CgkJYzAtMC42LTAuMy0wLjgtMC45LTAuOGgtOS43Yy0wLjUsMC0wLjktMC42LTAuOS0xLjJzMC40LTEuMiwwLjktMS4yaDEwLjVjMS44LDAsMi42LDAuOCwyLjYsMi42djQuOWMwLDEuOS0wLjksMi42LTIuNiwyLjYKCQlMMzQ5LjIsMTcwLjRMMzQ5LjIsMTcwLjR6IE0zNjYuOSwxNjAuM2MwLTAuNiwwLjUtMSwxLjMtMXMxLjMsMC40LDEuMywxdjI4LjRjMCwwLjctMC41LDEuMS0xLjMsMS4xcy0xLjMtMC40LTEuMy0xLjFWMTYwLjN6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMzk3LjEsMTc3LjljLTEuNi0xLjUtMy0zLjMtNC4zLTUuM2MtNC4zLDAuNi04LjgsMS4xLTEzLjQsMS4xYy0wLjksMC0xLjMtMC41LTEuMy0xLjJ2LTAuMQoJCWMwLTAuOCwwLjQtMS4yLDEuMS0xLjJjMy43LDAsNy45LTAuMywxMi4yLTFjLTAuNy0xLjEtMS4zLTIuMy0xLjktMy42Yy0zLjQsMC40LTcsMC43LTEwLjMsMC43Yy0wLjgsMC0xLjMtMC41LTEuMy0xLjIKCQlzMC41LTEuMiwxLjItMS4yYzMsMCw2LjItMC4yLDkuMy0wLjZjLTAuNC0wLjktMC44LTEuOS0xLjEtMi45Yy0wLjEtMC4yLTAuMS0wLjQtMC4xLTAuNmMwLTAuNSwwLjMtMC45LDAuOS0xLjEKCQljMC4yLDAsMC40LTAuMSwwLjUtMC4xYzAuNSwwLDEsMC4zLDEuMiwxYzAuNCwxLjEsMC44LDIuMiwxLjIsMy4zYzMuMS0wLjUsNi0xLjEsOC4zLTEuOGMwLjItMC4xLDAuNC0wLjEsMC41LTAuMQoJCWMwLjUsMCwwLjksMC4zLDEuMSwwLjljMCwwLjIsMC4xLDAuMywwLjEsMC41YzAsMC41LTAuMywwLjktMC45LDEuMWMtMi4zLDAuNy01LjEsMS4yLTguMSwxLjhjMC41LDEuMiwxLjEsMi40LDEuOCwzLjUKCQljMi41LTAuNCw1LTEsNy4yLTEuNmMwLjIsMCwwLjQtMC4xLDAuNS0wLjFjMC42LDAsMSwwLjMsMS4xLDAuOWMwLDAuMiwwLjEsMC4zLDAuMSwwLjRjMCwwLjYtMC40LDEtMSwxLjJjLTEuOSwwLjUtNCwxLTYuNSwxLjQKCQljMS4yLDEuOSwyLjksNCw0LjksNmMwLjUsMC41LDAuNiwxLDAuNiwxLjNjMCwwLjgtMC42LDEuNS0xLjQsMS41Yy0wLjUsMC0wLjktMC4yLTEuNi0wLjVjLTIuMi0xLjItNS0xLjktOC4zLTEuOQoJCWMtNS43LDAtNy40LDEuNy03LjQsMy45YzAsMi40LDIuMywzLjUsNy41LDMuNWMyLjcsMCw1LjctMC40LDguNC0xLjNjMC4yLTAuMSwwLjQtMC4xLDAuNi0wLjFjMC41LDAsMSwwLjMsMS4yLDEKCQljMCwwLjIsMC4xLDAuMywwLjEsMC41YzAsMC42LTAuMywxLjEtMSwxLjNjLTIuOSwwLjktNiwxLjMtOS40LDEuM2MtNi43LDAtMTAuMS0yLjMtMTAuMS02LjJjMC0zLjcsMy4xLTYuMywxMC4xLTYuMwoJCWMyLjcsMCw1LjQsMC42LDcuNSwxLjdMMzk3LjEsMTc3LjlMMzk3LjEsMTc3Ljl6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDA4LjksMTc2LjljLTAuNiwwLTAuOS0wLjQtMC45LTEuMmMwLTAuNywwLjMtMS4xLDAuOS0xLjFINDM3YzAuNiwwLDAuOSwwLjQsMC45LDEuMWMwLDAuNy0wLjQsMS4yLTAuOSwxLjIKCQloLTMuOXYxMGMwLDIuNC0xLjEsMy4zLTMuOSwzLjNjLTEuNCwwLTIuNiwwLTMuNi0wLjNjLTAuNS0wLjEtMC45LTAuNS0wLjktMS4xYzAtMC4xLDAtMC4yLDAtMC4zYzAuMS0wLjYsMC41LTEsMS0xCgkJYzAuMSwwLDAuMiwwLDAuMywwYzAuOCwwLjIsMS43LDAuMywyLjcsMC4zYzEuNiwwLDEuOS0wLjIsMS45LTEuMnYtOS43SDQwOC45TDQwOC45LDE3Ni45eiBNNDI0LjYsMTY4LjVjMi4yLDIuNCw1LjMsMy4yLDkuOCwzLjUKCQljMC41LDAsMC45LDAuNCwwLjksMXYwLjJjLTAuMSwwLjctMC42LDEtMS4xLDFINDM0Yy01LjMtMC4zLTkuMi0xLjctMTEuNi01LjJjLTAuNiwxLjEtMS40LDItMi4zLDIuNmMtMS45LDEuMy01LDIuMi04LjEsMi42aC0wLjIKCQljLTAuNSwwLTAuOS0wLjMtMS4xLTAuOGMwLTAuMSwwLTAuMiwwLTAuM2MwLTAuNSwwLjMtMC44LDAuOC0wLjljMy0wLjMsNS45LTEsNy42LTIuM2MwLjUtMC40LDAuOS0wLjgsMS4yLTEuMmgtNwoJCWMtMC41LDAtMC44LTAuNC0wLjgtMXMwLjMtMSwwLjgtMWg3LjljMC4xLTAuNSwwLjItMSwwLjMtMS43YzAuMS0wLjYsMC40LTAuOCwxLTAuOWgtMTAuMWMtMC43LDAtMSwwLjItMSwwLjl2Mi41CgkJYzAsMC43LTAuNSwxLTEuMiwxcy0xLjItMC4zLTEuMi0xdi0yLjljMC0xLjksMC45LTIuNywyLjgtMi43aDEwdi0yYzAtMC42LDAuNS0xLDEuMi0xczEuMiwwLjMsMS4yLDF2MmgxMC4zCgkJYzEuOSwwLDIuOCwwLjgsMi44LDIuN3YyLjljMCwwLjctMC41LDEtMS4yLDFzLTEuMi0wLjMtMS4yLTFWMTY1YzAtMC43LTAuMy0wLjktMS0wLjloLTExYzAuNywwLDEuMiwwLjMsMS4yLDAuOQoJCWMwLDAuMSwwLDAuMiwwLDAuMmMtMC4xLDAuNS0wLjIsMS0wLjMsMS40aDkuM2MwLjUsMCwwLjgsMC40LDAuOCwxcy0wLjMsMS0wLjgsMUw0MjQuNiwxNjguNUw0MjQuNiwxNjguNXogTTQyMy44LDE3OC44CgkJYzEuOSwwLDIuNywwLjcsMi43LDIuNHYzLjJjMCwxLjctMC45LDIuNS0yLjcsMi41aC04LjVjLTEuOSwwLTIuOC0wLjctMi44LTIuNXYtMy4yYzAtMS43LDAuOS0yLjQsMi44LTIuNEg0MjMuOHogTTQyMy4yLDE4NC45CgkJYzAuNiwwLDEtMC4yLDEtMC44di0yLjVjMC0wLjYtMC4zLTAuOC0xLTAuOGgtNy4zYy0wLjYsMC0xLDAuMi0xLDAuOHYyLjVjMCwwLjYsMC4zLDAuOCwxLDAuOEg0MjMuMnoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00NjMuMSwxNzYuNGMtMC41LDIuNS0xLjcsNC00LDRjLTEuNiwwLTMuNS0wLjYtNS0xLjljLTAuMy0wLjMtMC41LTAuNi0wLjUtMWMwLTAuMywwLjEtMC42LDAuMy0wLjgKCQljMC4zLTAuMywwLjYtMC41LDEtMC41YzAuMywwLDAuNiwwLjEsMC45LDAuM2MwLjgsMC43LDIsMS4yLDMuMSwxLjJjMSwwLDEuNS0wLjUsMS43LTEuOWMwLjItMS4zLDAuMy0zLjIsMC40LTUuNAoJCWMtMS43LDAuMS0zLjQsMC4xLTQuOSwwLjJjLTIuMSwwLjEtNC4yLDAuMi02LjMsMC40djMuN2MwLDYuMSwwLjIsNy41LDAuNiw4LjNjMC44LDEuNSwyLjYsMiw2LjgsMmMzLjIsMCw2LjMtMC4zLDguNi0wLjgKCQljMC4yLDAsMC4zLDAsMC41LDBjMC43LDAsMS4xLDAuNCwxLjIsMS4xYzAsMC4xLDAsMC4yLDAsMC4zYzAsMC44LTAuNSwxLjMtMS4yLDEuNWMtMi4zLDAuNS01LjcsMC44LTksMC44Yy01LjEsMC03LjktMC45LTktMwoJCWMtMC45LTEuNC0xLjItMy4xLTEuMi04Ljl2LTFjMC0xLjIsMC0yLjUsMC0zLjljLTEuNywwLjEtMy40LDAuMy01LjEsMC40aC0wLjJjLTAuNywwLTEuMS0wLjUtMS4xLTEuMnYtMC4xYzAtMC43LDAuNC0xLjIsMS4xLTEuMgoJCWMxLjgtMC4xLDMuNS0wLjMsNS40LTAuNGMwLTIuMSwwLTQuNCwwLTYuM2MwLTAuOCwwLjYtMS4yLDEuMy0xLjJjMC45LDAsMS40LDAuNSwxLjQsMS4yYzAsMiwwLDQsMCw2LjFjMi0wLjEsNC0wLjMsNi4xLTAuNAoJCWMxLjQtMC4xLDMuMS0wLjIsNS0wLjJjMC0wLjcsMC0xLjQsMC0yLjFjMC0xLjQsMC0yLjcsMC00YzAtMC44LDAuNS0xLjIsMS4zLTEuMnMxLjQsMC40LDEuNCwxLjJ2M2MwLDEsMCwyLDAsMy4xCgkJYzEuOC0wLjEsMy43LTAuMSw1LjUtMC4xYzAuOSwwLDEuMywwLjUsMS4zLDEuMmMwLDAuOC0wLjQsMS4zLTEuMiwxLjNjLTEuOCwwLTMuNywwLjEtNS42LDAuMQoJCUM0NjMuNiwxNzIuNSw0NjMuNCwxNzQuOCw0NjMuMSwxNzYuNEw0NjMuMSwxNzYuNHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00ODQsMTczLjRjMi41LTEuMiw0LjktMS44LDcuMi0xLjhjNS45LDAsOS40LDMuMiw5LjQsNy44YzAsNS43LTUsOS4zLTEyLjksOS4zYy00LjgsMC03LjktMi4xLTcuOS01LjIKCQljMC0yLjYsMi4xLTQuNiw1LjMtNC42YzMuNSwwLDYuNCwyLjIsNyw2LjdjMy4zLTAuOCw1LjgtMi45LDUuOC02LjFzLTIuNS01LjUtNy4yLTUuNWMtNC4zLDAtOC4zLDEuNS0xMy42LDQuOQoJCWMtMC4zLDAuMi0wLjYsMC4yLTAuOSwwLjJjLTAuNSwwLTAuOS0wLjItMS4yLTAuNmMtMC4yLTAuMi0wLjItMC41LTAuMi0wLjdjMC0wLjUsMC4zLTEsMC44LTEuM2M1LjQtMy40LDEyLjYtOC45LDE2LjctMTIuNwoJCWMtMy41LDAuMy04LjUsMC41LTEyLjcsMC41Yy0wLjcsMC0xLjItMC41LTEuMi0xLjNzMC40LTEuNCwxLjEtMS40YzQuNCwwLDEwLTAuMiwxNC4zLTAuNWgwLjNjMC44LDAsMS4zLDAuMywxLjYsMC44CgkJYzAuMiwwLjMsMC4zLDAuNiwwLjMsMWMwLDAuNS0wLjIsMS0wLjYsMS40Yy0yLjgsMi43LTUuOSw1LjEtOC41LDdjLTAuOSwwLjYtMiwxLjQtMi45LDJMNDg0LDE3My40TDQ4NCwxNzMuNHogTTQ4NSwxODEuMgoJCWMtMS43LDAtMi43LDAuOS0yLjcsMi4yYzAsMS41LDIsMi44LDQuOSwyLjljMC44LDAsMS42LDAsMi40LTAuMUM0ODkuMywxODIuOCw0ODcuMiwxODEuMiw0ODUsMTgxLjJMNDg1LDE4MS4yeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTUxNi4yLDE4NC43YzAsMi45LTIuMyw1LjMtNS4xLDUuM3MtNS4xLTIuNC01LjEtNS4zczIuMy01LjMsNS4xLTUuM1M1MTYuMiwxODEuOCw1MTYuMiwxODQuN3ogTTUwOC4xLDE4NC43CgkJYzAsMS43LDEuNCwzLjEsMywzLjFzMy0xLjUsMy0zLjFzLTEuNC0zLjEtMy0zLjFDNTA5LjUsMTgxLjYsNTA4LjEsMTgzLDUwOC4xLDE4NC43eiIvPgo8L2c+CjxnIGNsYXNzPSJzdDMiPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTMzMi41LDMyN2MxLDIuMiwyLjgsMy4zLDQuOSwzLjZjMS41LDAuMiwzLjUsMC40LDYsMC40YzQsMCw4LjItMC4yLDExLjUtMC40YzAuMSwwLDAuMSwwLDAuMiwwCgkJYzAuNywwLDEuMSwwLjQsMS4xLDEuMmMwLDAuMSwwLDAuMSwwLDAuMmMwLDAuNy0wLjQsMS4yLTEuMiwxLjJjLTMuMywwLjItNy45LDAuMy0xMS44LDAuM2MtMi43LDAtNS4xLTAuMS02LjctMC41CgkJYy0yLjQtMC41LTQuMi0xLjgtNS4zLTMuOGMtMS4xLDEuNS0yLjQsMy0zLjgsNGMtMC4yLDAuMi0wLjQsMC4yLTAuNiwwLjJjLTAuMywwLTAuNi0wLjItMC45LTAuNmMtMC4yLTAuMy0wLjMtMC41LTAuMy0wLjgKCQljMC0wLjQsMC4yLTAuNywwLjUtMWMxLjEtMC44LDIuOC0yLjQsNC00di03LjRjMC0wLjctMC4yLTAuOC0wLjgtMC44aC0yLjZjLTAuNiwwLTEtMC40LTEtMS4xYzAtMC44LDAuNC0xLjIsMS0xLjJoMy41CgkJYzEuNywwLDIuNCwwLjksMi40LDIuN3Y3LjhIMzMyLjV6IE0zMzIuNywzMDguOWMwLjIsMC4zLDAuMywwLjYsMC4zLDAuOGMwLDAuNC0wLjIsMC43LTAuNSwxYy0wLjMsMC4yLTAuNiwwLjQtMC45LDAuNAoJCXMtMC42LTAuMS0wLjktMC41Yy0xLjEtMS43LTIuMy0zLjMtMy43LTQuN2MtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjdjMC0wLjMsMC4yLTAuNiwwLjUtMC45czAuNi0wLjQsMC45LTAuNHMwLjUsMC4xLDAuNywwLjMKCQlDMzMwLjIsMzA1LjUsMzMxLjcsMzA3LjMsMzMyLjcsMzA4Ljl6IE0zNDYuOSwzMTcuN3YtMS42YzAtMC42LDAuNS0wLjksMS4xLTAuOWMwLjcsMCwxLjEsMC4zLDEuMSwwLjl2MS42aDQuMgoJCWMwLjUsMCwwLjgsMC41LDAuOCwxYzAsMC42LTAuMywxLTAuOCwxaC00LjJ2Mi44aDUuNGMwLjUsMCwwLjgsMC41LDAuOCwxYzAsMC42LTAuMywxLTAuOCwxaC0yMGMtMC41LDAtMC44LTAuNS0wLjgtMXMwLjMtMSwwLjgtMQoJCWg0Ljh2LTIuOGgtMy43Yy0wLjUsMC0wLjgtMC41LTAuOC0xczAuMy0xLDAuOC0xaDMuN3YtMS42YzAtMC42LDAuNS0wLjksMS4xLTAuOWMwLjcsMCwxLjIsMC4zLDEuMiwwLjl2MS42SDM0Ni45eiBNMzM3LjIsMzA5LjkKCQljLTAuNywwLTAuOCwwLjEtMC44LDAuOHYxYzAsMC43LDAuMiwxLDIuMywxYzEuOSwwLDIuNC0wLjEsMi43LTAuM2MwLjMtMC4zLDAuNS0wLjYsMC41LTEuMWMwLjEtMC42LDAuNS0wLjgsMS0wLjgKCQljMC4xLDAsMC4xLDAsMC4yLDBjMC42LDAuMSwxLDAuNSwxLDF2MC4xYy0wLjEsMC45LTAuNCwxLjgtMC44LDIuMmMtMC4zLDAuNC0wLjgsMC43LTEuOCwwLjhjLTAuNywwLjEtMS42LDAuMS0yLjgsMC4xCgkJYy0xLjQsMC0yLjQsMC0zLTAuMmMtMS4xLTAuMy0xLjQtMS0xLjQtMi4zVjMxMGMwLTEuMywwLjYtMiwyLjEtMmg0LjFjMC42LDAsMC44LTAuMSwwLjgtMC44di0wLjZjMC0wLjYtMC4xLTAuOC0wLjgtMC44aC01LjYKCQljLTAuNSwwLTAuOC0wLjQtMC44LTFzMC4zLTEsMC44LTFoNi40YzEuNywwLDIuMiwwLjYsMi4yLDIuM3YxLjljMCwxLjctMC43LDIuMS0yLjIsMi4xaC00LjFWMzA5Ljl6IE0zNDIuNCwzMjYuNAoJCWMwLDAuMy0wLjEsMC42LTAuNCwwLjhjLTEuNSwxLTMuNSwyLTUuMywyLjVjLTAuMiwwLTAuMywwLjEtMC40LDAuMWMtMC41LDAtMC44LTAuMi0xLTAuNmMtMC4xLTAuMi0wLjEtMC4zLTAuMS0wLjUKCQljMC0wLjQsMC4zLTAuOCwwLjctMC45YzEuNS0wLjQsMy40LTEuMyw0LjgtMi4yYzAuMi0wLjEsMC40LTAuMiwwLjYtMC4yYzAuMywwLDAuNiwwLjEsMC44LDAuNAoJCUMzNDIuNCwzMjUuOSwzNDIuNCwzMjYuMiwzNDIuNCwzMjYuNHogTTM0Ni45LDMyMi42di0yLjhoLTUuM3YyLjhIMzQ2Ljl6IE0zNDguMiwzMDkuOWMtMC43LDAtMC44LDAuMS0wLjgsMC44djEKCQljMCwwLjksMC4yLDEsMi40LDFjMC4yLDAsMC40LDAsMC42LDBjMS41LDAsMi4xLTAuMSwyLjQtMC4zYzAuMy0wLjMsMC40LTAuNiwwLjUtMS4yYzAtMC41LDAuNS0wLjcsMS0wLjdjMC4xLDAsMC4yLDAsMC4yLDAKCQljMC42LDAuMSwwLjksMC41LDAuOSwxdjAuMWMtMC4xLDAuOS0wLjMsMS44LTAuNywyLjFjLTAuMywwLjQtMC44LDAuNy0xLjgsMC44Yy0wLjcsMC4xLTEuOCwwLjItMywwLjJjLTEuNCwwLTIuNS0wLjEtMy4yLTAuMgoJCWMtMS4xLTAuMy0xLjQtMC45LTEuNC0yLjN2LTIuNGMwLTEuMiwwLjYtMS45LDIuMS0xLjloNC4yYzAuNywwLDAuOC0wLjIsMC44LTAuOXYtMC41YzAtMC42LTAuMS0wLjgtMC44LTAuOEgzNDYKCQljLTAuNSwwLTAuOC0wLjQtMC44LTFzMC4zLTEsMC44LTFoNi40YzEuNiwwLDIuMiwwLjYsMi4yLDIuM3YxLjljMCwxLjctMC43LDIuMS0yLjMsMi4xaC00LjFWMzA5Ljl6IE0zNTIuMiwzMjkuOAoJCWMtMi0wLjYtNC0xLjUtNS43LTIuNmMtMC4zLTAuMi0wLjUtMC40LTAuNS0wLjdjMC0wLjMsMC4xLTAuNSwwLjQtMC44YzAuMy0wLjIsMC42LTAuMywwLjgtMC4zYzAuMiwwLDAuNSwwLjEsMC43LDAuMgoJCWMxLjcsMSwzLjgsMS45LDUuNywyLjVjMC40LDAuMSwwLjYsMC40LDAuNiwwLjhjMCwwLjEsMCwwLjItMC4xLDAuNGMtMC4xLDAuNi0wLjUsMC44LTAuOSwwLjhjLTAuMSwwLTAuMywwLTAuNC0wLjFMMzUyLjIsMzI5Ljh6IgoJCS8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNMzc1LjksMzEyLjJjMy4yLTIuNCw1LjktNS4yLDcuOS04YzAuMy0wLjMsMC42LTAuNSwxLTAuNWMwLjMsMCwwLjYsMC4xLDAuOCwwLjNjMC40LDAuMywwLjYsMC42LDAuNiwxCgkJYzAsMC4zLTAuMSwwLjYtMC4zLDAuOGMtMS43LDIuMy0zLjksNC40LTYuMyw2LjVoNy43YzAuNiwwLDAuOSwwLjQsMC45LDEuMXMtMC40LDEuMi0wLjksMS4yaC0xMC43Yy0wLjksMC42LTEuOCwxLjMtMi44LDEuOQoJCWMtMS4xLDAuNy0yLjEsMS4yLTMuMywxLjhjMCwwLjEsMCwwLjItMC4xLDAuM2MwLDAuMSwwLDAuMS0wLjEsMC4yYzQuNy0wLjIsOS42LTAuOSwxMy4zLTJjMC4yLTAuMSwwLjQtMC4xLDAuNi0wLjEKCQljMC41LDAsMC44LDAuMywxLDAuOGMwLjEsMC4yLDAuMSwwLjMsMC4xLDAuNWMwLDAuNS0wLjMsMS0wLjksMS4xYy00LjEsMS4xLTkuNCwxLjctMTQuOCwyYy0wLjIsMC42LTAuNSwxLjItMC42LDEuNwoJCWMtMC4xLDAuMi0wLjEsMC4zLTAuMSwwLjRjMCwwLjMsMC4yLDAuMywwLjcsMC4zaDExLjdjMS45LDAsMi44LDAuNywyLjgsMi40YzAsMC4xLDAsMC4yLDAsMC4zYy0wLjEsMS45LTAuNSwzLjgtMSw1LjEKCQljLTAuNiwxLjgtMS44LDIuNS00LjUsMi41Yy0xLjgsMC0zLjUtMC4yLTQuNy0wLjZjLTAuNi0wLjEtMC45LTAuNi0wLjktMS4xYzAtMC4xLDAtMC4zLDAuMS0wLjRjMC4yLTAuNiwwLjYtMC45LDEuMS0wLjkKCQljMC4xLDAsMC4yLDAsMC4zLDBjMS4yLDAuMywyLjcsMC41LDMuOSwwLjVjMS40LDAsMi4xLTAuMywyLjUtMS40YzAuMi0wLjcsMC42LTIuMiwwLjYtMy40di0wLjFjMC0wLjUtMC4zLTAuNy0xLTAuN2gtMTIuNwoJCWMtMS4yLDAtMS44LTAuNS0xLjgtMS40YzAtMC4zLDAuMS0wLjcsMC4zLTEuMWMwLjUtMSwwLjktMi4yLDEuMy0zLjRjLTIuNCwxLjItNSwyLjMtNy40LDMuMmMtMC4yLDAuMS0wLjQsMC4xLTAuNiwwLjEKCQljLTAuNSwwLTAuOS0wLjMtMS4xLTAuOGMtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjVjMC0wLjUsMC4zLTEsMC44LTEuMWM0LjUtMS40LDktMy41LDEyLjktNS45YzAuMi0wLjEsMC40LTAuMiwwLjYtMC40aC0xMwoJCWMtMC42LDAtMC45LTAuNS0wLjktMS4yczAuNC0xLjEsMC45LTEuMWgxMC44di0zLjZoLTcuN2MtMC42LDAtMC45LTAuNC0wLjktMS4xczAuNC0xLjEsMC45LTEuMWg3Ljd2LTIuNmMwLTAuNiwwLjQtMC45LDEuMi0wLjkKCQljMC43LDAsMS4yLDAuNCwxLjIsMC45djIuNmg1LjZjMC42LDAsMSwwLjQsMSwxLjFzLTAuNCwxLjEtMS4xLDEuMWgtNS41djMuNmgzVjMxMi4yeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTM5Mi44LDMyNC45YzAuNCwwLDAuNywwLjEsMSwwLjRjMS44LDEuNSw0LjEsNCw1LjQsNmMwLjIsMC4zLDAuMywwLjcsMC4zLDFjMCwwLjQtMC4yLDAuOC0wLjYsMS4xCgkJYy0wLjMsMC4yLTAuNiwwLjQtMSwwLjRjLTAuNSwwLTAuOS0wLjItMS4yLTAuN2MtMS4yLTEuOC0zLjItNC4yLTUuMS01LjljLTAuMi0wLjItMC40LTAuNS0wLjQtMC44YzAtMC40LDAuMi0wLjgsMC41LTEuMQoJCUMzOTIuMSwzMjUsMzkyLjUsMzI0LjksMzkyLjgsMzI0Ljl6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDE0LjEsMzIzLjljLTIsMC0zLTAuOC0zLTIuOXYtMTQuM2MwLTIuMiwwLjktMywzLTNoMTUuNmMyLDAsMywwLjgsMywzVjMyMWMwLDIuMS0wLjksMi45LTMsMi45aC0zLjZ2NS45CgkJYzAsMS4xLDAuMywxLjIsMy4zLDEuMmMzLjMsMCwzLjktMC4zLDQuMi0xYzAuMy0wLjUsMC41LTEuOCwwLjYtMi45YzAuMS0wLjgsMC41LTEuMSwxLjEtMS4xYzAuMSwwLDAuMiwwLDAuMywwCgkJYzAuOCwwLjEsMS4xLDAuNSwxLjEsMS4xdjAuMWMtMC4xLDEuNS0wLjUsMy4xLTAuOSw0LjFjLTAuNiwxLjUtMS42LDIuMS02LjIsMi4xYy01LjMsMC02LjEtMC41LTYuMS0yLjh2LTYuN2gtNAoJCWMtMC43LDUuOS00LjUsOS0xMC43LDEwLjNjLTAuMSwwLTAuMywwLTAuNCwwYy0wLjYsMC0xLjEtMC4zLTEuMy0xYzAtMC4yLTAuMS0wLjMtMC4xLTAuNGMwLTAuNiwwLjQtMS4xLDEtMS4yCgkJYzUuMy0xLDguMy0zLjIsOC45LTcuN0g0MTQuMXogTTQzMC4yLDMwNy4xYzAtMC43LTAuMy0wLjktMS0wLjloLTE0LjdjLTAuNywwLTEsMC4yLTEsMC45djIuN2gxNi42di0yLjdINDMwLjJ6IE00MzAuMiwzMTJoLTE2LjYKCQl2My42aDE2LjZWMzEyeiBNNDEzLjYsMzE3Ljl2Mi45YzAsMC43LDAuMywwLjksMSwwLjloMTQuN2MwLjYsMCwxLTAuMiwxLTAuOXYtMi45SDQxMy42eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ0OCwzMDkuM2MwLjYsMCwwLjgsMC41LDAuOCwxLjFzLTAuMywxLjEtMC44LDEuMWgtMi4yYzAuNiwyLjIsMS40LDMuOCwyLjQsNS4yYzAuMiwwLjMsMC4zLDAuNiwwLjMsMC45CgkJcy0wLjEsMC41LTAuMywwLjdjLTAuMiwwLjItMC41LDAuNC0wLjcsMC40cy0wLjYtMC4xLTAuNy0wLjRjLTAuNi0xLTEtMi4xLTEuNS0zLjhjMC4yLDEuNiwwLjQsNC4xLDAuNCw1LjV2MTMuMwoJCWMwLDAuNi0wLjQsMS0xLjEsMXMtMS4xLTAuNC0xLjEtMXYtMTEuOGMwLTEuNCwwLjItNC4zLDAuNS02LjhjLTAuNiwzLjEtMS44LDcuMS0zLjIsOS42Yy0wLjIsMC40LTAuNiwwLjYtMSwwLjYKCQljLTAuMiwwLTAuNC0wLjEtMC42LTAuMmMtMC4zLTAuMi0wLjUtMC41LTAuNS0wLjljMC0wLjMsMC4xLTAuNSwwLjMtMC44YzEuOC0yLjcsMy40LTcuNCw0LjItMTEuNGgtMi43Yy0wLjYsMC0wLjktMC41LTAuOS0xLjEKCQljMC0wLjcsMC4zLTEuMSwwLjktMS4xaDN2LTUuNmMwLTAuNiwwLjQtMSwxLjEtMXMxLjEsMC4zLDEuMSwxdjUuNmgyLjNWMzA5LjN6IE00NDguMiwzMzMuMWMtMC42LDAtMC45LTAuNS0wLjktMS4yCgkJczAuMy0xLjEsMC45LTEuMWgyMC40YzAuNiwwLDAuOSwwLjQsMC45LDEuMXMtMC4zLDEuMi0wLjksMS4ySDQ0OC4yeiBNNDQ4LjgsMzA2LjJjLTAuNiwwLTAuOS0wLjQtMC45LTEuMXMwLjMtMS4xLDAuOS0xLjFoMTkuNgoJCWMwLjYsMCwwLjksMC40LDAuOSwxLjFzLTAuMywxLjEtMC45LDEuMWgtMTAuOWMtMC4zLDEtMC43LDItMSwyLjZjLTAuMSwwLjEtMC4xLDAuMi0wLjEsMC4zYzAsMC4yLDAuMiwwLjMsMC41LDAuM2gxLjIKCQljMS41LDAsMi4xLDAuNywyLjEsMi4zYzAsOC0wLjQsMTIuNi0xLDE1LjNjLTAuNCwxLjktMS4zLDIuNi0zLjMsMi42Yy0xLDAtMi0wLjEtMi44LTAuM2MtMC41LTAuMS0wLjgtMC42LTAuOC0xLjEKCQljMC0wLjEsMC0wLjIsMC0wLjRjMC4xLTAuNSwwLjUtMC44LDEtMC44YzAuMSwwLDAuMiwwLDAuNCwwYzAuNSwwLjEsMS4zLDAuMywxLjksMC4zYzAuOCwwLDEuMy0wLjIsMS41LTEuMgoJCWMwLjYtMi40LDAuOC03LjEsMC44LTEzLjljMC0wLjctMC4yLTAuOS0wLjctMC45aC0xLjdjLTEuMSwwLTEuNy0wLjctMS43LTEuNWMwLTAuMywwLjEtMC42LDAuMi0wLjljMC4zLTAuNywwLjgtMS45LDEuMi0yLjloLTYuNAoJCVYzMDYuMnogTTQ1NS43LDMyMy4yYzAsMS44LTAuNywyLjQtMi4yLDIuNGgtMi4zYy0xLjYsMC0yLjItMC43LTIuMi0yLjR2LTguNWMwLTEuOCwwLjYtMi40LDIuMi0yLjRoMi4zYzEuNiwwLDIuMiwwLjYsMi4yLDIuNAoJCVYzMjMuMnogTTQ1MS4xLDMyMi43YzAsMC42LDAuMiwwLjgsMC43LDAuOGgxLjFjMC41LDAsMC44LTAuMiwwLjgtMC44di03LjZjMC0wLjYtMC4zLTAuOC0wLjgtMC44aC0xLjFjLTAuNSwwLTAuNywwLjItMC43LDAuOAoJCVYzMjIuN3ogTTQ2MS41LDMxMi45Yy0wLjYsMC0wLjktMC41LTAuOS0xLjFzMC4zLTEsMC45LTFoNS40YzEuNSwwLDIuMiwwLjcsMi4yLDJjMCwwLjMsMCwwLjUtMC4xLDAuOWMtMC42LDMuMi0xLjUsNi0yLjgsOC41CgkJYzAuOCwxLjUsMS45LDIuOSwzLjMsNC4yYzAuMywwLjMsMC40LDAuNiwwLjQsMWMwLDAuMy0wLjEsMC42LTAuMywwLjhjLTAuMiwwLjItMC42LDAuNC0wLjksMC40cy0wLjYtMC4xLTAuNy0wLjMKCQljLTEuMi0xLjItMi4xLTIuNS0zLTRjLTEsMS42LTIuMSwyLjktMy40LDQuMWMtMC4yLDAuMi0wLjUsMC4zLTAuOCwwLjNzLTAuNi0wLjEtMC45LTAuNGMtMC4yLTAuMi0wLjMtMC40LTAuMy0wLjcKCQljMC0wLjQsMC4yLTAuNywwLjUtMWMxLjUtMS4zLDIuOC0yLjgsMy44LTQuNmMtMS4zLTIuOC0yLTYtMi4yLTkuMUw0NjEuNSwzMTIuOUw0NjEuNSwzMTIuOXogTTQ2My42LDMxMi45CgkJYzAuMiwyLjMsMC42LDQuNiwxLjQsNi44YzAuOS0yLDEuNS00LDEuOC01LjljMC0wLjEsMC0wLjEsMC0wLjJjMC0wLjQtMC4yLTAuNi0wLjctMC42TDQ2My42LDMxMi45TDQ2My42LDMxMi45eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ3Ny40LDMyOS45Yy0yLjksMC01LjEtMi40LTUuMS02LjhjMC00LjIsMi03LjksNS41LTEwLjZjLTAuNC0xLjktMC44LTMuOS0xLTUuOGMwLTAuMSwwLTAuMiwwLTAuMgoJCWMwLTAuNywwLjQtMS4yLDEtMS4zYzAuMSwwLDAuMiwwLDAuMywwYzAuNiwwLDEsMC40LDEuMSwxLjFjMC4yLDEuNiwwLjUsMy4zLDAuNyw0LjljMi4yLTEuMiw0LjgtMS45LDcuOS0xLjkKCQljMC4zLTEuNCwwLjUtMi44LDAuNi00LjFjMC4xLTAuOCwwLjUtMS4yLDEuMi0xLjJjMC4xLDAsMC4yLDAsMC4zLDBjMC43LDAuMSwxLjEsMC42LDEuMSwxLjJjMCwwLjEsMCwwLjIsMCwwLjMKCQljLTAuMiwxLjItMC40LDIuNS0wLjYsMy45YzEuOCwwLjMsMy4zLDAuOSw0LjYsMS44YzIuOCwxLjksNC41LDQuOSw0LjUsOWMwLDYuNy00LjgsMTEuMS0xMi40LDEyLjFjLTAuMSwwLTAuMiwwLTAuMywwCgkJYy0wLjcsMC0xLjItMC40LTEuMy0xLjFjMC0wLjEsMC0wLjIsMC0wLjNjMC0wLjYsMC40LTEuMiwxLjItMS4zYzYuMS0wLjgsMTAuMS00LjMsMTAuMS05LjRjMC0zLTEuMy01LjUtMy4zLTcKCQljLTEuMS0wLjgtMi4zLTEuMi0zLjctMS41Yy0wLjQsMS43LTAuOCwzLjItMS4zLDQuN2MtMSwyLjgtMi4zLDUuNy0zLjYsNy45YzAuMywwLjUsMC42LDAuOSwwLjksMS40YzAuMiwwLjMsMC4zLDAuNiwwLjMsMC45CgkJcy0wLjEsMC43LTAuNSwxYy0wLjIsMC4yLTAuNiwwLjMtMC45LDAuM3MtMC42LTAuMS0wLjgtMC40Yy0wLjMtMC4zLTAuNS0wLjYtMC43LTFDNDgxLjMsMzI5LjEsNDc5LjIsMzI5LjksNDc3LjQsMzI5Ljl6CgkJIE00NzguNCwzMTUuMmMtMi4zLDItMy42LDQuOS0zLjYsNy43YzAsMi42LDEuMiw0LjMsMi43LDQuM2MxLjIsMCwyLjgtMC42LDQuNC0yLjhDNDgwLjUsMzIxLjgsNDc5LjIsMzE4LjYsNDc4LjQsMzE1LjJ6CgkJIE00ODYuMiwzMTUuN2MwLjQtMS4zLDAuOC0yLjYsMS4xLTQuMWMtMi40LDAtNC44LDAuNy02LjgsMS45YzAuNywzLjEsMS44LDYuMSwzLDguN0M0ODQuNSwzMjAuMyw0ODUuNCwzMTgsNDg2LjIsMzE1Ljd6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNTA0LjgsMzI0LjljMC40LDAsMC43LDAuMSwxLDAuNGMxLjgsMS41LDQuMSw0LDUuNCw2YzAuMiwwLjMsMC4zLDAuNywwLjMsMWMwLDAuNC0wLjIsMC44LTAuNiwxLjEKCQljLTAuMywwLjItMC42LDAuNC0xLDAuNGMtMC41LDAtMC45LTAuMi0xLjItMC43Yy0xLjItMS44LTMuMi00LjItNS4xLTUuOWMtMC4yLTAuMi0wLjQtMC41LTAuNC0wLjhjMC0wLjQsMC4yLTAuOCwwLjUtMS4xCgkJQzUwNCwzMjUsNTA0LjQsMzI0LjksNTA0LjgsMzI0Ljl6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNTI4LjYsMzI5LjZjMS45LTAuMiwzLjctMC41LDUuMy0wLjhjMC4xLDAsMC4yLDAsMC4zLDBjMC41LDAsMC43LDAuMywwLjgsMC44YzAsMC4xLDAsMC4yLDAsMC4yCgkJYzAsMC41LTAuMywwLjgtMC45LDFjLTQsMC44LTkuNCwxLjUtMTQsMS45SDUyMGMtMC42LDAtMS0wLjQtMS4xLTEuMWMwLTAuMSwwLTAuMSwwLTAuMmMwLTAuNiwwLjQtMSwwLjktMS4xCgkJYzIuMS0wLjEsNC40LTAuMiw2LjYtMC40di0yLjZoLTUuOWMtMC41LDAtMC44LTAuNC0wLjgtMXMwLjMtMSwwLjgtMWg1Ljl2LTJoLTMuOWMtMS43LDAtMi40LTAuNi0yLjQtMi4ydi02LjMKCQljMC0xLjYsMC43LTIuMiwyLjQtMi4yaDMuOXYtMS44aC02LjZjLTAuNiwwLTAuOC0wLjQtMC44LTFzMC4zLTEsMC44LTFoNi42di0yLjJjLTEuOSwwLjItMy45LDAuNC01LjYsMC40YzAsMCwwLDAtMC4xLDAKCQljLTAuNiwwLTEtMC40LTEtMS4xYzAsMCwwLDAsMC0wLjFjMC0wLjYsMC40LTEsMS0xYzQtMC4xLDguOC0wLjcsMTIuNC0xLjhjMC4xLDAsMC4yLDAsMC4zLDBjMC41LDAsMC44LDAuMywxLDAuOAoJCWMwLDAuMSwwLjEsMC4zLDAuMSwwLjRjMCwwLjUtMC4zLDAuOS0wLjgsMWMtMS41LDAuNC0zLjIsMC43LTUuMSwxdjIuNWg1LjljMC41LDAsMC44LDAuNCwwLjgsMXMtMC4zLDEtMC44LDFoLTUuOXYxLjhoNAoJCWMxLjcsMCwyLjQsMC42LDIuNCwyLjJ2Ni4zYzAsMS42LTAuNywyLjItMi40LDIuMmgtNHYyaDUuNWMwLjUsMCwwLjgsMC40LDAuOCwxcy0wLjMsMS0wLjgsMWgtNS41TDUyOC42LDMyOS42TDUyOC42LDMyOS42egoJCSBNNTIzLDMxNC41Yy0wLjYsMC0wLjgsMC4yLTAuOCwwLjd2MS44aDQuMnYtMi41SDUyM3ogTTUyMi4yLDMxOC44djEuOWMwLDAuNSwwLjMsMC43LDAuOCwwLjdoMy4zdi0yLjZINTIyLjJ6IE01MzIuOSwzMTd2LTEuOAoJCWMwLTAuNS0wLjMtMC43LTAuOC0wLjdoLTMuNXYyLjVINTMyLjl6IE01MzIuMSwzMjEuNGMwLjYsMCwwLjgtMC4yLDAuOC0wLjd2LTEuOWgtNC4zdjIuNkg1MzIuMXogTTUzOS41LDMxMC4yCgkJYzAuMS0yLDAuMS00LjEsMC4xLTYuMmMwLTAuNiwwLjUtMSwxLjItMXMxLjIsMC40LDEuMiwxYzAsMiwwLDQuMS0wLjEsNi4yaDMuNWMxLjksMCwyLjgsMC44LDIuOCwyLjhjLTAuMSw3LjMtMC40LDE0LTEuMywxNy43CgkJYy0wLjUsMi0xLjcsMi44LTMuNiwyLjhjLTEuMiwwLTIuMy0wLjEtMy4xLTAuM2MtMC40LTAuMS0wLjctMC41LTAuNy0xLjFjMC0wLjEsMC0wLjIsMC4xLTAuNGMwLjItMC42LDAuNi0xLDEtMQoJCWMwLjEsMCwwLjEsMCwwLjIsMGMwLjYsMC4yLDEuNSwwLjMsMi4yLDAuM2MxLDAsMS42LTAuMywxLjgtMS4yYzAuNy0zLjEsMS4yLTkuOSwxLjItMTYuMmMwLTAuNy0wLjMtMC45LTEtMC45aC0zCgkJYy0wLjIsNC4zLTAuNiw4LjQtMS40LDExLjRjLTEsMy42LTIuNCw2LjYtNC40LDkuMWMtMC4zLDAuNC0wLjcsMC42LTEsMC42cy0wLjYtMC4xLTAuOC0wLjNjLTAuMy0wLjMtMC40LTAuNi0wLjQtMC45CgkJczAuMS0wLjcsMC40LTFjMS45LTIuMSwzLjEtNC45LDQuMS04LjRjMC43LTIuNiwxLjEtNi4yLDEuMy0xMC40aC0zLjFjLTAuNiwwLTAuOS0wLjUtMC45LTEuMnMwLjMtMS4yLDAuOS0xLjJoMi44VjMxMC4yeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTU1Ny40LDMxMS41YzAuNiwxLjUsMS40LDIuOCwyLjEsMy44YzAuMiwwLjIsMC4zLDAuNSwwLjMsMC44YzAsMC4xLDAsMC4xLDAsMC4yYzAuMS0wLjMsMC40LTAuNCwwLjYtMC40CgkJYzAuMSwwLDAuMiwwLDAuMywwYzAuOS0xLjEsMS44LTIuMywyLjYtMy41Yy0xLjEtMS42LTIuMy0zLTMuNC00Yy0wLjItMC4yLTAuNC0wLjUtMC40LTAuOGMwLTAuMiwwLjEtMC41LDAuMy0wLjdzMC41LTAuNCwwLjctMC40CgkJczAuNCwwLjEsMC42LDAuM2MwLjIsMC4yLDAuNCwwLjQsMC42LDAuNmMwLjgtMS4zLDEuNi0yLjcsMi0zLjhjMC4yLTAuNCwwLjUtMC42LDAuOS0wLjZjMC4yLDAsMC40LDAsMC41LDAuMQoJCWMwLjQsMC4yLDAuNiwwLjUsMC42LDAuOWMwLDAuMSwwLDAuMy0wLjEsMC40Yy0wLjYsMS4zLTEuNiwyLjktMi42LDQuNGMwLjUsMC42LDAuOSwxLjIsMS40LDEuOGMwLjctMS4xLDEuMy0yLjEsMS44LTMKCQljMC4yLTAuMywwLjUtMC41LDAuOC0wLjVjMC4yLDAsMC40LDAuMSwwLjYsMC4yYzAuMywwLjIsMC41LDAuNiwwLjUsMC45YzAsMC4yLDAsMC4zLTAuMSwwLjVjLTEuMiwyLjEtMy4xLDQuOC00LjgsNwoJCWMwLjIsMCwwLjQsMCwwLjYtMC4xYzAuOS0wLjEsMS44LTAuMiwyLjctMC40Yy0wLjItMC41LTAuNS0xLTAuNi0xLjNjLTAuMS0wLjItMC4xLTAuMy0wLjEtMC40YzAtMC4zLDAuMi0wLjYsMC42LTAuNwoJCWMwLjEtMC4xLDAuMy0wLjEsMC40LTAuMWMwLjMsMCwwLjYsMC4yLDAuNywwLjVjMC42LDEsMS4zLDIuOCwxLjcsNC4xYzAsMC4xLDAsMC4yLDAsMC4zYzAsMC40LTAuMiwwLjctMC42LDAuOAoJCWMtMC4xLDAtMC4zLDAuMS0wLjQsMC4xYy0wLjQsMC0wLjYtMC4yLTAuOC0wLjZjLTAuMS0wLjMtMC4yLTAuNi0wLjMtMWMtMi4xLDAuNC00LjQsMC44LTYuNCwxaC0wLjFjLTAuNSwwLTAuOC0wLjMtMC45LTAuOQoJCWMwLTAuMSwwLTAuMSwwLTAuMnYtMC4xYzAsMC4xLTAuMSwwLjItMC4yLDAuM2MtMC4yLDAuMi0wLjQsMC4zLTAuNywwLjNzLTAuNi0wLjEtMC44LTAuNWMtMC40LTAuNi0wLjgtMS42LTEuMS0yLjgKCQljMC4yLDEuNiwwLjQsNCwwLjQsNS41djEzLjhjMCwwLjYtMC41LDEtMS4yLDFzLTEuMS0wLjQtMS4xLTFWMzIyYzAtMS41LDAuMi00LjUsMC41LTdjLTAuNiwzLjEtMS43LDYuNy0yLjcsOC44CgkJYy0wLjIsMC41LTAuNiwwLjgtMS4xLDAuOGMtMC4yLDAtMC40LTAuMS0wLjYtMC4yYy0wLjMtMC4yLTAuNS0wLjUtMC41LTAuOHMwLjEtMC42LDAuMy0wLjljMS42LTIuNywzLjEtNy40LDMuOC0xMWgtMi42CgkJYy0wLjYsMC0wLjktMC40LTAuOS0xLjFjMC0wLjYsMC4zLTEsMC45LTFoMi44di01LjhjMC0wLjYsMC40LTEsMS4xLTFjMC43LDAsMS4yLDAuNCwxLjIsMXY1LjhoMi4xYzAuNiwwLDAuOCwwLjQsMC44LDEKCQlzLTAuMywxLjEtMC44LDEuMWgtMS45VjMxMS41eiBNNTcyLjQsMzE1YzAuOS0xLDEuNy0yLjEsMi42LTMuMWMtMS0xLjMtMi0yLjUtMy0zLjRjLTAuMy0wLjMtMC40LTAuNS0wLjQtMC44CgkJYzAtMC4yLDAuMS0wLjUsMC4zLTAuN3MwLjQtMC4zLDAuNi0wLjNzMC41LDAuMSwwLjcsMC4zYzAuMSwwLjEsMC4yLDAuMSwwLjIsMC4yYzAuOC0xLjIsMS41LTIuNCwyLTMuN2MwLjItMC4zLDAuNS0wLjUsMC44LTAuNQoJCWMwLjIsMCwwLjQsMCwwLjYsMC4xYzAuNCwwLjIsMC42LDAuNSwwLjYsMC45YzAsMC4yLDAsMC4zLTAuMSwwLjVjLTAuNywxLjQtMS42LDIuNy0yLjYsNC4xYzAuNSwwLjYsMSwxLjEsMS40LDEuOAoJCWMxLTEuMywxLjgtMi41LDIuNS0zLjVjMC4yLTAuMywwLjQtMC40LDAuNy0wLjRjMC4yLDAsMC41LDAuMSwwLjYsMC4yYzAuMywwLjIsMC41LDAuNSwwLjUsMC44YzAsMC4yLTAuMSwwLjQtMC4yLDAuNgoJCWMtMS40LDItMy44LDQuOS01LjUsNi45YzEuMy0wLjEsMi42LTAuMiwzLjktMC40Yy0wLjItMC40LTAuNC0wLjgtMC42LTEuMmMtMC4xLTAuMi0wLjEtMC4zLTAuMS0wLjVjMC0wLjQsMC4yLTAuNiwwLjYtMC44CgkJYzAuMSwwLDAuMy0wLjEsMC40LTAuMWMwLjQsMCwwLjcsMC4yLDAuOSwwLjZjMC41LDAuOSwxLjQsMywxLjcsNGMwLjEsMC4zLDAuMSwwLjUsMC4xLDAuN2MwLDAuNC0wLjIsMC43LTAuNiwwLjgKCQljLTAuMiwwLTAuMywwLjEtMC40LDAuMWMtMC40LDAtMC43LTAuMi0wLjktMC44Yy0wLjEtMC40LTAuMy0wLjgtMC40LTEuMmMtMS40LDAuMi0yLjksMC40LTQuMywwLjZjMC4xLDAsMC4zLDAsMC40LDAuMQoJCWMwLjksMC4zLDEuOCwwLjgsMi43LDEuNGMwLjMsMC4yLDAuNSwwLjUsMC41LDAuOWMwLDAuMiwwLDAuNC0wLjEsMC42cy0wLjMsMC4zLTAuNSwwLjRoMi41YzAuNiwwLDAuOSwwLjQsMC45LDEuMQoJCXMtMC4zLDEuMS0wLjksMS4xaC04LjFjMC4zLDEsMC42LDEuOSwwLjksMi43YzAuMiwwLjUsMC41LDEsMC43LDEuNmMxLjEtMSwyLTIuMSwyLjctMy4xYzAuMi0wLjMsMC42LTAuNSwwLjktMC41CgkJYzAuMiwwLDAuNSwwLjEsMC43LDAuMmMwLjMsMC4yLDAuNSwwLjUsMC41LDAuOGMwLDAuMi0wLjEsMC41LTAuMywwLjdjLTAuOSwxLjMtMi4xLDIuNS0zLjQsMy43YzAuOCwxLjIsMS43LDIuMSwyLjUsMi42CgkJYzAuMywwLjIsMC41LDAuMywwLjcsMC4zczAuNC0wLjIsMC42LTAuNWMwLjQtMC44LDAuNS0yLDAuNy0zLjJjMC4xLTAuNSwwLjUtMC44LDEtMC44YzAuMSwwLDAuMSwwLDAuMiwwYzAuNiwwLjEsMC45LDAuNSwwLjksMS4xCgkJYzAsMCwwLDAsMCwwLjFjLTAuMSwxLjgtMC42LDMuNi0xLjIsNC43Yy0wLjUsMC44LTEuMiwxLjItMS45LDEuMmMtMC42LDAtMS4yLTAuMi0xLjgtMC42Yy0xLjEtMC43LTIuMy0xLjktMy4zLTMuNQoJCWMtMi40LDEuOC01LjEsMy4yLTcuNiwzLjljLTAuMiwwLjEtMC40LDAuMS0wLjYsMC4xYy0wLjUsMC0wLjgtMC4yLTEtMC43YzAtMC4xLTAuMS0wLjMtMC4xLTAuNGMwLTAuNSwwLjMtMC45LDAuOC0xLjEKCQljMi41LTAuNyw1LTIsNy4zLTMuNmMtMC40LTAuNy0wLjctMS40LTEtMi4yYy0wLjQtMS0wLjgtMi4yLTEuMS0zLjVINTY1YzAsMC41LTAuMSwxLTAuMiwxLjVjMSwxLjQsMi41LDIuNSwzLjYsMy4yCgkJYzAuNCwwLjMsMC42LDAuNiwwLjYsMWMwLDAuMiwwLDAuNC0wLjEsMC42Yy0wLjIsMC40LTAuNSwwLjYtMC44LDAuNmMtMC4yLDAtMC40LTAuMS0wLjYtMC4yYy0wLjgtMC41LTIuMS0xLjctMy0yLjgKCQljLTAuNywyLjktMiw1LjQtMy45LDcuMmMtMC4yLDAuMi0wLjUsMC40LTAuOCwwLjRzLTAuNi0wLjEtMC44LTAuNGMtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjhzMC4xLTAuNywwLjQtMWMyLjMtMiwzLjYtNSwzLjgtOS4yCgkJaC0yLjNjLTAuNiwwLTAuOS0wLjUtMC45LTEuMWMwLTAuNywwLjMtMS4xLDAuOS0xLjFoOS40Yy0wLjctNC41LTAuOS0xMC0wLjktMTYuNGMwLTAuNiwwLjQtMSwxLjEtMWMwLjcsMCwxLjEsMC4zLDEuMSwxCgkJYzAsNi42LDAuMSwxMiwwLjksMTYuNGg1LjRjLTAuMSwwLTAuMi0wLjEtMC4zLTAuMWMtMC45LTAuNi0xLjgtMS0yLjYtMS40Yy0wLjMtMC4xLTAuNi0wLjQtMC42LTAuOGMwLTAuMSwwLTAuMywwLjEtMC40CgkJYzAuMi0wLjMsMC40LTAuNCwwLjYtMC41Yy0wLjgsMC4xLTEuNSwwLjEtMi4yLDAuMmMtMC4xLDAtMC4xLDAtMC4yLDBjLTAuNiwwLTAuNy0wLjMtMC43LTAuOWMwLTAuMSwwLTAuMSwwLTAuMgoJCWMwLTAuNSwwLjMtMC44LDAuNy0wLjhsMCwwVjMxNXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01ODguNiwzMTkuNGMwLTEuNSwwLjEtMy4xLDAuMy00LjdjLTAuOCwxLjQtMS44LDIuOC0yLjgsNGMtMC4zLDAuMy0wLjYsMC41LTEsMC41Yy0wLjMsMC0wLjYtMC4xLTAuOS0wLjQKCQljLTAuMy0wLjMtMC41LTAuNi0wLjUtMWMwLTAuMywwLjEtMC42LDAuNC0wLjljMy4xLTMuMyw1LjctOC4yLDcuMi0xMy4xYzAuMi0wLjYsMC42LTAuOCwxLjItMC44YzAuMiwwLDAuMywwLDAuNSwwLjEKCQljMC42LDAuMSwwLjksMC42LDAuOSwxLjFjMCwwLjEsMCwwLjMtMC4xLDAuNGMtMC44LDIuMi0xLjgsNC40LTIuOCw2LjZ2MjJjMCwwLjYtMC41LDEtMS4zLDFjLTAuNywwLTEuMi0wLjMtMS4yLTFMNTg4LjYsMzE5LjQKCQlMNTg4LjYsMzE5LjR6IE01OTMuOCwzMTMuMWMtMC42LDAtMC45LTAuNS0wLjktMS4yczAuMy0xLjIsMC45LTEuMmgxMi43VjMwNGMwLTAuNiwwLjYtMSwxLjMtMWMwLjgsMCwxLjMsMC4zLDEuMywxdjYuN2gzLjcKCQljMC42LDAsMC45LDAuNSwwLjksMS4ycy0wLjMsMS4yLTAuOSwxLjJINjA5djE3YzAsMi40LTEuMywzLjMtNCwzLjNjLTEuMSwwLTIuNS0wLjEtMy42LTAuNGMtMC41LTAuMS0wLjktMC41LTAuOS0xLjEKCQljMC0wLjEsMC0wLjIsMC0wLjRjMC4yLTAuNywwLjYtMS4xLDEuMS0xLjFjMC4xLDAsMC4xLDAsMC4yLDBjMC45LDAuMiwyLDAuNCwyLjksMC40YzEuMywwLDEuNy0wLjMsMS43LTEuNXYtMTYuMkw1OTMuOCwzMTMuMQoJCUw1OTMuOCwzMTMuMXogTTU5Ni41LDMxNi4yYzAuMywwLDAuNiwwLjIsMC45LDAuNWMxLjYsMS45LDMuMyw0LjMsNC41LDYuNGMwLjEsMC4yLDAuMiwwLjUsMC4yLDAuN2MwLDAuNS0wLjIsMC45LTAuNiwxLjEKCQljLTAuMywwLjItMC41LDAuMy0wLjgsMC4zYy0wLjQsMC0wLjgtMC4yLTEtMC42Yy0xLjEtMi0yLjctNC41LTQuMi02LjJjLTAuMi0wLjMtMC4zLTAuNS0wLjMtMC44YzAtMC40LDAuMi0wLjcsMC42LTEKCQlDNTk2LDMxNi4zLDU5Ni4zLDMxNi4yLDU5Ni41LDMxNi4yeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTYyMi43LDMwNS41YzAsMC4xLDAsMC4zLTAuMSwwLjRjLTAuOSw0LjYtMS42LDkuMy0xLjYsMTNjMCwzLjYsMC40LDcuNiwxLjIsMTFjMC4xLDAuMiwwLjEsMC40LDAuMSwwLjYKCQljMCwwLjYtMC40LDEtMC45LDEuMmMtMC4xLDAtMC4zLDAuMS0wLjUsMC4xYy0wLjYsMC0xLjEtMC4zLTEuNC0xLjFjLTAuOC0zLjUtMS4zLTcuNy0xLjMtMTEuOGMwLTMuOSwwLjYtOC43LDEuNi0xMy41CgkJYzAuMS0wLjgsMC43LTEuMiwxLjUtMS4yYzAuMSwwLDAuMiwwLDAuMywwQzYyMi4zLDMwNC4zLDYyMi43LDMwNC44LDYyMi43LDMwNS41eiBNNjM5LjEsMzE3LjFjMCw1LTAuOCw4LjUtMi4yLDEwLjgKCQljLTEuNCwyLjQtMy45LDQuMy02LjYsNS4yYy0wLjIsMC4xLTAuNCwwLjEtMC42LDAuMWMtMC42LDAtMS0wLjMtMS4yLTAuOWMtMC4xLTAuMy0wLjEtMC41LTAuMS0wLjdjMC0wLjYsMC4zLTEsMC45LTEuMgoJCWMyLjEtMC43LDQuMy0yLjEsNS40LTQuMWMxLjEtMS44LDEuOC00LjgsMS44LTkuNGMwLTAuOSwwLTEuOCwwLTIuN2MtMS43LDAuMS0zLjMsMC4yLTUsMC4yYy0xLjgsMC0zLjksMC01LjEtMC4xCgkJYy0wLjYtMC4xLTEuMS0wLjYtMS4xLTEuM2MwLDAsMCwwLDAtMC4xYzAtMC44LDAuNS0xLjIsMS4yLTEuMmMwLDAsMCwwLDAuMSwwYzEuMSwwLjEsMy4zLDAuMSw0LjksMC4xYzEuOCwwLDMuNSwwLDUuMS0wLjIKCQljLTAuMS0yLjQtMC4yLTQuNy0wLjMtNi41YzAtMC4xLDAtMC4xLDAtMC4yYzAtMC44LDAuNS0xLjIsMS4zLTEuMmgwLjFjMC43LDAsMS4yLDAuNCwxLjMsMS4yYzAuMSwxLjcsMC4zLDQsMC4zLDYuMwoJCWMxLjMtMC4xLDIuNy0wLjQsMy44LTAuNmMwLjEsMCwwLjIsMCwwLjMsMGMwLjYsMCwxLjEsMC40LDEuMSwxLjFjMCwwLjEsMCwwLjIsMCwwLjNjMCwwLjYtMC40LDEuMS0xLDEuMgoJCWMtMS4zLDAuMi0yLjYsMC41LTQuMiwwLjZDNjM5LjEsMzE1LjEsNjM5LjEsMzE2LjEsNjM5LjEsMzE3LjF6Ii8+CjwvZz4KPGcgY2xhc3M9InN0MyI+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNjU1LjMsMzI4LjZjMCwyLjktMi4zLDUuMy01LjEsNS4zcy01LjEtMi40LTUuMS01LjNzMi4zLTUuMyw1LjEtNS4zQzY1MywzMjMuMyw2NTUuMywzMjUuNyw2NTUuMywzMjguNnoKCQkgTTY0Ny4yLDMyOC42YzAsMS43LDEuNCwzLjEsMywzLjFzMy0xLjUsMy0zLjFjMC0xLjctMS40LTMuMS0zLTMuMVM2NDcuMiwzMjYuOSw2NDcuMiwzMjguNnoiLz4KPC9nPgo8ZyBjbGFzcz0ic3QzIj4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0zMjcuMiwzNDkuNWMtMC42LDAtMS0wLjYtMS0xLjNjMC0wLjcsMC40LTEuNCwxLTEuNGgyNy4zYzAuNiwwLDEsMC42LDEsMS40YzAsMC43LTAuNCwxLjMtMSwxLjNoLTExLjh2MjIuNgoJCWMwLDIuNC0xLjIsMy41LTMuOSwzLjVjLTEuNiwwLTMuMy0wLjItNC42LTAuNWMtMC42LTAuMi0wLjktMC43LTAuOS0xLjNjMC0wLjEsMC0wLjMsMC0wLjRjMC4yLTAuNywwLjYtMS4xLDEuMi0xLjEKCQljMC4xLDAsMC4zLDAsMC40LDAuMWMxLDAuMywyLjQsMC41LDMuNSwwLjVjMS4zLDAsMS43LTAuMywxLjctMS41di0yMS44aC0xMi45VjM0OS41eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTM1OS42LDM3MGMtMC42LDAtMC45LTAuNS0wLjktMS4xczAuMy0xLjEsMC45LTEuMWgyNy41YzAuNiwwLDAuOSwwLjUsMC45LDEuMXMtMC4zLDEuMS0wLjksMS4xaC0xMS45djMuNgoJCWMwLDIuMS0wLjksMi44LTQuMiwyLjhjLTEuMSwwLTIuMy0wLjEtMy4zLTAuMmMtMC42LTAuMS0wLjktMC41LTAuOS0xYzAtMC4xLDAtMC4yLDAtMC4zYzAuMS0wLjYsMC41LTAuOSwwLjktMC45CgkJYzAuMSwwLDAuMiwwLDAuMywwYzAuOCwwLjIsMS45LDAuMywyLjcsMC4zYzEuNiwwLDEuOS0wLjEsMS45LTEuMVYzNzBIMzU5LjZ6IE0zODQuOCwzNDcuN2MxLjksMCwyLjgsMC44LDIuOCwyLjZ2Mi4zCgkJYzAsMC42LTAuNSwxLTEuMiwxcy0xLjItMC40LTEuMi0xdi0xLjljMC0wLjctMC4zLTAuOS0xLTAuOWgtMjEuOGMtMC43LDAtMSwwLjItMSwwLjl2MS45YzAsMC42LTAuNCwxLTEuMiwxcy0xLjItMC40LTEuMi0xdi0yLjQKCQljMC0xLjgsMC45LTIuNiwyLjgtMi42aDEwLjF2LTJjMC0wLjYsMC40LTAuOSwxLjItMC45YzAuOCwwLDEuMiwwLjMsMS4yLDAuOXYyaDEwLjVWMzQ3Ljd6IE0zNjYuMSwzNTNjMCwwLjItMC4xLDAuNC0wLjIsMC42CgkJYy0xLDEuNS0yLjUsMy4xLTQsNC4zYy0wLjMsMC4yLTAuNSwwLjMtMC44LDAuM2MtMC40LDAtMC43LTAuMi0wLjktMC41Yy0wLjItMC4yLTAuMi0wLjQtMC4yLTAuNmMwLTAuNCwwLjItMC43LDAuNi0wLjkKCQljMS40LTEsMi43LTIuMywzLjUtMy42YzAuMi0wLjQsMC42LTAuNSwwLjktMC41YzAuMiwwLDAuNCwwLjEsMC42LDAuMkMzNjUuOSwzNTIuMywzNjYuMSwzNTIuNywzNjYuMSwzNTN6IE0zODIuNywzNTguOQoJCWMxLjgsMCwyLjYsMC42LDIuNiwyLjR2Mi4zYzAsMS44LTAuOCwyLjMtMi42LDIuM2gtMTguOGMtMS44LDAtMi42LTAuNi0yLjYtMi4zdi0yLjNjMC0xLjgsMC44LTIuNCwyLjYtMi40SDM4Mi43eiBNMzY4LjYsMzYwLjYKCQloLTQuMWMtMC42LDAtMC44LDAuMi0wLjgsMC44djEuOWMwLDAuNiwwLjMsMC44LDAuOCwwLjhoNC4xVjM2MC42eiBNMzY3LjQsMzUxLjdjMC0wLjYsMC40LTAuOSwxLjEtMC45YzAuOCwwLDEuMiwwLjQsMS4yLDAuOXYyLjcKCQljMCwwLjcsMC4zLDEsMy45LDFjMi45LDAsMy44LTAuMiw0LjItMC43YzAuMy0wLjMsMC40LTAuOCwwLjUtMS40YzAuMS0wLjQsMC40LTAuNywwLjktMC43YzAuMSwwLDAuMiwwLDAuMywwYzAuNiwwLjEsMSwwLjQsMSwwLjkKCQljMCwwLjEsMCwwLjEsMCwwLjJjLTAuMSwwLjctMC4zLDEuNS0wLjUsMS45Yy0wLjcsMS40LTEuOCwxLjctNi41LDEuN2MtNS4zLDAtNS45LTAuNi01LjktMi4zdi0zLjNIMzY3LjR6IE0zNzUuNiwzNjQuMXYtMy40aC00LjgKCQl2My40SDM3NS42eiBNMzc1LjksMzUyLjRjMC4yLDAuMiwwLjMsMC40LDAuMywwLjZzLTAuMSwwLjUtMC4zLDAuN2MtMC4yLDAuMi0wLjUsMC4zLTAuNywwLjNzLTAuNS0wLjEtMC43LTAuMwoJCWMtMC42LTAuNi0xLjctMS40LTIuNS0xLjljLTAuMi0wLjItMC40LTAuNC0wLjQtMC42czAuMS0wLjQsMC4zLTAuNmMwLjItMC4yLDAuNS0wLjMsMC43LTAuM3MwLjUsMC4xLDAuNiwwLjIKCQlDMzc0LjEsMzUxLDM3NS4yLDM1MS43LDM3NS45LDM1Mi40eiBNMzc3LjksMzY0LjFoNC4yYzAuNiwwLDAuOS0wLjIsMC45LTAuOHYtMS45YzAtMC42LTAuMy0wLjgtMC45LTAuOGgtNC4yVjM2NC4xeiBNMzg2LjQsMzU2CgkJYzAuMiwwLjIsMC4zLDAuNSwwLjMsMC43YzAsMC4zLTAuMiwwLjYtMC40LDAuOWMtMC4yLDAuMi0wLjUsMC4yLTAuNywwLjJjLTAuMywwLTAuNi0wLjItMC45LTAuNWMtMC45LTEuMi0yLjQtMi43LTMuNy0zLjkKCQljLTAuMy0wLjItMC40LTAuNS0wLjQtMC44YzAtMC4yLDAuMS0wLjUsMC4zLTAuN2MwLjItMC4yLDAuNS0wLjMsMC44LTAuM3MwLjUsMC4xLDAuNywwLjNDMzgzLjcsMzUzLDM4NS4zLDM1NC42LDM4Ni40LDM1NnoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0zOTMuOSwzNjkuMmMtMC4zLDAuNi0wLjcsMC45LTEuMiwwLjljLTAuMywwLTAuNi0wLjEtMC45LTAuM2MtMC40LTAuMy0wLjYtMC43LTAuNi0xLjFjMC0wLjMsMC4xLTAuNywwLjMtMQoJCWMyLjItNCw0LjQtOC44LDUuNy0xMy4zYy0xLjIsMC4xLTIuNSwwLjEtMy43LDAuMWMtMC40LDAtMC44LDAtMS4yLDBjLTAuNywwLTEuMS0wLjUtMS4xLTEuM3MwLjUtMS4zLDEuMi0xLjNjMC41LDAsMC45LDAsMS40LDAKCQljMS40LDAsMi45LDAsNC4yLTAuMWMwLjUtMS43LDAuOC0zLjMsMS4yLTUuMWMwLjEtMC43LDAuNi0xLjEsMS4yLTEuMWMwLjEsMCwwLjIsMCwwLjMsMGMwLjcsMC4xLDEuMSwwLjUsMS4xLDEuMgoJCWMwLDAuMSwwLDAuMywwLDAuNGMtMC4zLDEuNC0wLjYsMi44LTEsNC4zYzEuNi0wLjEsMy4xLTAuMyw0LjUtMC41YzAuMSwwLDAuMiwwLDAuMywwYzAuNiwwLDEsMC40LDEuMiwxLjFjMCwwLjEsMCwwLjEsMCwwLjIKCQljMCwwLjYtMC40LDEuMS0xLjIsMS4zYy0xLjcsMC4zLTMuNiwwLjQtNS41LDAuNkMzOTguNSwzNTkuNCwzOTYuNCwzNjQuOCwzOTMuOSwzNjkuMnogTTQxOC41LDM3MGMwLjMsMC4zLDAuNSwwLjcsMC41LDEuMQoJCWMwLDAuMy0wLjEsMC43LTAuNCwwLjljLTAuMywwLjMtMC42LDAuNS0wLjksMC41cy0wLjctMC4yLTEtMC40Yy0xLjMtMS4zLTIuOS0yLjctNC4yLTMuNWMwLjEsMC40LDAuMSwwLjgsMC4xLDEuMQoJCWMtMC4yLDMuNy0yLjQsNS40LTYuOCw1LjRjLTQuMSwwLTYuNy0yLjItNi43LTUuNGMwLTMuMiwyLjgtNS42LDYuOC01LjZjMS40LDAsMi43LDAuMiw0LDAuNmMtMC4yLTEuOS0wLjQtNC42LTAuNC02LjgKCQljMC0xLDAuNi0xLjQsMS4zLTEuNGMwLjgsMCwxLjMsMC40LDEuMywxLjRjMCwyLjksMC4xLDUuMywwLjQsNy43QzQxNC42LDM2Ni43LDQxNi45LDM2OC4zLDQxOC41LDM3MHogTTQwNS44LDM2Ni41CgkJYy0yLjYsMC00LjMsMS4zLTQuMywzLjFjMCwxLjksMS42LDIuOSw0LjIsMi45YzIuOCwwLDQuMi0xLjEsNC4yLTMuNWMwLTAuNSwwLTEtMC4xLTEuN0M0MDguNywzNjYuOCw0MDcuMiwzNjYuNSw0MDUuOCwzNjYuNXoKCQkgTTQxOCwzNTQuMWMwLjUsMC4zLDAuNiwwLjgsMC42LDEuMmMwLDAuMy0wLjEsMC41LTAuMiwwLjhjLTAuMywwLjQtMC43LDAuNi0xLjEsMC42Yy0wLjMsMC0wLjYtMC4xLTAuOC0wLjMKCQljLTEuOS0xLjQtNC4zLTIuNy02LjgtMy43Yy0wLjQtMC4yLTAuNi0wLjYtMC42LTFjMC0wLjMsMC4xLTAuNSwwLjItMC44YzAuMy0wLjUsMC43LTAuNywxLjItMC43YzAuMiwwLDAuNCwwLDAuNiwwLjEKCQlDNDEzLjYsMzUxLjQsNDE2LjIsMzUyLjgsNDE4LDM1NC4xeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ0Mi43LDM0OS40YzIuNSwwLDMuNywxLjQsMy43LDQuMXYxNC43YzAsMi43LTEuMiw0LjEtMy43LDQuMWgtMTguNGMtMC44LDAtMS4yLTAuNi0xLjItMS41czAuNC0xLjQsMS4zLTEuNAoJCWgxNy41YzEuMywwLDEuNi0wLjQsMS42LTEuNnYtMTRjMC0xLjItMC4zLTEuNi0xLjYtMS42aC0xN2MtMC44LDAtMS4yLTAuNS0xLjItMS40czAuNC0xLjUsMS4zLTEuNUw0NDIuNywzNDkuNEw0NDIuNywzNDkuNHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00NzcuNCwzNjguOGMwLjgsMCwxLjIsMC44LDEuMiwxLjVjMCwwLjgtMC40LDEuNi0xLjIsMS42SDQ1M2MtMC43LDAtMS4yLTAuNy0xLjItMS42YzAtMC43LDAuNS0xLjUsMS4yLTEuNQoJCUg0NzcuNHogTTQ3NC44LDM1MC4xYzAuNywwLDEuMiwwLjgsMS4yLDEuNWMwLDAuOC0wLjUsMS41LTEuMiwxLjVoLTE5LjFjLTAuNywwLTEuMi0wLjctMS4yLTEuNWMwLTAuNywwLjUtMS41LDEuMi0xLjVINDc0Ljh6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNTA0LjMsMzcwLjdjMC43LDAsMSwwLjUsMSwxLjJzLTAuMywxLjQtMSwxLjRoLTIwLjJjLTAuNiwwLTEuMS0wLjYtMS4xLTEuNHMwLjQtMS4yLDEuMS0xLjJoMTIKCQljMS00LjQsMS43LTguNiwyLTEyYzAtMC4xLDAtMC4yLDAtMC4zYzAtMC42LTAuMi0wLjgtMS0wLjhoLTEwLjZjLTAuNiwwLTEtMC41LTEtMS4yczAuNC0xLjQsMS0xLjRoMTEuN2MwLjksMCwxLjYsMC4zLDIsMC44CgkJYzAuNSwwLjYsMC42LDEuMiwwLjYsMmMwLDAuMiwwLDAuMywwLDAuNWMtMC4zLDMuNy0xLjEsOC4yLTIsMTIuNEg1MDQuM3oiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01MzUuMywzNjguOGMwLjgsMCwxLjIsMC44LDEuMiwxLjVjMCwwLjgtMC40LDEuNi0xLjIsMS42aC0yNC41Yy0wLjcsMC0xLjItMC43LTEuMi0xLjYKCQljMC0wLjcsMC41LTEuNSwxLjItMS41SDUzNS4zeiBNNTMyLjYsMzUwLjFjMC43LDAsMS4yLDAuOCwxLjIsMS41YzAsMC44LTAuNSwxLjUtMS4yLDEuNWgtMTkuMWMtMC43LDAtMS4yLTAuNy0xLjItMS41CgkJYzAtMC43LDAuNS0xLjUsMS4yLTEuNUg1MzIuNnoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01NTguNCwzNTQuN2MtMC4zLDEwLTQuNywxNy4xLTEzLjIsMjAuMmMtMC4yLDAuMS0wLjUsMC4xLTAuNiwwLjFjLTAuNiwwLTEtMC4zLTEuMi0wLjgKCQljLTAuMS0wLjItMC4yLTAuNS0wLjItMC43YzAtMC42LDAuMy0xLjEsMS0xLjNjNy4xLTIuNywxMS4xLTguMiwxMS40LTE3LjVoLTkuOGMtMS42LDIuOC0zLjQsNS01LjQsNi44Yy0wLjMsMC4zLTAuNywwLjQtMSwwLjQKCQljLTAuNCwwLTAuNy0wLjItMC45LTAuNGMtMC4zLTAuMy0wLjQtMC42LTAuNC0xczAuMi0wLjgsMC42LTEuMWMzLTIuNSw0LjgtNS43LDYuNi05LjhjMC40LTAuOSwwLjctMS45LDAuOS0yLjUKCQljMC4yLTAuNywwLjctMSwxLjItMWMwLjEsMCwwLjMsMCwwLjQsMC4xYzAuNywwLjIsMS4xLDAuNywxLjEsMS4yYzAsMC4xLDAsMC4yLDAsMC4zYy0wLjMsMS40LTEuMiwzLjMtMS44LDQuNWgxOAoJCWMwLjgsMCwxLjIsMC41LDEuMiwxLjNzLTAuNCwxLjQtMS4yLDEuNGgtNi43VjM1NC43eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTU2OS42LDM2Mi40Yy0wLjgsMC0xLjMtMC41LTEuMy0xLjVjMC0wLjksMC41LTEuNSwxLjMtMS41aDI0LjZjMC44LDAsMS4zLDAuNiwxLjMsMS41cy0wLjUsMS41LTEuMywxLjUKCQlINTY5LjZ6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNjEwLjcsMzU5LjZjMC41LDAuMywwLjcsMC43LDAuNywxLjJjMCwwLjMtMC4xLDAuNi0wLjMsMC45Yy0wLjMsMC40LTAuNywwLjctMS4yLDAuN2MtMC4zLDAtMC42LTAuMS0wLjktMC4zCgkJYy0xLjktMS40LTQuOC0zLTcuMy00LjFjLTAuNS0wLjItMC43LTAuNi0wLjctMWMwLTAuMywwLjEtMC41LDAuMi0wLjhjMC4zLTAuNSwwLjYtMC44LDEuMS0wLjhjMC4yLDAsMC40LDAsMC43LDAuMQoJCUM2MDUuNCwzNTYuNSw2MDguNSwzNTguMiw2MTAuNywzNTkuNnogTTYyNi44LDM1NC43YzAsMC4yLDAsMC4zLTAuMSwwLjVjLTEuNSw1LjctNC43LDEwLjUtOC45LDEzLjhjLTMuOCwyLjktOS41LDQuOC0xNC43LDUuMgoJCWMwLDAtMC4xLDAtMC4yLDBjLTAuOCwwLTEuNC0wLjUtMS41LTEuNGMwLTAuMSwwLTAuMiwwLTAuMmMwLTAuNywwLjQtMS4yLDEuMy0xLjNjNC43LTAuMywxMC4xLTIsMTMuNS00LjdjMy43LTIuOSw2LjQtNyw3LjctMTIuMQoJCWMwLjItMC43LDAuNi0xLjEsMS4yLTEuMWMwLjIsMCwwLjMsMCwwLjUsMC4xQzYyNi40LDM1My41LDYyNi44LDM1NCw2MjYuOCwzNTQuN3ogTTYxMy43LDM1Mi40YzAsMC4zLTAuMSwwLjUtMC4yLDAuOAoJCWMtMC4zLDAuNS0wLjcsMC44LTEuMywwLjhjLTAuMywwLTAuNS0wLjEtMC43LTAuMmMtMi4yLTEuNS00LjktMy03LjEtMy45Yy0wLjUtMC4yLTAuNy0wLjYtMC43LTEuMWMwLTAuMywwLjEtMC41LDAuMi0wLjgKCQljMC4zLTAuNSwwLjctMC44LDEuMi0wLjhjMC4yLDAsMC41LDAsMC43LDAuMWMyLjIsMC45LDUsMi40LDcuMiwzLjlDNjEzLjQsMzUxLjUsNjEzLjcsMzUyLDYxMy43LDM1Mi40eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTY0OC45LDM1Ny4zYzAtMC45LTAuMy0xLjItMS4yLTEuMmgtMTRjLTAuNiwwLTEtMC42LTEtMS4zczAuNC0xLjIsMS0xLjJoMTQuOWMxLjgsMCwyLjgsMSwyLjgsMy4xdjE0LjIKCQljMCwyLTEsMy4xLTIuOCwzLjFoLTE1LjJjLTAuNywwLTEtMC42LTEtMS4yYzAtMC43LDAuMy0xLjMsMS0xLjNoMTQuMmMwLjksMCwxLjItMC4zLDEuMi0xLjJ2LTUuNGgtMTQuM2MtMC42LDAtMS0wLjYtMS0xLjIKCQljMC0wLjcsMC4zLTEuMywxLTEuM2gxNC4zTDY0OC45LDM1Ny4zTDY0OC45LDM1Ny4zeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTY4NC41LDM1Mi45YzAsMC4yLDAsMC40LTAuMSwwLjZjLTEuMyw1LjctNC40LDExLjItOC45LDE0LjhjLTMuOSwzLjEtOS45LDUuMS0xNC45LDUuM2MwLDAsMCwwLTAuMSwwCgkJYy0wLjgsMC0xLjUtMC41LTEuNS0xLjRjMC0wLjEsMC0wLjEsMC0wLjJjMC0wLjgsMC41LTEuNSwxLjMtMS41YzQuOC0wLjIsMTAuMy0yLjIsMTMuNi00LjhjMy44LTMuMSw2LjYtOCw3LjgtMTMKCQljMC4yLTAuOSwwLjctMS4zLDEuMy0xLjNjMC4yLDAsMC4zLDAsMC41LDAuMUM2ODQuMSwzNTEuNyw2ODQuNSwzNTIuMiw2ODQuNSwzNTIuOXogTTY2OC45LDM1NS40YzAuMywwLjMsMC40LDAuNywwLjQsMS4xCgkJcy0wLjIsMC44LTAuNSwxLjFjLTAuMywwLjMtMC42LDAuNS0xLDAuNXMtMC44LTAuMi0xLjItMC42Yy0xLjgtMi4xLTQuNC00LjUtNi44LTYuMmMtMC40LTAuMy0wLjUtMC43LTAuNS0xLjEKCQljMC0wLjMsMC4xLTAuNywwLjQtMWMwLjMtMC40LDAuNi0wLjUsMS0wLjVzMC43LDAuMSwxLDAuM0M2NjQuMSwzNTAuNiw2NjcsMzUzLDY2OC45LDM1NS40eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTcwNi4yLDM1MWMtMS42LDAuMy0zLDAuNS00LjEsMC42Yy00LjYsMC40LTkuMiwwLjgtMTMuMywxLjJjLTAuMSwwLTAuMSwwLTAuMiwwYy0wLjgsMC0xLjMtMC41LTEuNC0xLjN2LTAuMQoJCWMwLTAuNywwLjUtMS40LDEuMi0xLjRjNy45LTAuNiwxNi41LTEuMiwyNC4zLTEuNmgwLjFjMC45LDAsMS4zLDAuNSwxLjQsMS4zdjAuMWMwLDAuNy0wLjMsMS40LTEuMywxLjVjLTAuNiwwLjEtMS4xLDAuMS0xLjgsMC4zCgkJYy03LDEuMi0xMS45LDYuMS0xMS45LDExLjVjMCwzLjQsMS44LDUuNCw0LjIsNi41YzEuNywwLjgsMy45LDEuMiw2LjEsMS4yYzAuOSwwLDEuNCwwLjYsMS40LDEuNGMwLDAuMSwwLDAuMSwwLDAuMgoJCWMtMC4xLDEtMC42LDEuNS0xLjYsMS41Yy0yLjcsMC01LjMtMC41LTcuMy0xLjZjLTMuMy0xLjctNS42LTQuOC01LjYtOS4xYzAtNS4xLDMuNC05LjcsOS43LTEyLjFMNzA2LjIsMzUxeiBNNzA4LjksMzU1LjkKCQljMC40LDAsMC42LDAuMSwwLjgsMC40YzEsMSwyLjIsMi43LDIuOCwzLjhjMC4xLDAuMiwwLjIsMC40LDAuMiwwLjlzLTAuNSwwLjktMS4xLDAuOWMtMC40LDAtMC42LTAuMi0wLjgtMC42CgkJYy0wLjctMS4yLTEuNy0yLjYtMi42LTMuN2MtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjhDNzA4LDM1Ni40LDcwOC40LDM1NS45LDcwOC45LDM1NS45eiBNNzEyLjUsMzUzLjdjMC40LDAsMC42LDAuMSwwLjksMC40CgkJYzAuOCwwLjgsMi4xLDIuNiwyLjcsMy43YzAuMSwwLjIsMC4yLDAuNSwwLjIsMC44YzAsMC40LTAuNCwwLjktMSwwLjljLTAuNCwwLTAuNi0wLjItMC44LTAuNWMtMC43LTEuMy0xLjYtMi42LTIuNC0zLjYKCQljLTAuMy0wLjMtMC40LTAuNS0wLjQtMC45QzcxMS42LDM1NC4yLDcxMiwzNTMuNyw3MTIuNSwzNTMuN3oiLz4KPC9nPgo8ZyBjbGFzcz0ic3QzIj4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0zMzcuMywzOTMuOGMwLjYsMCwwLjksMC41LDAuOSwxLjFjMCwwLjctMC4zLDEuMi0wLjksMS4yaC0zLjRjMC45LDIuNSwyLjQsNC44LDMuOSw2LjcKCQljMC4yLDAuMiwwLjMsMC42LDAuMywwLjlzLTAuMSwwLjYtMC40LDAuOGMtMC4yLDAuMi0wLjUsMC4zLTAuNywwLjNjLTAuNCwwLTAuNy0wLjItMS0wLjZjLTEtMS40LTEuOS0zLjEtMi43LTUuNgoJCWMwLjMsMiwwLjQsMy43LDAuNCw1LjN2MTMuOGMwLDAuNi0wLjUsMS0xLjIsMXMtMS4yLTAuMy0xLjItMXYtMTIuMmMwLTEuNiwwLjItNC4yLDAuNS02LjJjLTAuOCwzLjQtMi41LDcuNC00LjIsMTAuMQoJCWMtMC4zLDAuNC0wLjcsMC42LTEsMC42Yy0wLjIsMC0wLjUtMC4xLTAuNy0wLjNjLTAuMy0wLjMtMC40LTAuNi0wLjQtMWMwLTAuMywwLjEtMC42LDAuMy0wLjhjMi4zLTMuMiw0LjItNy41LDUuMi0xMS44aC0zLjgKCQljLTAuNiwwLTAuOS0wLjUtMC45LTEuMnMwLjMtMS4xLDAuOS0xLjFoNC4ydi01LjdjMC0wLjYsMC40LTEsMS4yLTFjMC43LDAsMS4yLDAuMywxLjIsMXY1LjdMMzM3LjMsMzkzLjhMMzM3LjMsMzkzLjh6CgkJIE0zMzkuMSwzOTEuM2MwLTIuMiwwLjktMi45LDIuOC0yLjlIMzUyYzEuOCwwLDIuNywwLjgsMi43LDIuOXYyMy4zYzAsMi4xLTAuOCwyLjktMi43LDIuOWgtMTAuMWMtMS45LDAtMi44LTAuOC0yLjgtMi45VjM5MS4zegoJCSBNMzUyLjEsMzkxLjdjMC0wLjctMC4zLTAuOS0wLjktMC45aC04LjhjLTAuNiwwLTAuOSwwLjItMC45LDAuOXY1LjNoMTAuNkwzNTIuMSwzOTEuN0wzNTIuMSwzOTEuN3ogTTM0MS42LDM5OS4zdjYuMmgxMC42di02LjIKCQlIMzQxLjZ6IE0zNDEuNiw0MDcuOXY2LjNjMCwwLjcsMC4zLDAuOSwwLjksMC45aDguOGMwLjYsMCwwLjktMC4yLDAuOS0wLjl2LTYuM0gzNDEuNnoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik0zNzkuNCwzOTZjMiwwLDIuOSwwLjgsMi45LDIuNmMwLDAuMywwLDAuNS0wLjEsMC44Yy0wLjYsNC40LTEuNywxMC4yLTMuMSwxNS40aDguMWMwLjYsMCwwLjksMC41LDAuOSwxLjIKCQlzLTAuMywxLjMtMC45LDEuM2gtMjhjLTAuNiwwLTAuOS0wLjUtMC45LTEuM2MwLTAuNywwLjMtMS4yLDAuOS0xLjJoMTcuMmMwLjUtMS44LDAuOS0zLjUsMS4zLTUuM2gtMTIuMmMtMS41LDAtMi40LTAuOS0yLjQtMi4xCgkJYzAtMC40LDAuMS0wLjksMC4zLTEuNWMxLjYtMy44LDMuMi05LjYsNC4yLTE1LjFIMzYwYy0wLjYsMC0wLjktMC41LTAuOS0xLjJzMC40LTEuMiwwLjktMS4yaDI2LjdjMC42LDAsMC45LDAuNSwwLjksMS4yCgkJcy0wLjMsMS4yLTAuOSwxLjJoLTE2LjNjLTAuMywxLjctMC43LDMuNC0xLjEsNS4xaDEwLjFWMzk2eiBNMzY4LjcsMzk4LjRjLTAuNywyLjktMS42LDUuNi0yLjQsNy42Yy0wLjEsMC4zLTAuMiwwLjUtMC4yLDAuNgoJCWMwLDAuNCwwLjMsMC41LDAuOSwwLjVoMTEuM2MwLjYtMi44LDEtNS41LDEuMy03LjhjMC0wLjEsMC0wLjIsMC0wLjNjMC0wLjUtMC4zLTAuOC0xLTAuOGgtOS45VjM5OC40eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTM5MS41LDM5MS41Yy0wLjYsMC0wLjktMC41LTAuOS0xLjJzMC4zLTEuMiwwLjktMS4yaDguOGMwLjYsMCwwLjksMC41LDAuOSwxLjJzLTAuMywxLjItMC45LDEuMmgtMy4ydjcuNwoJCWgyLjdjMC42LDAsMC45LDAuNCwwLjksMS4xcy0wLjMsMS4xLTAuOSwxLjFoLTIuN3Y4LjJjMC45LTAuNCwxLjctMC44LDIuNS0xLjFjMC4yLTAuMSwwLjQtMC4xLDAuNi0wLjFjMC40LDAsMC43LDAuMiwwLjksMC43CgkJYzAuMSwwLjIsMC4yLDAuNCwwLjIsMC42YzAsMC40LTAuMiwwLjgtMC42LDFjLTIuNywxLjMtNiwyLjYtOC43LDMuNWMtMC4yLDAtMC4zLDAuMS0wLjUsMC4xYy0wLjUsMC0wLjktMC4zLTEuMS0wLjkKCQljMC0wLjItMC4xLTAuNC0wLjEtMC41YzAtMC41LDAuMy0xLDAuOC0xLjFjMS4yLTAuMywyLjQtMC44LDMuNy0xLjJ2LTkuMmgtM2MtMC42LDAtMC45LTAuNS0wLjktMS4xYzAtMC43LDAuMy0xLjEsMC45LTEuMWgzdi03LjcKCQlIMzkxLjV6IE00MDQuOSw0MDQuN2MtMS44LDAtMi44LTAuNy0yLjgtMi44di0xMC42YzAtMi4xLDAuOC0yLjgsMi44LTIuOGgxMmMxLjgsMCwyLjgsMC43LDIuOCwyLjh2MTAuNmMwLDItMC45LDIuOC0yLjgsMi44aC01CgkJdjMuNWg3LjFjMC42LDAsMC44LDAuNCwwLjgsMS4xcy0wLjMsMS4yLTAuOCwxLjJoLTcuMXY0LjVoOC4zYzAuNiwwLDAuOSwwLjUsMC45LDEuMXMtMC4zLDEuMi0wLjksMS4yaC0xOS44CgkJYy0wLjYsMC0wLjktMC41LTAuOS0xLjJzMC4zLTEuMSwwLjktMS4xaDkuMXYtNC41aC02LjdjLTAuNiwwLTAuOS0wLjUtMC45LTEuMmMwLTAuNiwwLjMtMS4xLDAuOS0xLjFoNi43di0zLjVINDA0Ljl6CgkJIE00MDUuNCwzOTAuOGMtMC42LDAtMC45LDAuMi0wLjksMC45djMuOWg1LjF2LTQuOEg0MDUuNHogTTQwNC41LDM5Ny43djMuOWMwLDAuNiwwLjMsMC45LDAuOSwwLjloNC4xdi00LjhINDA0LjV6IE00MTEuOSwzOTUuNQoJCWg1LjV2LTMuOWMwLTAuNi0wLjMtMC45LTAuOS0wLjlINDEydjQuOEg0MTEuOXogTTQxMS45LDQwMi40aDQuNWMwLjYsMCwwLjktMC4yLDAuOS0wLjl2LTMuOWgtNS41djQuOEg0MTEuOXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00MjcuMSw0MDkuOGMwLDAuMSwwLDAuMSwwLDAuMmMtMC4yLDIuNi0wLjcsNS40LTEuNiw3LjZjLTAuMiwwLjUtMC42LDAuOC0xLjEsMC44Yy0wLjIsMC0wLjQsMC0wLjYtMC4xCgkJYy0wLjUtMC4yLTAuNy0wLjYtMC43LTEuMWMwLTAuMiwwLTAuMywwLjEtMC41YzAuNy0xLjksMS4zLTQuNCwxLjYtN2MwLjItMi42LDAuMy02LjEsMC4zLTExLjJjMC0wLjIsMC0wLjQsMC0wLjUKCQljLTAuMiwwLjEtMC41LDAuMi0wLjcsMC4yYy0wLjMsMC0wLjYtMC4xLTAuNy0wLjJjLTAuMy0wLjItMC40LTAuNS0wLjQtMC44czAuMS0wLjUsMC4zLTAuOGMxLjgtMi4xLDMuMy01LDQuMi04LjIKCQljMC4yLTAuNSwwLjUtMC44LDEtMC44YzAuMSwwLDAuMywwLDAuNSwwLjFjMC42LDAuMSwwLjksMC40LDAuOSwwLjhjMCwwLjEsMCwwLjItMC4xLDAuNGMtMC4xLDAuMy0wLjIsMC42LTAuMywwLjloMy41CgkJYzEuMiwwLDEuOSwwLjcsMS45LDEuN2MwLDAuMiwwLDAuNS0wLjEsMC44Yy0wLjQsMS4xLTEsMi40LTEuNywzLjZoMS4zYzEuNywwLDIuNCwwLjgsMi40LDIuN3YxNy4yYzAsMi0xLjEsMi43LTMuMiwyLjcKCQljLTAuOSwwLTEuOS0wLjEtMi41LTAuM2MtMC41LTAuMS0wLjctMC41LTAuNy0xYzAtMC4xLDAtMC4yLDAtMC4zYzAuMS0wLjYsMC41LTAuOSwwLjktMC45YzAuMSwwLDAuMiwwLDAuMywwCgkJYzAuNCwwLjEsMS4yLDAuMiwxLjcsMC4yYzEuMiwwLDEuNC0wLjEsMS40LTAuOVY0MTBoLTcuOVY0MDkuOHogTTQyOC45LDM5MS42Yy0wLjYsMS40LTEuMywyLjctMi4xLDRjMC4yLDAsMC41LTAuMSwwLjctMC4xaDMuNQoJCWMwLjctMS4yLDEuMi0yLjQsMS41LTMuM2MwLTAuMSwwLjEtMC4yLDAuMS0wLjNjMC0wLjItMC4yLTAuNC0wLjUtMC40TDQyOC45LDM5MS42TDQyOC45LDM5MS42eiBNNDI3LjMsNDAzLjdjMCwxLjQsMCwyLjctMC4xLDQKCQloMi44di00SDQyNy4zeiBNNDI4LjIsMzk3LjdjLTAuNiwwLTAuOSwwLjEtMC45LDAuOGMwLDEuMSwwLDIuMSwwLDMuMWgyLjd2LTMuOUg0MjguMnogTTQzMi4xLDQwMS42aDIuOHYtMy4xCgkJYzAtMC42LTAuMy0wLjgtMC45LTAuOGgtMS45VjQwMS42eiBNNDM0LjksNDAzLjdoLTIuOHY0aDIuOFY0MDMuN3ogTTQzOC45LDM5MC45Yy0wLjYsMC0wLjktMC41LTAuOS0xLjFjMC0wLjcsMC40LTEuMSwwLjktMS4xCgkJaDEwLjNjMS45LDAsMi43LDEsMi43LDIuN3MtMC4yLDMuMy0wLjYsNC43Yy0wLjQsMS40LTEuMiwyLjMtMy40LDIuM2MtMC45LDAtMS44LTAuMS0yLjQtMC4yYy0wLjUtMC4xLTAuOC0wLjUtMC44LTEKCQljMC0wLjEsMC0wLjMsMC4xLTAuNGMwLjEtMC42LDAuNS0wLjksMC44LTAuOWMwLjEsMCwwLjEsMCwwLjIsMGMwLjYsMC4xLDEuMiwwLjIsMS43LDAuMmMxLDAsMS40LTAuMywxLjYtMS4xCgkJYzAuMi0wLjgsMC40LTIsMC40LTMuMWMwLTAuNy0wLjItMC44LTAuOS0wLjhoLTMuN2MtMC40LDMuNS0yLjMsNi42LTUuMiw4LjNjLTAuMiwwLjEtMC41LDAuMi0wLjcsMC4yYy0wLjQsMC0wLjctMC4yLTEtMC42CgkJYy0wLjEtMC4yLTAuMi0wLjUtMC4yLTAuN2MwLTAuNCwwLjItMC43LDAuNi0xYzIuNS0xLjUsMy44LTMuNCw0LjEtNi4yaC0zLjZWMzkwLjl6IE00NDEuMiw0MDQuOWMtMC4zLDAuOC0wLjcsMS42LTEsMi4yCgkJYy0wLjIsMC40LTAuNiwwLjYtMSwwLjZjLTAuMiwwLTAuNCwwLTAuNi0wLjFjLTAuNC0wLjItMC42LTAuNi0wLjYtMWMwLTAuMiwwLjEtMC40LDAuMi0wLjZjMC45LTEuNSwxLjctMy41LDItNS4yCgkJYzAuMS0wLjYsMC41LTAuOCwxLTAuOGMwLjEsMCwwLjIsMCwwLjMsMGMwLjYsMC4xLDAuOSwwLjUsMC45LDFjMCwwLjEsMCwwLjIsMCwwLjNjLTAuMSwwLjQtMC4yLDAuOC0wLjQsMS4zaDIuN3YtMi41CgkJYzAtMC43LDAuNS0xLDEuMi0xczEuMiwwLjMsMS4yLDF2Mi41aDQuNmMwLjYsMCwwLjksMC40LDAuOSwxLjFzLTAuMywxLjItMC45LDEuMkg0NDd2My45aDUuNWMwLjYsMCwwLjksMC40LDAuOSwxLjEKCQlzLTAuMywxLjItMC45LDEuMkg0NDd2Ni41YzAsMC42LTAuNSwxLTEuMiwxcy0xLjItMC40LTEuMi0xdi02LjVoLTUuOGMtMC42LDAtMC45LTAuNS0wLjktMS4yczAuNC0xLjEsMC45LTEuMWg1Ljh2LTMuOUg0NDEuMnoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00NjIuOSw0MDFjMi41LTEuOSw0LjMtMi44LDYuNC0yLjhjMi4zLDAsNC4xLDEsNC41LDRjMi45LTEuMSw1LjctMiw4LTIuN2MwLjIsMCwwLjQtMC4xLDAuNi0wLjEKCQljMC42LDAsMSwwLjMsMS4yLDAuOWMwLDAuMiwwLjEsMC40LDAuMSwwLjVjMCwwLjYtMC4zLDEuMS0xLDEuMmMtMi40LDAuNi01LjQsMS41LTguNSwyLjdjMC4xLDEuMiwwLjEsMi40LDAuMSwzLjYKCQljMCwwLjYsMCwxLjMsMCwxLjljMCwwLjgtMC42LDEuMy0xLjMsMS4zYy0wLjcsMC0xLjItMC40LTEuMi0xLjNzMC0yLDAtMy4xYzAtMC41LDAtMS4xLDAtMS42Yy00LjUsMS44LTYuNSwzLjktNi41LDUuOQoJCXMyLjEsMyw2LjcsM2MzLjEsMCw2LjQtMC4zLDguOC0wLjdjMC4yLDAsMC4zLDAsMC41LDBjMC42LDAsMS4xLDAuMywxLjIsMWMwLDAuMSwwLDAuMiwwLDAuM2MwLDAuNy0wLjUsMS4zLTEuMiwxLjQKCQljLTIuNCwwLjQtNS42LDAuNy05LDAuN2MtNi4xLDAtOS41LTEuOC05LjUtNS42YzAtMy4yLDMtNi40LDktOC42Yy0wLjItMi4xLTEuMi0yLjYtMi42LTIuNmMtMi44LDAtNi4zLDIuMi0xMC4yLDYuNAoJCWMtMC4zLDAuMy0wLjcsMC41LTEsMC41cy0wLjYtMC4xLTAuOS0wLjRzLTAuNC0wLjYtMC40LTFzMC4yLTAuOCwwLjUtMS4xYzIuOC0yLjcsNS42LTYuMiw3LjctOS43Yy0wLjUsMC0xLDAtMS41LDAKCQljLTEuNiwwLTMuNSwwLTQuOS0wLjFjLTAuNywwLTEuMS0wLjYtMS4xLTEuMnYtMC4xYzAuMS0wLjcsMC41LTEuMiwxLjItMS4yaDAuMWMxLjUsMC4xLDMuNiwwLjIsNS43LDAuMmMwLjYsMCwxLjIsMCwxLjgsMAoJCWMwLjYtMS4yLDEuMi0yLjUsMS42LTMuN2MwLjItMC43LDAuNy0xLDEuMi0xYzAuMiwwLDAuMywwLDAuNSwwLjFjMC42LDAuMSwxLDAuNSwxLDFjMCwwLjIsMCwwLjQtMC4xLDAuNmMtMC40LDEtMC44LDEuOS0xLjMsMi45CgkJYzIuOC0wLjEsNi42LTAuNSwxMC4yLTFjMC4xLDAsMC4yLDAsMC4zLDBjMC42LDAsMS4xLDAuNCwxLjIsMS4xYzAsMC4xLDAsMC4xLDAsMC4yYzAsMC42LTAuNCwxLjEtMS4xLDEuMgoJCWMtNC4xLDAuNi04LjEsMS0xMS44LDEuMWMtMS4zLDIuMi0yLjgsNC4zLTQuNCw1LjhMNDYyLjksNDAxeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ5Myw0MDFjMCwwLjMtMC4xLDAuNi0wLjMsMC44Yy0wLjMsMC4zLTAuNiwwLjUtMSwwLjVjLTAuMywwLTAuNi0wLjEtMC45LTAuNGMtMS4yLTEuMS0yLjktMi42LTQuMi0zLjQKCQljLTAuMy0wLjItMC41LTAuNS0wLjUtMC45YzAtMC4zLDAuMS0wLjUsMC4zLTAuOGMwLjMtMC4zLDAuNi0wLjUsMS0wLjVjMC4yLDAsMC41LDAuMSwwLjYsMC4yYzEuNSwwLjgsMy4xLDIuMyw0LjQsMy41CgkJQzQ5Mi44LDQwMC4yLDQ5Myw0MDAuNiw0OTMsNDAxeiBNNDkzLjEsNDA3LjRjMCwwLjIsMCwwLjMtMC4xLDAuNWMtMSwyLjktMi44LDYuOC00LjUsOS41Yy0wLjIsMC40LTAuNiwwLjYtMSwwLjYKCQljLTAuMywwLTAuNi0wLjEtMC44LTAuM2MtMC40LTAuMy0wLjYtMC42LTAuNi0xYzAtMC4yLDAuMS0wLjUsMC4yLTAuN2MxLjctMi41LDMuNC02LDQuNC05YzAuMi0wLjUsMC42LTAuOCwxLjEtMC44CgkJYzAuMiwwLDAuNCwwLDAuNSwwLjFDNDkyLjksNDA2LjUsNDkzLjEsNDA2LjksNDkzLjEsNDA3LjR6IE00OTQsMzkyLjdjMCwwLjMtMC4xLDAuNi0wLjMsMC44Yy0wLjMsMC4zLTAuNiwwLjQtMC45LDAuNAoJCWMtMC40LDAtMC43LTAuMi0xLTAuNWMtMS0xLjEtMi42LTIuNS0zLjktMy40Yy0wLjMtMC4yLTAuNC0wLjYtMC40LTAuOXMwLjEtMC42LDAuMy0wLjhjMC4zLTAuMywwLjYtMC41LDEtMC41CgkJYzAuMywwLDAuNSwwLjEsMC43LDAuMmMxLjIsMC44LDMsMi40LDQuMSwzLjZDNDkzLjgsMzkyLDQ5NCwzOTIuNCw0OTQsMzkyLjd6IE00OTUuMyw0MDUuOWMtMC42LDAtMC45LTAuNS0wLjktMS4xCgkJYzAtMC43LDAuMy0xLjIsMC45LTEuMmg4LjJ2LTMuMWMwLTAuNiwwLjUtMC45LDEuMi0wLjlzMS4yLDAuMywxLjIsMC45djMuMWg5LjNjMC42LDAsMC45LDAuNSwwLjksMS4xYzAsMC43LTAuMywxLjEtMC45LDEuMWgtOC41CgkJYzIuMiwzLjMsNS43LDYsOS4yLDcuN2MwLjQsMC4yLDAuNiwwLjYsMC42LDEuMWMwLDAuMi0wLjEsMC41LTAuMiwwLjdjLTAuMywwLjUtMC42LDAuOC0xLjEsMC44Yy0wLjIsMC0wLjQtMC4xLTAuNi0wLjIKCQljLTMuNS0xLjctNi45LTQuOS05LjItOC40YzAuMiwxLjQsMC40LDIuOSwwLjQsNC40djUuOGMwLDAuNi0wLjUsMC45LTEuMiwwLjlzLTEuMi0wLjMtMS4yLTAuOXYtNS44YzAtMS41LDAuMi0zLDAuNC00LjQKCQljLTIuMSwzLjMtNS4zLDYuNS04LjksOC40Yy0wLjIsMC4xLTAuNSwwLjItMC42LDAuMmMtMC41LDAtMC44LTAuMi0xLjEtMC43Yy0wLjEtMC4yLTAuMi0wLjUtMC4yLTAuN2MwLTAuNCwwLjItMC44LDAuNi0xCgkJYzMuMS0xLjYsNi44LTQuNCw4LjktNy44SDQ5NS4zeiBNNDk4LjEsMzkxYy0wLjYsMC0wLjksMC4yLTAuOSwwLjh2Mi41YzAsMC42LTAuNSwwLjktMS4yLDAuOWMtMC42LDAtMS4xLTAuMy0xLjEtMC45di0yLjkKCQljMC0yLDAuOC0yLjcsMi43LTIuN2gxNS4yYzEuOCwwLDIuNywwLjcsMi43LDIuN3YyLjJjMCwwLjYtMC41LDAuOS0xLjIsMC45cy0xLjItMC4zLTEuMi0wLjl2LTEuN2MwLTAuNy0wLjMtMC44LTAuOS0wLjhoLTMuNHY1LjgKCQljMCwwLjgsMC4xLDAuOSwyLjQsMC45YzEuOCwwLDItMC4xLDIuMi0wLjVjMC4yLTAuMywwLjMtMC43LDAuMy0xLjFjMC0wLjUsMC40LTAuOCwxLTAuOGMwLjEsMCwwLjEsMCwwLjIsMGMwLjcsMC4xLDEsMC41LDEsMQoJCWMwLDAsMCwwLDAsMC4xYy0wLjEsMS0wLjMsMS44LTAuNiwyLjRjLTAuNSwwLjgtMS42LDEuMi00LjIsMS4yYy0zLjgsMC00LjUtMC41LTQuNS0yLjZWMzkxaC0zYy0wLjEsNS4zLTIuMyw4LjUtNi45LDEwLjQKCQljLTAuMiwwLjEtMC40LDAuMS0wLjUsMC4xYy0wLjQsMC0wLjgtMC4yLTEtMC43Yy0wLjEtMC4yLTAuMS0wLjQtMC4xLTAuNmMwLTAuNCwwLjItMC44LDAuNi0xYzMuNy0xLjUsNS41LTMuNyw1LjYtOC4yTDQ5OC4xLDM5MQoJCUw0OTguMSwzOTF6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNTI0LjIsNDE0LjNjLTIuOSwwLTUuMS0yLjQtNS4xLTYuOGMwLTQuMiwyLTcuOSw1LjUtMTAuNmMtMC40LTEuOS0wLjgtMy45LTEtNS44YzAtMC4xLDAtMC4yLDAtMC4yCgkJYzAtMC43LDAuNC0xLjIsMS0xLjNjMC4xLDAsMC4yLDAsMC4zLDBjMC42LDAsMSwwLjQsMS4xLDEuMWMwLjIsMS42LDAuNSwzLjMsMC43LDQuOWMyLjItMS4yLDQuOC0xLjksNy45LTEuOQoJCWMwLjMtMS40LDAuNS0yLjgsMC42LTQuMWMwLjEtMC44LDAuNS0xLjIsMS4yLTEuMmMwLjEsMCwwLjIsMCwwLjMsMGMwLjcsMC4xLDEuMSwwLjYsMS4xLDEuMmMwLDAuMSwwLDAuMiwwLDAuMwoJCWMtMC4yLDEuMi0wLjQsMi41LTAuNiwzLjljMS44LDAuMywzLjMsMC45LDQuNiwxLjhjMi44LDEuOSw0LjUsNC45LDQuNSw5YzAsNi43LTQuOCwxMS4xLTEyLjQsMTIuMWMtMC4xLDAtMC4yLDAtMC4zLDAKCQljLTAuNywwLTEuMi0wLjQtMS4zLTEuMWMwLTAuMSwwLTAuMiwwLTAuM2MwLTAuNiwwLjQtMS4yLDEuMi0xLjNjNi4xLTAuOCwxMC4xLTQuMywxMC4xLTkuNGMwLTMtMS4zLTUuNS0zLjMtNwoJCWMtMS4xLTAuOC0yLjMtMS4yLTMuNy0xLjVjLTAuNCwxLjctMC44LDMuMi0xLjMsNC43Yy0xLDIuOC0yLjMsNS43LTMuNiw3LjljMC4zLDAuNSwwLjYsMC45LDAuOSwxLjRjMC4yLDAuMywwLjMsMC42LDAuMywwLjkKCQlzLTAuMSwwLjctMC41LDFjLTAuMiwwLjItMC42LDAuMy0wLjksMC4zcy0wLjYtMC4xLTAuOC0wLjRjLTAuMy0wLjMtMC41LTAuNi0wLjctMUM1MjguMiw0MTMuNiw1MjYuMSw0MTQuMyw1MjQuMiw0MTQuM3oKCQkgTTUyNS4zLDM5OS42Yy0yLjMsMi0zLjYsNC45LTMuNiw3LjdjMCwyLjYsMS4yLDQuMywyLjcsNC4zYzEuMiwwLDIuOC0wLjYsNC40LTIuOEM1MjcuNCw0MDYuMiw1MjYuMSw0MDMsNTI1LjMsMzk5LjZ6CgkJIE01MzMuMSw0MDAuMWMwLjQtMS4zLDAuOC0yLjYsMS4xLTQuMWMtMi40LDAtNC44LDAuNy02LjgsMS45YzAuNywzLjEsMS44LDYuMSwzLDguN0M1MzEuMyw0MDQuOCw1MzIuMyw0MDIuNCw1MzMuMSw0MDAuMXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01NTkuMiw0MDEuN2MyLjUtMS4yLDQuOS0xLjgsNy4yLTEuOGM1LjgsMCw5LjQsMy4yLDkuNCw3LjhjMCw1LjctNSw5LjMtMTIuOSw5LjNjLTQuOCwwLTcuOS0yLjEtNy45LTUuMgoJCWMwLTIuNiwyLjEtNC42LDUuMy00LjZjMy41LDAsNi40LDIuMiw2LjksNi43YzMuMy0wLjgsNS44LTIuOSw1LjgtNi4xcy0yLjUtNS41LTcuMS01LjVjLTQuMywwLTguMiwxLjUtMTMuNiw0LjkKCQljLTAuMywwLjItMC42LDAuMi0wLjksMC4yYy0wLjUsMC0wLjktMC4yLTEuMi0wLjZjLTAuMi0wLjItMC4yLTAuNS0wLjItMC43YzAtMC41LDAuMy0xLDAuNy0xLjNjNS4zLTMuNCwxMi41LTguOSwxNi42LTEyLjcKCQljLTMuNSwwLjMtOC41LDAuNS0xMi42LDAuNWMtMC43LDAtMS4yLTAuNS0xLjItMS4zczAuNC0xLjQsMS4xLTEuNGM0LjQsMCw5LjktMC4yLDE0LjItMC41YzAuMSwwLDAuMiwwLDAuMywwCgkJYzAuNywwLDEuMywwLjMsMS42LDAuOGMwLjIsMC4zLDAuMywwLjYsMC4zLDFjMCwwLjUtMC4yLDAuOS0wLjYsMS40Yy0yLjgsMi43LTUuOCw1LjEtOC41LDdjLTAuOSwwLjYtMiwxLjQtMi45LDJMNTU5LjIsNDAxLjd6CgkJIE01NjAuMiw0MDkuNWMtMS43LDAtMi43LDAuOS0yLjcsMi4yYzAsMS42LDEuOSwyLjgsNC44LDIuOWMwLjgsMCwxLjYsMCwyLjQtMC4xQzU2NC41LDQxMS4yLDU2Mi40LDQwOS41LDU2MC4yLDQwOS41eiIvPgo8L2c+CjxnIGNsYXNzPSJzdDMiPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTU5Niw0MTNjMCwyLjktMi4zLDUuMy01LjEsNS4zcy01LjEtMi40LTUuMS01LjNzMi4zLTUuMyw1LjEtNS4zUzU5Niw0MTAuMSw1OTYsNDEzeiBNNTg3LjksNDEzCgkJYzAsMS43LDEuNCwzLjEsMywzLjFzMy0xLjUsMy0zLjFzLTEuNC0zLjEtMy0zLjFDNTg5LjMsNDA5LjksNTg3LjksNDExLjMsNTg3LjksNDEzeiIvPgo8L2c+CjxnIGNsYXNzPSJzdDMiPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQxOC4zLDUzOS41Yy0wLjYsMC0xLTAuNi0xLTEuM3MwLjQtMS4zLDEtMS4zaDYuNGMyLDAsMi45LDAuOCwzLDIuOGMwLjEsNC41LDEuMiw4LjUsMy40LDEyLjYKCQljMi4xLDQsNS44LDgsOS40LDEwLjNjMC40LDAuMywwLjYsMC43LDAuNiwxLjJjMCwwLjMtMC4xLDAuNi0wLjMsMC45Yy0wLjMsMC40LTAuNywwLjctMS4yLDAuN2MtMC4zLDAtMC42LTAuMS0wLjktMC4zCgkJYy01LjgtNC4xLTEwLjYtMTAuMy0xMi4zLTE4LjdjLTEuOSw4LjQtNi43LDE0LjgtMTIuNSwxOC43Yy0wLjQsMC4yLTAuNywwLjMtMSwwLjNjLTAuNSwwLTAuOS0wLjItMS4yLTAuNwoJCWMtMC4yLTAuMy0wLjMtMC42LTAuMy0wLjljMC0wLjQsMC4zLTAuOSwwLjctMS4yYzMuNy0yLjQsNy4yLTYuMSw5LjQtMTAuM2MyLjEtNC4xLDMuMy04LjMsMy40LTExLjljMC0wLjgtMC4zLTAuOS0xLTAuOQoJCUw0MTguMyw1MzkuNUw0MTguMyw1MzkuNXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00NDguOCw1NTZjMC0xLjEsMC4xLTIuMywwLjItMy40Yy0xLjEsMS4xLTIuMywyLjMtMy41LDMuMmMtMC4zLDAuMi0wLjYsMC4zLTAuOCwwLjNjLTAuNCwwLTAuNy0wLjItMC45LTAuNQoJCWMtMC4yLTAuMy0wLjMtMC42LTAuMy0wLjhjMC0wLjQsMC4yLTAuNywwLjYtMC45YzMuOC0yLjgsNy02LjMsOC45LTkuOWMwLjEtMC4xLDAuMS0wLjMsMC4xLTAuNGMwLTAuMy0wLjItMC40LTAuNS0wLjRoLTcuNAoJCWMtMC42LDAtMC45LTAuNS0wLjktMS4yczAuMy0xLjEsMC45LTEuMWgzLjd2LTQuN2MwLTAuNiwwLjUtMC45LDEuMi0wLjlzMS4yLDAuMywxLjIsMC45djQuN2gyLjRjMS4zLDAsMi4xLDAuOCwyLjEsMS45CgkJYzAsMC40LTAuMSwwLjgtMC4zLDEuMmMtMC44LDEuOS0yLjEsMy44LTMuNSw1LjZjMS40LDEuNywyLjksMyw0LjMsNGMwLjQsMC4yLDAuNSwwLjYsMC41LDFjMCwwLjItMC4xLDAuNS0wLjIsMC43CgkJYy0wLjMsMC40LTAuNiwwLjYtMSwwLjZjLTAuMiwwLTAuNS0wLjEtMC43LTAuM2MtMS4xLTAuOS0yLjUtMi4yLTMuNi0zLjdjMC4xLDEuMSwwLjEsMi4zLDAuMSwzLjV2MTAuM2MwLDAuNS0wLjUsMC45LTEuMiwwLjkKCQljLTAuNiwwLTEuMi0wLjMtMS4yLTAuOVY1NTZINDQ4Ljh6IE00NTcsNTQ3LjljLTAuNiwwLTEtMC41LTEtMS4yczAuNC0xLjIsMS0xLjJoNS40di05LjNjMC0wLjcsMC41LTEsMS4zLTFzMS4zLDAuNCwxLjMsMXY5LjMKCQloNi42YzAuNiwwLDAuOSwwLjUsMC45LDEuMnMtMC4zLDEuMi0wLjksMS4ySDQ2NXYxNC42aDcuN2MwLjYsMCwwLjksMC41LDAuOSwxLjJzLTAuMywxLjMtMC45LDEuM2gtMTcuM2MtMC42LDAtMC45LTAuNS0wLjktMS4yCgkJczAuMy0xLjIsMC45LTEuMmg3LjFWNTQ4TDQ1Nyw1NDcuOUw0NTcsNTQ3Ljl6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDc4LjIsNTU3LjJjMC40LDAsMC43LDAuMSwxLDAuNGMxLjgsMS41LDQuMSw0LDUuNCw2YzAuMiwwLjMsMC4zLDAuNywwLjMsMWMwLDAuNC0wLjIsMC44LTAuNiwxLjEKCQljLTAuMywwLjItMC42LDAuNC0xLDAuNGMtMC41LDAtMC45LTAuMi0xLjItMC43Yy0xLjItMS44LTMuMi00LjItNS4xLTUuOWMtMC4yLTAuMi0wLjQtMC41LTAuNC0wLjhjMC0wLjQsMC4yLTAuOCwwLjUtMS4xCgkJQzQ3Ny41LDU1Ny4zLDQ3Ny44LDU1Ny4yLDQ3OC4yLDU1Ny4yeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ5Ny42LDU0Ny42Yy0wLjYsMC0wLjktMC41LTAuOS0xLjJzMC4zLTEuMSwwLjktMS4xSDUxN2MwLjYsMCwwLjksMC41LDAuOSwxLjFzLTAuMywxLjItMC45LDEuMmgtOC4ydjUuMwoJCWg4LjdjMC42LDAsMC45LDAuNSwwLjksMS4xYzAsMC43LTAuMywxLjItMC45LDEuMmgtOC43djcuMmMxLjUsMC4zLDMuMywwLjQsNS40LDAuNGMyLDAsNC4xLTAuMSw2LjMtMC4yYzAsMCwwLDAsMC4xLDAKCQljMC44LDAsMS4xLDAuNSwxLjEsMS4zdjAuMWMwLDAuOC0wLjUsMS4yLTEuMiwxLjNjLTEuOCwwLjEtMy40LDAuMS01LDAuMWMtMi42LDAtNC44LTAuMS02LjktMC41Yy00LjItMC43LTcuNC0yLjctOS4yLTYuMQoJCWMtMS4xLDIuNi0yLjUsNS00LjMsN2MtMC4yLDAuMy0wLjYsMC40LTAuOSwwLjRzLTAuNi0wLjEtMC45LTAuNGMtMC4zLTAuMy0wLjUtMC43LTAuNS0xczAuMS0wLjYsMC4zLTAuOQoJCWMzLjItMy4xLDUuMS03LjgsNS43LTEyLjZjMC4xLTAuNiwwLjUtMC45LDEuMS0wLjljMC4xLDAsMC4zLDAsMC40LDBjMC42LDAuMSwxLDAuNiwxLDEuMWMwLDAuMSwwLDAuMiwwLDAuMmMtMC4yLDEuNS0wLjYsMy0xLDQuNAoJCWMxLjMsMi42LDMuMyw0LjYsNiw1LjZ2LTE0LjFMNDk3LjYsNTQ3LjZMNDk3LjYsNTQ3LjZ6IE01MTguNSw1MzguOWMxLjksMCwyLjgsMC44LDIuOCwyLjd2My41YzAsMC43LTAuNSwxLTEuMywxCgkJYy0wLjcsMC0xLjMtMC4zLTEuMy0xdi0yLjljMC0wLjctMC4zLTAuOS0xLTAuOWgtMjAuOGMtMC43LDAtMSwwLjItMSwwLjl2Mi45YzAsMC43LTAuNiwxLTEuMywxYy0wLjcsMC0xLjMtMC4zLTEuMy0xdi0zLjUKCQljMC0yLDAuOS0yLjcsMi44LTIuN2g5Ljd2LTIuN2MwLTAuNywwLjUtMS4xLDEuMy0xLjFzMS4zLDAuNCwxLjMsMS4xdjIuN0g1MTguNXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01MzQuNyw1NDkuM2MtMC4yLDAuOC0wLjQsMS42LTAuNiwyLjNjMC41LTAuMiwxLTAuMywxLjctMC4zaDEyLjljMS45LDAsMi44LDAuNywyLjgsMi42djkuNAoJCWMwLDEuOS0wLjksMi42LTIuOCwyLjZoLTEzLjhjLTEuOSwwLTIuOC0wLjctMi44LTIuNnYtNC4xYzAtMC45LDAuMS0yLjMsMC4yLTMuNGMtMS4yLDMuMi0zLjIsNi01LjIsOC4xYy0wLjMsMC4zLTAuNiwwLjUtMSwwLjUKCQljLTAuMywwLTAuNy0wLjEtMS0wLjRjLTAuMy0wLjMtMC40LTAuNi0wLjQtMC45YzAtMC40LDAuMi0wLjgsMC41LTFjMy4yLTIuOSw2LTcuNiw3LjEtMTIuNmgtNi40Yy0wLjYsMC0wLjktMC40LTAuOS0xCgkJczAuMy0xLDAuOS0xaDEyLjZWNTQ1aC05LjhjLTAuNSwwLTAuOC0wLjQtMC44LTFzMC4zLTEsMC44LTFoOS44di0yLjJoLTExLjNjLTAuNiwwLTAuOS0wLjQtMC45LTFzMC4zLTEsMC45LTFoNy4yCgkJYy0wLjYtMC45LTEuMi0xLjctMS44LTIuNGMtMC4xLTAuMS0wLjItMC4zLTAuMi0wLjVjMC0wLjMsMC4yLTAuNiwwLjYtMC44YzAuMi0wLjEsMC41LTAuMiwwLjYtMC4yYzAuNCwwLDAuNywwLjIsMC45LDAuNAoJCWMwLjcsMC45LDEuNSwyLjEsMi4zLDMuNGg1LjVjMS0xLjEsMS45LTIuNCwyLjQtMy4zYzAuMi0wLjMsMC42LTAuNSwxLTAuNWMwLjIsMCwwLjQsMCwwLjYsMC4xYzAuNSwwLjIsMC43LDAuNSwwLjcsMC44CgkJYzAsMC4yLTAuMSwwLjMtMC4yLDAuNWMtMC42LDAuOC0xLjIsMS42LTIsMi41aDcuM2MwLjUsMCwwLjgsMC40LDAuOCwxcy0wLjMsMS0wLjgsMWgtMTEuNnYyLjJoMTAuMWMwLjUsMCwwLjgsMC40LDAuOCwxCgkJcy0wLjMsMS0wLjgsMWgtMTAuMXYyLjJoMTIuOWMwLjYsMCwwLjksMC40LDAuOSwxcy0wLjMsMS0wLjksMUw1MzQuNyw1NDkuM0w1MzQuNyw1NDkuM3ogTTU0OS4xLDU1NS40di0xLjNjMC0wLjYtMC4zLTAuOC0wLjktMC44CgkJaC0xMi44Yy0wLjYsMC0wLjksMC4yLTAuOSwwLjh2MS4zSDU0OS4xeiBNNTQ5LjEsNTU5LjR2LTIuMmgtMTQuN3YyLjJINTQ5LjF6IE01MzQuNCw1NjIuOWMwLDAuNiwwLjMsMC45LDAuOSwwLjloMTIuOAoJCWMwLjYsMCwwLjktMC4yLDAuOS0wLjl2LTEuNmgtMTQuN0w1MzQuNCw1NjIuOUw1MzQuNCw1NjIuOXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01NTkuMiw1NTcuMmMwLjQsMCwwLjcsMC4xLDEsMC40YzEuOCwxLjUsNC4xLDQsNS40LDZjMC4yLDAuMywwLjMsMC43LDAuMywxYzAsMC40LTAuMiwwLjgtMC42LDEuMQoJCWMtMC4zLDAuMi0wLjYsMC40LTEsMC40Yy0wLjUsMC0wLjktMC4yLTEuMi0wLjdjLTEuMi0xLjgtMy4yLTQuMi01LjEtNS45Yy0wLjItMC4yLTAuNC0wLjUtMC40LTAuOGMwLTAuNCwwLjItMC44LDAuNS0xLjEKCQlDNTU4LjUsNTU3LjMsNTU4LjksNTU3LjIsNTU5LjIsNTU3LjJ6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNTc5LjgsNTQ4YzAuNCwwLjMsMC41LDAuNywwLjUsMXMtMC4xLDAuNi0wLjQsMC45Yy0wLjMsMC4zLTAuNiwwLjQtMSwwLjRjLTAuMywwLTAuNi0wLjEtMC45LTAuMwoJCWMtMS4xLTEtMi45LTIuNy00LjMtMy42Yy0wLjMtMC4yLTAuNC0wLjUtMC40LTAuOHMwLjEtMC41LDAuMy0wLjhjMC4zLTAuMywwLjYtMC41LDEuMS0wLjVjMC4yLDAsMC41LDAuMSwwLjcsMC4yCgkJQzU3Ni43LDU0NS4yLDU3OC44LDU0Ni45LDU3OS44LDU0OHogTTU4MC45LDU1NS4zYzAsMC4yLDAsMC4zLTAuMSwwLjVjLTEuMiwyLjktMy4yLDctNC44LDkuM2MtMC4zLDAuNC0wLjcsMC42LTEuMSwwLjYKCQljLTAuMywwLTAuNi0wLjEtMC44LTAuM2MtMC4zLTAuMi0wLjUtMC41LTAuNS0wLjljMC0wLjMsMC4xLTAuNywwLjQtMWMxLjUtMi4yLDMuNC02LDQuNS04LjhjMC4yLTAuNCwwLjYtMC43LDEtMC43CgkJYzAuMiwwLDAuNCwwLDAuNiwwLjFDNTgwLjcsNTU0LjQsNTgwLjksNTU0LjksNTgwLjksNTU1LjN6IE01ODEuMyw1MzkuN2MwLjMsMC4zLDAuNCwwLjcsMC40LDFzLTAuMSwwLjYtMC40LDAuOQoJCWMtMC4yLDAuMy0wLjYsMC40LTAuOSwwLjRjLTAuMywwLTAuNy0wLjEtMC45LTAuNGMtMS4xLTEuMi0zLTIuNy00LjItMy42Yy0wLjMtMC4yLTAuNC0wLjUtMC40LTAuOHMwLjEtMC42LDAuMy0wLjgKCQljMC4zLTAuMywwLjctMC41LDEuMS0wLjVjMC4yLDAsMC41LDAuMSwwLjcsMC4yQzU3OC4yLDUzNi45LDU4MC4yLDUzOC41LDU4MS4zLDUzOS43eiBNNTk4LjksNTUzLjJjMS45LDAsMi44LDAuNywyLjgsMi43djYuOAoJCWMwLDItMC44LDIuNy0yLjgsMi43aC0xMi41Yy0xLjksMC0yLjgtMC44LTIuOC0yLjd2LTYuOGMwLTEuOSwwLjktMi43LDIuOC0yLjdoNC44di01LjVoLTguN2MtMC42LDAtMS0wLjQtMS0xLjIKCQljMC0wLjcsMC40LTEuMiwxLTEuMmg4Ljd2LTUuMmMtMi41LDAuNC00LjksMC42LTcuMiwwLjhjMCwwLDAsMC0wLjEsMGMtMC43LDAtMS4xLTAuNC0xLjEtMS4xdi0wLjFjMC0wLjcsMC41LTEuMSwxLjEtMS4xCgkJYzUuMy0wLjMsMTEuNS0xLjMsMTYuMy0yLjljMC4yLTAuMSwwLjMtMC4xLDAuNS0wLjFjMC41LDAsMC44LDAuMiwxLDAuOGMwLjEsMC4yLDAuMSwwLjQsMC4xLDAuNWMwLDAuNS0wLjMsMS0wLjgsMS4yCgkJYy0yLjIsMC43LTQuOCwxLjMtNy40LDEuOHY1LjZoOWMwLjYsMCwxLDAuNCwxLDEuMmMwLDAuNy0wLjQsMS4yLTEsMS4yaC05djUuNWg1LjNWNTUzLjJ6IE01OTguMiw1NjNjMC42LDAsMS0wLjIsMS0wLjl2LTUuNwoJCWMwLTAuNy0wLjMtMC45LTEtMC45SDU4N2MtMC42LDAtMC45LDAuMi0wLjksMC45djUuN2MwLDAuNywwLjMsMC45LDAuOSwwLjlINTk4LjJ6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNjA5LDU0Ny4yYy0xLjcsMC0yLjQtMC43LTIuNC0yLjV2LTYuMmMwLTEuOCwwLjgtMi41LDIuNS0yLjVoNC40YzEuNywwLDIuNSwwLjgsMi41LDIuNXY2LjIKCQljMCwxLjgtMC44LDIuNS0yLjQsMi41aC0wLjN2NC41aDIuMWMwLjUsMCwwLjgsMC40LDAuOCwxYzAsMC43LTAuMywxLjEtMC44LDEuMWgtMnY2LjhjMC42LTAuMiwxLjMtMC41LDEuOS0wLjcKCQljMC4yLTAuMSwwLjMtMC4xLDAuNS0wLjFjMC40LDAsMC43LDAuMywwLjgsMC43YzAuMSwwLjIsMC4xLDAuMywwLjEsMC41YzAsMC40LTAuMywwLjgtMC44LDFjLTIuOCwxLjItNS43LDIuMy04LjcsMwoJCWMtMC4yLDAtMC4zLDAuMS0wLjQsMC4xYy0wLjUsMC0wLjktMC4zLTEuMS0wLjljMC0wLjEsMC0wLjMsMC0wLjRjMC0wLjUsMC4yLTEsMC43LTEuMWMwLjIsMCwwLjQtMC4xLDAuNi0wLjFWNTUxCgkJYzAtMC42LDAuNS0wLjksMS4xLTAuOXMxLjEsMC4zLDEuMSwwLjl2MTFjMC42LTAuMiwxLjMtMC40LDItMC42di0xNC4zTDYwOSw1NDcuMkw2MDksNTQ3LjJ6IE02MDkuNyw1MzguMmMtMC42LDAtMC44LDAuMi0wLjgsMC45CgkJdjUuMWMwLDAuNywwLjMsMC44LDAuOCwwLjhoMy4xYzAuNiwwLDAuOC0wLjIsMC44LTAuOHYtNS4xYzAtMC43LTAuMy0wLjktMC44LTAuOUg2MDkuN3ogTTYzNSw1NjMuNmMwLjYsMCwwLjgsMC40LDAuOCwxCgkJcy0wLjMsMS0wLjgsMWgtMTQuM2MtMS44LDAtMi43LTAuNy0yLjctMi41di00LjdjMC0yLjcsMC4xLTMuNiwwLjMtNC41Yy0wLjQsMC41LTAuNywwLjktMS4xLDEuMmMtMC4zLDAuMy0wLjYsMC40LTAuOCwwLjQKCQlzLTAuNS0wLjEtMC43LTAuM3MtMC4zLTAuNS0wLjMtMC43YzAtMC4zLDAuMS0wLjYsMC40LTAuOGMxLjQtMS4zLDMuMS0zLjcsNC4xLTUuNmMwLjMtMC41LDAuNi0wLjgsMC45LTAuOGMwLjIsMCwwLjQsMC4xLDAuNiwwLjIKCQljMC40LDAuMiwwLjYsMC41LDAuNiwwLjhjMCwwLjItMC4xLDAuNC0wLjIsMC42Yy0wLjIsMC40LTAuNSwwLjgtMC44LDEuM2MwLjUtMC4xLDEtMC4xLDEuNi0wLjFoMy43YzAuNS0wLjcsMC45LTEuNSwxLjItMgoJCWMwLjItMC40LDAuNS0wLjYsMC45LTAuNmMwLjEsMCwwLjMsMCwwLjUsMC4xYzAuNSwwLjIsMC43LDAuNSwwLjcsMC44YzAsMC4xLDAsMC4zLTAuMSwwLjRjLTAuMiwwLjQtMC41LDAuOC0wLjgsMS4zaDYuMQoJCWMwLjUsMCwwLjgsMC40LDAuOCwwLjljMCwwLjYtMC4zLDAuOS0wLjgsMC45aC02LjV2Mi42aDUuN2MwLjUsMCwwLjcsMC40LDAuNywwLjlzLTAuMywxLTAuNywxaC01Ljd2Mi42aDUuNwoJCWMwLjUsMCwwLjcsMC40LDAuNywwLjlzLTAuMywwLjktMC43LDAuOWgtNS43djIuOWg2LjdWNTYzLjZ6IE02MjMuMyw1MzguOGMwLTAuNy0wLjMtMC45LTAuOS0wLjloLTQuOWMtMC41LDAtMC44LTAuNC0wLjgtMQoJCXMwLjMtMSwwLjgtMWg1LjVjMS43LDAsMi41LDAuNiwyLjUsMi40djUuOWMwLDEuOC0wLjgsMi40LTIuNSwyLjRoLTUuNmMtMC41LDAtMC43LTAuNC0wLjctMXMwLjMtMC45LDAuNy0wLjloNS4xCgkJYzAuNiwwLDAuOS0wLjIsMC45LTAuOXYtMS42aC01LjVjLTAuNSwwLTAuNy0wLjUtMC43LTFzMC4yLTAuOSwwLjctMC45aDUuNUw2MjMuMyw1MzguOEw2MjMuMyw1MzguOHogTTYyNiw1NTQuNHYtMi42aC00LjgKCQljLTAuNiwwLTAuOSwwLjItMC45LDAuOHYxLjhINjI2eiBNNjIwLjIsNTU4LjloNS43di0yLjZoLTUuN1Y1NTguOXogTTYyMC4yLDU2Mi44YzAsMC42LDAuMywwLjgsMC45LDAuOGg0Ljh2LTIuOWgtNS43VjU2Mi44egoJCSBNNjMzLDUzOC44YzAtMC43LTAuMy0wLjktMC45LTAuOUg2MjdjLTAuNSwwLTAuOC0wLjQtMC44LTFzMC4zLTEsMC44LTFoNS42YzEuNywwLDIuNSwwLjYsMi41LDIuNHY1LjljMCwxLjgtMC44LDIuNC0yLjUsMi40SDYyNwoJCWMtMC41LDAtMC43LTAuNC0wLjctMXMwLjMtMC45LDAuNy0wLjloNS4xYzAuNiwwLDAuOS0wLjIsMC45LTAuOXYtMS42aC01LjZjLTAuNSwwLTAuNy0wLjUtMC43LTFzMC4yLTAuOSwwLjctMC45aDUuNlY1MzguOHoiLz4KPC9nPgo8ZyBjbGFzcz0ic3QzIj4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik02NTIuMyw1NjAuOWMwLDIuOS0yLjMsNS4zLTUuMSw1LjNzLTUuMS0yLjQtNS4xLTUuM3MyLjMtNS4zLDUuMS01LjNTNjUyLjMsNTU4LDY1Mi4zLDU2MC45eiBNNjQ0LjIsNTYwLjkKCQljMCwxLjcsMS40LDMuMSwzLDMuMXMzLTEuNSwzLTMuMXMtMS40LTMuMS0zLTMuMUM2NDUuNiw1NTcuOCw2NDQuMiw1NTkuMiw2NDQuMiw1NjAuOXoiLz4KPC9nPgo8ZyBjbGFzcz0ic3QzIj4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00MTIuNCw2MDYuNWMtMC4yLDAtMC40LDAtMC42LTAuMWMtMC41LTAuMi0wLjctMC41LTAuNy0xYzAtMC4yLDAuMS0wLjQsMC4yLTAuNmMwLjctMS43LDEuNS00LjYsMS44LTcuMwoJCWMwLjEtMC42LDAuNS0wLjksMS4xLTAuOWMwLjEsMCwwLjEsMCwwLjIsMGMwLjcsMC4xLDEsMC40LDEsMWMwLDAuMSwwLDAuMiwwLDAuM2MtMC4zLDIuNS0xLDUuOC0xLjgsNy45CgkJQzQxMy4yLDYwNi4yLDQxMi45LDYwNi41LDQxMi40LDYwNi41eiBNNDE3LjEsNTk0LjNjLTEuNiwwLjEtMy4xLDAuMy00LjYsMC4zaC0wLjFjLTAuNiwwLTEtMC40LTEtMS4xYzAtMC44LDAuNC0xLjEsMS0xLjEKCQljMC4yLDAsMC40LDAsMC41LDBjMC40LDAsMC44LDAsMS4zLDBjMC43LTEsMS41LTIsMi4yLTNjLTEuNS0xLjktMy40LTMuOC00LjctNS4xYy0wLjMtMC4yLTAuNC0wLjUtMC40LTAuOHMwLjEtMC42LDAuNC0wLjgKCQljMC4zLTAuMywwLjYtMC40LDAuOC0wLjRjMC4yLDAsMC40LDAuMSwwLjYsMC4yYzAuNCwwLjMsMC43LDAuNywxLjEsMS4xYzEuMi0xLjcsMi4yLTMuNywzLTUuNGMwLjItMC40LDAuNS0wLjYsMC45LTAuNgoJCWMwLjIsMCwwLjQsMCwwLjYsMC4xYzAuNSwwLjIsMC43LDAuNiwwLjcsMWMwLDAuMiwwLDAuMy0wLjEsMC41Yy0wLjgsMS44LTIuMSw0LTMuNiw2YzAuNiwwLjcsMS4zLDEuNSwxLjksMi4zCgkJYzEuMy0yLDIuNS0zLjksMy40LTUuN2MwLjItMC40LDAuNi0wLjYsMC45LTAuNmMwLjIsMCwwLjQsMC4xLDAuNiwwLjJjMC41LDAuMiwwLjcsMC42LDAuNywxYzAsMC4yLTAuMSwwLjMtMC4yLDAuNQoJCWMtMS43LDMtNC4zLDYuOC02LjMsOS40YzEuNi0wLjEsMy4zLTAuMyw0LjktMC41Yy0wLjQtMC44LTAuNy0xLjUtMS4xLTIuMWMtMC4xLTAuMS0wLjEtMC4yLTAuMS0wLjNjMC0wLjMsMC4zLTAuNywwLjYtMC45CgkJYzAuMi0wLjEsMC4zLTAuMSwwLjUtMC4xYzAuNCwwLDAuNiwwLjIsMC44LDAuNWMwLjksMS42LDEuOSwzLjgsMi41LDUuNGMwLDAuMSwwLjEsMC4yLDAuMSwwLjNjMCwwLjQtMC4zLDAuNy0wLjcsMC45CgkJYy0wLjIsMC4xLTAuNCwwLjEtMC42LDAuMWMtMC40LDAtMC43LTAuMi0wLjgtMC43Yy0wLjEtMC40LTAuMy0wLjgtMC41LTEuM2MtMSwwLjItMi4xLDAuMy0zLjEsMC40djEzLjljMCwwLjYtMC41LDAuOS0xLjIsMC45CgkJYy0wLjYsMC0xLjEtMC4zLTEuMS0wLjh2LTEzLjdINDE3LjF6IE00MjQuMiw2MDIuOWMwLDAuNS0wLjMsMC44LTAuOCwwLjljLTAuMSwwLTAuMiwwLTAuNCwwYy0wLjUsMC0wLjgtMC4zLTAuOS0wLjkKCQljLTAuMy0xLjgtMC42LTMuNi0xLjItNS41YzAtMC4xLDAtMC4yLDAtMC4yYzAtMC40LDAuMy0wLjcsMC43LTAuOWMwLjEsMCwwLjMsMCwwLjQsMGMwLjQsMCwwLjcsMC4yLDAuOSwwLjYKCQljMC42LDEuOSwxLjEsMy44LDEuNCw1LjdDNDI0LjIsNjAyLjcsNDI0LjIsNjAyLjgsNDI0LjIsNjAyLjl6IE00NDAuNyw2MDVjMC42LDAsMC45LDAuNSwwLjksMS4ycy0wLjMsMS4yLTAuOSwxLjJoLTE3LjYKCQljLTAuNiwwLTAuOS0wLjUtMC45LTEuMnMwLjMtMS4yLDAuOS0xLjJoMi43di0yMy41YzAtMiwwLjktMi44LDIuNy0yLjhoNy43YzEuOSwwLDIuNywwLjgsMi43LDIuOFY2MDVINDQwLjd6IE00MzYuNSw1ODIuMQoJCWMwLTAuNy0wLjMtMC45LTAuOS0wLjloLTYuNWMtMC42LDAtMC45LDAuMi0wLjksMC45djUuM2g4LjNWNTgyLjF6IE00MjguMiw1OTZoOC4zdi02LjNoLTguM1Y1OTZ6IE00MjguMiw2MDVoOC4zdi02LjhoLTguM1Y2MDV6IgoJCS8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDQ3LjksNTk0LjJjLTEuMywwLjEtMi42LDAuMi0zLjgsMC4zSDQ0NGMtMC42LDAtMS0wLjMtMS0xLjFjMC0wLjcsMC4zLTEuMSwwLjktMS4xYzAuNCwwLDAuNywwLDEuMSwwCgkJYzAuNy0xLDEuMy0yLDItMy4xYy0xLTEuNy0yLjQtMy42LTMuNS00LjljLTAuMi0wLjItMC4zLTAuNS0wLjMtMC44czAuMS0wLjYsMC40LTAuOWMwLjMtMC4yLDAuNS0wLjMsMC44LTAuMwoJCWMwLjIsMCwwLjUsMC4xLDAuNiwwLjNzMC4zLDAuMywwLjQsMC41YzEtMS42LDEuOC0zLjUsMi40LTUuMWMwLjItMC40LDAuNS0wLjYsMC45LTAuNmMwLjIsMCwwLjMsMCwwLjUsMC4xYzAuNSwwLjIsMC43LDAuNSwwLjcsMQoJCWMwLDAuMSwwLDAuMy0wLjEsMC41Yy0wLjgsMS44LTEuOCwzLjktMy4xLDUuOWMwLjEsMC4xLDAuMiwwLjMsMC4zLDAuNGMwLjUsMC42LDAuOSwxLjIsMS4zLDEuOWMxLTEuOCwxLjktMy41LDIuNy01LjIKCQljMC4yLTAuNCwwLjUtMC42LDAuOS0wLjZjMC4yLDAsMC40LDAsMC41LDAuMWMwLjQsMC4yLDAuNiwwLjYsMC42LDFjMCwwLjIsMCwwLjQtMC4xLDAuNWMtMS41LDMtMy42LDYuNi01LjQsOS4xCgkJYzEuMy0wLjEsMi43LTAuMiw0LTAuM2MtMC4yLTAuOC0wLjUtMS42LTAuNy0yLjJjMC0wLjEtMC4xLTAuMi0wLjEtMC40YzAtMC40LDAuMi0wLjcsMC42LTAuOWMwLjItMC4xLDAuMy0wLjEsMC41LTAuMQoJCWMwLjMsMCwwLjYsMC4yLDAuOCwwLjZjMC42LDEuNSwxLjMsMy41LDEuNiw0LjljMC4xLDAuMSwwLjEsMC4zLDAuMSwwLjRjMCwwLjUtMC4zLDAuOC0wLjcsMWMtMC4xLDAtMC4yLDAtMC40LDAKCQljLTAuNCwwLTAuNy0wLjItMC45LTAuOGMtMC4xLTAuMi0wLjEtMC41LTAuMi0wLjdjLTAuNiwwLjEtMS4yLDAuMi0xLjgsMC4ydjE0YzAsMC41LTAuNSwwLjktMS4xLDAuOXMtMS4xLTAuMy0xLjEtMC45di0xMy42CgkJSDQ0Ny45eiBNNDQ2LjYsNTk3LjJMNDQ2LjYsNTk3LjJjLTAuMiwyLjYtMC42LDUuNi0xLjIsOGMtMC4yLDAuNy0wLjYsMC45LTEuMSwwLjljLTAuMSwwLTAuMywwLTAuNC0wLjFjLTAuNC0wLjEtMC43LTAuNC0wLjctMQoJCWMwLTAuMSwwLTAuMywwLjEtMC41YzAuNi0yLjEsMS01LjIsMS4yLTcuNGMwLjEtMC44LDAuNi0xLDEuMS0xaDAuMUM0NDYuMiw1OTYuMyw0NDYuNiw1OTYuNiw0NDYuNiw1OTcuMnogTTQ1Mi4xLDU5Ni4zCgkJYzAuNSwwLDAuOCwwLjIsMC45LDAuN2MwLjQsMS43LDAuOSw0LjQsMSw2LjJjMCwwLjEsMCwwLjEsMCwwLjJjMCwwLjctMC4zLDEtMC45LDEuMWMtMC4xLDAtMC4xLDAtMC4yLDBjLTAuNSwwLTAuOS0wLjMtMS0xCgkJYy0wLjEtMS43LTAuNS00LjItMC44LTUuOGMwLTAuMSwwLTAuMiwwLTAuM2MwLTAuNSwwLjMtMC44LDAuOC0wLjlDNDUxLjksNTk2LjMsNDUyLDU5Ni4zLDQ1Mi4xLDU5Ni4zeiBNNDY3LjgsNTg5LjYKCQljMC4xLDIuOSwwLjMsNS4zLDAuNyw3LjRjMCwwLjIsMC4xLDAuNCwwLjEsMC43YzAuOC0xLjcsMS40LTMuNSwxLjktNS40YzAuMS0wLjUsMC40LTAuNywwLjgtMC43YzAuMiwwLDAuMywwLDAuNSwwLjEKCQljMC41LDAuMiwwLjYsMC41LDAuNiwwLjhjMCwwLjEsMCwwLjMtMC4xLDAuNGMtMC43LDIuNi0xLjgsNS4yLTMuMSw3LjVjMC42LDEuOCwxLjIsMy4zLDEuOCw0LjJjMC4yLDAuMywwLjMsMC40LDAuNSwwLjQKCQljMC4xLDAsMC4zLTAuMiwwLjQtMC41YzAuMi0wLjYsMC4zLTEuOCwwLjQtMi44YzAtMC42LDAuNC0wLjksMS0wLjloMC4xYzAuNiwwLDAuOSwwLjMsMC45LDAuOXYwLjFjLTAuMSwxLjctMC41LDMuOS0wLjksNC45CgkJYy0wLjQsMC44LTEsMS4yLTEuNywxLjJjLTAuNiwwLTEuMi0wLjMtMS43LTAuOWMtMC44LTAuOS0xLjUtMi40LTIuMi00LjJjLTEuMywxLjktMi45LDMuNi00LjYsNS4xYy0wLjMsMC4yLTAuNiwwLjMtMC44LDAuMwoJCXMtMC42LTAuMS0wLjgtMC41Yy0wLjItMC4yLTAuMi0wLjUtMC4yLTAuN2MwLTAuNCwwLjItMC43LDAuNS0wLjljMC40LTAuMywwLjgtMC43LDEuMi0xYy0wLjQsMC4yLTAuOCwwLjMtMS40LDAuM2gtNC40CgkJYy0xLjcsMC0yLjUtMC43LTIuNS0yLjR2LTljMC0xLjcsMC44LTIuNCwyLjUtMi40aDQuNGMxLjYsMCwyLjQsMC43LDIuNCwyLjR2OWMwLDAuNi0wLjEsMS0wLjMsMS40YzEuMi0xLjIsMi4zLTIuNiwzLjItNC4xCgkJYy0wLjItMC44LTAuNC0xLjctMC42LTIuNWMtMC40LTIuMy0wLjYtNC45LTAuOC04LjFINDU0Yy0wLjYsMC0wLjktMC41LTAuOS0xLjFzMC4zLTEsMC45LTFoMi4xYy0wLjItMS42LTAuNS0zLjItMC44LTQuN2gtMC44CgkJYy0wLjUsMC0wLjgtMC40LTAuOC0xczAuMy0xLDAuOC0xaDMuOHYtMi40YzAtMC42LDAuNS0wLjksMS4xLTAuOWMwLjcsMCwxLjEsMC4zLDEuMSwwLjl2Mi40aDMuNmMwLjUsMCwwLjgsMC40LDAuOCwxCgkJcy0wLjMsMS0wLjgsMWgtMC42Yy0wLjMsMS42LTAuNiwzLjItMS4xLDQuN2gzLjJjLTAuMS0yLjctMC4xLTUuOC0wLjEtOS4yYzAtMC42LDAuNS0wLjksMS4xLTAuOWMwLjcsMCwxLjIsMC4zLDEuMiwwLjkKCQljMCwxLjUsMCwzLDAsNC4zYzAsMS44LDAsMy40LDAsNC45aDUuMWMwLjYsMCwwLjksMC40LDAuOSwxYzAsMC43LTAuMywxLjEtMC45LDEuMUw0NjcuOCw1ODkuNkw0NjcuOCw1ODkuNnogTTQ1Nyw2MDIuNAoJCWMwLDAuNiwwLjMsMC44LDAuOSwwLjhoMy4zYzAuNiwwLDAuOS0wLjIsMC45LTAuOHYtMy4yaC01TDQ1Nyw2MDIuNEw0NTcsNjAyLjR6IE00NjIsNTk3LjJ2LTIuOGMwLTAuNi0wLjMtMC44LTAuOC0wLjhoLTMuMwoJCWMtMC42LDAtMC45LDAuMi0wLjksMC44djIuOEg0NjJ6IE00NTcuMyw1ODIuN2MwLjMsMS4yLDAuNCwyLjUsMC42LDMuOGMwLDAuMywwLjEsMC42LDAuMSwxaDIuMmMwLjUtMS41LDAuOC0zLjEsMS00LjcKCQlMNDU3LjMsNTgyLjdMNDU3LjMsNTgyLjd6IE00NjkuNyw1NzkuNWMwLjQsMCwwLjYsMC4yLDAuOCwwLjVjMC45LDEuNCwxLjksMy4zLDIuNCw0LjZjMC4xLDAuMSwwLjEsMC4zLDAuMSwwLjQKCQljMCwwLjUtMC4zLDAuOC0wLjYsMWMtMC4xLDAuMS0wLjMsMC4xLTAuNSwwLjFjLTAuNCwwLTAuOC0wLjItMS0wLjdjLTAuNS0xLjEtMS40LTMtMi4yLTQuNGMtMC4xLTAuMi0wLjItMC40LTAuMi0wLjYKCQljMC0wLjMsMC4yLTAuNiwwLjYtMC44QzQ2OS40LDU3OS42LDQ2OS42LDU3OS41LDQ2OS43LDU3OS41eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ5OS43LDU4NS40Yy0xLjMsNC44LTMuNiw5LjMtNi45LDEzYzAuNiwwLjUsMS4yLDEsMS44LDEuNWMzLDIuMyw2LjcsNC4xLDEwLjMsNS4zYzAuNiwwLjIsMC45LDAuNywwLjksMS4yCgkJYzAsMC4yLDAsMC4zLTAuMSwwLjVjLTAuMiwwLjctMC42LDEtMS4yLDFjLTAuMiwwLTAuNSwwLTAuNy0wLjFjLTQuMi0xLjQtNy43LTMuMy0xMS02Yy0wLjYtMC41LTEuMy0xLTEuOC0xLjYKCQljLTAuNiwwLjYtMS4yLDEuMS0xLjgsMS42Yy0zLjUsMi44LTYuOCw0LjUtMTAuOSw2Yy0wLjIsMC4xLTAuNCwwLjEtMC42LDAuMWMtMC42LDAtMS0wLjMtMS4zLTAuOWMtMC4xLTAuMi0wLjEtMC4zLTAuMS0wLjUKCQljMC0wLjYsMC40LTEsMS0xLjNjMy43LTEuMyw3LjEtMi45LDExLTZjMC4zLTAuMywwLjYtMC41LDAuOS0wLjhjLTMuMy0zLjctNS41LTguMi02LjgtMTNoLTUuMWMtMC42LDAtMC45LTAuNi0wLjktMS4zCgkJczAuMy0xLjIsMC45LTEuMmgxMi4zdi00LjRjMC0wLjYsMC41LTEuMSwxLjMtMS4xczEuMywwLjUsMS4zLDEuMXY0LjRINTA1YzAuNiwwLDAuOSwwLjUsMC45LDEuMnMtMC4zLDEuMy0wLjksMS4zSDQ5OS43egoJCSBNNDg0LjksNTg1LjRjMS4yLDQuMiwzLjMsOCw2LjEsMTEuMmMyLjgtMy4yLDQuOS03LDYtMTEuMkg0ODQuOXoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01MTMuMyw1OTQuMmMwLTEuNSwwLjEtMy4xLDAuMy00LjZjLTAuOCwxLjUtMS45LDMtMy4xLDQuNGMtMC4zLDAuMy0wLjYsMC41LTAuOSwwLjVzLTAuNi0wLjEtMC45LTAuNAoJCWMtMC4zLTAuMy0wLjQtMC42LTAuNC0xczAuMS0wLjYsMC40LTAuOWMzLjgtNC4yLDYuMy04LjgsNy43LTEzLjljMC4xLTAuNSwwLjYtMC44LDEuMS0wLjhjMC4yLDAsMC40LDAsMC42LDAuMQoJCWMwLjYsMC4yLDAuOSwwLjYsMC45LDEuMWMwLDAuMSwwLDAuMy0wLjEsMC40Yy0wLjcsMi4zLTEuNyw0LjctMi45LDcuMnYyMS4zYzAsMC42LTAuNSwxLTEuMywxYy0wLjcsMC0xLjMtMC40LTEuMy0xTDUxMy4zLDU5NC4yCgkJTDUxMy4zLDU5NC4yeiBNNTI1LjEsNjAzLjNjMCwxLDAuMywxLjQsMS41LDEuNWMwLjcsMC4xLDEuNywwLjEsMywwLjFjMS43LDAsMy0wLjEsMy45LTAuNGMwLjYtMC4yLDEuMi0wLjYsMS40LTEuMgoJCWMwLjMtMC44LDAuNS0yLjQsMC42LTQuMWMwLTAuOCwwLjUtMS4yLDEuMi0xLjJjMCwwLDAuMSwwLDAuMiwwYzAuNywwLjEsMS4yLDAuNSwxLjIsMS4yYzAsMCwwLDAsMCwwLjFjLTAuMSwyLjEtMC40LDQuMi0wLjksNS40CgkJYy0wLjUsMS4zLTEuNSwyLTMsMi4zYy0xLjIsMC4zLTIuNywwLjQtNC42LDAuNGMtMS43LDAtMywwLTQuMS0wLjJjLTIuMi0wLjMtMy0xLjItMy0zLjR2LTI1LjRjMC0wLjcsMC41LTEsMS4zLTFzMS4zLDAuNCwxLjMsMQoJCXYxMi4xYzMuNS0yLDYuOS00LjYsOS42LTcuN2MwLjMtMC4yLDAuNi0wLjQsMC44LTAuNGMwLjMsMCwwLjcsMC4yLDEsMC40YzAuMywwLjMsMC41LDAuNywwLjUsMS4xYzAsMC4zLTAuMSwwLjctMC41LDAuOQoJCWMtMi45LDMtNyw2LTExLjQsOC41VjYwMy4zeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTU1NS44LDU4NS4yYzMuOCw1LjIsOC44LDEwLjYsMTQuMSwxNS4zYzAuNCwwLjMsMC42LDAuOCwwLjYsMS4zYzAsMC40LTAuMSwwLjgtMC40LDEuMQoJCWMtMC4zLDAuNC0wLjcsMC42LTEuMSwwLjZjLTAuNCwwLTAuOC0wLjEtMS4xLTAuNGMtNS4yLTQuNy0xMC4xLTEwLjQtMTMuOC0xNS43Yy0wLjgtMS4xLTEuMy0xLjYtMS45LTEuNmMtMC43LDAtMS4xLDAuMy0yLDEuOAoJCWMtMS45LDMuMi00LjMsNi45LTYuMyw5LjRjLTAuNCwwLjUtMC44LDAuNy0xLjIsMC43cy0wLjctMC4yLTEuMS0wLjVjLTAuMy0wLjMtMC41LTAuNy0wLjUtMS4xYzAtMC40LDAuMS0wLjgsMC40LTEuMQoJCWMyLjItMi42LDQuNy02LjEsNi44LTkuNWMxLjMtMi4xLDIuNC0yLjcsMy45LTIuN0M1NTMuNCw1ODIuNyw1NTQuNSw1ODMuMyw1NTUuOCw1ODUuMnoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01NzYuNiw1OTQuMWMwLTAuNi0wLjItMC44LTAuOC0wLjhoLTIuNmMtMC42LDAtMS0wLjQtMS0xLjJzMC40LTEuMSwxLTEuMWgzLjVjMS43LDAsMi4zLDAuOSwyLjMsMi43djcuOQoJCWMwLjksMi4xLDIuNywzLjIsNC42LDMuNWMxLjUsMC4yLDMuNSwwLjQsNi4zLDAuNGM0LDAsOC4yLTAuMiwxMS41LTAuNGMwLjEsMCwwLjEsMCwwLjIsMGMwLjcsMCwxLjEsMC40LDEuMSwxLjIKCQljMCwwLjEsMCwwLjEsMCwwLjFjMCwwLjctMC41LDEuMi0xLjIsMS4yYy0zLjMsMC4yLTcuOSwwLjMtMTEuOCwwLjNjLTIuOSwwLTUuMy0wLjItNi45LTAuNWMtMi4zLTAuNS00LjEtMS45LTUuMS0zLjgKCQljLTEuMiwxLjUtMi41LDMtMy45LDRjLTAuMiwwLjItMC41LDAuMy0wLjcsMC4zYy0wLjMsMC0wLjYtMC4yLTAuOS0wLjZjLTAuMi0wLjMtMC4zLTAuNi0wLjMtMC45YzAtMC4zLDAuMi0wLjcsMC40LTAuOQoJCWMxLjItMC45LDMtMi41LDQuMi00LjF2LTcuM0g1NzYuNnogTTU3OS4zLDU4My41YzAuMiwwLjMsMC4zLDAuNSwwLjMsMC44YzAsMC40LTAuMiwwLjctMC41LDFjLTAuMywwLjItMC42LDAuNC0wLjksMC40CgkJcy0wLjYtMC4yLTAuOS0wLjVjLTEuMi0xLjgtMi43LTMuNy00LjEtNWMtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjdjMC0wLjMsMC4yLTAuNiwwLjUtMC45YzAuMy0wLjMsMC42LTAuNCwwLjktMC40CgkJYzAuMywwLDAuNiwwLjEsMC43LDAuM0M1NzYuNCw1NzkuOCw1NzguMiw1ODEuOCw1NzkuMyw1ODMuNXogTTU4MS42LDU4Mi4xYy0wLjYsMC0wLjktMC40LTAuOS0xczAuMy0xLDAuOS0xaDguNXYtMS45CgkJYzAtMC42LDAuNS0wLjksMS4yLTAuOXMxLjIsMC4zLDEuMiwwLjl2MS45aDguNmMwLjYsMCwwLjksMC40LDAuOSwxcy0wLjMsMS0wLjksMWgtMy44Yy0wLjQsMS0wLjksMi4xLTEuNCwzaDIuNgoJCWMxLjgsMCwyLjYsMC43LDIuNiwyLjZ2MTMuMWMwLDIuMS0xLjIsMi44LTMuMywyLjhjLTAuMiwwLTAuNSwwLTAuNywwYy0wLjMsMC0wLjcsMC0xLjEtMC4xYy0wLjUtMC4xLTAuOC0wLjUtMC44LTEKCQljMC0wLjEsMC0wLjIsMC0wLjNjMC4xLTAuNiwwLjUtMC45LDAuOS0wLjloMC4xYzAuNiwwLjEsMS4xLDAuMSwxLjUsMC4xYzAuNywwLDAuOS0wLjIsMC45LTEuM1Y1ODhjMC0wLjYtMC4zLTAuOC0wLjktMC44SDU4NQoJCWMtMC42LDAtMC45LDAuMi0wLjksMC44djE0LjZjMCwwLjYtMC40LDAuOS0xLjEsMC45Yy0wLjcsMC0xLjItMC4zLTEuMi0wLjl2LTE0LjljMC0xLjksMC44LTIuNiwyLjYtMi42aDIuM2MtMC4zLTEtMC43LTIuMS0xLjItMwoJCUg1ODEuNnogTTU5NC4xLDU5NC4xYzEuNSwwLDIuMiwwLjcsMi4yLDIuM3YyLjhjMCwxLjYtMC43LDIuMi0yLjIsMi4yaC01LjVjLTEuNSwwLTIuMi0wLjYtMi4yLTIuMnYtMi44YzAtMS42LDAuNy0yLjMsMi4yLTIuMwoJCWgxLjd2LTIuM2gtNC41Yy0wLjUsMC0wLjgtMC40LTAuOC0xczAuMy0wLjksMC44LTAuOWg0LjV2LTEuNGMwLTAuNywwLjMtMC45LDEtMC45czEuMSwwLjIsMS4xLDAuOXYxLjRoNC44YzAuNSwwLDAuOCwwLjMsMC44LDAuOQoJCWMwLDAuNi0wLjMsMS0wLjgsMWgtNC44djIuM0g1OTQuMXogTTU4Ny45LDU4Mi4xYzAuNSwxLDAuOCwyLDEuMiwzaDQuNGMwLjYtMSwxLTIsMS40LTNINTg3Ljl6IE01OTMuNCw1OTkuNQoJCWMwLjUsMCwwLjgtMC4yLDAuOC0wLjd2LTJjMC0wLjYtMC4zLTAuOC0wLjgtMC44aC00LjJjLTAuNSwwLTAuOCwwLjItMC44LDAuOHYyYzAsMC42LDAuMywwLjcsMC44LDAuN0g1OTMuNHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik02MzMuNyw1ODFjMC43LDAsMC45LDAuNSwwLjksMS4ycy0wLjIsMS4yLTAuOSwxLjJoLTIyLjRjLTEuMSwwLTEuNSwwLjQtMS41LDEuNWMwLDQuMS0wLjEsOS40LTAuNSwxMi42CgkJcy0xLjEsNy4yLTIuMiw5LjdjLTAuMywwLjYtMC43LDEtMS4yLDFjLTAuMiwwLTAuNCwwLTAuNi0wLjFjLTAuNS0wLjMtMC43LTAuNi0wLjctMWMwLTAuMiwwLjEtMC41LDAuMi0wLjgKCQljMS4xLTIuNCwxLjgtNS42LDIuMi05LjhjMC4yLTIuOSwwLjMtOC4xLDAuMy0xMi4xYzAtMi4zLDEuMi0zLjQsMy4yLTMuNGg4Ljh2LTIuN2MwLTAuNiwwLjYtMSwxLjMtMWMwLjgsMCwxLjMsMC40LDEuMywxdjIuNwoJCUw2MzMuNyw1ODFMNjMzLjcsNTgxeiBNNjEzLjgsNTkyLjZMNjEzLjgsNTkyLjZjMC44LDAuMSwxLjMsMC41LDEuMywxLjJjMCwwLjEsMCwwLjIsMCwwLjJjLTAuNCwzLjQtMS4yLDcuMy0yLjQsMTAuMwoJCWMtMC4yLDAuNS0wLjYsMC44LTEuMSwwLjhjLTAuMiwwLTAuNCwwLTAuNi0wLjFjLTAuNS0wLjItMC44LTAuNi0wLjgtMS4xYzAtMC4yLDAtMC40LDAuMS0wLjZjMS4yLTIuOCwyLTYuNCwyLjMtOS43CgkJQzYxMi42LDU5Myw2MTMuMSw1OTIuNiw2MTMuOCw1OTIuNnogTTYxNy40LDU5MS4xYzAtMC42LDAuNS0xLDEuMy0xczEuMywwLjQsMS4zLDF2MTMuNGMwLDAuNywwLjMsMSwwLjcsMS4xCgkJYzAuNiwwLjIsMS41LDAuMiwyLjUsMC4yYzEuNCwwLDIuMS0wLjEsMi43LTAuNXMwLjctMC43LDAuOS0xLjhjMC4xLTAuNywwLjItMiwwLjItMy4yYzAtMC43LDAuNS0xLjIsMS4yLTEuMmMwLDAsMCwwLDAuMSwwCgkJYzAuNywwLDEuMiwwLjUsMS4yLDEuMmMwLDItMC4yLDQuMS0wLjUsNS4xYy0wLjQsMS4yLTAuOSwxLjgtMS45LDIuM2MtMC43LDAuMy0xLjksMC41LTMuNywwLjVjLTIuNCwwLTMuNSwwLTQuMy0wLjQKCQljLTEtMC41LTEuNS0xLjItMS41LTIuOHYtMTMuOUg2MTcuNHogTTYyNi42LDU4OS41YzAuMywwLjIsMC41LDAuNiwwLjUsMC45YzAsMC4zLTAuMSwwLjYtMC4zLDAuOWMtMC4zLDAuNC0wLjYsMC42LTEsMC42CgkJYy0wLjMsMC0wLjYtMC4xLTAuOC0wLjNjLTEuOC0xLjYtNC41LTMuNC02LjQtNC41Yy0wLjQtMC4yLTAuNi0wLjUtMC42LTAuOGMwLTAuMiwwLjEtMC41LDAuMy0wLjhjMC4zLTAuNCwwLjYtMC42LDEtMC42CgkJYzAuMiwwLDAuNSwwLjEsMC44LDAuMkM2MjIuMiw1ODYuMyw2MjQuNyw1ODcuOSw2MjYuNiw1ODkuNXogTTYyOC45LDU5My42YzAtMC41LDAuMy0wLjksMC44LTEuMWMwLjItMC4xLDAuNC0wLjEsMC41LTAuMQoJCWMwLjUsMCwwLjksMC4zLDEuMSwwLjdjMS41LDMuMSwyLjgsNi44LDMuNCwxMGMwLDAuMSwwLDAuMywwLDAuNGMwLDAuNi0wLjMsMS0wLjksMS4yYy0wLjIsMC0wLjMsMC4xLTAuNSwwLjFjLTAuNiwwLTEtMC4zLTEuMS0xCgkJYy0wLjYtMy4yLTEuOC02LjgtMy4yLTkuN0M2MjguOSw1OTMuOSw2MjguOSw1OTMuNyw2MjguOSw1OTMuNnoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik02NDQuNiw1OTEuMWMyLjUtMS45LDQuMy0yLjgsNi40LTIuOGMyLjMsMCw0LjEsMSw0LjUsNGMyLjktMS4xLDUuNy0yLDgtMi43YzAuMiwwLDAuNC0wLjEsMC42LTAuMQoJCWMwLjYsMCwxLDAuMywxLjIsMC45YzAsMC4yLDAuMSwwLjQsMC4xLDAuNWMwLDAuNi0wLjMsMS4xLTEsMS4yYy0yLjQsMC42LTUuNCwxLjUtOC41LDIuN2MwLjEsMS4yLDAuMSwyLjQsMC4xLDMuNgoJCWMwLDAuNiwwLDEuMywwLDEuOWMwLDAuOC0wLjYsMS4zLTEuMywxLjNzLTEuMi0wLjQtMS4yLTEuM2MwLTAuOSwwLTIsMC0zLjFjMC0wLjUsMC0xLjEsMC0xLjZjLTQuNSwxLjgtNi41LDMuOS02LjUsNS45CgkJczIuMSwzLDYuNywzYzMuMSwwLDYuNC0wLjMsOC44LTAuN2MwLjIsMCwwLjMsMCwwLjUsMGMwLjYsMCwxLjEsMC4zLDEuMiwxYzAsMC4xLDAsMC4yLDAsMC4zYzAsMC43LTAuNSwxLjMtMS4yLDEuNAoJCWMtMi40LDAuNC01LjYsMC43LTksMC43Yy02LjEsMC05LjUtMS44LTkuNS01LjZjMC0zLjIsMy02LjQsOS04LjZjLTAuMi0yLjEtMS4yLTIuNi0yLjYtMi42Yy0yLjgsMC02LjMsMi4yLTEwLjIsNi40CgkJYy0wLjMsMC4zLTAuNywwLjUtMSwwLjVzLTAuNi0wLjEtMC45LTAuNGMtMC4zLTAuMy0wLjQtMC42LTAuNC0xczAuMi0wLjgsMC41LTEuMWMyLjgtMi43LDUuNi02LjIsNy43LTkuN2MtMC41LDAtMSwwLTEuNSwwCgkJYy0xLjYsMC0zLjUsMC00LjktMC4xYy0wLjcsMC0xLjEtMC42LTEuMS0xLjJ2LTAuMWMwLjEtMC43LDAuNS0xLjIsMS4yLTEuMmgwLjFjMS41LDAuMSwzLjYsMC4yLDUuNywwLjJjMC42LDAsMS4yLDAsMS44LDAKCQljMC42LTEuMiwxLjItMi41LDEuNi0zLjdjMC4yLTAuNywwLjctMSwxLjItMWMwLjIsMCwwLjMsMCwwLjUsMC4xYzAuNiwwLjEsMSwwLjUsMSwxYzAsMC4yLDAsMC40LTAuMSwwLjZjLTAuNCwxLTAuOCwxLjktMS4zLDIuOQoJCWMyLjgtMC4xLDYuNi0wLjUsMTAuMi0xYzAuMSwwLDAuMiwwLDAuMywwYzAuNiwwLDEuMSwwLjQsMS4yLDEuMWMwLDAuMSwwLDAuMSwwLDAuMmMwLDAuNi0wLjQsMS4xLTEuMSwxLjIKCQljLTQuMSwwLjYtOC4xLDEtMTEuOCwxLjFjLTEuMywyLjItMi44LDQuMy00LjQsNS44TDY0NC42LDU5MS4xeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTY3NC4yLDYwNy43YzAsMC42LTAuNSwwLjktMS4yLDAuOXMtMS4yLTAuMy0xLjItMC45di0xNGMwLTEuNCwwLjItMi45LDAuNC00LjRjLTAuNywxLjUtMS42LDIuOC0yLjMsMy44CgkJYy0wLjIsMC4zLTAuNiwwLjUtMC45LDAuNWMtMC4zLDAtMC42LTAuMS0wLjktMC40Yy0wLjMtMC4zLTAuNS0wLjYtMC41LTFjMC0wLjMsMC4xLTAuNiwwLjMtMC44YzMtMy41LDUuNC04LjQsNi42LTEzCgkJYzAuMi0wLjYsMC42LTAuOSwxLjEtMC45YzAuMiwwLDAuMywwLDAuNSwwLjFjMC42LDAuMiwwLjksMC42LDAuOSwxLjFjMCwwLjEsMCwwLjMtMC4xLDAuNGMtMC43LDIuMi0xLjcsNC42LTIuNyw2LjdMNjc0LjIsNjA3LjcKCQlMNjc0LjIsNjA3Ljd6IE02ODguNyw2MDQuM2MwLjEsMCwwLjIsMCwwLjMsMC4xYzEuNSwwLjMsMy4zLDAuNSw1LjQsMC41YzAuOSwwLDEuOCwwLDIuOS0wLjFjMCwwLDAsMCwwLjEsMGMwLjcsMCwxLjEsMC41LDEuMSwxLjQKCQljMCwwLjgtMC41LDEuMy0xLjMsMS4zYy0wLjYsMC0xLjMsMC0xLjksMGMtMi41LDAtNC44LTAuMi02LjgtMC42Yy0zLjMtMC43LTYtMi43LTcuNi01LjZjLTAuNywyLjQtMS44LDQuNi0zLDYuMwoJCWMtMC4zLDAuNC0wLjYsMC42LTEsMC42Yy0wLjIsMC0wLjUtMC4xLTAuNy0wLjJjLTAuNC0wLjItMC42LTAuNi0wLjYtMS4xYzAtMC4zLDAuMS0wLjYsMC4zLTAuOGMyLjQtMy4xLDMuOC03LjYsNC4xLTEyLjYKCQljMC0wLjcsMC40LTEsMS4xLTFjMC4xLDAsMC4xLDAsMC4yLDBjMC42LDAuMSwxLjEsMC41LDEuMSwxLjF2MC4xYy0wLjEsMS42LTAuNCwzLjEtMC43LDQuN2MxLjEsMi4yLDIuNiw0LjEsNC44LDUuMXYtMTMuNGgtNC42CgkJYy0xLjksMC0yLjktMC43LTIuOS0yLjh2LTUuN2MwLTIuMSwwLjktMi44LDIuOS0yLjhoMTEuNmMyLDAsMi45LDAuNywyLjksMi44djUuN2MwLDIuMS0wLjksMi44LTIuOSwyLjhoLTQuNnY1aDcuNgoJCWMwLjYsMCwwLjksMC41LDAuOSwxLjJzLTAuMywxLjItMC45LDEuMmgtNy42djYuOEg2ODguN3ogTTY5Mi43LDU4Ny43YzAuNywwLDEtMC4yLDEtMC45di00LjdjMC0wLjctMC4zLTAuOS0xLTAuOWgtMTAuNQoJCWMtMC42LDAtMSwwLjItMSwwLjl2NC43YzAsMC43LDAuMywwLjksMSwwLjlINjkyLjd6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNzA3LjMsNTgwLjJMNzA3LjMsNTgwLjJjLTAuMiw1LjEtMC40LDExLTAuNCwxNi41YzAsMy4yLDAuNCw0LjksMS40LDZjMS4xLDEsMi43LDEuNCw0LjksMS40CgkJYzIuNSwwLDUtMC44LDYuOS0yLjljMS41LTEuNiwyLjctMy45LDMuNC02LjdjMC4yLTAuOCwwLjctMS4xLDEuMi0xLjFjMC4yLDAsMC40LDAsMC41LDAuMWMwLjYsMC4yLDEsMC43LDEsMS40CgkJYzAsMC4yLDAsMC40LTAuMSwwLjZjLTEsMy40LTIuNCw2LjEtNC4zLDguMWMtMi40LDIuNC01LjQsMy42LTguOCwzLjZjLTMsMC01LjMtMC43LTYuOS0yLjNjLTEuNS0xLjUtMi4yLTMuNy0yLjItOAoJCWMwLTUuMiwwLjItMTEuNSwwLjQtMTYuNWMwLTAuOSwwLjYtMS40LDEuNC0xLjRjMCwwLDAsMCwwLjEsMEM3MDYuOSw1NzguOSw3MDcuMyw1NzkuNCw3MDcuMyw1ODAuMnoiLz4KPC9nPgo8ZyBjbGFzcz0ic3QzIj4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik03MzcuNiw1OTkuNGMwLjQsMCwwLjcsMC4xLDEsMC40YzEuOCwxLjUsNC4xLDQsNS40LDZjMC4yLDAuMywwLjMsMC43LDAuMywxYzAsMC40LTAuMiwwLjgtMC42LDEuMQoJCWMtMC4zLDAuMi0wLjYsMC40LTEsMC40Yy0wLjUsMC0wLjktMC4yLTEuMi0wLjdjLTEuMi0xLjgtMy4yLTQuMi01LjEtNS45Yy0wLjItMC4yLTAuNC0wLjUtMC40LTAuOGMwLTAuNCwwLjItMC44LDAuNS0xLjEKCQlDNzM2LjksNTk5LjYsNzM3LjIsNTk5LjQsNzM3LjYsNTk5LjR6Ii8+CjwvZz4KPGcgY2xhc3M9InN0MyI+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNDEyLjEsNjM3LjdjLTAuNiwwLTAuOS0wLjUtMC45LTEuMXMwLjMtMS4xLDAuOS0xLjFoNC40di0xMS44YzAtMS45LDAuOS0yLjcsMi45LTIuN2gxNy44CgkJYzAuNiwwLDAuOSwwLjUsMC45LDEuMXMtMC4zLDEuMS0wLjksMS4xSDQyMGMtMC42LDAtMC45LDAuMi0wLjksMC44djEuOEg0MzZjMC41LDAsMC44LDAuNSwwLjgsMS4xcy0wLjMsMS4xLTAuOCwxLjFoLTE2Ljl2Mi41aDE3CgkJYzAuNSwwLDAuOCwwLjUsMC44LDEuMXMtMC4zLDEuMS0wLjgsMS4xaC0xN3YyLjdoMjEuMWMwLjYsMCwwLjksMC41LDAuOSwxLjFjMCwwLjctMC4zLDEuMS0wLjksMS4xaC0xNC42YzEuMSwyLDIuNSwzLjcsNC4yLDUuMQoJCWMyLTEuMiwzLjktMi44LDUuMS00LjJjMC4yLTAuMiwwLjYtMC40LDAuOS0wLjRzMC42LDAuMSwwLjgsMC4yYzAuNSwwLjMsMC42LDAuNywwLjYsMWMwLDAuMi0wLjEsMC40LTAuMiwwLjYKCQljLTEuNSwxLjUtMy4zLDMtNS4yLDQuMmMyLjUsMS42LDUuMywyLjcsOC4xLDMuNWMwLjYsMC4yLDAuOSwwLjYsMC45LDEuMmMwLDAuMiwwLDAuMy0wLjEsMC41Yy0wLjIsMC43LTAuNywxLTEuMywxCgkJYy0wLjEsMC0wLjMsMC0wLjQsMGMtNi4xLTEuNy0xMy01LjgtMTYuMi0xMi44SDQxOXY5LjFjMi4yLTAuNiw0LjMtMS4yLDYuMi0xLjljMC4xLDAsMC4zLTAuMSwwLjQtMC4xYzAuNSwwLDAuOCwwLjMsMSwwLjgKCQljMCwwLjIsMC4xLDAuMywwLjEsMC41YzAsMC41LTAuMywwLjgtMC43LDFjLTMuOSwxLjUtOC44LDIuOC0xMi44LDMuNWMtMC4xLDAtMC4yLDAtMC4yLDBjLTAuNiwwLTEtMC40LTEuMS0xLjFjMC0wLjEsMC0wLjIsMC0wLjMKCQljMC0wLjYsMC40LTEuMSwwLjktMS4yYzEuMi0wLjIsMi41LTAuNCwzLjktMC43di05LjdoLTQuNlY2MzcuN3oiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik00NTksNjIzLjNjMC42LDAsMC45LDAuNCwwLjksMS4xYzAsMC43LTAuMywxLjEtMC45LDEuMWgtMS42djE0LjZoMS42YzAuNiwwLDAuOSwwLjQsMC45LDEuMQoJCWMwLDAuNy0wLjMsMS4xLTAuOSwxLjFoLTE0LjZjLTAuNiwwLTAuOS0wLjQtMC45LTEuMWMwLTAuNywwLjMtMS4xLDAuOS0xLjFoMnYtMTQuNmgtMS44Yy0wLjYsMC0wLjktMC40LTAuOS0xLjEKCQljMC0wLjcsMC4zLTEuMSwwLjktMS4xaDEuOHYtMi45YzAtMC42LDAuNC0wLjksMS4yLTAuOWMwLjcsMCwxLjEsMC4zLDEuMSwwLjl2Mi45aDYuNHYtMi45YzAtMC42LDAuNC0wLjksMS4xLTAuOXMxLjIsMC4zLDEuMiwwLjkKCQl2Mi45SDQ1OXogTTQ0OC4xLDY0NC4xYzAuMi0wLjQsMC42LTAuNSwwLjktMC41YzAuMiwwLDAuNSwwLjEsMC43LDAuMmMwLjQsMC4yLDAuNiwwLjYsMC42LDFjMCwwLjItMC4xLDAuNC0wLjIsMC43CgkJYy0xLjEsMS45LTIuOSwzLjktNC41LDUuMWMtMC4zLDAuMi0wLjUsMC4zLTAuOCwwLjNjLTAuNCwwLTAuNy0wLjItMC45LTAuNWMtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjhzMC4yLTAuNywwLjYtMQoJCUM0NDUuNSw2NDcuNCw0NDcuMiw2NDUuNiw0NDguMSw2NDQuMXogTTQ0OC42LDYyOC45aDYuNHYtMy4zaC02LjRWNjI4Ljl6IE00NDguNiw2MzQuM2g2LjRWNjMxaC02LjRWNjM0LjN6IE00NDguNiw2NDAuMmg2LjR2LTMuOAoJCWgtNi40VjY0MC4yeiBNNDU0LjQsNjQzLjRjMC40LDAsMC43LDAuMiwwLjksMC42YzAuNSwwLjcsMS40LDEuOCwyLDIuM2MwLjQsMC4zLDAuNSwwLjYsMC41LDFjMCwwLjMtMC4xLDAuNS0wLjMsMC43CgkJYy0wLjMsMC4zLTAuNiwwLjQtMC44LDAuNGMtMC4zLDAtMC42LTAuMS0wLjgtMC40Yy0wLjgtMC43LTEuOC0xLjktMi40LTIuOWMtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjdjMC0wLjMsMC4yLTAuNiwwLjUtMC44CgkJQzQ1My45LDY0My41LDQ1NC4xLDY0My40LDQ1NC40LDY0My40eiBNNDYzLjQsNjM5LjVjLTAuNSw0LjgtMS41LDgtMy4yLDEwLjVjLTAuMywwLjQtMC42LDAuNi0xLjEsMC42Yy0wLjMsMC0wLjUtMC4xLTAuOC0wLjMKCQljLTAuNC0wLjMtMC42LTAuNi0wLjYtMWMwLTAuMywwLjEtMC41LDAuMy0wLjhjMi4xLTMsMy4xLTYuOSwzLjItMTUuMWMwLTMuNCwwLTcsMC0xMC4xYzAtMiwwLjgtMi43LDIuNy0yLjdoNS44CgkJYzEuOSwwLDIuOCwwLjcsMi44LDIuN1Y2NDdjMCwyLjUtMSwzLjMtMy40LDMuM2MtMS4xLDAtMi4yLTAuMS0yLjktMC4zYy0wLjYtMC4yLTAuOS0wLjUtMC45LTEuMWMwLTAuMSwwLTAuMywwLTAuNAoJCWMwLjItMC43LDAuNi0xLDEtMWMwLjEsMCwwLjIsMCwwLjMsMGMwLjYsMC4xLDEuNCwwLjMsMi4xLDAuM2MxLjIsMCwxLjQtMC4yLDEuNC0xLjN2LTcuMmgtNi43VjYzOS41eiBNNDYzLjcsNjMxLjIKCQljMCwwLjksMCwxLjksMCwyLjhjMCwxLjEsMCwyLjItMC4xLDMuMmg2LjZ2LTZINDYzLjd6IE00NzAuMiw2MjMuOWMwLTAuNy0wLjMtMC44LTAuOS0wLjhoLTQuNmMtMC42LDAtMSwwLjItMSwwLjgKCQljMCwxLjUsMCwzLjIsMCw1LjFoNi41VjYyMy45eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTQ4NS40LDYyNC41YzEuOCwwLDIuNywwLjcsMi43LDIuNnYxOC42YzAsMS45LTAuOSwyLjctMi43LDIuN2gtNS42Yy0xLjgsMC0yLjgtMC44LTIuOC0yLjd2LTE4LjYKCQljMC0xLjksMC45LTIuNiwyLjgtMi42aDEuMWMwLjUtMS40LDAuOS0yLjksMS4yLTQuMWMwLjEtMC41LDAuNS0wLjgsMS4xLTAuOGMwLjEsMCwwLjMsMCwwLjQsMGMwLjcsMC4xLDEsMC41LDEsMQoJCWMwLDAuMSwwLDAuMiwwLDAuM2MtMC4zLDEuMS0wLjcsMi41LTEuMiwzLjZINDg1LjR6IE00ODUuNiw2MzQuN3YtNy4xYzAtMC43LTAuMy0wLjktMC45LTAuOWgtNC4yYy0wLjYsMC0xLDAuMi0xLDAuOXY3LjFINDg1LjZ6CgkJIE00NzkuNSw2NDUuMmMwLDAuOCwwLjMsMC45LDEsMC45aDQuMmMwLjYsMCwwLjktMC4yLDAuOS0wLjlWNjM3aC02LjJ2OC4ySDQ3OS41eiBNNDkzLjYsNjI2LjljLTAuOCwxLjctMS43LDMuMy0yLjcsNC41CgkJYy0wLjMsMC4zLTAuNiwwLjUtMSwwLjVjLTAuMywwLTAuNy0wLjEtMC45LTAuM2MtMC4yLTAuMi0wLjQtMC41LTAuNC0wLjlzMC4xLTAuNywwLjQtMC45YzEuNy0yLjEsMy40LTUuOCw0LjItOS4zCgkJYzAuMi0wLjYsMC42LTAuOSwxLjEtMC45YzAuMSwwLDAuMywwLDAuNCwwYzAuNSwwLjEsMC45LDAuNSwwLjksMS4xYzAsMC4xLDAsMC4yLDAsMC40Yy0wLjMsMS4xLTAuNiwyLjItMSwzLjRoNy44CgkJYzIsMCwyLjksMC45LDIuOSwzYzAsMC4yLDAsMC41LDAsMC43YzAsOS43LTAuNywxNS44LTEuNywxOS4zYy0wLjcsMi4yLTIuMSwzLTQuNCwzYy0xLjQsMC0yLjktMC4yLTQtMC41CgkJYy0wLjUtMC4xLTAuOC0wLjYtMC44LTEuMmMwLTAuMSwwLTAuMywwLjEtMC41YzAuMi0wLjYsMC42LTAuOSwxLjEtMC45YzAuMSwwLDAuMywwLDAuNCwwLjFjMC44LDAuMywxLjksMC40LDMuMSwwLjQKCQljMS40LDAsMi0wLjMsMi40LTEuOWMwLjgtMi45LDEuNC05LDEuNC0xOGMwLTAuOC0wLjMtMS0xLjEtMUw0OTMuNiw2MjYuOUw0OTMuNiw2MjYuOXogTTQ5My42LDYzMS40YzAuMywwLDAuNiwwLjEsMC44LDAuNAoJCWMxLjYsMiwzLjIsNC45LDQuMiw3LjFjMC4xLDAuMiwwLjEsMC40LDAuMSwwLjZjMCwwLjUtMC4yLDAuOS0wLjcsMS4xYy0wLjIsMC4xLTAuNSwwLjItMC43LDAuMmMtMC40LDAtMC44LTAuMi0xLjEtMC44CgkJYy0wLjgtMS45LTIuMy00LjgtMy43LTYuN2MtMC4yLTAuMi0wLjMtMC41LTAuMy0wLjdjMC0wLjMsMC4yLTAuNywwLjUtMC45QzQ5Myw2MzEuNSw0OTMuMyw2MzEuNCw0OTMuNiw2MzEuNHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01MTEuNyw2NDMuOGMtMC4zLDAuNi0wLjcsMC45LTEuMiwwLjljLTAuMywwLTAuNi0wLjEtMC45LTAuM2MtMC40LTAuMy0wLjYtMC43LTAuNi0xLjFjMC0wLjMsMC4xLTAuNywwLjMtMQoJCWMyLjItNCw0LjQtOC44LDUuNy0xMy4zYy0xLjIsMC4xLTIuNSwwLjEtMy43LDAuMWMtMC40LDAtMC44LDAtMS4yLDBjLTAuNywwLTEuMS0wLjUtMS4xLTEuM3MwLjUtMS4zLDEuMi0xLjNjMC41LDAsMC45LDAsMS40LDAKCQljMS40LDAsMi45LDAsNC4yLTAuMWMwLjUtMS43LDAuOC0zLjMsMS4yLTUuMWMwLjEtMC43LDAuNi0xLjEsMS4yLTEuMWMwLjEsMCwwLjIsMCwwLjMsMGMwLjcsMC4xLDEuMSwwLjUsMS4xLDEuMgoJCWMwLDAuMSwwLDAuMywwLDAuNGMtMC4zLDEuNC0wLjYsMi44LTEsNC4zYzEuNi0wLjEsMy4xLTAuMyw0LjUtMC41YzAuMSwwLDAuMiwwLDAuMywwYzAuNiwwLDEsMC40LDEuMiwxLjFjMCwwLjEsMCwwLjEsMCwwLjIKCQljMCwwLjYtMC40LDEuMS0xLjIsMS4zYy0xLjcsMC4zLTMuNiwwLjQtNS41LDAuNkM1MTYuMiw2MzQsNTE0LjEsNjM5LjMsNTExLjcsNjQzLjh6IE01MzYuMiw2NDQuNWMwLjMsMC4zLDAuNSwwLjcsMC41LDEuMQoJCWMwLDAuMy0wLjEsMC43LTAuNCwwLjljLTAuMywwLjMtMC42LDAuNS0wLjksMC41cy0wLjctMC4yLTEtMC40Yy0xLjMtMS4zLTIuOS0yLjctNC4yLTMuNWMwLjEsMC40LDAuMSwwLjgsMC4xLDEuMQoJCWMtMC4yLDMuNy0yLjQsNS40LTYuOCw1LjRjLTQuMSwwLTYuNy0yLjItNi43LTUuNHMyLjgtNS42LDYuOC01LjZjMS40LDAsMi43LDAuMiw0LDAuNmMtMC4yLTEuOS0wLjQtNC42LTAuNC02LjgKCQljMC0xLDAuNi0xLjQsMS4zLTEuNGMwLjgsMCwxLjMsMC40LDEuMywxLjRjMCwyLjksMC4xLDUuMywwLjQsNy43QzUzMi4zLDY0MS4zLDUzNC42LDY0Mi44LDUzNi4yLDY0NC41eiBNNTIzLjYsNjQxLjEKCQljLTIuNiwwLTQuMywxLjMtNC4zLDMuMWMwLDEuOSwxLjYsMi45LDQuMiwyLjljMi44LDAsNC4yLTEuMSw0LjItMy41YzAtMC41LDAtMS0wLjEtMS43QzUyNi40LDY0MS40LDUyNSw2NDEuMSw1MjMuNiw2NDEuMXoKCQkgTTUzNS44LDYyOC43YzAuNSwwLjMsMC42LDAuOCwwLjYsMS4yYzAsMC4zLTAuMSwwLjUtMC4yLDAuOGMtMC4zLDAuNC0wLjcsMC42LTEuMSwwLjZjLTAuMywwLTAuNi0wLjEtMC44LTAuMwoJCWMtMS45LTEuNC00LjMtMi43LTYuOC0zLjdjLTAuNC0wLjItMC42LTAuNi0wLjYtMWMwLTAuMywwLjEtMC41LDAuMi0wLjhjMC4zLTAuNSwwLjctMC43LDEuMi0wLjdjMC4yLDAsMC40LDAsMC42LDAuMQoJCUM1MzEuNCw2MjYsNTM0LDYyNy40LDUzNS44LDYyOC43eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTU1OC40LDYyNy4zYzAuMiw0LjEsMC42LDcuNSwxLjUsMTAuNGMwLjIsMC42LDAuMywxLjEsMC42LDEuN2MxLjYtMi41LDIuOS01LjIsMy44LTguMwoJCWMwLjItMC41LDAuNS0wLjcsMC45LTAuN2MwLjIsMCwwLjQsMCwwLjYsMC4xYzAuNiwwLjIsMC44LDAuNSwwLjgsMWMwLDAuMiwwLDAuMy0wLjEsMC41Yy0xLjEsMy43LTIuOSw3LjEtNSwxMAoJCWMxLDIuMSwyLjIsMy44LDMuNSw0LjhjMC40LDAuMywwLjcsMC40LDAuOSwwLjRjMC4zLDAsMC41LTAuMiwwLjYtMC42YzAuMi0wLjYsMC41LTEuOSwwLjYtMy4yYzAuMS0wLjcsMC41LTEsMS4yLTFoMC4xCgkJYzAuNywwLDEuMSwwLjUsMS4xLDEuMWMwLDAsMCwwLDAsMC4xYy0wLjEsMS45LTAuNiw0LTEuMyw1LjJjLTAuNiwwLjktMS4zLDEuNC0yLjEsMS40Yy0wLjcsMC0xLjUtMC40LTIuNC0xCgkJYy0xLjQtMS4xLTIuNy0yLjktMy45LTVjLTIuMywyLjUtNSw0LjYtNy45LDYuMWMtMC4zLDAuMS0wLjUsMC4yLTAuOCwwLjJjLTAuNCwwLTAuOC0wLjItMS0wLjZjLTAuMi0wLjMtMC4yLTAuNS0wLjItMC44CgkJYzAtMC40LDAuMi0wLjgsMC43LTFjMy4xLTEuNSw1LjktMy43LDguMS02LjRjLTAuNC0wLjktMC43LTEuOS0xLTIuOWMtMC45LTMuMS0xLjQtNi45LTEuNy0xMS41aC0xMC4xYy0wLjksMC0xLjIsMC40LTEuMiwxLjN2NGg2CgkJYzEuOCwwLDIuNywwLjksMi43LDIuOGMwLDIuNS0wLjQsNS45LTAuOCw3LjdjLTAuNSwyLjEtMS42LDIuNi0zLjYsMi42Yy0wLjgsMC0yLjEtMC4xLTIuOS0wLjNjLTAuNi0wLjItMC45LTAuNS0wLjktMS4xCgkJYzAtMC4xLDAtMC4zLDAuMS0wLjRjMC4xLTAuNiwwLjUtMC44LDAuOS0wLjhjMC4xLDAsMC4zLDAsMC40LDAuMWMwLjYsMC4xLDEuNSwwLjIsMi4xLDAuMmMxLjEsMCwxLjQtMC4yLDEuNi0xCgkJYzAuNC0xLjcsMC42LTQuMiwwLjYtNi40YzAtMC43LTAuMy0wLjktMS0wLjloLTUuM2MtMC4xLDUuOS0xLDEwLjYtMywxNC43Yy0wLjIsMC42LTAuNiwwLjgtMS4xLDAuOGMtMC4zLDAtMC42LTAuMS0wLjgtMC4yCgkJYy0wLjQtMC4yLTAuNi0wLjUtMC42LTAuOWMwLTAuMiwwLjEtMC41LDAuMi0wLjhjMi4yLTQuNCwyLjktOS4yLDIuOS0xNi42VjYyOGMwLTIuMSwxLTMuMSwzLTMuMUg1NTZjMC0xLjQtMC4xLTIuNy0wLjEtNC4yCgkJYzAtMC42LDAuNS0xLDEuMi0xczEuMiwwLjMsMS4yLDFjMCwxLjUsMCwyLjksMC4xLDQuMmg5LjljMC42LDAsMC45LDAuNSwwLjksMS4ycy0wLjMsMS4yLTAuOSwxLjJMNTU4LjQsNjI3LjNMNTU4LjQsNjI3LjN6CgkJIE01NjYuMSw2MjIuNGMwLjMsMC4zLDAuNSwwLjYsMC41LDAuOWMwLDAuMy0wLjEsMC41LTAuMywwLjdjLTAuMiwwLjMtMC42LDAuNS0wLjksMC41Yy0wLjMsMC0wLjUtMC4xLTAuOC0wLjMKCQljLTEtMC44LTIuMy0xLjgtMy4zLTIuNGMtMC40LTAuMi0wLjUtMC41LTAuNS0wLjljMC0wLjIsMC4xLTAuNSwwLjItMC43YzAuMi0wLjMsMC42LTAuNSwwLjktMC41YzAuMiwwLDAuNCwwLjEsMC42LDAuMgoJCUM1NjMuNiw2MjAuNSw1NjUuMSw2MjEuNSw1NjYuMSw2MjIuNHoiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik01NzIuOCw2MzcuN2MtMC42LDAtMC45LTAuNS0wLjktMS4xczAuMy0xLjEsMC45LTEuMWg0LjR2LTExLjhjMC0xLjksMC45LTIuNywyLjktMi43aDE3LjgKCQljMC42LDAsMC45LDAuNSwwLjksMS4xcy0wLjMsMS4xLTAuOSwxLjFoLTE3LjJjLTAuNiwwLTAuOSwwLjItMC45LDAuOHYxLjhoMTYuOWMwLjUsMCwwLjgsMC41LDAuOCwxLjFzLTAuMywxLjEtMC44LDEuMWgtMTYuOXYyLjUKCQloMTdjMC41LDAsMC44LDAuNSwwLjgsMS4xcy0wLjMsMS4xLTAuOCwxLjFoLTE3djIuN2gyMS4xYzAuNiwwLDAuOSwwLjUsMC45LDEuMWMwLDAuNy0wLjMsMS4xLTAuOSwxLjFoLTE0LjYKCQljMS4xLDIsMi41LDMuNyw0LjIsNS4xYzItMS4yLDMuOS0yLjgsNS4xLTQuMmMwLjItMC4yLDAuNi0wLjQsMC45LTAuNGMwLjMsMCwwLjYsMC4xLDAuOCwwLjJjMC41LDAuMywwLjYsMC43LDAuNiwxCgkJYzAsMC4yLTAuMSwwLjQtMC4yLDAuNmMtMS41LDEuNS0zLjMsMy01LjIsNC4yYzIuNSwxLjYsNS4zLDIuNyw4LjEsMy41YzAuNiwwLjIsMC45LDAuNiwwLjksMS4yYzAsMC4yLDAsMC4zLTAuMSwwLjUKCQljLTAuMiwwLjctMC43LDEtMS4zLDFjLTAuMSwwLTAuMywwLTAuNCwwYy02LjEtMS43LTEzLTUuOC0xNi4yLTEyLjhoLTMuOHY5LjFjMi4yLTAuNiw0LjMtMS4yLDYuMi0xLjljMC4xLDAsMC4zLTAuMSwwLjQtMC4xCgkJYzAuNSwwLDAuOCwwLjMsMSwwLjhjMCwwLjIsMC4xLDAuMywwLjEsMC41YzAsMC41LTAuMywwLjgtMC43LDFjLTMuOSwxLjUtOC44LDIuOC0xMi44LDMuNWMtMC4xLDAtMC4yLDAtMC4yLDAKCQljLTAuNiwwLTEtMC40LTEuMS0xLjFjMC0wLjEsMC0wLjIsMC0wLjNjMC0wLjYsMC40LTEuMSwwLjktMS4yYzEuMi0wLjIsMi41LTAuNCwzLjktMC43di05LjdoLTQuNlY2MzcuN3oiLz4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik02MTEuNiw2MzMuM2MyLjUtMS45LDQuMy0yLjgsNi40LTIuOGMyLjMsMCw0LjEsMSw0LjUsNGMyLjktMS4xLDUuNy0yLDgtMi43YzAuMiwwLDAuNC0wLjEsMC42LTAuMQoJCWMwLjYsMCwxLDAuMywxLjIsMC45YzAsMC4yLDAuMSwwLjQsMC4xLDAuNWMwLDAuNi0wLjMsMS4xLTEsMS4yYy0yLjQsMC42LTUuNCwxLjUtOC41LDIuN2MwLjEsMS4yLDAuMSwyLjQsMC4xLDMuNgoJCWMwLDAuNiwwLDEuMywwLDEuOWMwLDAuOC0wLjYsMS4zLTEuMywxLjNzLTEuMi0wLjQtMS4yLTEuM2MwLTAuOSwwLTIsMC0zLjFjMC0wLjUsMC0xLjEsMC0xLjZjLTQuNSwxLjgtNi41LDMuOS02LjUsNS45CgkJczIuMSwzLDYuNywzYzMuMSwwLDYuNC0wLjMsOC44LTAuN2MwLjIsMCwwLjMsMCwwLjUsMGMwLjYsMCwxLjEsMC4zLDEuMiwxYzAsMC4xLDAsMC4yLDAsMC4zYzAsMC43LTAuNSwxLjMtMS4yLDEuNAoJCWMtMi40LDAuNC01LjYsMC43LTksMC43Yy02LjEsMC05LjUtMS44LTkuNS01LjZjMC0zLjIsMy02LjQsOS04LjZjLTAuMi0yLjEtMS4yLTIuNi0yLjYtMi42Yy0yLjgsMC02LjMsMi4yLTEwLjIsNi40CgkJYy0wLjMsMC4zLTAuNywwLjUtMSwwLjVzLTAuNi0wLjEtMC45LTAuNGMtMC4zLTAuMy0wLjQtMC42LTAuNC0xczAuMi0wLjgsMC41LTEuMWMyLjgtMi43LDUuNi02LjIsNy43LTkuN2MtMC41LDAtMSwwLTEuNSwwCgkJYy0xLjYsMC0zLjUsMC00LjktMC4xYy0wLjcsMC0xLjEtMC42LTEuMS0xLjJ2LTAuMWMwLjEtMC43LDAuNS0xLjIsMS4yLTEuMmgwLjFjMS41LDAuMSwzLjYsMC4yLDUuNywwLjJjMC42LDAsMS4yLDAsMS44LDAKCQljMC42LTEuMiwxLjItMi41LDEuNi0zLjdjMC4yLTAuNywwLjctMSwxLjItMWMwLjIsMCwwLjMsMCwwLjUsMC4xYzAuNiwwLjEsMSwwLjUsMSwxYzAsMC4yLDAsMC40LTAuMSwwLjZjLTAuNCwxLTAuOCwxLjktMS4zLDIuOQoJCWMyLjgtMC4xLDYuNi0wLjUsMTAuMi0xYzAuMSwwLDAuMiwwLDAuMywwYzAuNiwwLDEuMSwwLjQsMS4yLDEuMWMwLDAuMSwwLDAuMSwwLDAuMmMwLDAuNi0wLjQsMS4xLTEuMSwxLjIKCQljLTQuMSwwLjYtOC4xLDEtMTEuOCwxLjFjLTEuMywyLjItMi44LDQuMy00LjQsNS44TDYxMS42LDYzMy4zeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTY1Nyw2MzIuMWMxLjcsMCwyLjYsMC45LDIuNiwyLjFjMCwwLjUtMC4yLDEuMS0wLjYsMS44Yy0xLjYsMi43LTMuOSw1LjItNi42LDcuNGMzLjMsMi4xLDcuMSwzLjYsMTEuMiw0LjQKCQljMC43LDAuMSwxLDAuNiwxLDEuMmMwLDAuMiwwLDAuMy0wLjEsMC41Yy0wLjIsMC44LTAuNiwxLjItMS4zLDEuMmMtMC4yLDAtMC4zLDAtMC41LTAuMWMtNC40LTEtOC44LTIuOS0xMi41LTUuNwoJCWMtMy45LDIuNi04LjMsNC42LTEzLDUuNmMtMC4yLDAtMC4zLDAtMC41LDBjLTAuNiwwLTEuMi0wLjMtMS4zLTFjMC0wLjItMC4xLTAuMy0wLjEtMC40YzAtMC43LDAuNC0xLjIsMS4xLTEuMwoJCWM0LjEtMC45LDguMS0yLjUsMTEuNi00LjZjLTEuOC0xLjYtMy40LTMuNS00LjctNS41Yy0wLjctMS0xLjItMi4yLTEuNy0zLjNoLTMuM2MtMC42LDAtMC45LTAuNS0wLjktMS4yczAuMy0xLjIsMC45LTEuMmgxMHYtNQoJCWgtMTEuOWMtMC42LDAtMS0wLjUtMS0xLjJzMC40LTEuMiwxLTEuMmgxMS45di00YzAtMC42LDAuNS0xLDEuMi0xYzAuOCwwLDEuMiwwLjQsMS4yLDF2NGgxMi41YzAuNiwwLDEsMC41LDEsMS4ycy0wLjQsMS4yLTEsMS4yCgkJaC0xMi41djVMNjU3LDYzMi4xTDY1Nyw2MzIuMXogTTY0NC40LDYzNC40YzEuMywzLDMuNCw1LjQsNS45LDcuNGMyLjUtMS45LDQuNy00LjEsNi4yLTYuNWMwLjEtMC4yLDAuMi0wLjQsMC4yLTAuNQoJCWMwLTAuMy0wLjItMC40LTAuNy0wLjRINjQ0LjR6Ii8+Cgk8cGF0aCBjbGFzcz0ic3Q0IiBkPSJNNjc2LDYyNi4yYzAuNiwwLDAuOSwwLjUsMC45LDEuMWMwLDAuNy0wLjMsMS4yLTAuOSwxLjJoLTIuMnY1LjljMC41LTAuMywxLTAuNSwxLjUtMC44CgkJYzAuMi0wLjEsMC40LTAuMSwwLjUtMC4xYzAuNCwwLDAuNywwLjIsMC44LDAuNmMwLjEsMC4yLDAuMSwwLjQsMC4xLDAuNmMwLDAuNC0wLjIsMC44LTAuNiwxYy0wLjcsMC40LTEuNSwwLjgtMi4zLDEuMnYxMC43CgkJYzAsMi4xLTAuOCwyLjktMywyLjljLTAuOCwwLTEuNi0wLjEtMi4xLTAuMmMtMC41LTAuMS0wLjgtMC41LTAuOC0xLjFjMC0wLjEsMC0wLjIsMC0wLjRjMC4xLTAuNiwwLjUtMC44LDAuOS0wLjgKCQljMC4xLDAsMC4xLDAsMC4yLDBjMC41LDAuMSwxLjEsMC4yLDEuNiwwLjJjMC44LDAsMC45LTAuMSwwLjktMVY2MzhjLTEsMC40LTEuOSwwLjgtMi44LDEuMWMtMC4yLDAtMC4zLDAuMS0wLjUsMC4xCgkJYy0wLjUsMC0wLjgtMC4zLTEtMC45Yy0wLjEtMC4yLTAuMS0wLjQtMC4xLTAuNWMwLTAuNSwwLjMtMC45LDAuNy0xYzEuMS0wLjQsMi40LTAuOCwzLjYtMS4zdi03aC0zLjJjLTAuNiwwLTAuOS0wLjUtMC45LTEuMQoJCWMwLTAuNywwLjMtMS4yLDAuOS0xLjJoMy4ydi01LjdjMC0wLjYsMC41LTEsMS4yLTFzMS4yLDAuMywxLjIsMXY1LjdMNjc2LDYyNi4yTDY3Niw2MjYuMnogTTY5Mi44LDYzOC43YzEuNSwwLDIuMiwwLjYsMi4yLDEuNgoJCWMwLDAuNS0wLjIsMS4xLTAuNywxLjhjLTEuMSwxLjUtMi41LDIuOS00LDQuMWMxLjksMSw0LjEsMS44LDYuNSwyLjRjMC42LDAuMSwwLjksMC41LDAuOSwxLjFjMCwwLjEsMCwwLjMtMC4xLDAuNQoJCWMtMC4yLDAuNi0wLjYsMC45LTEuMSwwLjljLTAuMSwwLTAuMywwLTAuNC0wLjFjLTMtMC45LTUuNi0yLTcuOS0zLjRjLTIuNCwxLjUtNS4yLDIuNi03LjgsMy4zYy0wLjIsMC0wLjQsMC4xLTAuNSwwLjEKCQljLTAuNSwwLTAuOC0wLjItMS0wLjhjMC0wLjItMC4xLTAuMy0wLjEtMC40YzAtMC41LDAuMy0wLjksMC44LTFjMi4zLTAuNiw0LjYtMS41LDYuNi0yLjVjLTEuNi0xLjItMy0yLjgtNC4yLTQuNQoJCWMtMS40LDMuMy0zLjQsNi4yLTUuNiw4LjRjLTAuMywwLjMtMC42LDAuNC0wLjksMC40Yy0wLjMsMC0wLjYtMC4xLTAuOC0wLjNjLTAuMy0wLjMtMC40LTAuNi0wLjQtMC45czAuMS0wLjYsMC40LTAuOAoJCWMzLjItMyw1LjYtNy4yLDYuNy0xMi4zSDY3OGMtMC41LDAtMC44LTAuNS0wLjgtMS4xczAuMy0xLjEsMC44LTEuMWgzLjhjMC4xLTAuOCwwLjItMS43LDAuMy0yLjZoLTMuN2MtMC41LDAtMC44LTAuNC0wLjgtMQoJCWMwLTAuNSwwLjMtMSwwLjgtMWgxMS45YzEuMi0xLjksMi0zLjcsMi43LTUuM2MwLjItMC41LDAuNi0wLjgsMS0wLjhjMC4yLDAsMC40LDAsMC41LDAuMWMwLjUsMC4yLDAuOCwwLjYsMC44LDEKCQljMCwwLjIsMCwwLjQtMC4xLDAuNWMtMC42LDEuMy0xLjQsMi44LTIuNSw0LjRoMy4yYzAuNSwwLDAuOCwwLjQsMC44LDFzLTAuMywxLTAuOCwxaC0xMS40Yy0wLjEsMC45LTAuMiwxLjctMC4zLDIuNmgxMi4zCgkJYzAuNSwwLDAuOCwwLjUsMC44LDEuMXMtMC4zLDEuMS0wLjgsMS4xaC0xMi43Yy0wLjIsMC45LTAuNSwxLjgtMC43LDIuNkw2OTIuOCw2MzguN0w2OTIuOCw2MzguN3ogTTY5NC44LDYxOS43CgkJYzAuNSwwLDAuOCwwLjMsMSwwLjljMCwwLjIsMC4xLDAuMywwLjEsMC41YzAsMC41LTAuMywwLjktMC44LDFjLTUuMiwxLjItMTEuNSwxLjgtMTcuMSwxLjljLTAuNywwLTEuMS0wLjUtMS4xLTEuMWMwLDAsMCwwLDAtMC4xCgkJYzAtMC42LDAuNC0xLjEsMC45LTEuMWM1LjMsMCwxMS43LTAuNiwxNi43LTEuOUM2OTQuNiw2MTkuNyw2OTQuNyw2MTkuNyw2OTQuOCw2MTkuN3ogTTY4MC4zLDYyNC40YzAuNCwwLDAuNywwLjIsMSwwLjYKCQljMC40LDAuNiwwLjgsMS41LDEuMSwyLjJjMCwwLjIsMC4xLDAuMywwLjEsMC41YzAsMC40LTAuMywwLjctMC43LDAuOWMtMC4yLDAuMS0wLjQsMC4xLTAuNSwwLjFjLTAuNSwwLTAuOC0wLjItMS0wLjcKCQljLTAuMi0wLjYtMC42LTEuNS0xLTIuMWMtMC4xLTAuMi0wLjEtMC4zLTAuMS0wLjVjMC0wLjQsMC4yLTAuNywwLjYtMC45QzY3OS45LDYyNC41LDY4MC4xLDYyNC40LDY4MC4zLDYyNC40eiBNNjgzLjgsNjQwLjcKCQljMS4zLDEuNiwyLjgsMyw0LjQsNC4yYzEuNi0xLDIuOS0yLjIsMy45LTMuNWMwLjEtMC4yLDAuMi0wLjMsMC4yLTAuNGMwLTAuMi0wLjItMC4yLTAuNi0wLjJMNjgzLjgsNjQwLjdMNjgzLjgsNjQwLjd6CgkJIE02ODYuMSw2MjQuMWMwLjQsMCwwLjcsMC4yLDEsMC42YzAuNSwwLjgsMC45LDEuNywxLjEsMi40YzAsMC4yLDAuMSwwLjMsMC4xLDAuNWMwLDAuNS0wLjMsMC44LTAuNywwLjljLTAuMiwwLjEtMC40LDAuMS0wLjUsMC4xCgkJYy0wLjQsMC0wLjctMC4yLTAuOS0wLjdjLTAuMi0wLjctMC42LTEuNi0xLTIuM2MtMC4xLTAuMi0wLjItMC40LTAuMi0wLjVjMC0wLjQsMC4zLTAuNywwLjctMC45CgkJQzY4NS43LDYyNC4xLDY4NS45LDYyNC4xLDY4Ni4xLDYyNC4xeiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTcxNi41LDYzOC4yYy0wLjgsMi45LTIuOCwzLjktNS40LDMuOWMtMy40LDAtNS44LTIuNC01LjgtNS44YzAtMy41LDIuNy02LDYuNC02YzEuNiwwLDIuOSwwLjUsMy45LDEuNgoJCWMwLTEuMiwwLTIuOSwwLTQuNWMtNC44LDAuMS05LjcsMC4zLTE0LjQsMC42aC0wLjFjLTAuNywwLTEuMi0wLjUtMS4yLTEuM3YtMC4xYzAtMC43LDAuNC0xLjIsMS4yLTEuM2M0LjYtMC4zLDkuNi0wLjQsMTQuNi0wLjUKCQljMC0xLjIsMC0yLjQsMC0zLjRjMC0wLjcsMC40LTEuMiwxLjItMS4yYzAuOSwwLDEuNCwwLjQsMS40LDEuM2MwLDAuOSwwLDIuMSwwLDMuM2MxLjgsMCwzLjUtMC4xLDUuMS0wLjFjMS4yLDAsMi4zLDAsMy40LDAKCQljMC45LDAsMS4zLDAuNCwxLjMsMS40djAuMWMwLDAuOC0wLjUsMS4yLTEuMiwxLjJjLTEuOSwwLTMuOS0wLjEtNi0wLjFjLTAuOSwwLTEuOCwwLTIuNywwYzAsMi4zLDAsNC43LDAsNwoJCWMwLjYsMS40LDAuOSwyLjgsMC45LDQuNGMwLDQuNC0xLjgsNy4yLTUuMyw5LjFjLTEuNSwwLjgtMy4yLDEuNC01LjIsMS44Yy0wLjEsMC0wLjIsMC0wLjMsMGMtMC42LDAtMS4yLTAuNC0xLjMtMS4xCgkJYzAtMC4xLDAtMC4zLDAtMC40YzAtMC43LDAuNC0xLjIsMS0xLjRjNS44LTEuMSw4LjctNCw4LjctNy45di0wLjZINzE2LjV6IE03MTEuOSw2MzIuNmMtMi4yLDAtMy45LDEuNS0zLjksMy42CgkJYzAsMi4zLDEuNSwzLjQsMy41LDMuNGMyLjMsMCwzLjgtMS43LDMuOC00LjFDNzE1LjMsNjMzLjgsNzE0LDYzMi42LDcxMS45LDYzMi42eiIvPgoJPHBhdGggY2xhc3M9InN0NCIgZD0iTTc0MCw2MzRjMi41LTEuMiw0LjktMS44LDcuMi0xLjhjNS44LDAsOS40LDMuMiw5LjQsNy44YzAsNS43LTUsOS4zLTEyLjksOS4zYy00LjgsMC03LjktMi4xLTcuOS01LjIKCQljMC0yLjYsMi4xLTQuNiw1LjMtNC42YzMuNSwwLDYuNCwyLjIsNi45LDYuN2MzLjMtMC44LDUuOC0yLjksNS44LTYuMWMwLTMuMi0yLjUtNS41LTcuMS01LjVjLTQuMywwLTguMiwxLjUtMTMuNiw0LjkKCQljLTAuMywwLjItMC42LDAuMi0wLjksMC4yYy0wLjUsMC0wLjktMC4yLTEuMi0wLjZjLTAuMi0wLjItMC4yLTAuNS0wLjItMC43YzAtMC41LDAuMy0xLDAuNy0xLjNjNS40LTMuNCwxMi41LTguOSwxNi42LTEyLjcKCQljLTMuNSwwLjMtOC41LDAuNS0xMi42LDAuNWMtMC43LDAtMS4yLTAuNS0xLjItMS4zczAuNC0xLjQsMS4xLTEuNGM0LjQsMCw5LjktMC4yLDE0LjItMC41YzAuMSwwLDAuMiwwLDAuMywwCgkJYzAuNywwLDEuMywwLjMsMS42LDAuOGMwLjIsMC4zLDAuMywwLjYsMC4zLDFjMCwwLjUtMC4yLDAuOS0wLjYsMS40Yy0yLjgsMi43LTUuOCw1LjEtOC41LDdjLTAuOSwwLjYtMiwxLjQtMi45LDJMNzQwLDYzNHoKCQkgTTc0MSw2NDEuOGMtMS43LDAtMi43LDAuOS0yLjcsMi4yYzAsMS42LDEuOSwyLjgsNC44LDIuOWMwLjgsMCwxLjYsMCwyLjQtMC4xQzc0NS4zLDY0My41LDc0My4yLDY0MS44LDc0MSw2NDEuOHoiLz4KPC9nPgo8ZyBjbGFzcz0ic3QzIj4KCTxwYXRoIGNsYXNzPSJzdDQiIGQ9Ik03NzguNiw2NDUuM2MwLDIuOS0yLjMsNS4zLTUuMSw1LjNzLTUuMS0yLjQtNS4xLTUuM3MyLjMtNS4zLDUuMS01LjNDNzc2LjMsNjQwLjEsNzc4LjYsNjQyLjQsNzc4LjYsNjQ1LjN6CgkJIE03NzAuNSw2NDUuM2MwLDEuNywxLjQsMy4xLDMsMy4xczMtMS41LDMtMy4xcy0xLjQtMy4xLTMtMy4xUzc3MC41LDY0My43LDc3MC41LDY0NS4zeiIvPgo8L2c+Cjwvc3ZnPgo=" alt="採用フロー説明" style={{ maxWidth: '100%', maxHeight: '100%', objectFit: 'contain' }} />
              </div>
              </div>
              
              {/* タイプ名 + 深度 */}
              <div className="col-span-7 p-4 pl-6">
                <div className="section-label"><span className="section-label-dot"><svg width="8" height="8" viewBox="0 0 8 8"><circle cx="4" cy="4" r="4" fill="#64748b"/></svg></span><span className="section-label-text">御社の採用力のバランス</span></div>
                <div className="text-base font-bold text-gray-800 mb-3">注力タイプ</div>
                <div className="w-full h-0.5 bg-gray-600 mb-0"></div>
                <DepthBars scores={effectiveDepthScores} />
              </div>
            </div>
            
            {/* 下段：採用基礎力 + 魅力伝達力 (6) */}
            <div className="grid grid-cols-2" style={{ flex: '6 0 0', overflow: 'visible' }}>
              {/* 採用基礎力（マインドセット）レーダー */}
              <div className="p-2 pt-4 pl-6 border-r border-gray-200 flex flex-col" style={{ overflow: 'visible' }}>
                <div className="section-label"><span className="section-label-dot"><svg width="8" height="8" viewBox="0 0 8 8"><circle cx="4" cy="4" r="4" fill="#64748b"/></svg></span><span className="section-label-text">採用意識の癖</span></div>
                <div className="flex justify-between items-start mb-1 w-full">
                  <div className="text-base font-bold text-gray-800">採用基礎力</div>
                  <div style={{ fontSize: '10px' }}>
                    <span className="legend-item-inline" style={{ marginRight: '8px' }}>
                      <span className="legend-dot-cell"><svg width="6" height="6" viewBox="0 0 6 6"><circle cx="3" cy="3" r="3" fill="#06b6d4"/></svg></span>
                      <span className="legend-text-cell">担当者</span>
                    </span>
                    <span className="legend-item-inline">
                      <span className="legend-dot-cell"><svg width="6" height="6" viewBox="0 0 6 6"><circle cx="3" cy="3" r="3" fill="#3b82f6"/></svg></span>
                      <span className="legend-text-cell">上層部</span>
                    </span>
                  </div>
                </div>
                <div className="flex justify-center flex-1 items-center" style={{ overflow: 'visible' }}>
                  <TripleRadarChart
                    staffData={Object.keys(MINDSET_AXES).map(k => effectiveStaffMindsetScores?.[k] ?? 0)}
                    execData={Object.keys(MINDSET_AXES).map(k => effectiveExecMindsetScores?.[k] ?? 0)}
                    size={250}
                    labels={Object.values(MINDSET_AXES).map(axis => axis.name)}
                    maxValue={10}
                  />
                </div>
              </div>
              
              {/* 魅力伝達力（6軸×2視点）レーダー */}
              <div className="p-2 pt-4 pl-6 flex flex-col" style={{ overflow: 'visible' }}>
                <div className="section-label"><span className="section-label-dot"><svg width="8" height="8" viewBox="0 0 8 8"><circle cx="4" cy="4" r="4" fill="#64748b"/></svg></span><span className="section-label-text">翻訳の必要性</span></div>
                <div className="flex justify-between items-start mb-1 w-full">
                  <div className="text-base font-bold text-gray-800">魅力伝達力</div>
                  <div style={{ fontSize: '10px' }}>
                    <span className="legend-item-inline" style={{ marginRight: '8px' }}>
                      <span className="legend-dot-cell"><svg width="6" height="6" viewBox="0 0 6 6"><circle cx="3" cy="3" r="3" fill="#06b6d4"/></svg></span>
                      <span className="legend-text-cell">担当者</span>
                    </span>
                    <span className="legend-item-inline">
                      <span className="legend-dot-cell"><svg width="6" height="6" viewBox="0 0 6 6"><circle cx="3" cy="3" r="3" fill="#3b82f6"/></svg></span>
                      <span className="legend-text-cell">上層部</span>
                    </span>
                  </div>
                </div>
                <div className="flex justify-center flex-1 items-center" style={{ overflow: 'visible' }}>
                  <TripleRadarChart
                    staffData={staffRadar}
                    execData={execRadar}
                    size={250}
                    labels={['認知度', '具体性', '差別化力', '共感・ビジョン', '選考UX', '対話力']}
                    maxValue={10}
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
        </>
      )}
      
      {/* 改善アドバイスタブ */}
      {activeTab === 'advice' && (
        <>
          <div className="grid grid-cols-12 gap-4 items-stretch">
            {/* 左カラム: スコア + タイプ */}
            <div className="col-span-5 flex flex-col gap-4">
              {/* ボックス1: ランクカード + 処方箋 */}
              <div className="section-card p-5" style={{ flex: '4' }}>
                <div className="mb-4">
                  <div className="flex items-baseline gap-2 mb-2">
                    <span className="text-sm text-gray-500">ランク</span>
                    <span 
                      className="text-4xl font-black"
                      style={{ color: rankDef.color }}
                    >
                      {rank}
                    </span>
                    <span className="text-lg font-bold" style={{ color: rankDef.color }}>
                      {rankDef.name}
                    </span>
                  </div>
                  <div className="text-xs text-gray-500 leading-relaxed">{rankDef.description}</div>
                </div>
                
                <div className="border-t border-gray-200 pt-4">
                  <div className="flex items-center gap-2 mb-3">
                    <span className="w-5 h-5 text-gray-600">
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-5 h-5">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                      </svg>
                    </span>
                    <span className="font-bold text-gray-800">処方箋</span>
                    <span className="text-xs text-gray-500">今すぐ捨てるべき活動</span>
                  </div>
                  <div className="text-sm text-gray-600 leading-relaxed min-h-[100px]">
                    {aiAdvice?.prescription || (
                      <span className="text-gray-400 italic">AIアドバイス生成後に表示されます</span>
                    )}
                  </div>
                </div>
              </div>
              
              {/* ボックス2: ギャップ分析 + 組織課題 */}
              <div className="section-card p-5" style={{ flex: '6' }}>
                {/* ギャップ分析 */}
                <div className="mb-4">
                  <div className="flex items-center gap-2 mb-3">
                    <span className="text-sm font-bold text-gray-700">認識ギャップ</span>
                    {gapResult.gapQuestionCount > 0 && (
                      <span className="text-[10px] text-gray-400">（対象{gapResult.gapQuestionCount}問）</span>
                    )}
                  </div>
                  {gapResult.gapQuestionCount === 0 ? (
                    <div className="text-xs text-gray-400 italic">
                      ギャップチェック対象の質問がありません
                    </div>
                  ) : gapResult.companyRate === null || gapResult.studentRate === null ? (
                    <div className="text-xs text-gray-400 italic">
                      企業側または学生側の回答がありません
                    </div>
                  ) : (
                    <div className="flex items-center justify-between bg-blue-50 rounded-lg p-3" style={{ minWidth: '100%' }}>
                      <div className="text-center" style={{ flex: '1 1 0', minWidth: '80px' }}>
                        <div className="text-[10px] text-gray-500 mb-1">企業側</div>
                        <div className="text-xs text-gray-600">「知りたい」に応えている率</div>
                        <div className="text-xl font-black text-blue-600">{gapResult.companyRate ?? '-'}%</div>
                      </div>
                      <div className="text-center border-l border-r border-gray-200 mx-2 px-2" style={{ flex: '1 1 0', minWidth: '100px' }}>
                        <div className="text-[10px] text-gray-500 mb-1">学生側</div>
                        <div className="text-xs text-gray-600">「伝わった」</div>
                        <div className="text-xl font-black text-green-600">{gapResult.studentRate ?? '-'}%</div>
                      </div>
                      <div className="text-center" style={{ flex: '1 1 0', minWidth: '80px' }}>
                        <div className="text-[10px] text-gray-500 mb-1">ギャップ</div>
                        <div className="text-xs text-gray-600">「知りたいことが伝わった」</div>
                        <div className={`text-xl font-black ${gapResult.combinedRate !== null && gapResult.combinedRate <= 30 ? 'text-red-600' : gapResult.combinedRate !== null && gapResult.combinedRate <= 50 ? 'text-orange-500' : 'text-gray-600'}`}>
                          {gapResult.combinedRate ?? '-'}%
                        </div>
                      </div>
                    </div>
                  )}
                </div>
                
                <div className="border-t border-gray-200 pt-4">
                  <div className="flex items-center gap-2 mb-3">
                    <span className="w-5 h-5 text-gray-600">
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-5 h-5">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                      </svg>
                    </span>
                    <span className="font-bold text-gray-800">組織の課題</span>
                    <span className="text-xs text-gray-500">根本原因のマインドセット</span>
                  </div>
                  <div className="text-sm text-gray-600 leading-relaxed min-h-[80px]">
                    {aiAdvice?.organizationIssue || (
                      <span className="text-gray-400 italic">AIアドバイス生成後に表示されます</span>
                    )}
                  </div>
                </div>
              </div>
            </div>
            
            {/* 右カラム */}
            <div className="col-span-7" style={{ minHeight: '650px' }}>
              {/* 統合ボックス：採用担当者 + 上層部 */}
              <div className="section-card overflow-hidden h-full flex flex-col">
                {/* 上段：採用担当者 + 上層部 */}
                <div className="grid grid-cols-2 flex-1">
                  {/* 採用担当者カード */}
                  <div className="p-4 border-r border-gray-200 flex flex-col">
                    <div className="flex items-center gap-2 mb-3 pb-2 border-b-2 border-blue-500">
                      <span className="w-5 h-5 text-gray-600">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-5 h-5">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                      </span>
                      <span className="font-bold text-gray-800">採用担当者へ</span>
                    </div>
                    <div className="text-xs text-gray-500 mb-2">明日からやめるべき無駄な作業</div>
                    <div className="text-sm text-gray-600 leading-relaxed flex-1">
                      {aiAdvice?.forRecruiter || (
                        <span className="text-gray-400 italic">AIアドバイス生成後に表示されます</span>
                      )}
                    </div>
                    
                    {/* 深度スコア */}
                    <div className="border-t border-gray-200 pt-3 mt-3">
                      <div className="text-xs text-gray-500 mb-2">採用力バランス</div>
                      {[
                        { key: 'surface', name: '表層', score: effectiveDepthScores.surface ?? 0 },
                        { key: 'middle', name: '中層', score: effectiveDepthScores.middle ?? 0 },
                        { key: 'deep', name: '深層', score: effectiveDepthScores.deep ?? 0 }
                      ].map((layer) => {
                        const percentage = (layer.score / 10) * 100;
                        const displayPercentage = percentage % 1 === 0 ? percentage.toFixed(0) : percentage.toFixed(1);
                        return (
                        <div key={layer.key} className="flex items-center gap-2 py-1">
                          <span className="text-[10px] text-gray-500 w-6">{layer.name}</span>
                          <div className="flex-1 h-2 bg-gray-200 rounded overflow-hidden">
                            <div 
                              className="h-full rounded bg-blue-500"
                              style={{ width: `${percentage}%` }}
                            />
                          </div>
                          <span className="text-[10px] text-gray-500 w-10">{displayPercentage}%</span>
                        </div>
                      )})}
                    </div>
                  </div>
                  
                  {/* 上層部カード */}
                  <div className="p-4 flex flex-col">
                    <div className="flex items-center gap-2 mb-3 pb-2 border-b-2 border-purple-500">
                      <span className="w-5 h-5 text-gray-600">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-5 h-5">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                        </svg>
                      </span>
                      <span className="font-bold text-gray-800">上層部へ</span>
                    </div>
                    <div className="text-xs text-gray-500 mb-2">投資対効果の低い無駄なコスト</div>
                    <div className="text-sm text-gray-600 leading-relaxed flex-1">
                      {aiAdvice?.forManagement || (
                        <span className="text-gray-400 italic">AIアドバイス生成後に表示されます</span>
                      )}
                    </div>
                    
                    {/* 組織内採用伝達力スコア */}
                    <div className="border-t border-gray-200 pt-3 mt-3">
                      <div className="text-xs text-gray-500 mb-2">組織内採用伝達力(基礎力のギャップ)</div>
                      <div className="flex items-center gap-2">
                        <div className="flex-1 h-2 bg-gray-200 rounded overflow-hidden">
                          <div 
                            className="h-full rounded bg-purple-500"
                            style={{ width: hasBothMindsetScores ? `${mindsetCoef * 100}%` : '0%' }}
                          />
                        </div>
                        <span className="text-xs font-bold text-purple-600">
                          {hasBothMindsetScores ? `${(mindsetCoef * 100).toFixed(0)}%` : '-%'}
                        </span>
                      </div>
                      {!hasBothMindsetScores && (
                        <div className="text-[10px] text-gray-400 mt-1">
                          ※担当者・上層部の両方の問診が必要です
                        </div>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </>
      )}
      
      {/* 導入効果シミュレーションタブ（プレースホルダー） */}
      {activeTab === 'simulation' && (
        <div className="flex items-center justify-center bg-gray-50 rounded-xl border border-gray-200" style={{ minHeight: '650px' }}>
          <div className="text-center text-gray-500">
            <div className="mb-4">
              <svg className="w-12 h-12 mx-auto text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
              </svg>
            </div>
            <div className="text-lg font-bold mb-2">導入効果シミュレーション</div>
            <div className="text-sm">このページは開発中です</div>
          </div>
        </div>
      )}
      
      {/* フッタータブ */}
      <div className="tab-bar mt-4 rounded-xl overflow-hidden">
        <div 
          className={`tab-item ${activeTab === 'result' ? 'active' : ''}`}
          onClick={() => setActiveTab('result')}
          style={{ cursor: 'pointer' }}
        >
          {activeTab === 'result' && <div className="tab-active-bar"></div>}
          診断結果
        </div>
        <div 
          className={`tab-item ${activeTab === 'advice' ? 'active' : ''}`}
          onClick={() => setActiveTab('advice')}
          style={{ cursor: 'pointer' }}
        >
          {activeTab === 'advice' && <div className="tab-active-bar"></div>}
          改善アドバイス
        </div>
        <div 
          className={`tab-item ${activeTab === 'simulation' ? 'active' : ''}`}
          onClick={() => setActiveTab('simulation')}
          style={{ cursor: 'pointer', borderRight: 'none' }}
        >
          {activeTab === 'simulation' && <div className="tab-active-bar"></div>}
          導入効果シミュレーション
        </div>
      </div>
    </div>
  );
});

// ========================================
// 顧客データベース（スプレッドシート形式）
// ========================================

const CustomerDatabase = ({ customers, onSelect, onDelete, selectedId }) => {
  const [searchText, setSearchText] = useState('');
  const [searchInquiryNo, setSearchInquiryNo] = useState('');
  const [dateFrom, setDateFrom] = useState('');
  const [dateTo, setDateTo] = useState('');
  const [sortKey, setSortKey] = useState('diagnosisDate');
  const [sortOrder, setSortOrder] = useState('desc');
  const [viewMode, setViewMode] = useState('table'); // 'table' or 'card'
  
  // フィルタリング
  const filteredCustomers = useMemo(() => {
    return customers.filter(c => {
      // テキスト検索（企業名・担当者名）
      if (searchText) {
        const text = searchText.toLowerCase();
        const matchName = (c.companyName || '').toLowerCase().includes(text);
        const matchContact = (c.contactName || '').toLowerCase().includes(text);
        if (!matchName && !matchContact) return false;
      }
      
      // 問い合わせ番号検索
      if (searchInquiryNo) {
        if (!(c.inquiryNo || '').includes(searchInquiryNo)) return false;
      }
      
      // 期間検索
      if (dateFrom && c.diagnosisDate < dateFrom) return false;
      if (dateTo && c.diagnosisDate > dateTo) return false;
      
      return true;
    });
  }, [customers, searchText, searchInquiryNo, dateFrom, dateTo]);
  
  // ソート
  const sortedCustomers = useMemo(() => {
    return [...filteredCustomers].sort((a, b) => {
      let valA, valB;
      
      switch(sortKey) {
        case 'companyName':
          valA = a.companyName || '';
          valB = b.companyName || '';
          break;
        case 'diagnosisDate':
          valA = a.diagnosisDate || '';
          valB = b.diagnosisDate || '';
          break;
        case 'inquiryNo':
          valA = a.inquiryNo || '';
          valB = b.inquiryNo || '';
          break;
        case 'score':
          valA = calcFinalScore(a);
          valB = calcFinalScore(b);
          break;
        case 'industry':
          valA = a.industry || '';
          valB = b.industry || '';
          break;
        default:
          valA = a.diagnosisDate || '';
          valB = b.diagnosisDate || '';
      }
      
      if (sortOrder === 'asc') {
        return valA > valB ? 1 : -1;
      } else {
        return valA < valB ? 1 : -1;
      }
    });
  }, [filteredCustomers, sortKey, sortOrder]);
  
  const handleSort = (key) => {
    if (sortKey === key) {
      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');
    } else {
      setSortKey(key);
      setSortOrder('desc');
    }
  };
  
  const clearFilters = () => {
    setSearchText('');
    setSearchInquiryNo('');
    setDateFrom('');
    setDateTo('');
  };
  
  const SortIcon = ({ columnKey }) => {
    if (sortKey !== columnKey) return <span className="text-gray-300 ml-1">⇅</span>;
    return <span className="text-blue-500 ml-1">{sortOrder === 'asc' ? '↑' : '↓'}</span>;
  };
  
  return (
    <div className="glass-card rounded-xl p-5">
      {/* ヘッダー */}
      <div className="flex justify-between items-center mb-4">
        <h3 className="text-lg font-bold text-gray-800">
          顧客データベース
          <span className="text-sm font-normal text-gray-500 ml-2">
            （{filteredCustomers.length} / {customers.length}件）
          </span>
        </h3>
        <div className="flex gap-2">
          <button
            onClick={() => setViewMode('table')}
            className={`px-3 py-1.5 text-xs rounded-lg transition ${
              viewMode === 'table' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
            }`}
          >
            テーブル
          </button>
          <button
            onClick={() => setViewMode('card')}
            className={`px-3 py-1.5 text-xs rounded-lg transition ${
              viewMode === 'card' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
            }`}
          >
            カード
          </button>
        </div>
      </div>
      
      {/* 検索フィルター */}
      <div className="bg-gray-50 rounded-xl p-4 mb-4 space-y-3">
        <div className="grid grid-cols-2 gap-3">
          {/* 企業名・担当者名検索 */}
          <div>
            <label className="block text-xs text-gray-500 mb-1">企業名・担当者名</label>
            <input
              type="text"
              value={searchText}
              onChange={(e) => setSearchText(e.target.value)}
              placeholder="検索..."
              className="w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            />
          </div>
          
          {/* 問い合わせ番号検索 */}
          <div>
            <label className="block text-xs text-gray-500 mb-1">問い合わせ番号</label>
            <input
              type="text"
              value={searchInquiryNo}
              onChange={(e) => setSearchInquiryNo(e.target.value)}
              placeholder="番号で検索..."
              className="w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono"
            />
          </div>
        </div>
        
        <div className="grid grid-cols-3 gap-3">
          {/* 期間検索（開始） */}
          <div>
            <label className="block text-xs text-gray-500 mb-1">商談期間（開始）</label>
            <input
              type="date"
              value={dateFrom}
              onChange={(e) => setDateFrom(e.target.value)}
              className="w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            />
          </div>
          
          {/* 期間検索（終了） */}
          <div>
            <label className="block text-xs text-gray-500 mb-1">商談期間（終了）</label>
            <input
              type="date"
              value={dateTo}
              onChange={(e) => setDateTo(e.target.value)}
              className="w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            />
          </div>
          
          {/* フィルタークリア */}
          <div className="flex items-end">
            <button
              onClick={clearFilters}
              className="w-full px-3 py-2 text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition"
            >
              ✕ クリア
            </button>
          </div>
        </div>
      </div>
      
      {/* データ表示 */}
      {sortedCustomers.length === 0 ? (
        <div className="text-center py-12">
          <p className="text-sm text-gray-500">
            {customers.length === 0 ? '保存された顧客データはありません' : '検索条件に一致するデータがありません'}
          </p>
        </div>
      ) : viewMode === 'table' ? (
        /* テーブル表示 */
        <div className="overflow-x-auto">
          <table className="w-full text-sm">
            <thead>
              <tr className="bg-gray-100">
                <th 
                  className="px-3 py-2 text-left cursor-pointer hover:bg-gray-200 transition rounded-tl-lg"
                  onClick={() => handleSort('inquiryNo')}
                >
                  問い合わせNo <SortIcon columnKey="inquiryNo" />
                </th>
                <th 
                  className="px-3 py-2 text-left cursor-pointer hover:bg-gray-200 transition"
                  onClick={() => handleSort('companyName')}
                >
                  企業名 <SortIcon columnKey="companyName" />
                </th>
                <th 
                  className="px-3 py-2 text-left cursor-pointer hover:bg-gray-200 transition"
                  onClick={() => handleSort('industry')}
                >
                  業種 <SortIcon columnKey="industry" />
                </th>
                <th 
                  className="px-3 py-2 text-left cursor-pointer hover:bg-gray-200 transition"
                  onClick={() => handleSort('diagnosisDate')}
                >
                  診断日 <SortIcon columnKey="diagnosisDate" />
                </th>
                <th 
                  className="px-3 py-2 text-center cursor-pointer hover:bg-gray-200 transition"
                  onClick={() => handleSort('score')}
                >
                  スコア <SortIcon columnKey="score" />
                </th>
                <th className="px-3 py-2 text-center rounded-tr-lg">操作</th>
              </tr>
            </thead>
            <tbody>
              {sortedCustomers.map((c, idx) => {
                // calcFinalScoreでスコアを計算し、0の場合は保存されたfinalScoreを使用
                const calculatedScore = calcFinalScore(c);
                const score = calculatedScore > 0 ? calculatedScore : (c.finalScore || c['総合スコア'] || 0);
                const rank = determineRank(score);
                return (
                  <tr 
                    key={c.id}
                    className={`border-b border-gray-100 cursor-pointer transition ${
                      selectedId === c.id ? 'bg-blue-50' : 'hover:bg-gray-50'
                    }`}
                    onClick={() => onSelect(c)}
                  >
                    <td className="px-3 py-2.5 font-mono text-xs text-gray-600">
                      {c.inquiryNo || '-'}
                    </td>
                    <td className="px-3 py-2.5 font-medium text-gray-800">
                      {c.companyName || '未設定'}
                      {c.contactName && (
                        <span className="text-xs text-gray-400 ml-2">({c.contactName})</span>
                      )}
                    </td>
                    <td className="px-3 py-2.5 text-gray-600">
                      {c.industry || '-'}
                    </td>
                    <td className="px-3 py-2.5 text-gray-600">
                      {c.diagnosisDate || '-'}
                    </td>
                    <td className="px-3 py-2.5 text-center">
                      <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-bold rank-${rank.toLowerCase()}`}>
                        {rank} <span className="font-normal opacity-80">{score}点</span>
                      </span>
                    </td>
                    <td className="px-3 py-2.5 text-center">
                      <button
                        onClick={(e) => { 
                          e.stopPropagation(); 
                          if(confirm('この顧客データを削除しますか？')) onDelete(c.id); 
                        }}
                        className="text-gray-400 hover:text-red-500 px-2 py-1 text-xs transition"
                        title="削除"
                      >
                        削除
                      </button>
                    </td>
                  </tr>
                );
              })}
            </tbody>
          </table>
        </div>
      ) : (
        /* カード表示 */
        <div className="space-y-2 max-h-[500px] overflow-y-auto">
          {sortedCustomers.map(c => {
            const calculatedScore = calcFinalScore(c);
            const score = calculatedScore > 0 ? calculatedScore : (c.finalScore || c['総合スコア'] || 0);
            const rank = determineRank(score);
            return (
              <div 
                key={c.id}
                className={`customer-item ${selectedId === c.id ? 'selected' : ''}`}
                onClick={() => onSelect(c)}
              >
                <div className="flex justify-between items-start">
                  <div className="flex-1">
                    <div className="flex items-center gap-2 mb-1">
                      <span className="font-medium text-gray-800">{c.companyName || '企業名未設定'}</span>
                      <span className={`text-xs font-bold px-2 py-0.5 rounded rank-${rank.toLowerCase()}`}>
                        {rank}
                      </span>
                    </div>
                    <div className="text-xs text-gray-500 space-y-0.5">
                      <div>{c.diagnosisDate} | {c.industry || '業種未設定'}</div>
                      <div className="font-mono text-gray-400">{c.inquiryNo || '-'}</div>
                    </div>
                  </div>
                  <button
                    onClick={(e) => { e.stopPropagation(); if(confirm('削除しますか？')) onDelete(c.id); }}
                    className="text-gray-400 hover:text-red-500 px-2 py-1 text-xs transition"
                  >
                    削除
                  </button>
                </div>
              </div>
            );
          })}
        </div>
      )}
      
      {/* 統計サマリー */}
      {customers.length > 0 && (
        <div className="mt-4 pt-4 border-t border-gray-200">
          <div className="grid grid-cols-5 gap-2 text-center">
            {['S', 'A', 'B', 'C', 'D'].map(rank => {
              const count = filteredCustomers.filter(c => {
                const calculatedScore = calcFinalScore(c);
                const score = calculatedScore > 0 ? calculatedScore : (c.finalScore || c['総合スコア'] || 0);
                return determineRank(score) === rank;
              }).length;
              return (
                <div key={rank} className="bg-gray-50 rounded-lg py-2">
                  <div className={`text-lg font-bold rank-${rank.toLowerCase()} bg-clip-text`} style={{
                    background: RANK_DEFINITIONS[rank].gradient,
                    WebkitBackgroundClip: 'text',
                    WebkitTextFillColor: 'transparent'
                  }}>
                    {count}
                  </div>
                  <div className="text-[10px] text-gray-500">ランク{rank}</div>
                </div>
              );
            })}
          </div>
        </div>
      )}
    </div>
  );
};

// ========================================
// 設定認証モーダル
// ========================================

const AISettingsAuthModal = ({ onSuccess, onClose }) => {
  const [password, setPassword] = useState('');
  const [error, setError] = useState('');
  
  const handleSubmit = (e) => {
    e.preventDefault();
    if (AdminPasswordManager.verify(password)) {
      onSuccess();
    } else {
      setError('パスワードが正しくありません');
      setPassword('');
    }
  };
  
  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 no-print">
      <div className="bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl">
        <div className="flex items-center gap-3 mb-4">
          <div className="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>
          </div>
          <div>
            <h3 className="text-lg font-bold text-gray-800">設定</h3>
            <p className="text-xs text-gray-500">管理者認証が必要です</p>
          </div>
        </div>
        
        <form onSubmit={handleSubmit}>
          <div className="mb-4">
            <label className="block text-sm font-medium text-gray-700 mb-2">管理者パスワード</label>
            <input
              type="password"
              value={password}
              onChange={(e) => { setPassword(e.target.value); setError(''); }}
              className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
              placeholder="パスワードを入力"
              autoFocus
            />
            {error && <p className="mt-2 text-sm text-red-500">{error}</p>}
          </div>
          
          <div className="flex gap-3">
            <button
              type="button"
              onClick={onClose}
              className="flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-medium transition"
            >
              キャンセル
            </button>
            <button
              type="submit"
              className="flex-1 px-4 py-3 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-xl font-medium transition"
            >
              認証
            </button>
          </div>
        </form>
      </div>
    </div>
  );
};

// ========================================
// ログイン画面
// ========================================

const LoginScreen = ({ onLogin }) => {
  const [password, setPassword] = useState('');
  const [error, setError] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  
  // GASモードの場合はユーザー情報を取得
  const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
  const userEmail = window.GAS_CONFIG?.userEmail || '';
  const userName = window.GAS_CONFIG?.userName || '';
  
  const handleSubmit = (e) => {
    e.preventDefault();
    setIsLoading(true);
    setError('');
    
    // 少し遅延を入れてUX向上
    setTimeout(() => {
      if (LoginManager.verifyPassword(password)) {
        LoginManager.saveSession();
        setIsLoading(false);
        // ログイン成功 - コールバックを直接実行
        if (onLogin) {
          onLogin();
        }
      } else {
        setError('パスワードが正しくありません');
        setPassword('');
        setIsLoading(false);
      }
    }, 500);
  };
  
  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex items-center justify-center p-4">
      <div className="w-full max-w-md">
        {/* ロゴ・タイトル */}
        <div className="text-center mb-8">
          <div className="inline-flex items-center justify-center w-16 h-16 bg-white/10 backdrop-blur rounded-2xl mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" className="w-8 h-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
          </div>
          <h1 className="text-2xl font-bold text-white mb-2">採用ブラックボックス診断</h1>
          <p className="text-blue-200 text-sm">システムにログインしてください</p>
        </div>
        
        {/* ユーザー情報（GASモードの場合） */}
        {isGasMode && userEmail && (
          <div className="bg-white/5 backdrop-blur rounded-2xl p-4 mb-6 border border-white/10">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-blue-500/30 rounded-full flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5 text-blue-200" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                  <path strokeLinecap="round" strokeLinejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
              </div>
              <div>
                <div className="text-sm font-medium text-white">{userName || 'ユーザー'}</div>
                <div className="text-xs text-blue-200/70">{userEmail}</div>
              </div>
            </div>
          </div>
        )}
        
        {/* ログインフォーム */}
        <div className="bg-white/10 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/20">
          <form onSubmit={handleSubmit}>
            <div className="mb-6">
              <label className="block text-sm font-medium text-blue-100 mb-2">
                パスワード
              </label>
              <div className="relative">
                <input
                  type="password"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  className="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-blue-200/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"
                  placeholder="パスワードを入力"
                  autoFocus
                  disabled={isLoading}
                />
                <div className="absolute right-3 top-1/2 -translate-y-1/2">
                  <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5 text-blue-200/50" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                    <path strokeLinecap="round" strokeLinejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                  </svg>
                </div>
              </div>
            </div>
            
            {error && (
              <div className="mb-4 p-3 bg-red-500/20 border border-red-400/30 rounded-xl text-red-200 text-sm text-center">
                {error}
              </div>
            )}
            
            <button
              type="submit"
              disabled={isLoading || !password}
              className="w-full py-3 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 disabled:from-gray-500 disabled:to-gray-600 text-white font-medium rounded-xl transition shadow-lg disabled:cursor-not-allowed"
            >
              {isLoading ? (
                <span className="flex items-center justify-center gap-2">
                  <svg className="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  認証中...
                </span>
              ) : 'ログイン'}
            </button>
          </form>
        </div>
        
        {/* フッター */}
        <div className="text-center mt-6 text-blue-200/50 text-xs">
          © Gakusapo - 採用支援システム
        </div>
      </div>
    </div>
  );
};

// ========================================
// メンバー管理パネル
// ========================================

const MemberManagementPanel = () => {
  const [members, setMembers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [success, setSuccess] = useState(null);
  const [processing, setProcessing] = useState(false);
  
  // 新規追加フォーム
  const [showAddForm, setShowAddForm] = useState(false);
  const [newEmail, setNewEmail] = useState('');
  const [newName, setNewName] = useState('');
  const [newRole, setNewRole] = useState('member');
  
  // 編集中のメンバー
  const [editingEmail, setEditingEmail] = useState(null);
  const [editName, setEditName] = useState('');
  
  // 確認ダイアログ
  const [confirmAction, setConfirmAction] = useState(null); // { type, email, name }
  
  const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
  
  const loadMembers = async () => {
    if (!isGasMode) { setLoading(false); return; }
    setLoading(true);
    try {
      const res = await authFetch('getMembers');
      if (res?.success) setMembers(res.members || []);
      else setError(res?.error || 'メンバーの読み込みに失敗しました');
    } catch (err) {
      setError('通信エラー: ' + err.message);
    }
    setLoading(false);
  };
  
  useEffect(() => { loadMembers(); }, []);
  
  const handleAdd = async () => {
    if (!newEmail.trim()) { setError('Gmailアドレスを入力してください'); return; }
    if (!newName.trim()) { setError('名前を入力してください'); return; }
    setProcessing(true);
    setError(null);
    try {
      const res = await authPost('addMember', { memberData: { email: newEmail.trim(), name: newName.trim(), role: newRole } });
      if (res.success) {
        setSuccess(`${newName.trim()} を追加しました（学生No: ${res.studentId}）`);
        setNewEmail(''); setNewName(''); setNewRole('member'); setShowAddForm(false);
        await loadMembers();
      } else {
        setError(res.error || '追加に失敗しました');
      }
    } catch (err) { setError(err.message); }
    setProcessing(false);
    setTimeout(() => setSuccess(null), 3000);
  };
  
  const handleUpdateName = async (email) => {
    if (!editName.trim()) return;
    setProcessing(true); setError(null);
    try {
      const res = await authPost('updateMember', { email, updates: { name: editName.trim() } });
      if (res.success) {
        setSuccess('名前を更新しました');
        setEditingEmail(null);
        await loadMembers();
      } else { setError(res.error); }
    } catch (err) { setError(err.message); }
    setProcessing(false);
    setTimeout(() => setSuccess(null), 3000);
  };
  
  const handleToggleActive = async (email, currentActive) => {
    setProcessing(true); setError(null);
    try {
      const action = currentActive ? 'disableMember' : 'enableMember';
      const res = await authPost(action, { email });
      if (res.success) {
        setSuccess(currentActive ? '無効化しました' : '有効化しました');
        await loadMembers();
      } else { setError(res.error); }
    } catch (err) { setError(err.message); }
    setProcessing(false);
    setConfirmAction(null);
    setTimeout(() => setSuccess(null), 3000);
  };
  
  const handleDelete = async (email) => {
    setProcessing(true); setError(null);
    try {
      const res = await authPost('deleteMember', { email });
      if (res.success) {
        setSuccess('メンバーを削除しました');
        await loadMembers();
      } else { setError(res.error); }
    } catch (err) { setError(err.message); }
    setProcessing(false);
    setConfirmAction(null);
    setTimeout(() => setSuccess(null), 3000);
  };
  
  const handleToggleRole = async (email, currentRole) => {
    const newRoleVal = currentRole === 'admin' ? 'member' : 'admin';
    setProcessing(true); setError(null);
    try {
      const res = await authPost('updateMember', { email, updates: { role: newRoleVal } });
      if (res.success) {
        setSuccess(`権限を「${newRoleVal === 'admin' ? '管理者' : 'メンバー'}」に変更しました`);
        await loadMembers();
      } else { setError(res.error); }
    } catch (err) { setError(err.message); }
    setProcessing(false);
    setTimeout(() => setSuccess(null), 3000);
  };
  
  if (loading) {
    return (
      <div className="flex items-center justify-center py-12">
        <svg className="w-6 h-6 animate-spin text-indigo-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2}>
          <circle cx="12" cy="12" r="10" className="opacity-25" /><path d="M4 12a8 8 0 018-8" className="opacity-75" />
        </svg>
        <span className="ml-2 text-sm text-gray-500">メンバー情報を読み込み中...</span>
      </div>
    );
  }
  
  const activeMembers = members.filter(m => m.active);
  const inactiveMembers = members.filter(m => !m.active);
  
  return (
    <div className="space-y-4">
      <div className="flex items-center justify-between">
        <div>
          <h3 className="text-base font-bold text-gray-800">メンバー管理</h3>
          <p className="text-xs text-gray-500 mt-0.5">Gmail・名前・学生Noの管理（{activeMembers.length}名 有効）</p>
        </div>
        <div className="flex gap-2">
          <button onClick={loadMembers} disabled={processing}
            className="px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors">
            更新
          </button>
          <button onClick={() => setShowAddForm(!showAddForm)} disabled={processing}
            className="px-3 py-1.5 text-xs bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
            + メンバー追加
          </button>
        </div>
      </div>
      
      {/* 通知 */}
      {error && (
        <div className="bg-red-50 border border-red-200 text-red-700 text-sm px-3 py-2 rounded-lg flex justify-between items-center">
          <span>{error}</span>
          <button onClick={() => setError(null)} className="text-red-400 hover:text-red-600 ml-2 text-lg leading-none">&times;</button>
        </div>
      )}
      {success && (
        <div className="bg-green-50 border border-green-200 text-green-700 text-sm px-3 py-2 rounded-lg">{success}</div>
      )}
      
      {/* 新規追加フォーム */}
      {showAddForm && (
        <div className="bg-indigo-50 border border-indigo-200 rounded-xl p-4 space-y-3">
          <div className="text-sm font-medium text-indigo-800">新しいメンバーを追加</div>
          <div className="grid grid-cols-1 sm:grid-cols-3 gap-3">
            <div>
              <label className="block text-xs text-gray-600 mb-1">Gmail アドレス *</label>
              <input type="email" value={newEmail} onChange={e => setNewEmail(e.target.value)} placeholder="example@gmail.com"
                className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-300 focus:border-indigo-400 outline-none" />
            </div>
            <div>
              <label className="block text-xs text-gray-600 mb-1">名前 *</label>
              <input type="text" value={newName} onChange={e => setNewName(e.target.value)} placeholder="山田 太郎"
                className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-300 focus:border-indigo-400 outline-none" />
            </div>
            <div>
              <label className="block text-xs text-gray-600 mb-1">権限</label>
              <select value={newRole} onChange={e => setNewRole(e.target.value)}
                className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-300 focus:border-indigo-400 outline-none bg-white">
                <option value="member">メンバー</option>
                <option value="admin">管理者</option>
              </select>
            </div>
          </div>
          <div className="flex gap-2 pt-1">
            <button onClick={handleAdd} disabled={processing}
              className="px-4 py-2 text-sm bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors">
              {processing ? '追加中...' : '追加する'}
            </button>
            <button onClick={() => { setShowAddForm(false); setNewEmail(''); setNewName(''); setNewRole('member'); }}
              className="px-4 py-2 text-sm bg-white text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
              キャンセル
            </button>
          </div>
          <div className="text-xs text-indigo-600">※ 学生Noは自動で採番されます</div>
        </div>
      )}
      
      {/* メンバー一覧テーブル */}
      <div className="border border-gray-200 rounded-xl overflow-hidden">
        <table className="w-full text-sm">
          <thead>
            <tr className="bg-gray-50 border-b border-gray-200">
              <th className="text-left px-4 py-2.5 text-xs font-medium text-gray-500">学生No</th>
              <th className="text-left px-4 py-2.5 text-xs font-medium text-gray-500">名前</th>
              <th className="text-left px-4 py-2.5 text-xs font-medium text-gray-500">Gmail</th>
              <th className="text-center px-4 py-2.5 text-xs font-medium text-gray-500">権限</th>
              <th className="text-center px-4 py-2.5 text-xs font-medium text-gray-500">状態</th>
              <th className="text-right px-4 py-2.5 text-xs font-medium text-gray-500">操作</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-100">
            {members.length === 0 ? (
              <tr><td colSpan={6} className="px-4 py-8 text-center text-gray-400">メンバーがいません</td></tr>
            ) : members.map((m, i) => (
              <tr key={i} className={`${!m.active ? 'bg-gray-50 opacity-60' : 'hover:bg-gray-50'} transition-colors`}>
                <td className="px-4 py-2.5">
                  <span className="font-mono text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded">{m.studentId}</span>
                </td>
                <td className="px-4 py-2.5">
                  {editingEmail === m.email ? (
                    <div className="flex gap-1.5 items-center">
                      <input type="text" value={editName} onChange={e => setEditName(e.target.value)}
                        onKeyDown={e => { if (e.key === 'Enter') handleUpdateName(m.email); if (e.key === 'Escape') setEditingEmail(null); }}
                        className="px-2 py-1 border border-indigo-300 rounded text-sm w-32 focus:ring-1 focus:ring-indigo-300 outline-none" autoFocus />
                      <button onClick={() => handleUpdateName(m.email)} className="text-indigo-600 hover:text-indigo-800 text-xs">保存</button>
                      <button onClick={() => setEditingEmail(null)} className="text-gray-400 hover:text-gray-600 text-xs">取消</button>
                    </div>
                  ) : (
                    <span className="font-medium text-gray-800 cursor-pointer hover:text-indigo-600"
                      onClick={() => { setEditingEmail(m.email); setEditName(m.name); }}>
                      {m.name || '(未設定)'}
                      <svg className="w-3 h-3 inline ml-1 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                      </svg>
                    </span>
                  )}
                </td>
                <td className="px-4 py-2.5 text-gray-500 text-xs">{m.email}</td>
                <td className="px-4 py-2.5 text-center">
                  <button onClick={() => { if (m.studentId !== '0001') handleToggleRole(m.email, m.role); }}
                    disabled={m.studentId === '0001' || processing}
                    className={`text-xs px-2 py-0.5 rounded cursor-pointer transition-colors ${
                      m.role === 'admin' ? 'bg-purple-100 text-purple-700 hover:bg-purple-200' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                    } ${m.studentId === '0001' ? 'cursor-not-allowed opacity-70' : ''}`}>
                    {m.role === 'admin' ? '管理者' : 'メンバー'}
                  </button>
                </td>
                <td className="px-4 py-2.5 text-center">
                  <span className={`text-xs px-2 py-0.5 rounded ${m.active ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-600'}`}>
                    {m.active ? '有効' : '無効'}
                  </span>
                </td>
                <td className="px-4 py-2.5 text-right">
                  {m.studentId !== '0001' && (
                    <div className="flex gap-1 justify-end">
                      <button onClick={() => setConfirmAction({ type: m.active ? 'disable' : 'enable', email: m.email, name: m.name })}
                        disabled={processing}
                        className={`text-xs px-2 py-1 rounded transition-colors ${
                          m.active ? 'text-orange-600 hover:bg-orange-50' : 'text-green-600 hover:bg-green-50'
                        }`}>
                        {m.active ? '無効化' : '有効化'}
                      </button>
                      <button onClick={() => setConfirmAction({ type: 'delete', email: m.email, name: m.name })}
                        disabled={processing}
                        className="text-xs px-2 py-1 rounded text-red-500 hover:bg-red-50 transition-colors">
                        削除
                      </button>
                    </div>
                  )}
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
      
      {/* 確認ダイアログ */}
      {confirmAction && (
        <div className="fixed inset-0 bg-black/30 flex items-center justify-center z-[60]" onClick={() => setConfirmAction(null)}>
          <div className="bg-white rounded-xl p-5 max-w-sm mx-4 shadow-xl" onClick={e => e.stopPropagation()}>
            <div className="text-sm font-medium text-gray-800 mb-3">
              {confirmAction.type === 'delete' 
                ? `「${confirmAction.name}」を削除しますか？` 
                : confirmAction.type === 'disable'
                ? `「${confirmAction.name}」を無効化しますか？`
                : `「${confirmAction.name}」を有効化しますか？`}
            </div>
            {confirmAction.type === 'delete' && (
              <div className="text-xs text-red-600 mb-3 bg-red-50 px-3 py-2 rounded-lg">この操作は取り消せません。メンバーシートから行が削除されます。</div>
            )}
            <div className="flex gap-2 justify-end">
              <button onClick={() => setConfirmAction(null)} className="px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors">キャンセル</button>
              <button onClick={() => {
                  if (confirmAction.type === 'delete') handleDelete(confirmAction.email);
                  else handleToggleActive(confirmAction.email, confirmAction.type === 'disable');
                }}
                disabled={processing}
                className={`px-4 py-2 text-sm text-white rounded-lg transition-colors disabled:opacity-50 ${
                  confirmAction.type === 'delete' ? 'bg-red-600 hover:bg-red-700' : 'bg-indigo-600 hover:bg-indigo-700'
                }`}>
                {processing ? '処理中...' : '実行'}
              </button>
            </div>
          </div>
        </div>
      )}
      
      <div className="text-xs text-gray-400 px-1">
        ※ 学生No 0001（管理者）は権限変更・無効化・削除ができません。<br/>
        ※ 名前をクリックすると編集できます。権限バッジをクリックすると管理者/メンバーを切り替えできます。
      </div>
    </div>
  );
};

// ========================================
// 引き継ぎ管理パネル
// ========================================

const HandoverPanel = () => {
  const [members, setMembers] = useState([]);
  const [allCustomers, setAllCustomers] = useState([]);
  const [history, setHistory] = useState([]);
  const [loading, setLoading] = useState(true);
  const [executing, setExecuting] = useState(false);
  const [error, setError] = useState(null);
  const [success, setSuccess] = useState(null);
  
  // 選択・フィルタ
  const [selectedCustomers, setSelectedCustomers] = useState(new Set());
  const [filterAssignee, setFilterAssignee] = useState('all');
  const [searchText, setSearchText] = useState('');
  const [toStudentId, setToStudentId] = useState('');
  const [remarks, setRemarks] = useState('');
  
  const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
  
  // データ読み込み
  useEffect(() => {
    if (!isGasMode) { setLoading(false); return; }
    
    const loadData = async () => {
      setLoading(true);
      try {
        // v34: authFetch使用
        const [membersRes, customersRes, historyRes] = await Promise.all([
          authFetch('getMembers'),
          authFetch('getCustomers'),
          authFetch('getHandoverHistory')
        ]);
        
        if (membersRes?.success) setMembers(membersRes.members || []);
        if (customersRes?.success) setAllCustomers(customersRes.customers || []);
        if (historyRes?.success) setHistory(historyRes.history || []);
      } catch (err) {
        console.error('[HandoverPanel] 読み込みエラー:', err);
        setError('データの読み込みに失敗しました');
      }
      setLoading(false);
    };
    loadData();
  }, [isGasMode]);
  
  // メンバーマップ（学生番号→名前）
  const memberMap = useMemo(() => {
    const map = {};
    members.forEach(m => { if (m.studentId) map[m.studentId] = m; });
    return map;
  }, [members]);
  
  // フィルタ済み顧客
  const filteredCustomers = useMemo(() => {
    return allCustomers.filter(c => {
      const rawId = c['担当者ID'] ?? c.assigneeId ?? '';
      const paddedId = String(rawId || '').padStart(4, '0');
      const assigneeId = (paddedId && paddedId !== '0000') ? paddedId : String(c['問い合わせNo'] || '').padStart(13, '0').substring(0, 4);
      if (filterAssignee !== 'all' && assigneeId !== filterAssignee) return false;
      if (searchText) {
        const text = searchText.toLowerCase();
        const name = (c['会社名'] || '').toLowerCase();
        const no = (c['問い合わせNo'] || '').toLowerCase();
        const contact = (c['担当者名'] || '').toLowerCase();
        if (!name.includes(text) && !no.includes(text) && !contact.includes(text)) return false;
      }
      return true;
    });
  }, [allCustomers, filterAssignee, searchText]);
  
  // 全選択/全解除
  const handleSelectAll = () => {
    if (selectedCustomers.size === filteredCustomers.length) {
      setSelectedCustomers(new Set());
    } else {
      setSelectedCustomers(new Set(filteredCustomers.map(c => c['問い合わせNo'])));
    }
  };
  
  const toggleCustomer = (inquiryNo) => {
    setSelectedCustomers(prev => {
      const next = new Set(prev);
      if (next.has(inquiryNo)) next.delete(inquiryNo);
      else next.add(inquiryNo);
      return next;
    });
  };
  
  // 担当者IDの取得ヘルパー（統一ロジック）
  const getAssigneeId = (c) => {
    const raw = c['担当者ID'] ?? c.assigneeId ?? '';
    const padded = String(raw || '').padStart(4, '0');
    return (padded && padded !== '0000') ? padded : String(c['問い合わせNo'] || '').padStart(13, '0').substring(0, 4);
  };
  
  // 引き継ぎ実行
  const handleExecute = async () => {
    if (selectedCustomers.size === 0) { setError('顧客を選択してください'); return; }
    if (!toStudentId) { setError('引き継ぎ先メンバーを選択してください'); return; }
    
    const toMember = memberMap[toStudentId];
    const selectedList = allCustomers.filter(c => selectedCustomers.has(c['問い合わせNo']));
    const fromIds = [...new Set(selectedList.map(c => getAssigneeId(c)))];
    const fromNames = fromIds.map(id => memberMap[id]?.name || id).join(', ');
    
    const msg = `以下の引き継ぎを実行しますか？\n\n` +
      `対象: ${selectedCustomers.size}件の顧客\n` +
      `現担当: ${fromNames}\n` +
      `引き継ぎ先: ${toMember?.name || toStudentId} (${toStudentId})\n` +
      (remarks ? `備考: ${remarks}` : '');
    if (!confirm(msg)) return;
    
    setExecuting(true);
    setError(null);
    setSuccess(null);
    
    try {
      // v34: authPost使用
      const result = await authPost('executeHandover', {
        params: {
          customerInquiryNos: Array.from(selectedCustomers),
          toStudentId: toStudentId,
          toName: toMember?.name || '',
          fromName: fromNames,
          remarks: remarks
        }
      });
      
      if (result?.success) {
        setSuccess(result.message);
        setSelectedCustomers(new Set());
        setToStudentId('');
        setRemarks('');
        // データ再読み込み
        // v34: authFetch使用
        const [custRes, histRes] = await Promise.all([
          authFetch('getCustomers'),
          authFetch('getHandoverHistory')
        ]);
        if (custRes?.success) setAllCustomers(custRes.customers || []);
        if (histRes?.success) setHistory(histRes.history || []);
      } else {
        setError(result?.error || '引き継ぎに失敗しました');
      }
    } catch (err) {
      setError('引き継ぎ実行エラー: ' + (err.message || err));
    }
    setExecuting(false);
  };
  
  if (!isGasMode) {
    return (
      <div className="p-6 text-center text-gray-500">
        引き継ぎ管理はGASモード（スプレッドシート連携）でのみ利用できます。
      </div>
    );
  }
  
  if (loading) {
    return (
      <div className="flex items-center justify-center py-12">
        <div className="w-8 h-8 border-3 border-purple-500 border-t-transparent rounded-full animate-spin"></div>
        <span className="ml-3 text-gray-500">読み込み中...</span>
      </div>
    );
  }
  
  const activeMembers = members.filter(m => m.active);
  // 学生番号の重複なしリスト（フィルタ用）
  const assigneeIds = [...new Set(allCustomers.map(c => getAssigneeId(c)))].sort();
  
  return (
    <div className="space-y-5">
      {/* 説明 */}
      <div className="p-4 bg-indigo-50 border border-indigo-200 rounded-xl">
        <div className="text-sm font-medium text-indigo-800 mb-1">引き継ぎ管理</div>
        <div className="text-xs text-indigo-700">
          顧客ごとに担当者を変更できます。引き継ぎ後も前担当者からデータを閲覧できます。
        </div>
      </div>
      
      {/* アラート */}
      {error && (
        <div className="p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700 flex items-center gap-2">
          <span>⚠</span> {error}
          <button onClick={() => setError(null)} className="ml-auto text-red-400 hover:text-red-600 text-xs">✕</button>
        </div>
      )}
      {success && (
        <div className="p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-700 flex items-center gap-2">
          <span>✓</span> {success}
          <button onClick={() => setSuccess(null)} className="ml-auto text-green-400 hover:text-green-600 text-xs">✕</button>
        </div>
      )}
      
      {/* 引き継ぎ操作パネル */}
      <div className="border border-orange-200 rounded-xl overflow-hidden">
        <div className="bg-orange-50 px-4 py-3 border-b border-orange-200 flex items-center justify-between">
          <div className="font-medium text-sm text-orange-800">
            顧客を選択して引き継ぎ
            {selectedCustomers.size > 0 && (
              <span className="ml-2 px-2 py-0.5 bg-orange-200 text-orange-800 rounded-full text-xs">
                {selectedCustomers.size}件選択中
              </span>
            )}
          </div>
        </div>
        <div className="p-4 space-y-3">
          {/* フィルタ行 */}
          <div className="flex gap-3 items-end">
            <div className="flex-1">
              <label className="block text-xs font-medium text-gray-600 mb-1">企業名検索</label>
              <input
                type="text"
                value={searchText}
                onChange={(e) => setSearchText(e.target.value)}
                placeholder="企業名・問い合わせNo・担当者名"
                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-400"
              />
            </div>
            <div>
              <label className="block text-xs font-medium text-gray-600 mb-1">担当者で絞り込み</label>
              <select
                value={filterAssignee}
                onChange={(e) => { setFilterAssignee(e.target.value); setSelectedCustomers(new Set()); }}
                className="px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-400"
              >
                <option value="all">全員</option>
                {assigneeIds.map(id => (
                  <option key={id} value={id}>[{id}] {memberMap[id]?.name || '不明'}</option>
                ))}
              </select>
            </div>
          </div>
          
          {/* 顧客テーブル */}
          <div className="border border-gray-200 rounded-lg overflow-hidden max-h-72 overflow-y-auto">
            <table className="w-full text-sm">
              <thead className="bg-gray-50 sticky top-0">
                <tr>
                  <th className="px-3 py-2 text-left w-8">
                    <input
                      type="checkbox"
                      checked={filteredCustomers.length > 0 && selectedCustomers.size === filteredCustomers.length}
                      onChange={handleSelectAll}
                      className="rounded border-gray-300 text-orange-500 focus:ring-orange-400"
                    />
                  </th>
                  <th className="px-3 py-2 text-left text-xs font-medium text-gray-500">企業名</th>
                  <th className="px-3 py-2 text-left text-xs font-medium text-gray-500">問い合わせNo</th>
                  <th className="px-3 py-2 text-left text-xs font-medium text-gray-500">現担当</th>
                  <th className="px-3 py-2 text-left text-xs font-medium text-gray-500">診断日</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-gray-100">
                {filteredCustomers.map((c, i) => {
                  const no = c['問い合わせNo'] || '';
                  const aid = getAssigneeId(c);
                  const selected = selectedCustomers.has(no);
                  return (
                    <tr
                      key={i}
                      onClick={() => toggleCustomer(no)}
                      className={`cursor-pointer transition ${selected ? 'bg-orange-50' : 'hover:bg-gray-50'}`}
                    >
                      <td className="px-3 py-2">
                        <input
                          type="checkbox"
                          checked={selected}
                          onChange={() => toggleCustomer(no)}
                          className="rounded border-gray-300 text-orange-500 focus:ring-orange-400"
                        />
                      </td>
                      <td className="px-3 py-2 font-medium text-gray-800">{c['会社名'] || '-'}</td>
                      <td className="px-3 py-2 font-mono text-xs text-gray-500">{no}</td>
                      <td className="px-3 py-2">
                        <span className="inline-flex items-center gap-1 px-2 py-0.5 bg-indigo-50 text-indigo-700 rounded text-xs">
                          {aid} {memberMap[aid]?.name ? `(${memberMap[aid].name})` : ''}
                        </span>
                      </td>
                      <td className="px-3 py-2 text-xs text-gray-500">{(c['診断日時'] || '').split(' ')[0]}</td>
                    </tr>
                  );
                })}
                {filteredCustomers.length === 0 && (
                  <tr><td colSpan={5} className="px-3 py-6 text-center text-gray-400">該当する顧客がありません</td></tr>
                )}
              </tbody>
            </table>
          </div>
          <div className="text-xs text-gray-400">{filteredCustomers.length}件 / 全{allCustomers.length}件</div>
          
          {/* 引き継ぎ先 */}
          <div className="flex gap-3 items-end pt-2 border-t border-gray-100">
            <div className="flex-1">
              <label className="block text-xs font-medium text-gray-600 mb-1">引き継ぎ先メンバー</label>
              <select
                value={toStudentId}
                onChange={(e) => setToStudentId(e.target.value)}
                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-400"
              >
                <option value="">選択してください</option>
                {activeMembers.map((m, i) => (
                  <option key={i} value={m.studentId}>
                    [{m.studentId}] {m.name} ({m.role === 'admin' ? '管理者' : 'メンバー'})
                  </option>
                ))}
              </select>
            </div>
            <div className="flex-1">
              <label className="block text-xs font-medium text-gray-600 mb-1">備考（任意）</label>
              <input
                type="text"
                value={remarks}
                onChange={(e) => setRemarks(e.target.value)}
                placeholder="引き継ぎ理由など"
                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-400"
              />
            </div>
            <button
              onClick={handleExecute}
              disabled={executing || selectedCustomers.size === 0 || !toStudentId}
              className={`btn-ripple px-5 py-2 rounded-lg font-medium text-sm shadow transition whitespace-nowrap flex items-center gap-1.5 ${
                executing
                  ? 'bg-gray-400 text-white cursor-wait'
                  : selectedCustomers.size === 0 || !toStudentId
                  ? 'bg-gray-300 text-gray-400 cursor-not-allowed'
                  : 'bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white'
              }`}
            >
              {executing && (
                <svg className="w-3.5 h-3.5 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2.5}>
                  <circle cx="12" cy="12" r="10" className="opacity-25" /><path d="M4 12a8 8 0 018-8" className="opacity-75" />
                </svg>
              )}
              {executing ? '実行中...' : `${selectedCustomers.size}件を引き継ぎ`}
            </button>
          </div>
        </div>
      </div>
      
      {/* メンバー一覧 */}
      <div className="border border-gray-200 rounded-xl overflow-hidden">
        <div className="bg-gray-50 px-4 py-3 border-b border-gray-200">
          <div className="font-medium text-sm text-gray-800">メンバー一覧（{activeMembers.length}名）</div>
        </div>
        <div className="divide-y divide-gray-100 max-h-40 overflow-y-auto">
          {activeMembers.map((m, i) => {
            const custCount = allCustomers.filter(c => getAssigneeId(c) === m.studentId).length;
            return (
              <div key={i} className="px-4 py-2 flex items-center gap-3 text-sm">
                <span className="font-mono text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded">{m.studentId}</span>
                <span className="font-medium text-gray-800">{m.name}</span>
                <span className="text-gray-400 text-xs">{m.email}</span>
                <span className="ml-auto text-xs text-gray-500">{custCount}件担当</span>
                <span className={`text-xs px-2 py-0.5 rounded ${m.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-gray-100 text-gray-600'}`}>
                  {m.role === 'admin' ? '管理者' : 'メンバー'}
                </span>
              </div>
            );
          })}
        </div>
      </div>
      
      {/* 引き継ぎ履歴 */}
      <div className="border border-gray-200 rounded-xl overflow-hidden">
        <div className="bg-gray-50 px-4 py-3 border-b border-gray-200">
          <div className="font-medium text-sm text-gray-800">引き継ぎ履歴（{history.length}件）</div>
        </div>
        {history.length > 0 ? (
          <div className="divide-y divide-gray-100 max-h-52 overflow-y-auto">
            {history.slice().reverse().map((h, i) => (
              <div key={i} className="px-4 py-2.5">
                <div className="flex items-center gap-2 mb-0.5">
                  <span className="text-xs text-gray-400">{h['引き継ぎ日時']}</span>
                  <span className="text-xs text-gray-300 font-mono">{h['引き継ぎID']}</span>
                </div>
                <div className="flex items-center gap-2 text-sm">
                  <span className="font-medium text-gray-600">{h['会社名'] || h['問い合わせNo']}</span>
                  <span className="text-gray-400">:</span>
                  <span className="text-xs bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded">{h['前担当者ID']}{h['前担当者名'] ? ` (${h['前担当者名']})` : ''}</span>
                  <svg className="w-3.5 h-3.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7l5 5m0 0l-5 5m5-5H6" />
                  </svg>
                  <span className="text-xs bg-indigo-100 text-indigo-700 px-1.5 py-0.5 rounded">{h['後担当者ID']}{h['後担当者名'] ? ` (${h['後担当者名']})` : ''}</span>
                </div>
                {h['備考'] && <div className="text-xs text-gray-400 mt-0.5">{h['備考']}</div>}
              </div>
            ))}
          </div>
        ) : (
          <div className="px-4 py-6 text-sm text-gray-400 text-center">引き継ぎ履歴はありません</div>
        )}
      </div>
    </div>
  );
};

// ========================================
// AI設定画面モーダル
// ========================================

const AISettingsModal = ({ settings, onSave, onClose }) => {
  const [localSettings, setLocalSettings] = useState(() => {
    const masterConfig = MasterDataSpreadsheetManager.getConfig();
    return {
      ...settings,
      masterSpreadsheetUrl: settings.masterSpreadsheetUrl || masterConfig.scriptUrl || ''
    };
  });
  const [activeSection, setActiveSection] = useState('layermedia');
  const [testResult, setTestResult] = useState(null);
  const [isTesting, setIsTesting] = useState(false);
  
  // スプレッドシート設定
  const [spreadsheetConfig, setSpreadsheetConfig] = useState(() => SpreadsheetManager.getConfig());
  const [isTestingConnection, setIsTestingConnection] = useState(false);
  const [connectionTestResult, setConnectionTestResult] = useState(null);
  
  // 同期処理用state
  const [isSyncing, setIsSyncing] = useState(false);
  const [syncProgress, setSyncProgress] = useState({ current: 0, total: 0, name: '' });
  const [syncResult, setSyncResult] = useState(null);
  const [showSyncConfirm, setShowSyncConfirm] = useState(null); // 'upload' | 'download' | 'fullSync' | null
  
  // ログイン設定
  const [loginConfig, setLoginConfig] = useState(() => LoginManager.getConfig());
  const [newPassword, setNewPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [passwordError, setPasswordError] = useState('');
  
  // 質問マスター設定
  const [questionMaster, setQuestionMaster] = useState(() => {
    // GASモードの場合はキャッシュから読み込み（loadAllMasterDataで更新される）
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    if (isGasMode && typeof GASDataManager !== 'undefined') {
      const gasData = GASDataManager.getQuestionMaster();
      if (gasData) {
        return gasData;
      }
    }
    try {
      const saved = localStorage.getItem('gakusapo_question_master');
      return saved ? JSON.parse(saved) : DEFAULT_QUESTION_MASTER;
    } catch (e) {
      return DEFAULT_QUESTION_MASTER;
    }
  });
  
  const [questionEditSection, setQuestionEditSection] = useState('base');
  const [questionEditSize, setQuestionEditSize] = useState('small');
  const [questionEditIndustry, setQuestionEditIndustry] = useState('製造業（ものづくり）');
  const [questionEditLayer, setQuestionEditLayer] = useState('A');
  const [questionEditMethod, setQuestionEditMethod] = useState('ナビサイト');
  const [questionEditDepth, setQuestionEditDepth] = useState('surface');
  const [questionEditRole, setQuestionEditRole] = useState('staff');
  
  // 質問マスターの配列を取得するヘルパー関数
  const getQuestionArray = (master, section, size, industry, layer, method, depth, role) => {
    if (section === 'base') {
      return master.base?.[size]?.[role];
    } else if (section === 'industry') {
      return master.industry?.[industry]?.[size]?.[role];
    } else if (section === 'targetLayer') {
      return master.targetLayer?.[layer]?.[role];
    } else if (section === 'recruitmentMethod') {
      return getMethodQuestionsByCategory(master, method, methodMaster, role);
    } else if (section === 'depth') {
      return master.depth?.[depth]?.[role];
    }
    return null;
  };
  
  // 採用手法マスター設定
  const [methodMaster, setMethodMaster] = useState(() => {
    // GASモードの場合はキャッシュから読み込み
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    if (isGasMode && typeof GASDataManager !== 'undefined') {
      const gasData = GASDataManager.getMethodMaster();
      if (gasData) {
        return gasData;
      }
    }
    try {
      const saved = localStorage.getItem('gakusapo_method_master');
      return saved ? JSON.parse(saved) : DEFAULT_RECRUITMENT_METHODS;
    } catch (e) {
      return DEFAULT_RECRUITMENT_METHODS;
    }
  });
  
  const [editingMethodKey, setEditingMethodKey] = useState(null);
  const [newMethodData, setNewMethodData] = useState({
    key: '',
    name: '',
    category: 'その他',
    targetLayers: [],
    description: '',
    phaseMapping: { surface: 0.5, middle: 0.5, deep: 0.5 }
  });
  
  // カスタムカテゴリ一覧
  const [customCategories, setCustomCategories] = useState(() => {
    try {
      const saved = localStorage.getItem('gakusapo_custom_categories');
      return saved ? JSON.parse(saved) : [];
    } catch (e) {
      return [];
    }
  });
  
  // 学生層別媒体利用率マスター
  const [layerMediaUsage, setLayerMediaUsage] = useState(() => {
    // GASモードの場合はキャッシュから読み込み
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    if (isGasMode && typeof GASDataManager !== 'undefined') {
      const gasData = GASDataManager.getMediaUsageMaster();
      if (gasData) {
        return gasData;
      }
    }
    try {
      const saved = localStorage.getItem('gakusapo_layer_media_usage');
      return saved ? JSON.parse(saved) : DEFAULT_LAYER_MEDIA_USAGE;
    } catch (e) {
      return DEFAULT_LAYER_MEDIA_USAGE;
    }
  });
  
  const [selectedEditLayer, setSelectedEditLayer] = useState('A');
  
  // 歩留まり率マスター（業界別・規模別）- GASモードの場合はスプレッドシートから
  const [yieldMaster, setYieldMaster] = useState(() => {
    return GASDataManager.getYieldMaster();
  });
  
  // 設定画面パスワード変更用
  const [currentAdminPassword, setCurrentAdminPassword] = useState('');
  const [newAdminPassword, setNewAdminPassword] = useState('');
  const [confirmAdminPassword, setConfirmAdminPassword] = useState('');
  const [adminPasswordError, setAdminPasswordError] = useState('');
  const [adminPasswordSuccess, setAdminPasswordSuccess] = useState(false);
  
  // GASモードの場合、マスターデータ読み込み後に各マスターを更新
  useEffect(() => {
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    if (isGasMode && typeof GASDataManager !== 'undefined') {
      const timer = setTimeout(() => {
        // 質問マスター
        const questionData = GASDataManager.getQuestionMaster();
        if (questionData) {
          setQuestionMaster(questionData);
        }
        // 採用手法マスター
        const methodData = GASDataManager.getMethodMaster();
        if (methodData) {
          setMethodMaster(methodData);
        }
        // 媒体利用率マスター
        const mediaData = GASDataManager.getMediaUsageMaster();
        if (mediaData) {
          setLayerMediaUsage(mediaData);
        }
        // 歩留まりマスター
        const yieldData = GASDataManager.getYieldMaster();
        if (yieldData) {
          setYieldMaster(yieldData);
        }
      }, 1000);
      return () => clearTimeout(timer);
    }
  }, []);
  
  const currentPreset = AI_TONE_PRESETS[localSettings.selectedPreset] || AI_TONE_PRESETS.standard;
  
  const getEffectiveSystemPrompt = () => {
    if (localSettings.selectedPreset === 'custom') {
      return localSettings.customSystemPrompt || AI_TONE_PRESETS.standard.systemPrompt;
    }
    return currentPreset.systemPrompt;
  };
  
  const handlePresetChange = (presetId) => {
    setLocalSettings(prev => ({
      ...prev,
      selectedPreset: presetId,
      customSystemPrompt: presetId === 'custom' ? (prev.customSystemPrompt || AI_TONE_PRESETS.standard.systemPrompt) : prev.customSystemPrompt
    }));
  };
  
  const handleTestGeneration = async () => {
    if (!localSettings.apiKey) {
      setTestResult({ type: 'error', message: 'APIキーを入力してください' });
      return;
    }
    
    setIsTesting(true);
    setTestResult(null);
    
    const testData = {
      companyName: 'サンプル株式会社',
      industry: 'IT・通信',
      employeeCount: '101～300名',
      rank: 'B',
      diagnosisType: { name: 'ステルス・ゴースト', description: '認知度不足で見つけてもらえない' },
      scores: { recognition: 4, specificity: 6, differentiation: 6, visionEmpathy: 5, selectionUX: 6, dialogue: 6 },
      recruitmentEfficiency: {
        targetLayers: ['B', 'C'],
        targetLayerDetails: [
          { layer: 'B', weight: 60 },
          { layer: 'C', weight: 40 }
        ],
        activeMethods: [
          { key: 'mynavi', name: 'マイナビ', category: 'ナビサイト', budget: 50, priority: 1 },
          { key: 'offerbox', name: 'OfferBox', category: 'ダイレクトリクルーティング', budget: 30, priority: 2 },
          { key: 'onecareer', name: 'One Career', category: '口コミ・情報サイト', budget: 20, priority: 3 }
        ],
        totalBudget: 100,
        
        
        methodDetails: [
          { key: 'mynavi', name: 'マイナビ', category: 'ナビサイト', budget: 50, priority: 1, reachRate: 21, recommended: 25, budgetRatio: 50 },
          { key: 'offerbox', name: 'OfferBox', category: 'ダイレクトリクルーティング', budget: 30, priority: 2, reachRate: 17.5, recommended: 21, budgetRatio: 30 },
          { key: 'onecareer', name: 'One Career', category: '口コミ・情報サイト', budget: 20, priority: 3, reachRate: 45, recommended: 54, budgetRatio: 20 }
        ],
        recommendedAllocation: { mynavi: 25, offerbox: 21, onecareer: 54 }
      },
      remarks: 'マイナビに出稿しているが反応が薄い。地方なので人が集まらない。'
    };
    
    const systemPrompt = getEffectiveSystemPrompt();
    const userPrompt = buildUserPrompt(localSettings.userPromptTemplate || DEFAULT_USER_PROMPT_TEMPLATE, testData);
    
    try {
      const generateFunc = localSettings.apiType === 'openai' ? generateAIDiagnosisOpenAI : generateAIDiagnosisGemini;
      const result = await generateFunc(systemPrompt, userPrompt, localSettings.apiKey);
      const parsed = parseAIResponse(result);
      
      setTestResult({
        type: 'success',
        message: 'テスト生成成功！',
        data: parsed
      });
    } catch (error) {
      setTestResult({
        type: 'error',
        message: `エラー: ${error.message}`
      });
    } finally {
      setIsTesting(false);
    }
  };
  
  const handleSave = () => {
    const isGasMode = window.GAS_CONFIG?.deploymentMode === 'gas';
    const isAdmin = window.GAS_CONFIG?.permissions?.includes('admin');
    
    onSave(localSettings);
    // スプレッドシート設定も保存
    SpreadsheetManager.saveConfig(spreadsheetConfig);
    // マスターデータ用スプレッドシート設定も保存
    if (localSettings.masterSpreadsheetUrl) {
      MasterDataSpreadsheetManager.saveConfig({
        enabled: true,
        scriptUrl: localSettings.masterSpreadsheetUrl,
        lastSync: new Date().toISOString()
      });
    }
    // ログイン設定も保存
    LoginManager.saveConfig(loginConfig);
    
    // 学生層別媒体利用率マスターも保存
    if (layerMediaUsage) {
      try {
        localStorage.setItem('gakusapo_layer_media_usage', JSON.stringify(layerMediaUsage));
      } catch (e) {
        console.error('媒体利用率マスターの保存に失敗:', e);
      }
      // GASモードの場合はキャッシュを更新
      if (isGasMode) {
        // 管理者の場合はスプレッドシートにも保存
        if (isAdmin) {
          GASDataManager.saveMediaUsageMaster(layerMediaUsage);
        } else {
          // 管理者以外でもキャッシュを更新
          GASDataManager.updateMediaUsageCache(layerMediaUsage);
        }
      }
    }
    
    // 質問マスターも保存
    if (questionMaster) {
      try {
        localStorage.setItem('gakusapo_question_master', JSON.stringify(questionMaster));
      } catch (e) {
        console.error('質問マスターの保存に失敗:', e);
      }
      // GASモードの場合はキャッシュを更新
      if (isGasMode) {
        if (isAdmin) {
          GASDataManager.saveQuestionMaster(questionMaster);
        } else {
          GASDataManager.updateQuestionMasterCache(questionMaster);
        }
      }
    }
    
    // 採用手法マスターも保存
    if (methodMaster) {
      try {
        localStorage.setItem('gakusapo_method_master', JSON.stringify(methodMaster));
      } catch (e) {
        console.error('採用手法マスターの保存に失敗:', e);
      }
      // GASモードの場合はキャッシュを更新
      if (isGasMode) {
        if (isAdmin) {
          GASDataManager.saveMethodMaster(methodMaster);
        } else {
          GASDataManager.updateMethodMasterCache(methodMaster);
        }
      }
    }
    
    // 歩留まり率マスターも保存
    if (yieldMaster) {
      // GASモードの場合はキャッシュを更新
      if (isGasMode) {
        if (isAdmin) {
          GASDataManager.saveYieldMaster(yieldMaster);
        } else {
          GASDataManager.updateYieldMasterCache(yieldMaster);
        }
      } else {
        // 非GASモードでもlocalStorageに保存
        try {
          localStorage.setItem('gakusapo_yield_master', JSON.stringify(yieldMaster));
        } catch (e) {}
      }
    }
    onClose();
  };
  
  // パスワード設定
  const handleSetPassword = () => {
    setPasswordError('');
    
    if (!newPassword) {
      setPasswordError('パスワードを入力してください');
      return;
    }
    
    if (newPassword.length < 4) {
      setPasswordError('パスワードは4文字以上で設定してください');
      return;
    }
    
    if (newPassword !== confirmPassword) {
      setPasswordError('パスワードが一致しません');
      return;
    }
    
    setLoginConfig(prev => ({
      ...prev,
      password: newPassword
    }));
    setNewPassword('');
    setConfirmPassword('');
    alert('パスワードを設定しました。保存ボタンを押して設定を確定してください。');
  };
  
  // パスワードをクリア
  const handleClearPassword = () => {
    if (confirm('パスワードを削除しますか？ログイン認証が無効になります。')) {
      setLoginConfig(prev => ({
        ...prev,
        password: '',
        enabled: false
      }));
      alert('パスワードを削除しました。保存ボタンを押して設定を確定してください。');
    }
  };
  
  // スプレッドシート接続テスト
  const handleTestConnection = async () => {
    if (!spreadsheetConfig.scriptUrl) {
      setConnectionTestResult({ success: false, message: 'URLを入力してください' });
      return;
    }
    
    setIsTestingConnection(true);
    setConnectionTestResult(null);
    
    try {
      const success = await SpreadsheetManager.testConnection(spreadsheetConfig.scriptUrl);
      setConnectionTestResult({
        success: success,
        message: success ? '接続成功！スプレッドシートと連携できます。' : '接続に失敗しました。URLを確認してください。'
      });
    } catch (e) {
      setConnectionTestResult({
        success: false,
        message: `エラー: ${e.message}`
      });
    } finally {
      setIsTestingConnection(false);
    }
  };
  
  // ローカル→スプレッドシートへアップロード
  const handleSyncUpload = async () => {
    setShowSyncConfirm(null);
    setIsSyncing(true);
    setSyncResult(null);
    setSyncProgress({ current: 0, total: 0, name: '' });
    
    try {
      const customers = StorageManager.getCustomers();
      if (customers.length === 0) {
        setSyncResult({ success: false, message: 'アップロードするデータがありません' });
        return;
      }
      
      const result = await SpreadsheetManager.syncAllToSpreadsheet(
        customers,
        (current, total, name) => {
          setSyncProgress({ current, total, name });
        }
      );
      
      setSpreadsheetConfig(SpreadsheetManager.getConfig());
      setSyncResult({
        success: true,
        message: `アップロード完了！ 成功: ${result.success}件, 失敗: ${result.failed}件`,
        details: result.errors.length > 0 ? result.errors : null
      });
    } catch (e) {
      setSyncResult({ success: false, message: `エラー: ${e.message}` });
    } finally {
      setIsSyncing(false);
    }
  };
  
  // スプレッドシート→ローカルへダウンロード（マージ）
  const handleSyncDownload = async (mode = 'merge') => {
    setShowSyncConfirm(null);
    setIsSyncing(true);
    setSyncResult(null);
    
    try {
      const result = await SpreadsheetManager.loadFromSpreadsheet(mode);
      
      setSpreadsheetConfig(SpreadsheetManager.getConfig());
      setSyncResult({
        success: true,
        message: mode === 'overwrite' 
          ? `ダウンロード完了（上書き）！ ${result.resultCount}件のデータに更新しました`
          : `ダウンロード完了（マージ）！ ローカル: ${result.localCount}件 + スプレッドシート: ${result.spreadsheetCount}件 → 結果: ${result.resultCount}件`,
        reload: true
      });
    } catch (e) {
      setSyncResult({ success: false, message: `エラー: ${e.message}` });
    } finally {
      setIsSyncing(false);
    }
  };
  
  // 完全同期（ローカルのデータでスプレッドシートを完全に置き換え）
  const handleFullSync = async () => {
    setShowSyncConfirm(null);
    setIsSyncing(true);
    setSyncResult(null);
    
    try {
      const customers = StorageManager.getCustomers();
      const result = await SpreadsheetManager.fullSyncToSpreadsheet(customers);
      
      setSpreadsheetConfig(SpreadsheetManager.getConfig());
      setSyncResult({
        success: true,
        message: `完全同期完了！ ${customers.length}件のデータでスプレッドシートを更新しました`
      });
    } catch (e) {
      setSyncResult({ success: false, message: `エラー: ${e.message}` });
    } finally {
      setIsSyncing(false);
    }
  };
  
  return (
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 no-print overflow-y-auto py-8">
      <div className="bg-white rounded-2xl w-full max-w-6xl shadow-2xl mx-4 max-h-[90vh] flex flex-col">
        {/* ヘッダー */}
        <div className="flex items-center justify-between p-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50">
          <div className="flex items-center gap-3">
            <div className="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                <path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            </div>
            <div>
              <h3 className="text-lg font-bold text-gray-800">設定</h3>
              <p className="text-xs text-gray-500">システム全体の設定を管理</p>
            </div>
          </div>
          <button
            onClick={onClose}
            className="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition"
          >
            <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        
        {/* サイドバー + コンテンツ */}
        <div className="flex flex-1 overflow-hidden">
          {/* サイドバーナビゲーション */}
          <div className="w-52 bg-gray-50 border-r border-gray-200 overflow-y-auto">
            <div className="py-2">
              {/* 問診票 */}
              <div className="px-4 py-2 text-xs font-bold text-gray-400 uppercase tracking-wider">問診票</div>
              {[
                { id: 'layermedia', icon: 'chart', label: '媒体利用率設定' },
                { id: 'method', icon: 'clipboard', label: '採用手法詳細設定' },
                { id: 'question', icon: 'question', label: '質問項目設定' },
                { id: 'spreadsheet', icon: 'database', label: '顧客データ保存設定' }
              ].map(tab => (
                <button
                  key={tab.id}
                  onClick={() => setActiveSection(tab.id)}
                  className={`w-full px-4 py-2.5 text-left text-sm flex items-center gap-2.5 transition ${
                    activeSection === tab.id
                      ? 'bg-purple-100 text-purple-700 font-medium border-r-2 border-purple-500'
                      : 'text-gray-600 hover:bg-gray-100'
                  }`}
                >
                  <span className="w-4 h-4 flex-shrink-0">
                    {tab.icon === 'chart' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                      </svg>
                    )}
                    {tab.icon === 'clipboard' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                      </svg>
                    )}
                    {tab.icon === 'question' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>
                    )}
                    {tab.icon === 'database' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" />
                      </svg>
                    )}
                  </span>
                  <span>{tab.label}</span>
                </button>
              ))}
              
              {/* 診断表 */}
              <div className="px-4 py-2 mt-4 text-xs font-bold text-gray-400 uppercase tracking-wider">診断表</div>
              {[
                { id: 'sidebuttons', icon: 'pin', label: '診断ボタン設定' },
                { id: 'tone', icon: 'chat', label: '口調プリセット' },
                { id: 'prompt', icon: 'document', label: 'AI基本プロンプト' },
                { id: 'test', icon: 'beaker', label: 'AIテスト実行' }
              ].map(tab => (
                <button
                  key={tab.id}
                  onClick={() => setActiveSection(tab.id)}
                  className={`w-full px-4 py-2.5 text-left text-sm flex items-center gap-2.5 transition ${
                    activeSection === tab.id
                      ? 'bg-purple-100 text-purple-700 font-medium border-r-2 border-purple-500'
                      : 'text-gray-600 hover:bg-gray-100'
                  }`}
                >
                  <span className="w-4 h-4 flex-shrink-0">
                    {tab.icon === 'pin' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                      </svg>
                    )}
                    {tab.icon === 'chat' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                      </svg>
                    )}
                    {tab.icon === 'document' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                      </svg>
                    )}
                    {tab.icon === 'beaker' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
                      </svg>
                    )}
                  </span>
                  <span>{tab.label}</span>
                </button>
              ))}
              
              {/* その他 */}
              <div className="px-4 py-2 mt-4 text-xs font-bold text-gray-400 uppercase tracking-wider">その他</div>
              {[
                { id: 'api', icon: 'key', label: 'API設定' },
                { id: 'login', icon: 'lock', label: 'ログイン設定' },
                { id: 'members', icon: 'users', label: 'メンバー管理' },
                { id: 'handover', icon: 'handover', label: '引き継ぎ管理' }
              ].map(tab => (
                <button
                  key={tab.id}
                  onClick={() => setActiveSection(tab.id)}
                  className={`w-full px-4 py-2.5 text-left text-sm flex items-center gap-2.5 transition ${
                    activeSection === tab.id
                      ? 'bg-purple-100 text-purple-700 font-medium border-r-2 border-purple-500'
                      : 'text-gray-600 hover:bg-gray-100'
                  }`}
                >
                  <span className="w-4 h-4 flex-shrink-0">
                    {tab.icon === 'key' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
                      </svg>
                    )}
                    {tab.icon === 'sliders' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" />
                      </svg>
                    )}
                    {tab.icon === 'lock' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                      </svg>
                    )}
                    {tab.icon === 'handover' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                      </svg>
                    )}
                    {tab.icon === 'users' && (
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" className="w-4 h-4">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                      </svg>
                    )}
                  </span>
                  <span>{tab.label}</span>
                </button>
              ))}
            </div>
          </div>
          
          {/* コンテンツエリア */}
          <div className="flex-1 overflow-y-auto p-6">
          {/* API設定 */}
          {activeSection === 'api' && (
            <div className="space-y-6">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">API種類</label>
                <div className="grid grid-cols-2 gap-3">
                  {[
                    { id: 'gemini', name: 'Google Gemini 2.0', description: '無料枠あり・高速・推奨' },
                    { id: 'openai', name: 'OpenAI GPT-4', description: '高品質・有料' }
                  ].map(api => (
                    <button
                      key={api.id}
                      onClick={() => setLocalSettings(prev => ({ ...prev, apiType: api.id }))}
                      className={`p-4 rounded-xl border-2 text-left transition ${
                        localSettings.apiType === api.id
                          ? 'border-purple-500 bg-purple-50'
                          : 'border-gray-200 hover:border-gray-300'
                      }`}
                    >
                      <div className="font-medium text-gray-800">{api.name}</div>
                      <div className="text-xs text-gray-500 mt-1">{api.description}</div>
                    </button>
                  ))}
                </div>
              </div>
              
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">APIキー</label>
                <input
                  type="password"
                  value={localSettings.apiKey}
                  onChange={(e) => setLocalSettings(prev => ({ ...prev, apiKey: e.target.value }))}
                  className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
                  placeholder="APIキーを入力"
                />
                <p className="mt-2 text-xs text-gray-500">
                  {localSettings.apiType === 'gemini'
                    ? '※ Google AI Studio (https://aistudio.google.com) でAPIキーを取得できます'
                    : '※ OpenAI Platform (https://platform.openai.com) でAPIキーを取得できます'
                  }
                </p>
              </div>
            </div>
          )}
          
          {/* 質問項目設定 */}
          {activeSection === 'question' && (
            <div className="space-y-6">
              <div className="p-4 bg-orange-50 border border-orange-200 rounded-xl">
                <div className="text-sm font-medium text-orange-800 mb-1">質問項目設定</div>
                <div className="text-xs text-orange-700">
                  診断で使用する質問を管理します。企業規模・業種・ターゲット層ごとにカスタマイズできます。
                </div>
              </div>
              
              {/* セクション選択 */}
              <div className="grid grid-cols-5 gap-2">
                {[
                  { id: 'base', label: '基本質問', desc: '規模別の共通質問' },
                  { id: 'industry', label: '業種別質問', desc: '業種特有の質問' },
                  { id: 'targetLayer', label: 'ターゲット層別', desc: '学生層別の質問' },
                  { id: 'recruitmentMethod', label: '採用手法別', desc: 'カテゴリごとの質問' },
                  { id: 'depth', label: '注力タイプ別', desc: '表層/中層/深層の質問' }
                ].map(section => (
                  <button
                    key={section.id}
                    onClick={() => setQuestionEditSection(section.id)}
                    className={`p-3 rounded-xl border-2 text-left transition ${
                      questionEditSection === section.id
                        ? 'border-orange-500 bg-orange-50'
                        : 'border-gray-200 hover:border-gray-300'
                    }`}
                  >
                    <div className="font-medium text-sm text-gray-800">{section.label}</div>
                    <div className="text-xs text-gray-500">{section.desc}</div>
                  </button>
                ))}
              </div>
              
              {/* フィルター選択 */}
              <div className="grid grid-cols-2 gap-4">
                {questionEditSection !== 'targetLayer' && questionEditSection !== 'recruitmentMethod' && questionEditSection !== 'depth' && (
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">企業規模</label>
                    <select
                      value={questionEditSize}
                      onChange={(e) => setQuestionEditSize(e.target.value)}
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg"
                    >
                      <option value="small">100名以下</option>
                      <option value="medium">101〜300名</option>
                      <option value="large">301名以上</option>
                    </select>
                  </div>
                )}
                
                {questionEditSection === 'industry' && (
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">業種</label>
                    <select
                      value={questionEditIndustry}
                      onChange={(e) => setQuestionEditIndustry(e.target.value)}
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg"
                    >
                      {['製造業（ものづくり）', '製造業（食品メーカー・その他）', 'IT・通信', '金融・保険', '小売・流通', 'サービス業', '建設・不動産', '医療・福祉', '飲食・宿泊', '運輸・物流', 'マスコミ・広告', 'コンサルティング', '商社・卸売', 'その他'].map(ind => (
                        <option key={ind} value={ind}>{ind}</option>
                      ))}
                    </select>
                  </div>
                )}
                
                {questionEditSection === 'targetLayer' && (
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">学生層</label>
                    <select
                      value={questionEditLayer}
                      onChange={(e) => setQuestionEditLayer(e.target.value)}
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg"
                    >
                      {Object.entries(STUDENT_MATRIX).map(([key, layer]) => (
                        <option key={key} value={key}>{key}層: {layer.name}</option>
                      ))}
                    </select>
                  </div>
                )}
                
                {questionEditSection === 'recruitmentMethod' && (
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">採用手法カテゴリ</label>
                    <select
                      value={questionEditMethod}
                      onChange={(e) => setQuestionEditMethod(e.target.value)}
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg"
                    >
                      {[...new Set(Object.values(methodMaster || DEFAULT_RECRUITMENT_METHODS).map(m => m.category).filter(Boolean))].sort().map(cat => (
                        <option key={cat} value={cat}>{cat}</option>
                      ))}
                    </select>
                  </div>
                )}
                
                {questionEditSection === 'depth' && (
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">注力タイプ</label>
                    <select
                      value={questionEditDepth}
                      onChange={(e) => setQuestionEditDepth(e.target.value)}
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg"
                    >
                      <option value="surface">表層部（認知〜興味）</option>
                      <option value="middle">中層部（応募〜選考）</option>
                      <option value="deep">深層部（内定〜承諾）</option>
                    </select>
                  </div>
                )}
                
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">対象者</label>
                  <select
                    value={questionEditRole}
                    onChange={(e) => setQuestionEditRole(e.target.value)}
                    className="w-full px-3 py-2 border border-gray-200 rounded-lg"
                  >
                    <option value="staff">担当者</option>
                    <option value="executive">上層部</option>
                  </select>
                </div>
              </div>
              
              {/* 質問一覧 */}
              <div className="border border-gray-200 rounded-xl overflow-hidden">
                <div className="bg-gray-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center">
                  <div className="text-sm font-medium text-gray-700">
                    質問一覧
                    <span className="ml-2 text-gray-500">
                      ({(() => {
                        // デバッグ用
                        if (DEBUG_MODE && questionEditSection === 'recruitmentMethod') {
                          debugLog('=== 設定画面デバッグ ===');
                          debugLog('questionEditMethod (カテゴリ):', questionEditMethod);
                          debugLog('questionEditRole:', questionEditRole);
                          debugLog('questionMaster.recruitmentMethod:', questionMaster.recruitmentMethod);
                          debugLog('questionMaster.recruitmentMethodのキー:', Object.keys(questionMaster.recruitmentMethod || {}));
                          debugLog('=== デバッグ終了 ===');
                        }
                        const questions = questionEditSection === 'base'
                          ? questionMaster.base?.[questionEditSize]?.[questionEditRole]
                          : questionEditSection === 'industry'
                          ? questionMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole]
                          : questionEditSection === 'targetLayer'
                          ? questionMaster.targetLayer?.[questionEditLayer]?.[questionEditRole]
                          : questionEditSection === 'depth'
                          ? questionMaster.depth?.[questionEditDepth]?.[questionEditRole]
                          : getMethodQuestionsByCategory(questionMaster, questionEditMethod, methodMaster, questionEditRole);
                        return questions?.length || 0;
                      })()}件)
                    </span>
                  </div>
                  <button
                    onClick={() => {
                      const newQuestion = {
                        id: `q_${Date.now()}`,
                        question: '新しい質問',
                        choiceA: '選択肢A（正解）',
                        choiceB: '選択肢B（不正解）',
                        correctAnswer: 'A',
                        scoreType: questionEditRole === 'student' ? 'bonus' : 'penalty',
                        points: 2,
                        penaltyPoints: 2,
                        // 注力タイプ別の場合は軸タイプを設定しない（注力タイプのみ）
                        axisType: questionEditSection === 'depth' ? undefined : (questionEditRole === 'student' ? 'evaluation' : 'mindset'),
                        axisKey: questionEditSection === 'depth' ? undefined : (questionEditRole === 'student' ? 'specificity' : 'marketUnderstanding'),
                        depthPhase: questionEditSection === 'depth' ? questionEditDepth : undefined,
                        depthKey: questionEditSection === 'depth' ? questionEditDepth : undefined,
                        gapCheck: false,
                        hint: ''
                      };
                      setQuestionMaster(prev => {
                        const newMaster = JSON.parse(JSON.stringify(prev));
                        if (questionEditSection === 'base') {
                          if (!newMaster.base) newMaster.base = {};
                          if (!newMaster.base[questionEditSize]) newMaster.base[questionEditSize] = {};
                          if (!newMaster.base[questionEditSize][questionEditRole]) newMaster.base[questionEditSize][questionEditRole] = [];
                          newMaster.base[questionEditSize][questionEditRole].push(newQuestion);
                        } else if (questionEditSection === 'industry') {
                          if (!newMaster.industry) newMaster.industry = {};
                          if (!newMaster.industry[questionEditIndustry]) newMaster.industry[questionEditIndustry] = {};
                          if (!newMaster.industry[questionEditIndustry][questionEditSize]) newMaster.industry[questionEditIndustry][questionEditSize] = {};
                          if (!newMaster.industry[questionEditIndustry][questionEditSize][questionEditRole]) newMaster.industry[questionEditIndustry][questionEditSize][questionEditRole] = [];
                          newMaster.industry[questionEditIndustry][questionEditSize][questionEditRole].push(newQuestion);
                        } else if (questionEditSection === 'targetLayer') {
                          if (!newMaster.targetLayer) newMaster.targetLayer = {};
                          if (!newMaster.targetLayer[questionEditLayer]) newMaster.targetLayer[questionEditLayer] = {};
                          if (!newMaster.targetLayer[questionEditLayer][questionEditRole]) newMaster.targetLayer[questionEditLayer][questionEditRole] = [];
                          newMaster.targetLayer[questionEditLayer][questionEditRole].push(newQuestion);
                        } else if (questionEditSection === 'depth') {
                          if (!newMaster.depth) newMaster.depth = {};
                          if (!newMaster.depth[questionEditDepth]) newMaster.depth[questionEditDepth] = {};
                          if (!newMaster.depth[questionEditDepth][questionEditRole]) newMaster.depth[questionEditDepth][questionEditRole] = [];
                          newMaster.depth[questionEditDepth][questionEditRole].push(newQuestion);
                        } else if (questionEditSection === 'recruitmentMethod') {
                          if (!newMaster.recruitmentMethod) newMaster.recruitmentMethod = {};
                          if (!newMaster.recruitmentMethod[questionEditMethod]) newMaster.recruitmentMethod[questionEditMethod] = {};
                          if (!newMaster.recruitmentMethod[questionEditMethod][questionEditRole]) newMaster.recruitmentMethod[questionEditMethod][questionEditRole] = [];
                          newMaster.recruitmentMethod[questionEditMethod][questionEditRole].push(newQuestion);
                        }
                        return newMaster;
                      });
                    }}
                    className="px-3 py-1.5 text-sm bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition"
                  >
                    + 質問追加
                  </button>
                </div>
                <div className="p-4 max-h-96 overflow-y-auto">
                  {(() => {
                    const questions = questionEditSection === 'base'
                      ? questionMaster.base?.[questionEditSize]?.[questionEditRole]
                      : questionEditSection === 'industry'
                      ? questionMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole]
                      : questionEditSection === 'targetLayer'
                      ? questionMaster.targetLayer?.[questionEditLayer]?.[questionEditRole]
                      : questionEditSection === 'depth'
                      ? questionMaster.depth?.[questionEditDepth]?.[questionEditRole]
                      : getMethodQuestionsByCategory(questionMaster, questionEditMethod, methodMaster, questionEditRole);
                    
                    if (!questions || questions.length === 0) {
                      return <div className="text-center text-gray-500 py-4">質問がありません</div>;
                    }
                    
                    return questions.map((q, idx) => (
                      <div key={q.id} className="p-3 bg-gray-50 rounded-lg mb-3 border border-gray-200">
                        <div className="flex justify-between items-start mb-2">
                          <span className="text-xs text-gray-400">Q{idx + 1}</span>
                          <button
                            onClick={() => {
                              if (confirm('この質問を削除しますか？')) {
                                setQuestionMaster(prev => {
                                  const newMaster = JSON.parse(JSON.stringify(prev));
                                  let targetArray;
                                  if (questionEditSection === 'base') {
                                    targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'industry') {
                                    targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'targetLayer') {
                                    targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                  } else if (questionEditSection === 'depth') {
                                    targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                  } else if (questionEditSection === 'recruitmentMethod') {
                                    targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                  }
                                  if (targetArray) {
                                    const index = targetArray.findIndex(item => item.id === q.id);
                                    if (index > -1) targetArray.splice(index, 1);
                                  }
                                  return newMaster;
                                });
                              }
                            }}
                            className="text-red-500 hover:bg-red-50 p-1 rounded text-xs"
                          >
                            削除
                          </button>
                        </div>
                        
                        {/* 質問文 */}
                        <textarea
                          value={q.question}
                          onChange={(e) => {
                            setQuestionMaster(prev => {
                              const newMaster = JSON.parse(JSON.stringify(prev));
                              let targetArray;
                              if (questionEditSection === 'base') {
                                targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                              } else if (questionEditSection === 'industry') {
                                targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                              } else if (questionEditSection === 'targetLayer') {
                                targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                              } else if (questionEditSection === 'depth') {
                                targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                              } else if (questionEditSection === 'recruitmentMethod') {
                                targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                              }
                              const item = targetArray?.find(item => item.id === q.id);
                              if (item) item.question = e.target.value;
                              return newMaster;
                            });
                          }}
                          className="w-full px-2 py-1.5 border border-gray-200 rounded text-sm mb-2 resize-none"
                          placeholder="質問文（改行可）"
                          rows={2}
                        />
                        
                        {/* 選択肢 */}
                        <div className="grid grid-cols-2 gap-2 mb-2">
                          <input
                            type="text"
                            value={q.choiceA}
                            onChange={(e) => {
                              setQuestionMaster(prev => {
                                const newMaster = JSON.parse(JSON.stringify(prev));
                                let targetArray;
                                if (questionEditSection === 'base') {
                                  targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                } else if (questionEditSection === 'industry') {
                                  targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                } else if (questionEditSection === 'targetLayer') {
                                  targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                } else if (questionEditSection === 'depth') {
                                  targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                } else if (questionEditSection === 'recruitmentMethod') {
                                  targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                }
                                const item = targetArray?.find(item => item.id === q.id);
                                if (item) item.choiceA = e.target.value;
                                return newMaster;
                              });
                            }}
                            className="px-2 py-1 border border-gray-200 rounded text-xs"
                            placeholder="選択肢A"
                          />
                          <input
                            type="text"
                            value={q.choiceB}
                            onChange={(e) => {
                              setQuestionMaster(prev => {
                                const newMaster = JSON.parse(JSON.stringify(prev));
                                let targetArray;
                                if (questionEditSection === 'base') {
                                  targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                } else if (questionEditSection === 'industry') {
                                  targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                } else if (questionEditSection === 'targetLayer') {
                                  targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                } else if (questionEditSection === 'depth') {
                                  targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                } else if (questionEditSection === 'recruitmentMethod') {
                                  targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                }
                                const item = targetArray?.find(item => item.id === q.id);
                                if (item) item.choiceB = e.target.value;
                                return newMaster;
                              });
                            }}
                            className="px-2 py-1 border border-gray-200 rounded text-xs"
                            placeholder="選択肢B"
                          />
                        </div>
                        
                        {/* 設定行1: 基本設定 */}
                        <div className="grid grid-cols-5 gap-2 text-xs">
                          <div>
                            <label className="block text-gray-500 mb-0.5">正解</label>
                            <select
                              value={q.correctAnswer}
                              onChange={(e) => {
                                setQuestionMaster(prev => {
                                  const newMaster = JSON.parse(JSON.stringify(prev));
                                  let targetArray;
                                  if (questionEditSection === 'base') {
                                    targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'industry') {
                                    targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'targetLayer') {
                                    targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                  } else if (questionEditSection === 'depth') {
                                    targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                  } else if (questionEditSection === 'recruitmentMethod') {
                                    targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                  }
                                  const item = targetArray?.find(item => item.id === q.id);
                                  if (item) item.correctAnswer = e.target.value;
                                  return newMaster;
                                });
                              }}
                              className="w-full px-1 py-1 border border-gray-200 rounded text-xs"
                            >
                              <option value="A">A</option>
                              <option value="B">B</option>
                            </select>
                          </div>
                          <div>
                            <label className="block text-gray-500 mb-0.5">点数</label>
                            <input
                              type="number"
                              min="1"
                              max="10"
                              value={q.points ?? q.penaltyPoints ?? 2}
                              onChange={(e) => {
                                setQuestionMaster(prev => {
                                  const newMaster = JSON.parse(JSON.stringify(prev));
                                  let targetArray;
                                  if (questionEditSection === 'base') {
                                    targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'industry') {
                                    targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'targetLayer') {
                                    targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                  } else if (questionEditSection === 'depth') {
                                    targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                  } else if (questionEditSection === 'recruitmentMethod') {
                                    targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                  }
                                  const item = targetArray?.find(item => item.id === q.id);
                                  if (item) {
                                    const val = parseInt(e.target.value) || 2;
                                    item.points = val;
                                    item.penaltyPoints = val;
                                  }
                                  return newMaster;
                                });
                              }}
                              className="w-full px-1 py-1 border border-gray-200 rounded text-xs"
                            />
                          </div>
                          <div>
                            <label className="block text-gray-500 mb-0.5">軸タイプ</label>
                            <select
                              value={q.axisType || ''}
                              onChange={(e) => {
                                setQuestionMaster(prev => {
                                  const newMaster = JSON.parse(JSON.stringify(prev));
                                  let targetArray;
                                  if (questionEditSection === 'base') {
                                    targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'industry') {
                                    targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'targetLayer') {
                                    targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                  } else if (questionEditSection === 'depth') {
                                    targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                  } else if (questionEditSection === 'recruitmentMethod') {
                                    targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                  }
                                  const item = targetArray?.find(item => item.id === q.id);
                                  if (item) {
                                    if (e.target.value) {
                                      item.axisType = e.target.value;
                                    } else {
                                      delete item.axisType;
                                      delete item.axisKey;
                                    }
                                  }
                                  return newMaster;
                                });
                              }}
                              className="w-full px-1 py-1 border border-gray-200 rounded text-xs"
                            >
                              <option value="">なし</option>
                              <option value="mindset">基礎力</option>
                              <option value="evaluation">伝達力</option>
                            </select>
                          </div>
                          <div>
                            <label className="block text-gray-500 mb-0.5">軸</label>
                            <select
                              value={q.axisKey || ''}
                              disabled={!q.axisType}
                              onChange={(e) => {
                                setQuestionMaster(prev => {
                                  const newMaster = JSON.parse(JSON.stringify(prev));
                                  let targetArray;
                                  if (questionEditSection === 'base') {
                                    targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'industry') {
                                    targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'targetLayer') {
                                    targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                  } else if (questionEditSection === 'depth') {
                                    targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                  } else if (questionEditSection === 'recruitmentMethod') {
                                    targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                  }
                                  const item = targetArray?.find(item => item.id === q.id);
                                  if (item) {
                                    if (e.target.value) {
                                      item.axisKey = e.target.value;
                                    } else {
                                      delete item.axisKey;
                                    }
                                  }
                                  return newMaster;
                                });
                              }}
                              className={`w-full px-1 py-1 border border-gray-200 rounded text-xs ${!q.axisType ? 'bg-gray-100 text-gray-400' : ''}`}
                            >
                              <option value="">-</option>
                              {(q.axisType === 'mindset' || q.axisType?.includes('マインドセット')) ? (
                                <>
                                  <option value="planning">計画力</option>
                                  <option value="structure">体制力</option>
                                  <option value="marketUnderstanding">市場理解</option>
                                  <option value="management">管理力</option>
                                  <option value="ownership">当事者意識</option>
                                </>
                              ) : q.axisType === 'evaluation' ? (
                                <>
                                  <option value="recognition">認知度</option>
                                  <option value="specificity">具体性</option>
                                  <option value="differentiation">差別化力</option>
                                  <option value="visionEmpathy">共感・ビジョン</option>
                                  <option value="selectionUX">選考UX</option>
                                  <option value="dialogue">対話力</option>
                                </>
                              ) : null}
                            </select>
                          </div>
                          <div>
                            <label className="block text-gray-500 mb-0.5">注力タイプ</label>
                            <select
                              value={q.depthKey || ''}
                              onChange={(e) => {
                                setQuestionMaster(prev => {
                                  const newMaster = JSON.parse(JSON.stringify(prev));
                                  let targetArray;
                                  if (questionEditSection === 'base') {
                                    targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'industry') {
                                    targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'targetLayer') {
                                    targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                  } else if (questionEditSection === 'depth') {
                                    targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                  } else if (questionEditSection === 'recruitmentMethod') {
                                    targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                  }
                                  const item = targetArray?.find(item => item.id === q.id);
                                  if (item) {
                                    if (e.target.value) {
                                      item.depthKey = e.target.value;
                                    } else {
                                      delete item.depthKey;
                                    }
                                  }
                                  return newMaster;
                                });
                              }}
                              className="w-full px-1 py-1 border border-gray-200 rounded text-xs"
                            >
                              <option value="">なし</option>
                              <option value="surface">表層部</option>
                              <option value="middle">中層部</option>
                              <option value="deep">深層部</option>
                            </select>
                          </div>
                        </div>
                        
                        {/* 設定行2: ギャップチェック */}
                        <div className="mt-2 flex items-center gap-4">
                          <label className="flex items-center gap-1.5 cursor-pointer">
                            <input
                              type="checkbox"
                              checked={q.gapCheck || false}
                              onChange={(e) => {
                                setQuestionMaster(prev => {
                                  const newMaster = JSON.parse(JSON.stringify(prev));
                                  let targetArray;
                                  if (questionEditSection === 'base') {
                                    targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'industry') {
                                    targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'targetLayer') {
                                    targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                  } else if (questionEditSection === 'depth') {
                                    targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                  } else if (questionEditSection === 'recruitmentMethod') {
                                    targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                  }
                                  const item = targetArray?.find(item => item.id === q.id);
                                  if (item) item.gapCheck = e.target.checked;
                                  return newMaster;
                                });
                              }}
                              className="w-3.5 h-3.5 rounded border-gray-300 text-orange-500 focus:ring-orange-500"
                            />
                            <span className="text-xs text-gray-600">ギャップチェック対象</span>
                            <span className="text-xs text-gray-400">（企業側と学生側の認識差を計測）</span>
                          </label>
                        </div>
                        
                        {/* 学生向け質問文（ギャップチェック対象の場合のみ表示） */}
                        {(q.gapCheck === true || q.gapCheck === 'true') && (
                          <div className="mt-2 p-2.5 bg-orange-50 border border-orange-200 rounded-lg">
                            <label className="text-xs text-orange-700 font-medium mb-1.5 flex items-center gap-1">
                              <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                              </svg>
                              学生向け質問・回答
                              <span className="text-orange-400 font-normal ml-1">（空欄なら企業向けをそのまま使用）</span>
                            </label>
                            <textarea
                              value={q.studentQuestion || ''}
                              onChange={(e) => {
                                setQuestionMaster(prev => {
                                  const newMaster = JSON.parse(JSON.stringify(prev));
                                  let targetArray;
                                  if (questionEditSection === 'base') {
                                    targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'industry') {
                                    targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                  } else if (questionEditSection === 'targetLayer') {
                                    targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                  } else if (questionEditSection === 'depth') {
                                    targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                  } else if (questionEditSection === 'recruitmentMethod') {
                                    targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                  }
                                  const item = targetArray?.find(item => item.id === q.id);
                                  if (item) item.studentQuestion = e.target.value;
                                  return newMaster;
                                });
                              }}
                              className="w-full px-2 py-1.5 border border-orange-200 rounded text-sm bg-white resize-none"
                              placeholder="例: この会社の強みを理解していますか？"
                              rows={2}
                            />
                            
                            {/* 学生向け選択肢 */}
                            <div className="grid grid-cols-2 gap-2 mt-2">
                              <div>
                                <label className="text-[10px] text-orange-600 block mb-0.5">学生向け選択肢A</label>
                                <input
                                  type="text"
                                  value={q.studentChoiceA || ''}
                                  onChange={(e) => {
                                    setQuestionMaster(prev => {
                                      const newMaster = JSON.parse(JSON.stringify(prev));
                                      let targetArray;
                                      if (questionEditSection === 'base') {
                                        targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                      } else if (questionEditSection === 'industry') {
                                        targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                      } else if (questionEditSection === 'targetLayer') {
                                        targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                      } else if (questionEditSection === 'depth') {
                                        targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                      } else if (questionEditSection === 'recruitmentMethod') {
                                        targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                      }
                                      const item = targetArray?.find(item => item.id === q.id);
                                      if (item) item.studentChoiceA = e.target.value;
                                      return newMaster;
                                    });
                                  }}
                                  className="w-full px-2 py-1 border border-orange-200 rounded text-xs bg-white"
                                  placeholder={`空欄なら「${q.choiceA}」を使用`}
                                />
                              </div>
                              <div>
                                <label className="text-[10px] text-orange-600 block mb-0.5">学生向け選択肢B</label>
                                <input
                                  type="text"
                                  value={q.studentChoiceB || ''}
                                  onChange={(e) => {
                                    setQuestionMaster(prev => {
                                      const newMaster = JSON.parse(JSON.stringify(prev));
                                      let targetArray;
                                      if (questionEditSection === 'base') {
                                        targetArray = newMaster.base?.[questionEditSize]?.[questionEditRole];
                                      } else if (questionEditSection === 'industry') {
                                        targetArray = newMaster.industry?.[questionEditIndustry]?.[questionEditSize]?.[questionEditRole];
                                      } else if (questionEditSection === 'targetLayer') {
                                        targetArray = newMaster.targetLayer?.[questionEditLayer]?.[questionEditRole];
                                      } else if (questionEditSection === 'depth') {
                                        targetArray = newMaster.depth?.[questionEditDepth]?.[questionEditRole];
                                      } else if (questionEditSection === 'recruitmentMethod') {
                                        targetArray = findMethodQuestionTargetArray(newMaster, questionEditMethod, methodMaster, questionEditRole, q.id);
                                      }
                                      const item = targetArray?.find(item => item.id === q.id);
                                      if (item) item.studentChoiceB = e.target.value;
                                      return newMaster;
                                    });
                                  }}
                                  className="w-full px-2 py-1 border border-orange-200 rounded text-xs bg-white"
                                  placeholder={`空欄なら「${q.choiceB}」を使用`}
                                />
                              </div>
                            </div>
                            <p className="text-[10px] text-orange-500 mt-1.5">
                              💡 企業向け: 「{q.choiceA}」/「{q.choiceB}」 → 学生向けに変更可能
                            </p>
                          </div>
                        )}
                      </div>
                    ));
                  })()}
                </div>
              </div>
              
              <div className="flex justify-end gap-2">
                <button
                  onClick={() => {
                    if (confirm('質問マスターをデフォルトに戻しますか？\n（localStorageのデータもクリアされます）')) {
                      localStorage.removeItem('gakusapo_question_master');
                      setQuestionMaster(DEFAULT_QUESTION_MASTER);
                      alert('質問マスターをデフォルトに戻しました。');
                    }
                  }}
                  className="px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition"
                >
                  デフォルトに戻す
                </button>
              </div>
            </div>
          )}
          
          {/* 採用手法詳細設定 */}
          {activeSection === 'method' && (
            <div className="space-y-6">
              <div className="p-4 bg-green-50 border border-green-200 rounded-xl">
                <div className="text-sm font-medium text-green-800 mb-1">採用手法詳細設定</div>
                <div className="text-xs text-green-700">
                  利用可能な採用手法（媒体）を管理します。カスタム媒体の追加や、既存媒体の編集ができます。
                </div>
              </div>
              
              {/* 現在の採用手法一覧 */}
              <div className="border border-gray-200 rounded-xl overflow-hidden">
                <div className="bg-gray-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center">
                  <div className="text-sm font-medium text-gray-700">
                    採用手法一覧
                    <span className="ml-2 text-gray-500">({Object.keys(methodMaster).length}件)</span>
                  </div>
                </div>
                <div className="p-4 max-h-80 overflow-y-auto">
                  <div className="space-y-2">
                    {Object.entries(methodMaster).map(([key, method]) => (
                      <div key={key} className="p-3 bg-gray-50 rounded-lg flex items-center justify-between">
                        <div className="flex-1">
                          <div className="font-medium text-sm text-gray-800">{method.name}</div>
                          <div className="text-xs text-gray-500">
                            {method.category} | {method.targetLayers?.join(', ')}層
                            {method.phaseMapping && (
                              <span className="ml-2 text-gray-400">
                                [表層:{method.phaseMapping.surface} 中層:{method.phaseMapping.middle} 深層:{method.phaseMapping.deep}]
                              </span>
                            )}
                          </div>
                        </div>
                        <div className="flex gap-2">
                          <button
                            onClick={() => {
                              setEditingMethodKey(key);
                              setNewMethodData({
                                key: key,
                                name: method.name,
                                category: method.category,
                                targetLayers: method.targetLayers || [],
                                description: method.description || '',
                                phaseMapping: method.phaseMapping || { surface: 0.5, middle: 0.5, deep: 0.5 }
                              });
                            }}
                            className="px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 rounded transition"
                          >
                            編集
                          </button>
                          <button
                            onClick={() => {
                              const isDefault = DEFAULT_RECRUITMENT_METHODS[key];
                              const confirmMsg = isDefault
                                ? `「${method.name}」はデフォルトの採用手法です。\n\n削除すると以下に影響があります：\n・問診票の採用手法選択から消えます\n・この手法に関連する診断データが使えなくなります\n\n本当に削除しますか？`
                                : `「${method.name}」を削除しますか？\n\nこの操作は取り消せません。`;
                              
                              if (confirm(confirmMsg)) {
                                setMethodMaster(prev => {
                                  const newMaster = { ...prev };
                                  delete newMaster[key];
                                  return newMaster;
                                });
                              }
                            }}
                            className="px-2 py-1 text-xs text-red-600 hover:bg-red-50 rounded transition"
                          >
                            削除
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
              
              {/* 新規追加/編集フォーム */}
              <div className="border border-gray-200 rounded-xl p-4">
                <div className="text-sm font-medium text-gray-700 mb-3">
                  {editingMethodKey ? '採用手法を編集' : '新規採用手法を追加'}
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-xs font-medium text-gray-600 mb-1">キー（英数字）</label>
                    <input
                      type="text"
                      value={newMethodData.key}
                      onChange={(e) => setNewMethodData(prev => ({ ...prev, key: e.target.value }))}
                      placeholder="custom_media"
                      disabled={!!editingMethodKey}
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm disabled:bg-gray-100"
                    />
                  </div>
                  <div>
                    <label className="block text-xs font-medium text-gray-600 mb-1">表示名</label>
                    <input
                      type="text"
                      value={newMethodData.name}
                      onChange={(e) => setNewMethodData(prev => ({ ...prev, name: e.target.value }))}
                      placeholder="カスタム媒体"
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm"
                    />
                  </div>
                  <div>
                    <label className="block text-xs font-medium text-gray-600 mb-1">カテゴリ</label>
                    <div className="flex gap-2">
                      <select
                        value={newMethodData.category}
                        onChange={(e) => {
                          if (e.target.value === '__add_new__') {
                            const newCat = prompt('新しいカテゴリ名を入力してください');
                            if (newCat && newCat.trim()) {
                              const trimmedCat = newCat.trim();
                              if (!customCategories.includes(trimmedCat) && !DEFAULT_METHOD_CATEGORIES.includes(trimmedCat)) {
                                const newCustomCats = [...customCategories, trimmedCat];
                                setCustomCategories(newCustomCats);
                                localStorage.setItem('gakusapo_custom_categories', JSON.stringify(newCustomCats));
                              }
                              setNewMethodData(prev => ({ ...prev, category: trimmedCat }));
                            }
                          } else {
                            setNewMethodData(prev => ({ ...prev, category: e.target.value }));
                          }
                        }}
                        className="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm"
                      >
                        {/* 既存カテゴリ（methodMasterから動的取得 + デフォルト + カスタム） */}
                        {(() => {
                          const existingCats = new Set([
                            ...DEFAULT_METHOD_CATEGORIES,
                            ...customCategories,
                            ...Object.values(methodMaster).map(m => m.category).filter(Boolean)
                          ]);
                          return [...existingCats].sort().map(cat => (
                            <option key={cat} value={cat}>{cat}</option>
                          ));
                        })()}
                        <option value="__add_new__">＋ 新規カテゴリを追加...</option>
                      </select>
                    </div>
                  </div>
                  <div>
                    <label className="block text-xs font-medium text-gray-600 mb-1">ターゲット層</label>
                    <div className="flex flex-wrap gap-1">
                      {Object.keys(STUDENT_MATRIX).map(layer => (
                        <button
                          key={layer}
                          onClick={() => {
                            setNewMethodData(prev => ({
                              ...prev,
                              targetLayers: prev.targetLayers.includes(layer)
                                ? prev.targetLayers.filter(l => l !== layer)
                                : [...prev.targetLayers, layer]
                            }));
                          }}
                          className={`px-2 py-1 text-xs rounded ${
                            newMethodData.targetLayers.includes(layer)
                              ? 'bg-green-500 text-white'
                              : 'bg-gray-200 text-gray-600'
                          }`}
                        >
                          {layer}
                        </button>
                      ))}
                    </div>
                  </div>
                </div>
                <div className="mt-3">
                  <label className="block text-xs font-medium text-gray-600 mb-1">説明</label>
                  <input
                    type="text"
                    value={newMethodData.description}
                    onChange={(e) => setNewMethodData(prev => ({ ...prev, description: e.target.value }))}
                    placeholder="この媒体の特徴や説明"
                    className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm"
                  />
                </div>
                
                {/* フェーズ寄与度設定 */}
                <div className="mt-4 p-3 bg-gray-50 rounded-lg">
                  <label className="block text-xs font-medium text-gray-600 mb-2">
                    フェーズ寄与度（0.0〜1.0）
                    <span className="ml-2 text-gray-400 font-normal">※採用活動のどのフェーズに効果があるか</span>
                  </label>
                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="block text-xs text-gray-500 mb-1">表層部（認知〜興味）</label>
                      <input
                        type="number"
                        min="0"
                        max="1"
                        step="0.1"
                        value={newMethodData.phaseMapping?.surface ?? 0.5}
                        onChange={(e) => setNewMethodData(prev => ({
                          ...prev,
                          phaseMapping: { ...prev.phaseMapping, surface: parseFloat(e.target.value) || 0 }
                        }))}
                        className="w-full px-2 py-1.5 border border-gray-200 rounded text-sm"
                      />
                    </div>
                    <div>
                      <label className="block text-xs text-gray-500 mb-1">中層部（応募〜選考）</label>
                      <input
                        type="number"
                        min="0"
                        max="1"
                        step="0.1"
                        value={newMethodData.phaseMapping?.middle ?? 0.5}
                        onChange={(e) => setNewMethodData(prev => ({
                          ...prev,
                          phaseMapping: { ...prev.phaseMapping, middle: parseFloat(e.target.value) || 0 }
                        }))}
                        className="w-full px-2 py-1.5 border border-gray-200 rounded text-sm"
                      />
                    </div>
                    <div>
                      <label className="block text-xs text-gray-500 mb-1">深層部（内定〜承諾）</label>
                      <input
                        type="number"
                        min="0"
                        max="1"
                        step="0.1"
                        value={newMethodData.phaseMapping?.deep ?? 0.5}
                        onChange={(e) => setNewMethodData(prev => ({
                          ...prev,
                          phaseMapping: { ...prev.phaseMapping, deep: parseFloat(e.target.value) || 0 }
                        }))}
                        className="w-full px-2 py-1.5 border border-gray-200 rounded text-sm"
                      />
                    </div>
                  </div>
                  <div className="text-xs text-gray-400 mt-2">
                    例：ナビサイトは表層部(1.0)に強く、中層部(0.2)・深層部(0.0)は弱い
                  </div>
                </div>
                
                <div className="flex justify-end gap-2 mt-4">
                  {editingMethodKey && (
                    <button
                      onClick={() => {
                        setEditingMethodKey(null);
                        setNewMethodData({ key: '', name: '', category: 'その他', targetLayers: [], description: '', phaseMapping: { surface: 0.5, middle: 0.5, deep: 0.5 } });
                      }}
                      className="px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition"
                    >
                      キャンセル
                    </button>
                  )}
                  <button
                    onClick={() => {
                      if (!newMethodData.key || !newMethodData.name) {
                        alert('キーと表示名は必須です');
                        return;
                      }
                      setMethodMaster(prev => ({
                        ...prev,
                        [newMethodData.key]: {
                          name: newMethodData.name,
                          category: newMethodData.category,
                          targetLayers: newMethodData.targetLayers,
                          description: newMethodData.description,
                          phaseMapping: newMethodData.phaseMapping || { surface: 0.5, middle: 0.5, deep: 0.5 }
                        }
                      }));
                      setEditingMethodKey(null);
                      setNewMethodData({ key: '', name: '', category: 'その他', targetLayers: [], description: '', phaseMapping: { surface: 0.5, middle: 0.5, deep: 0.5 } });
                    }}
                    className="px-4 py-2 text-sm bg-green-500 text-white rounded-lg hover:bg-green-600 transition"
                  >
                    {editingMethodKey ? '更新' : '追加'}
                  </button>
                </div>
              </div>
              
              <div className="flex justify-end">
                <button
                  onClick={() => {
                    if (confirm('採用手法マスターをデフォルトに戻しますか？')) {
                      setMethodMaster(DEFAULT_RECRUITMENT_METHODS);
                    }
                  }}
                  className="px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition"
                >
                  デフォルトに戻す
                </button>
              </div>
            </div>
          )}
          
          {/* 媒体利用率設定 */}
          {activeSection === 'layermedia' && (
            <div className="space-y-6">
              <div className="p-4 bg-blue-50 border border-blue-200 rounded-xl">
                <div className="text-sm font-medium text-blue-800 mb-1">媒体利用率設定</div>
                <div className="text-xs text-blue-700">
                  各学生層がどの採用媒体をどのくらい活用しているかを設定します。この設定がAI診断の採用手法分析の計算に使用されます。
                </div>
              </div>
              
              {/* 学生層選択 */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-3">編集する学生層を選択</label>
                <div className="grid grid-cols-4 gap-2">
                  {Object.entries(STUDENT_MATRIX).map(([key, layer]) => (
                    <button
                      key={key}
                      onClick={() => setSelectedEditLayer(key)}
                      className={`p-3 rounded-xl border-2 text-left transition ${
                        selectedEditLayer === key
                          ? 'border-blue-500 bg-blue-50'
                          : 'border-gray-200 hover:border-gray-300'
                      }`}
                    >
                      <div className="flex items-center gap-2">
                        <div 
                          className="w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold text-sm"
                          style={{ backgroundColor: layer.color }}
                        >
                          {key}
                        </div>
                        <div className="text-xs text-gray-600 truncate">{layer.name}</div>
                      </div>
                    </button>
                  ))}
                </div>
              </div>
              
              {/* 選択した層の説明 */}
              <div className="p-4 bg-gray-50 rounded-xl">
                <div className="flex items-center gap-3 mb-2">
                  <div 
                    className="w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold"
                    style={{ backgroundColor: STUDENT_MATRIX[selectedEditLayer]?.color }}
                  >
                    {selectedEditLayer}
                  </div>
                  <div>
                    <div className="font-bold text-gray-800">{STUDENT_MATRIX[selectedEditLayer]?.name}</div>
                    <div className="text-xs text-gray-500">{STUDENT_MATRIX[selectedEditLayer]?.description}</div>
                  </div>
                </div>
              </div>
              
              {/* 媒体利用率編集 */}
              <div className="border border-gray-200 rounded-xl overflow-hidden">
                <div className="bg-gray-50 px-4 py-3 border-b border-gray-200">
                  <div className="text-sm font-medium text-gray-700">{selectedEditLayer}層の媒体利用率（合計100%推奨）</div>
                  <div className="text-xs text-gray-500 mt-1">
                    現在の合計: 
                    <span className={`font-bold ml-1 ${
                      Object.values(layerMediaUsage[selectedEditLayer] || {}).reduce((a, b) => a + b, 0) === 100
                        ? 'text-green-600' : 'text-orange-500'
                    }`}>
                      {Object.values(layerMediaUsage[selectedEditLayer] || {}).reduce((a, b) => a + b, 0)}%
                    </span>
                  </div>
                </div>
                <div className="p-4 max-h-80 overflow-y-auto">
                  <div className="space-y-3">
                    {Object.entries(methodMaster || DEFAULT_RECRUITMENT_METHODS).map(([methodKey, method]) => (
                      <div key={methodKey} className="flex items-center gap-3">
                        <div className="flex-1">
                          <div className="text-sm font-medium text-gray-800">{method.name}</div>
                          <div className="text-xs text-gray-500">{method.category}</div>
                        </div>
                        <div className="flex items-center gap-2">
                          <input
                            type="number"
                            min="0"
                            max="100"
                            value={layerMediaUsage[selectedEditLayer]?.[methodKey] ?? ''}
                            onChange={(e) => {
                              const raw = e.target.value;
                              if (raw === '') {
                                setLayerMediaUsage(prev => ({
                                  ...prev,
                                  [selectedEditLayer]: {
                                    ...prev[selectedEditLayer],
                                    [methodKey]: 0
                                  }
                                }));
                                return;
                              }
                              const value = Math.max(0, Math.min(100, parseInt(raw) || 0));
                              setLayerMediaUsage(prev => ({
                                ...prev,
                                [selectedEditLayer]: {
                                  ...prev[selectedEditLayer],
                                  [methodKey]: value
                                }
                              }));
                            }}
                            className="w-20 px-3 py-2 border border-gray-200 rounded-lg text-center text-sm font-bold"
                          />
                          <span className="text-gray-500 text-sm">%</span>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
              
              {/* デフォルトに戻すボタン */}
              <div className="flex justify-between items-center">
                <button
                  onClick={() => {
                    if (confirm(`${selectedEditLayer}層の設定をデフォルトに戻しますか？`)) {
                      setLayerMediaUsage(prev => ({
                        ...prev,
                        [selectedEditLayer]: DEFAULT_LAYER_MEDIA_USAGE[selectedEditLayer] || {}
                      }));
                    }
                  }}
                  className="px-4 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition"
                >
                  ↩ {selectedEditLayer}層をデフォルトに戻す
                </button>
                <button
                  onClick={() => {
                    if (confirm('全ての層の設定をデフォルトに戻しますか？')) {
                      setLayerMediaUsage(DEFAULT_LAYER_MEDIA_USAGE);
                    }
                  }}
                  className="px-4 py-2 text-sm text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition"
                >
                  ↩ 全てデフォルトに戻す
                </button>
              </div>
              
              {/* 説明 */}
              <div className="p-4 bg-yellow-50 border border-yellow-200 rounded-xl">
                <div className="text-xs text-yellow-800">
                  <p className="font-medium mb-2 flex items-center gap-1">
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                    設定のポイント
                  </p>
                  <ul className="space-y-1 list-disc list-inside">
                    <li>各層が就職活動でメインで使う媒体に高い数値を設定</li>
                    <li>合計が100%になるように調整すると計算が正確になります</li>
                    <li>実際の採用市場調査データに基づいて調整してください</li>
                  </ul>
                </div>
              </div>
            </div>
          )}
          
          {/* 顧客データ保存設定 */}
          {activeSection === 'spreadsheet' && (
            <div className="space-y-6">
              <div className="p-4 bg-green-50 border border-green-200 rounded-xl">
                <div className="text-sm font-medium text-green-800 mb-1">顧客データ保存設定</div>
                <div className="text-xs text-green-700">
                  顧客データをGoogleスプレッドシートに自動保存できます。チームでのデータ共有やバックアップに便利です。
                </div>
              </div>
              
              {/* 有効/無効切り替え */}
              <div className="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                <div>
                  <div className="font-medium text-gray-800">スプレッドシート連携</div>
                  <div className="text-xs text-gray-500">
                    {spreadsheetConfig.enabled ? '有効（保存時にスプレッドシートにも保存）' : '無効（ローカルのみに保存）'}
                  </div>
                </div>
                <button
                  onClick={() => setSpreadsheetConfig(prev => ({ ...prev, enabled: !prev.enabled }))}
                  className={`relative w-14 h-7 rounded-full transition ${
                    spreadsheetConfig.enabled ? 'bg-green-500' : 'bg-gray-300'
                  }`}
                >
                  <div className={`absolute top-1 w-5 h-5 bg-white rounded-full transition-transform ${
                    spreadsheetConfig.enabled ? 'translate-x-8' : 'translate-x-1'
                  }`} />
                </button>
              </div>
              
              {/* Google Apps Script URL */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Google Apps Script URL
                </label>
                <input
                  type="text"
                  value={spreadsheetConfig.scriptUrl}
                  onChange={(e) => setSpreadsheetConfig(prev => ({ ...prev, scriptUrl: e.target.value }))}
                  className="w-full px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent transition"
                  placeholder="https://script.google.com/macros/s/xxxxx/exec"
                />
                <p className="mt-2 text-xs text-gray-500">
                  ※ Google Apps Scriptをデプロイして取得したURLを入力してください
                </p>
              </div>
              
              {/* 接続テスト */}
              <div>
                <button
                  onClick={handleTestConnection}
                  disabled={isTestingConnection || !spreadsheetConfig.scriptUrl}
                  className="px-6 py-3 bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white rounded-xl font-medium transition disabled:cursor-not-allowed"
                >
                  {isTestingConnection ? (
                    <span className="flex items-center gap-2">
                      <svg className="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                        <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                      </svg>
                      テスト中...
                    </span>
                  ) : '🔗 接続テスト'}
                </button>
                
                {connectionTestResult && (
                  <div className={`mt-3 p-3 rounded-xl text-sm ${
                    connectionTestResult.success 
                      ? 'bg-green-50 border border-green-200 text-green-800' 
                      : 'bg-red-50 border border-red-200 text-red-800'
                  }`}>
                    <span className="flex items-center gap-1">
                      {connectionTestResult.success ? (
                        <svg className="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                        </svg>
                      ) : (
                        <svg className="w-4 h-4 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                        </svg>
                      )}
                      {connectionTestResult.message}
                    </span>
                  </div>
                )}
              </div>
              
              {/* 最終同期日時 */}
              {spreadsheetConfig.lastSync && (
                <div className="p-3 bg-gray-50 rounded-xl">
                  <div className="text-xs text-gray-500">
                    最終同期: {new Date(spreadsheetConfig.lastSync).toLocaleString('ja-JP')}
                  </div>
                </div>
              )}
              
              {/* データ同期セクション */}
              {spreadsheetConfig.enabled && spreadsheetConfig.scriptUrl && (
                <div className="border border-blue-200 rounded-xl overflow-hidden">
                  <div className="bg-blue-50 px-4 py-3 border-b border-blue-200">
                    <div className="text-sm font-medium text-blue-800 flex items-center gap-1">
                      <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                      </svg>
                      データ同期
                    </div>
                    <div className="text-xs text-blue-600 mt-1">ローカルとスプレッドシートのデータを同期します</div>
                  </div>
                  <div className="p-4 space-y-4">
                    {/* 同期進行状況 */}
                    {isSyncing && (
                      <div className="p-4 bg-blue-50 border border-blue-200 rounded-xl">
                        <div className="flex items-center gap-3 mb-2">
                          <svg className="animate-spin h-5 w-5 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                          </svg>
                          <span className="text-sm font-medium text-blue-800">同期中...</span>
                        </div>
                        {syncProgress.total > 0 && (
                          <div>
                            <div className="text-xs text-blue-600 mb-1">
                              {syncProgress.current} / {syncProgress.total} 件処理中
                              {syncProgress.name && ` - ${syncProgress.name}`}
                            </div>
                            <div className="w-full h-2 bg-blue-200 rounded-full overflow-hidden">
                              <div 
                                className="h-full bg-blue-500 transition-all duration-300"
                                style={{ width: `${(syncProgress.current / syncProgress.total) * 100}%` }}
                              />
                            </div>
                          </div>
                        )}
                      </div>
                    )}
                    
                    {/* 同期結果 */}
                    {syncResult && (
                      <div className={`p-4 rounded-xl border ${
                        syncResult.success 
                          ? 'bg-green-50 border-green-200' 
                          : 'bg-red-50 border-red-200'
                      }`}>
                        <div className={`text-sm font-medium flex items-center gap-1 ${
                          syncResult.success ? 'text-green-800' : 'text-red-800'
                        }`}>
                          {syncResult.success ? (
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                            </svg>
                          ) : (
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                            </svg>
                          )}
                          {syncResult.message}
                        </div>
                        {syncResult.details && (
                          <div className="mt-2 text-xs text-red-600">
                            <div className="font-medium">失敗した項目:</div>
                            {syncResult.details.map((d, i) => (
                              <div key={i}>・{d.name}: {d.error}</div>
                            ))}
                          </div>
                        )}
                        {syncResult.reload && (
                          <button
                            onClick={() => window.location.reload()}
                            className="mt-3 px-4 py-2 bg-green-500 hover:bg-green-600 text-white text-sm rounded-lg transition"
                          >
                            ページを更新して反映
                          </button>
                        )}
                      </div>
                    )}
                    
                    {/* 同期ボタン */}
                    {!isSyncing && (
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                        {/* アップロード */}
                        <button
                          onClick={() => setShowSyncConfirm('upload')}
                          className="p-4 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl transition text-left"
                        >
                          <div className="flex items-center gap-2 mb-1">
                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                            </svg>
                            <span className="font-medium">アップロード</span>
                          </div>
                          <div className="text-xs text-blue-100">ローカル → スプレッドシート</div>
                        </button>
                        
                        {/* ダウンロード（マージ） */}
                        <button
                          onClick={() => setShowSyncConfirm('download')}
                          className="p-4 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-xl transition text-left"
                        >
                          <div className="flex items-center gap-2 mb-1">
                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            <span className="font-medium">ダウンロード（マージ）</span>
                          </div>
                          <div className="text-xs text-green-100">スプレッドシート → ローカル（既存データと統合）</div>
                        </button>
                        
                        {/* ダウンロード（上書き） */}
                        <button
                          onClick={() => setShowSyncConfirm('downloadOverwrite')}
                          className="p-4 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white rounded-xl transition text-left"
                        >
                          <div className="flex items-center gap-2 mb-1">
                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
                            </svg>
                            <span className="font-medium">ダウンロード（上書き）</span>
                          </div>
                          <div className="text-xs text-orange-100">スプレッドシートのデータで完全に置き換え</div>
                        </button>
                        
                        {/* 完全同期 */}
                        <button
                          onClick={() => setShowSyncConfirm('fullSync')}
                          className="p-4 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white rounded-xl transition text-left"
                        >
                          <div className="flex items-center gap-2 mb-1">
                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                            </svg>
                            <span className="font-medium">完全同期（上書きアップロード）</span>
                          </div>
                          <div className="text-xs text-purple-100">ローカルのデータでスプレッドシートを完全に置き換え</div>
                        </button>
                      </div>
                    )}
                  </div>
                </div>
              )}
              
              {/* 同期確認モーダル */}
              {showSyncConfirm && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-[60]">
                  <div className="bg-white rounded-2xl p-6 max-w-md mx-4 shadow-2xl">
                    <div className="flex items-center gap-2 text-lg font-bold text-gray-800 mb-3">
                      {showSyncConfirm === 'upload' && (
                        <>
                          <svg className="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                          </svg>
                          <span>アップロード確認</span>
                        </>
                      )}
                      {showSyncConfirm === 'download' && (
                        <>
                          <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                          </svg>
                          <span>ダウンロード確認（マージ）</span>
                        </>
                      )}
                      {showSyncConfirm === 'downloadOverwrite' && (
                        <>
                          <svg className="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
                          </svg>
                          <span>ダウンロード確認（上書き）</span>
                        </>
                      )}
                      {showSyncConfirm === 'fullSync' && (
                        <>
                          <svg className="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                          </svg>
                          <span>完全同期確認</span>
                        </>
                      )}
                    </div>
                    <div className="text-sm text-gray-600 mb-4">
                      {showSyncConfirm === 'upload' && (
                        <>
                          ローカルの全データ（{StorageManager.getCustomers().length}件）をスプレッドシートにアップロードします。
                          <br /><br />
                          スプレッドシートに同じIDのデータがある場合は上書きされます。
                        </>
                      )}
                      {showSyncConfirm === 'download' && (
                        <>
                          スプレッドシートのデータをローカルにダウンロードします。
                          <br /><br />
                          既存のローカルデータと統合され、同じIDのデータは新しい方が優先されます。
                        </>
                      )}
                      {showSyncConfirm === 'downloadOverwrite' && (
                        <>
                          <span className="text-red-600 font-medium">注意：</span>
                          ローカルのデータはすべて削除され、スプレッドシートのデータで完全に置き換えられます。
                          <br /><br />
                          この操作は取り消せません。
                        </>
                      )}
                      {showSyncConfirm === 'fullSync' && (
                        <>
                          <span className="text-red-600 font-medium">注意：</span>
                          スプレッドシートのデータはすべて削除され、ローカルのデータ（{StorageManager.getCustomers().length}件）で完全に置き換えられます。
                          <br /><br />
                          この操作は取り消せません。
                        </>
                      )}
                    </div>
                    <div className="flex gap-3">
                      <button
                        onClick={() => setShowSyncConfirm(null)}
                        className="flex-1 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg transition"
                      >
                        キャンセル
                      </button>
                      <button
                        onClick={() => {
                          if (showSyncConfirm === 'upload') handleSyncUpload();
                          else if (showSyncConfirm === 'download') handleSyncDownload('merge');
                          else if (showSyncConfirm === 'downloadOverwrite') handleSyncDownload('overwrite');
                          else if (showSyncConfirm === 'fullSync') handleFullSync();
                        }}
                        className={`flex-1 px-4 py-2 text-white rounded-lg transition ${
                          showSyncConfirm === 'downloadOverwrite' || showSyncConfirm === 'fullSync'
                            ? 'bg-red-500 hover:bg-red-600'
                            : 'bg-blue-500 hover:bg-blue-600'
                        }`}
                      >
                        実行する
                      </button>
                    </div>
                  </div>
                </div>
              )}
              
              {/* セットアップ手順 */}
              <div className="border border-gray-200 rounded-xl overflow-hidden">
                <div className="bg-gray-50 px-4 py-3 border-b border-gray-200">
                  <div className="text-sm font-medium text-gray-700 flex items-center gap-1">
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    セットアップ手順
                  </div>
                </div>
                <div className="p-4 text-xs text-gray-600 space-y-2">
                  <div><span className="font-bold">1.</span> Googleスプレッドシートを新規作成</div>
                  <div><span className="font-bold">2.</span> 拡張機能 → Apps Script を開く</div>
                  <div><span className="font-bold">3.</span> 下のボタンでGASコードをコピーして貼り付け</div>
                  <div><span className="font-bold">4.</span> 「setupSheets」関数を1回実行（シート作成）</div>
                  <div><span className="font-bold">5.</span> デプロイ → 新しいデプロイ → ウェブアプリ</div>
                  <div><span className="font-bold">6.</span> アクセスできるユーザー: 「全員」に設定</div>
                  <div><span className="font-bold">7.</span> デプロイ後のURLを上記に入力</div>
                </div>
              </div>
              
              {/* GASコード */}
              <div className="border border-gray-200 rounded-xl overflow-hidden">
                <div className="bg-gray-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center">
                  <div className="text-sm font-medium text-gray-700 flex items-center gap-1">
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                    </svg>
                    GASコード（顧客データ用）
                  </div>
                  <button
                    onClick={() => {
                      const gasCode = `// Gakusapo 顧客データ用 GAS コード
// ========================================
// 初期セットアップ（最初に1回だけ実行）
// ========================================
function setupSheets() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  
  // 顧客データシート
  let customerSheet = ss.getSheetByName('顧客データ');
  if (!customerSheet) {
    customerSheet = ss.insertSheet('顧客データ');
    customerSheet.getRange(1, 1, 1, 20).setValues([[
      'ID', '企業名', '担当者名', '業種', '従業員規模', '診断日', '問い合わせ番号',
      '最終スコア', 'ランク', '診断タイプ', '備考',
      '認知数', '興味数', '応募数', '選考数', '内定数', '承諾数',
      '更新日時', 'JSON詳細', 'AI履歴'
    ]]);
    customerSheet.setFrozenRows(1);
  }
  
  // 診断回答シート（NEW）
  let answerSheet = ss.getSheetByName('診断回答');
  if (!answerSheet) {
    answerSheet = ss.insertSheet('診断回答');
    answerSheet.getRange(1, 1, 1, 12).setValues([[
      '顧客ID', '企業名', '診断日', 'セクション', 'サブカテゴリ',
      '質問ID', '質問文', '回答', '正解', '正誤', 'ペナルティ', '更新日時'
    ]]);
    answerSheet.setFrozenRows(1);
    // 列幅調整
    answerSheet.setColumnWidth(7, 300); // 質問文
  }
  
  // AI履歴シート
  let aiSheet = ss.getSheetByName('AI診断履歴');
  if (!aiSheet) {
    aiSheet = ss.insertSheet('AI診断履歴');
    aiSheet.getRange(1, 1, 1, 6).setValues([[
      '顧客ID', '企業名', '診断タイプ', 'AI結果', '日時', '問い合わせ番号'
    ]]);
    aiSheet.setFrozenRows(1);
  }
  
  Logger.log('シートのセットアップが完了しました');
}

// ========================================
// Web API エンドポイント
// ========================================
// JSONレスポンス生成の共通化
function createJSONResponse(data) {
  return ContentService.createTextOutput(JSON.stringify(data))
    .setMimeType(ContentService.MimeType.JSON);
}

function doGet(e) {
  const action = e?.parameter?.action || '';
  
  try {
    let result;
    switch (action) {
      case 'ping':
        result = { success: true, message: 'pong' };
        break;
      case 'getCustomers':
        result = { success: true, data: getAllCustomers() };
        break;
      case 'getAnswers':
        result = { success: true, data: getAnswersByCustomerId(e.parameter.customerId) };
        break;
      default:
        result = { success: false, error: 'Unknown action' };
    }
    
    return createJSONResponse(result);
  } catch (error) {
    return createJSONResponse({
      success: false,
      error: error.message
    });
  }
}

function doPost(e) {
  if (!e || !e.postData) {
    return createJSONResponse({
      success: false,
      error: 'No POST data received'
    });
  }
  
  try {
    const data = JSON.parse(e.postData.contents);
    const action = data.action;
    
    let result;
    switch (action) {
      case 'saveCustomer':
        result = { success: true, data: saveCustomer(data.customer) };
        break;
      case 'deleteCustomer':
        result = { success: true, data: deleteCustomer(data.id) };
        break;
      case 'saveAIHistory':
        result = { success: true, data: saveAIHistory(data.history) };
        break;
      case 'fullSync':
        result = { success: true, data: fullSyncCustomers(data.customers) };
        break;
      default:
        result = { success: false, error: 'Unknown action' };
    }
    
    return createJSONResponse(result);
  } catch (error) {
    return createJSONResponse({
      success: false,
      error: error.message
    });
  }
}

// ========================================
// 顧客データ操作
// ========================================
function getAllCustomers() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('顧客データ');
  if (!sheet) return [];
  
  const data = sheet.getDataRange().getValues();
  if (data.length <= 1) return [];
  
  const customers = [];
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    if (!row[0]) continue;
    
    let jsonData = {};
    try {
      if (row[18]) jsonData = JSON.parse(row[18]);
    } catch (e) {
      // JSON解析エラーの場合は空オブジェクトを使用（破損したデータを無視）
    }
    
    customers.push({
      id: row[0],
      companyName: row[1],
      contactName: row[2],
      industry: row[3],
      companySize: row[4],
      diagnosisDate: row[5],
      inquiryNo: row[6],
      finalScore: row[7],
      rank: row[8],
      diagnosisType: row[9],
      notes: row[10],
      updatedAt: row[17],
      ...jsonData
    });
  }
  
  return customers;
}

function saveCustomer(customer) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('顧客データ');
  if (!sheet) throw new Error('顧客データシートが見つかりません');
  
  const data = sheet.getDataRange().getValues();
  let rowIndex = -1;
  
  for (let i = 1; i < data.length; i++) {
    if (data[i][0] === customer.id) {
      rowIndex = i + 1;
      break;
    }
  }
  
  const funnel = customer.funnelData || {};
  const selectedYear = funnel.selectedYear || '27卒';
  const yearData = funnel.years?.[selectedYear] || {};
  
  const rowData = [
    customer.id,
    customer.companyName || '',
    customer.contactName || '',
    customer.industry || '',
    customer.companySize || '',
    customer.diagnosisDate || '',
    customer.inquiryNo || '',
    customer.finalScore || 0,
    customer.rank || '',
    customer.diagnosisType || '',
    customer.notes || '',
    yearData.awareness || 0,
    yearData.interest || 0,
    yearData.application || 0,
    yearData.screening || 0,
    yearData.offer || 0,
    yearData.acceptance || 0,
    new Date().toISOString(),
    JSON.stringify(customer),
    ''
  ];
  
  if (rowIndex > 0) {
    sheet.getRange(rowIndex, 1, 1, rowData.length).setValues([rowData]);
  } else {
    sheet.appendRow(rowData);
  }
  
  // 診断回答も保存
  saveAnswers(customer);
  
  return { id: customer.id };
}

function deleteCustomer(id) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  
  // 顧客データ削除
  const customerSheet = ss.getSheetByName('顧客データ');
  if (customerSheet) {
    const data = customerSheet.getDataRange().getValues();
    for (let i = data.length - 1; i >= 1; i--) {
      if (data[i][0] === id) {
        customerSheet.deleteRow(i + 1);
        break;
      }
    }
  }
  
  // 診断回答も削除
  const answerSheet = ss.getSheetByName('診断回答');
  if (answerSheet) {
    const answerData = answerSheet.getDataRange().getValues();
    for (let i = answerData.length - 1; i >= 1; i--) {
      if (answerData[i][0] === id) {
        answerSheet.deleteRow(i + 1);
      }
    }
  }
  
  return { deleted: true };
}

// ========================================
// 診断回答操作
// ========================================
function saveAnswers(customer) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  let sheet = ss.getSheetByName('診断回答');
  
  if (!sheet) {
    // シートがなければ作成
    sheet = ss.insertSheet('診断回答');
    sheet.getRange(1, 1, 1, 12).setValues([[
      '顧客ID', '企業名', '診断日', 'セクション', 'サブカテゴリ',
      '質問ID', '質問文', '回答', '正解', '正誤', 'ペナルティ', '更新日時'
    ]]);
    sheet.setFrozenRows(1);
  }
  
  // 既存の回答を削除
  const existingData = sheet.getDataRange().getValues();
  for (let i = existingData.length - 1; i >= 1; i--) {
    if (existingData[i][0] === customer.id) {
      sheet.deleteRow(i + 1);
    }
  }
  
  const rows = [];
  const now = new Date().toISOString();
  const companyName = customer.companyName || '';
  const diagnosisDate = customer.diagnosisDate || '';
  
  // 回答データの定義（共通処理）
  const answerTypes = [
    { key: 'staffAnswers', section: 'staff', getSubCategory: (answer) => answer.category || '' },
    { key: 'executiveAnswers', section: 'executive', getSubCategory: () => '' },
    { key: 'studentAnswers', section: 'student', getSubCategory: (answer) => answer.layer || '' }
  ];
  
  // 共通処理で回答を保存
  answerTypes.forEach(({ key, section, getSubCategory }) => {
    if (customer[key]) {
      Object.entries(customer[key]).forEach(([qId, answer]) => {
        rows.push([
          customer.id, companyName, diagnosisDate,
          section, getSubCategory(answer),
          qId, answer.question || '',
          answer.answer || '', answer.correct || '',
          answer.answer === answer.correct ? '○' : '×',
          answer.penalty || 0, now
        ]);
      });
    }
  });
  
  // 一括追加
  if (rows.length > 0) {
    sheet.getRange(sheet.getLastRow() + 1, 1, rows.length, 12).setValues(rows);
  }
  
  return { saved: rows.length };
}

function getAnswersByCustomerId(customerId) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('診断回答');
  if (!sheet) return [];
  
  const data = sheet.getDataRange().getValues();
  const answers = [];
  
  for (let i = 1; i < data.length; i++) {
    if (data[i][0] === customerId) {
      answers.push({
        customerId: data[i][0],
        companyName: data[i][1],
        diagnosisDate: data[i][2],
        section: data[i][3],
        subCategory: data[i][4],
        questionId: data[i][5],
        question: data[i][6],
        answer: data[i][7],
        correct: data[i][8],
        isCorrect: data[i][9],
        penalty: data[i][10],
        updatedAt: data[i][11]
      });
    }
  }
  
  return answers;
}

// ========================================
// AI履歴操作
// ========================================
function saveAIHistory(history) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('AI診断履歴');
  if (!sheet) throw new Error('AI診断履歴シートが見つかりません');
  
  sheet.appendRow([
    history.customerId || '',
    history.companyName || '',
    history.diagnosisType || '',
    history.result || '',
    new Date().toISOString(),
    history.inquiryNo || ''
  ]);
  
  return { saved: true };
}

// ========================================
// 完全同期（全データを置き換え）
// ========================================
function fullSyncCustomers(customers) {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('顧客データ');
  if (!sheet) throw new Error('顧客データシートが見つかりません');
  
  // ヘッダー行以外を全削除
  const lastRow = sheet.getLastRow();
  if (lastRow > 1) {
    sheet.deleteRows(2, lastRow - 1);
  }
  
  // 全データを追加
  let savedCount = 0;
  customers.forEach(customer => {
    try {
      saveCustomer(customer);
      savedCount++;
    } catch (e) {
      console.error('保存エラー:', customer.id, e);
    }
  });
  
  return { syncedCount: savedCount, totalCount: customers.length };
}`;
                      navigator.clipboard.writeText(gasCode);
                      alert('GASコードをコピーしました！\\n\\nスプレッドシートの「拡張機能」→「Apps Script」に貼り付けてください。');
                    }}
                    className="px-3 py-1.5 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 transition"
                  >
                    コードをコピー
                  </button>
                </div>
                <div className="p-4">
                  <div className="text-xs text-gray-600 space-y-2">
                    <p><strong>含まれる機能：</strong></p>
                    <ul className="list-disc list-inside space-y-1 ml-2">
                      <li>setupSheets(): シートの初期セットアップ</li>
                      <li>顧客データの保存・取得・削除</li>
                      <li><span className="text-green-600 font-medium">診断回答の保存・取得（1行1回答形式）</span></li>
                      <li>AI診断履歴の保存</li>
                      <li><span className="text-blue-600 font-medium">完全同期（データの一括アップロード）</span></li>
                    </ul>
                    <p className="mt-3"><strong>作成されるシート：</strong></p>
                    <ul className="list-disc list-inside space-y-1 ml-2">
                      <li>顧客データ - 基本情報・スコア・ファネル数値</li>
                      <li><span className="text-green-600 font-medium">診断回答 - 質問ごとの回答・正誤・ペナルティ</span></li>
                      <li>AI診断履歴 - AI分析結果</li>
                    </ul>
                    <p className="mt-3 text-amber-600 flex items-start gap-1">
                      <svg className="w-4 h-4 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                      </svg>
                      デプロイ後、コードを変更した場合は「新しいデプロイ」で再デプロイが必要です
                    </p>
                  </div>
                </div>
              </div>
            </div>
          )}
          
          {/* ログイン設定 */}
          {activeSection === 'login' && (
            <div className="space-y-6">
              <div className="p-4 bg-blue-50 border border-blue-200 rounded-xl">
                <div className="text-sm font-medium text-blue-800 mb-1">ログイン認証</div>
                <div className="text-xs text-blue-700">
                  システムへのアクセスにパスワード認証を設定できます。ネット公開時のセキュリティ対策として推奨します。
                </div>
              </div>
              
              {/* 有効/無効切り替え */}
              <div className="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                <div>
                  <div className="font-medium text-gray-800">ログイン認証</div>
                  <div className="text-xs text-gray-500">
                    {loginConfig.enabled ? '有効（アクセス時にパスワード入力が必要）' : '無効（誰でもアクセス可能）'}
                  </div>
                </div>
                <button
                  onClick={() => {
                    if (!loginConfig.password && !loginConfig.enabled) {
                      alert('先にパスワードを設定してください');
                      return;
                    }
                    setLoginConfig(prev => ({ ...prev, enabled: !prev.enabled }));
                  }}
                  className={`relative w-14 h-7 rounded-full transition ${
                    loginConfig.enabled ? 'bg-blue-500' : 'bg-gray-300'
                  }`}
                >
                  <div className={`absolute top-1 w-5 h-5 bg-white rounded-full transition-transform ${
                    loginConfig.enabled ? 'translate-x-8' : 'translate-x-1'
                  }`} />
                </button>
              </div>
              
              {/* 現在のパスワード状態 */}
              <div className="p-4 border border-gray-200 rounded-xl">
                <div className="flex items-center justify-between">
                  <div>
                    <div className="text-sm font-medium text-gray-700">パスワード状態</div>
                    <div className="text-xs text-gray-500 mt-1">
                      {loginConfig.password 
                        ? `設定済み（${loginConfig.password.length}文字）` 
                        : '未設定'
                      }
                    </div>
                  </div>
                  {loginConfig.password && (
                    <button
                      onClick={handleClearPassword}
                      className="px-3 py-1.5 text-xs text-red-600 hover:bg-red-50 border border-red-200 rounded-lg transition"
                    >
                      パスワードを削除
                    </button>
                  )}
                </div>
              </div>
              
              {/* 新しいパスワード設定 */}
              <div className="border border-gray-200 rounded-xl overflow-hidden">
                <div className="bg-gray-50 px-4 py-3 border-b border-gray-200">
                  <div className="text-sm font-medium text-gray-700">
                    {loginConfig.password ? 'パスワードを変更' : '新しいパスワードを設定'}
                  </div>
                </div>
                <div className="p-4 space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      新しいパスワード
                    </label>
                    <input
                      type="password"
                      value={newPassword}
                      onChange={(e) => setNewPassword(e.target.value)}
                      className="w-full px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                      placeholder="4文字以上で入力"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      パスワード確認
                    </label>
                    <input
                      type="password"
                      value={confirmPassword}
                      onChange={(e) => setConfirmPassword(e.target.value)}
                      className="w-full px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                      placeholder="もう一度入力"
                    />
                  </div>
                  
                  {passwordError && (
                    <div className="p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-800 flex items-center gap-2">
                      <svg className="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                      </svg>
                      {passwordError}
                    </div>
                  )}
                  
                  <button
                    onClick={handleSetPassword}
                    disabled={!newPassword || !confirmPassword}
                    className="w-full py-3 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-xl font-medium transition disabled:cursor-not-allowed"
                  >
                    パスワードを設定
                  </button>
                </div>
              </div>
              
              {/* セッションタイムアウト設定 */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  セッション有効期間
                </label>
                <select
                  value={loginConfig.sessionTimeout}
                  onChange={(e) => setLoginConfig(prev => ({ ...prev, sessionTimeout: parseInt(e.target.value) }))}
                  className="w-full px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                >
                  <option value={1}>1時間</option>
                  <option value={8}>8時間（営業時間中）</option>
                  <option value={24}>24時間（1日）</option>
                  <option value={168}>1週間</option>
                </select>
                <p className="mt-2 text-xs text-gray-500">
                  ※ 一度ログインすると、この期間はパスワード入力なしでアクセスできます
                </p>
              </div>
              
              {/* 注意事項 */}
              <div className="p-4 bg-yellow-50 border border-yellow-200 rounded-xl">
                <div className="text-sm font-medium text-yellow-800 mb-1 flex items-center gap-1"><svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>注意</div>
                <ul className="text-xs text-yellow-700 space-y-1">
                  <li>・パスワードを忘れると、ブラウザのlocalStorageをクリアする必要があります</li>
                  <li>・セキュリティ上、推測されにくいパスワードを設定してください</li>
                  <li>・ログイン設定は端末ごとに保存されます</li>
                </ul>
              </div>
              
              {/* 区切り線 */}
              <div className="border-t border-gray-300 my-6"></div>
              
              {/* 設定画面パスワード変更 */}
              <div className="p-4 bg-purple-50 border border-purple-200 rounded-xl">
                <div className="text-sm font-medium text-purple-800 mb-1">設定画面パスワード</div>
                <div className="text-xs text-purple-700">
                  この設定画面にアクセスするためのパスワードを変更できます。
                </div>
              </div>
              
              {/* 設定画面パスワード変更フォーム */}
              <div className="border border-gray-200 rounded-xl overflow-hidden">
                <div className="bg-gray-50 px-4 py-3 border-b border-gray-200">
                  <div className="text-sm font-medium text-gray-700">設定画面パスワードを変更</div>
                </div>
                <div className="p-4 space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      現在のパスワード
                    </label>
                    <input
                      type="password"
                      value={currentAdminPassword}
                      onChange={(e) => { setCurrentAdminPassword(e.target.value); setAdminPasswordError(''); setAdminPasswordSuccess(false); }}
                      className="w-full px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
                      placeholder="現在のパスワードを入力"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      新しいパスワード
                    </label>
                    <input
                      type="password"
                      value={newAdminPassword}
                      onChange={(e) => { setNewAdminPassword(e.target.value); setAdminPasswordError(''); setAdminPasswordSuccess(false); }}
                      className="w-full px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
                      placeholder="新しいパスワード（4文字以上）"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      新しいパスワード（確認）
                    </label>
                    <input
                      type="password"
                      value={confirmAdminPassword}
                      onChange={(e) => { setConfirmAdminPassword(e.target.value); setAdminPasswordError(''); setAdminPasswordSuccess(false); }}
                      className="w-full px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
                      placeholder="もう一度入力"
                    />
                  </div>
                  
                  {adminPasswordError && (
                    <div className="p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-800 flex items-center gap-2">
                      <svg className="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                      </svg>
                      {adminPasswordError}
                    </div>
                  )}
                  
                  {adminPasswordSuccess && (
                    <div className="p-3 bg-green-50 border border-green-200 rounded-xl text-sm text-green-800 flex items-center gap-2">
                      <svg className="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                      </svg>
                      設定画面パスワードを変更しました
                    </div>
                  )}
                  
                  <button
                    onClick={() => {
                      setAdminPasswordError('');
                      setAdminPasswordSuccess(false);
                      
                      // 現在のパスワード確認
                      if (!AdminPasswordManager.verify(currentAdminPassword)) {
                        setAdminPasswordError('現在のパスワードが正しくありません');
                        return;
                      }
                      
                      // 新しいパスワードのバリデーション
                      if (!newAdminPassword) {
                        setAdminPasswordError('新しいパスワードを入力してください');
                        return;
                      }
                      
                      if (newAdminPassword.length < 4) {
                        setAdminPasswordError('パスワードは4文字以上で設定してください');
                        return;
                      }
                      
                      if (newAdminPassword !== confirmAdminPassword) {
                        setAdminPasswordError('新しいパスワードが一致しません');
                        return;
                      }
                      
                      // パスワード保存
                      if (AdminPasswordManager.setPassword(newAdminPassword)) {
                        setAdminPasswordSuccess(true);
                        setCurrentAdminPassword('');
                        setNewAdminPassword('');
                        setConfirmAdminPassword('');
                      } else {
                        setAdminPasswordError('パスワードの保存に失敗しました');
                      }
                    }}
                    disabled={!currentAdminPassword || !newAdminPassword || !confirmAdminPassword}
                    className="w-full py-3 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-400 text-white rounded-xl font-medium transition disabled:cursor-not-allowed"
                  >
                    設定画面パスワードを変更
                  </button>
                </div>
              </div>
            </div>
          )}
          
          {/* メンバー管理 */}
          {activeSection === 'members' && (
            <MemberManagementPanel />
          )}
          
          {/* 引き継ぎ管理 */}
          {activeSection === 'handover' && (
            <HandoverPanel />
          )}
          {/* 口調プリセット */}
          {activeSection === 'tone' && (
            <div className="space-y-4">
              <p className="text-sm text-gray-600 mb-4">AIが生成するアドバイスの口調を選択してください。</p>
              <div className="grid grid-cols-2 gap-4">
                {Object.values(AI_TONE_PRESETS).map(preset => (
                  <button
                    key={preset.id}
                    onClick={() => handlePresetChange(preset.id)}
                    className={`p-4 rounded-xl border-2 text-left transition ${
                      localSettings.selectedPreset === preset.id
                        ? 'border-purple-500 bg-purple-50'
                        : 'border-gray-200 hover:border-gray-300'
                    }`}
                  >
                    <div className="text-lg mb-1">{preset.name}</div>
                    <div className="text-xs text-gray-500">{preset.description}</div>
                  </button>
                ))}
              </div>
              
              {localSettings.selectedPreset !== 'custom' && (
                <div className="mt-6 p-4 bg-gray-50 rounded-xl">
                  <div className="text-sm font-medium text-gray-700 mb-2">プレビュー</div>
                  <div className="text-xs text-gray-600 whitespace-pre-wrap leading-relaxed max-h-48 overflow-y-auto">
                    {currentPreset.systemPrompt}
                  </div>
                </div>
              )}
            </div>
          )}
          
          {/* サイドボタン設定 */}
          {activeSection === 'sidebuttons' && (
            <div className="space-y-6">
              <div className="p-4 bg-blue-50 border border-blue-200 rounded-xl">
                <div className="text-sm font-medium text-blue-800 mb-1">診断ボタン設定</div>
                <div className="text-xs text-blue-600">
                  診断結果画面の右端に表示される4つのボタンのラベルとプロンプトを設定できます。
                  各ボタンは異なる観点からAI診断を生成します。
                </div>
              </div>
              
              {(localSettings.sideButtons || DEFAULT_SIDE_BUTTONS).map((btn, index) => (
                <div key={btn.id} className="border border-gray-200 rounded-xl overflow-hidden">
                  <div className="bg-gray-50 px-4 py-3 border-b border-gray-200 flex items-center justify-between">
                    <div className="flex items-center gap-3">
                      <span className="text-sm font-bold text-gray-700">ボタン {index + 1}</span>
                      <input
                        type="text"
                        value={btn.label}
                        onChange={(e) => {
                          const newButtons = [...(localSettings.sideButtons || DEFAULT_SIDE_BUTTONS)];
                          newButtons[index] = { ...newButtons[index], label: e.target.value };
                          setLocalSettings(prev => ({ ...prev, sideButtons: newButtons }));
                        }}
                        className="px-3 py-1.5 border border-gray-300 rounded-lg text-sm font-medium w-32"
                        placeholder="ラベル"
                      />
                    </div>
                    <button
                      onClick={() => {
                        const newButtons = [...(localSettings.sideButtons || DEFAULT_SIDE_BUTTONS)];
                        newButtons[index] = { ...DEFAULT_SIDE_BUTTONS[index] };
                        setLocalSettings(prev => ({ ...prev, sideButtons: newButtons }));
                      }}
                      className="text-xs text-purple-600 hover:text-purple-700"
                    >
                      デフォルトに戻す
                    </button>
                  </div>
                  <div className="p-4">
                    <label className="block text-xs font-medium text-gray-600 mb-2">プロンプト</label>
                    <textarea
                      value={btn.prompt}
                      onChange={(e) => {
                        const newButtons = [...(localSettings.sideButtons || DEFAULT_SIDE_BUTTONS)];
                        newButtons[index] = { ...newButtons[index], prompt: e.target.value };
                        setLocalSettings(prev => ({ ...prev, sideButtons: newButtons }));
                      }}
                      className="w-full h-40 px-3 py-2 border border-gray-200 rounded-lg text-xs font-mono focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
                      placeholder="プロンプトを入力..."
                    />
                    <p className="mt-2 text-xs text-gray-400">
                      使用可能な変数: {'{companyName}'}, {'{industry}'}, {'{employeeCount}'}, {'{rank}'}, {'{diagnosisTypeName}'}, {'{diagnosisTypeDescription}'}, {'{remarks}'}, {'{scores.recognition}'} など
                    </p>
                  </div>
                </div>
              ))}
            </div>
          )}
          
          {/* AI基本プロンプト */}
          {activeSection === 'prompt' && (
            <div className="space-y-6">
              <div className="p-4 bg-purple-50 border border-purple-200 rounded-xl">
                <div className="text-sm font-medium text-purple-800 mb-1">AI基本プロンプト</div>
                <div className="text-xs text-purple-600">
                  AI診断全体で使用される共通のプロンプト設定です。システムプロンプト（AIの役割）とユーザープロンプト（出力フォーマット）を編集できます。
                </div>
              </div>
              
              <div>
                <div className="flex items-center justify-between mb-2">
                  <label className="text-sm font-medium text-gray-700">システムプロンプト（AIの役割設定）</label>
                  {localSettings.selectedPreset !== 'custom' && (
                    <span className="text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded">
                      ※ 編集するには「カスタム」プリセットを選択してください
                    </span>
                  )}
                </div>
                <textarea
                  value={localSettings.selectedPreset === 'custom' ? localSettings.customSystemPrompt : currentPreset.systemPrompt}
                  onChange={(e) => setLocalSettings(prev => ({ ...prev, customSystemPrompt: e.target.value }))}
                  disabled={localSettings.selectedPreset !== 'custom'}
                  className="w-full h-48 px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition disabled:bg-gray-50 disabled:text-gray-500"
                  placeholder="システムプロンプトを入力..."
                />
              </div>
              
              <div>
                <div className="flex items-center justify-between mb-2">
                  <label className="text-sm font-medium text-gray-700">ユーザープロンプト（出力フォーマット）</label>
                  <button
                    onClick={() => setLocalSettings(prev => ({ ...prev, userPromptTemplate: DEFAULT_USER_PROMPT_TEMPLATE }))}
                    className="text-xs text-purple-600 hover:text-purple-700"
                  >
                    デフォルトに戻す
                  </button>
                </div>
                <textarea
                  value={localSettings.userPromptTemplate || DEFAULT_USER_PROMPT_TEMPLATE}
                  onChange={(e) => setLocalSettings(prev => ({ ...prev, userPromptTemplate: e.target.value }))}
                  className="w-full h-64 px-4 py-3 border border-gray-200 rounded-xl text-sm font-mono focus:ring-2 focus:ring-purple-500 focus:border-transparent transition"
                  placeholder="ユーザープロンプトテンプレートを入力..."
                />
                <p className="mt-2 text-xs text-gray-500">
                  {'{companyName}'}, {'{industry}'}, {'{rank}'}, {'{remarks}'} などの変数が使用できます
                </p>
              </div>
            </div>
          )}
          
          {/* テスト実行 */}
          {activeSection === 'test' && (
            <div className="space-y-6">
              <div className="p-4 bg-blue-50 border border-blue-200 rounded-xl">
                <div className="text-sm font-medium text-blue-800 mb-1">AIテスト実行</div>
                <div className="text-xs text-blue-600">
                  サンプルデータを使用してAI生成をテストします。実際の診断データは使用されません。
                </div>
              </div>
              
              <div className="p-4 bg-gray-50 rounded-xl">
                <div className="text-sm font-medium text-gray-700 mb-2">テスト用サンプルデータ</div>
                <div className="text-xs text-gray-600 space-y-1">
                  <div>• 会社名: サンプル株式会社</div>
                  <div>• 業種: IT・通信 / 規模: 101～300名</div>
                  <div>• ランク: B / タイプ: ステルス・ゴースト</div>
                  <div>• 備考: マイナビに出稿しているが反応が薄い。地方なので人が集まらない。</div>
                </div>
              </div>
              
              <button
                onClick={handleTestGeneration}
                disabled={isTesting || !localSettings.apiKey}
                className="w-full px-6 py-4 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 disabled:from-gray-400 disabled:to-gray-500 text-white rounded-xl font-medium transition disabled:cursor-not-allowed"
              >
                {isTesting ? (
                  <span className="flex items-center justify-center gap-2">
                    <svg className="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                      <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                      <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    生成中...
                  </span>
                ) : '🧪 テスト生成を実行'}
              </button>
              
              {testResult && (
                <div className={`p-4 rounded-xl border ${
                  testResult.type === 'success'
                    ? 'bg-green-50 border-green-200'
                    : 'bg-red-50 border-red-200'
                }`}>
                  <div className={`text-sm font-medium mb-2 ${
                    testResult.type === 'success' ? 'text-green-800' : 'text-red-800'
                  }`}>
                    {testResult.message}
                  </div>
                  
                  {testResult.data && (
                    <div className="space-y-3 mt-4">
                      {[
                        { key: 'prescription', label: '処方箋' },
                        { key: 'forRecruiter', label: '採用担当者へ' },
                        { key: 'forManagement', label: '上層部へ' },
                        { key: 'organizationIssue', label: '組織の課題' }
                      ].map(item => (
                        <div key={item.key} className="bg-white p-3 rounded-lg">
                          <div className="text-xs font-medium text-gray-500 mb-1">{item.label}</div>
                          <div className="text-sm text-gray-700">{testResult.data[item.key]}</div>
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              )}
            </div>
          )}
          </div>
        </div>
        
        {/* フッター */}
        <div className="flex items-center justify-end gap-3 p-6 border-t border-gray-200">
          <button
            onClick={onClose}
            className="px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-medium transition"
          >
            キャンセル
          </button>
          <button
            onClick={handleSave}
            className="px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-xl font-medium transition flex items-center gap-2"
          >
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
            </svg>
            設定を保存
          </button>
        </div>
      </div>
    </div>
  );
};

// ========================================
// トースト通知システム（alert置き換え）
// ========================================

const ToastContext = React.createContext(null);

const ToastProvider = ({ children }) => {
  const [toasts, setToasts] = useState([]);
  const idRef = useRef(0);

  const addToast = useCallback((message, type = 'success', duration = 2800) => {
    const id = ++idRef.current;
    setToasts(prev => [...prev, { id, message, type, duration }]);
  }, []);
  const removeToast = useCallback((id) => {
    setToasts(prev => prev.filter(t => t.id !== id));
  }, []);

  return (
    <ToastContext.Provider value={addToast}>
      {children}
      <div className="fixed bottom-6 left-1/2 -translate-x-1/2 z-[9998] flex flex-col gap-2 items-center pointer-events-none no-print" style={{ zIndex: 9998 }}>
        {toasts.map(t => (
          <ToastItem key={t.id} toast={t} onDone={() => removeToast(t.id)} />
        ))}
      </div>
    </ToastContext.Provider>
  );
};

const ToastItem = ({ toast, onDone }) => {
  const [exiting, setExiting] = useState(false);
  useEffect(() => {
    const timer = setTimeout(() => setExiting(true), toast.duration || 2800);
    return () => clearTimeout(timer);
  }, []);
  useEffect(() => {
    if (exiting) { const t = setTimeout(onDone, 300); return () => clearTimeout(t); }
  }, [exiting]);

  const colors = { success: 'bg-emerald-600', error: 'bg-red-600', info: 'bg-blue-600', warning: 'bg-amber-500' };
  const icons = { success: '✓', error: '✕', info: 'ℹ', warning: '⚠' };

  return (
    <div className={`pointer-events-auto px-5 py-3 rounded-xl shadow-2xl flex items-center gap-3 text-sm font-medium text-white ${colors[toast.type] || colors.info} ${exiting ? 'toast-exit' : 'toast-enter'}`}>
      <span className="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center text-xs font-bold flex-shrink-0">
        {icons[toast.type] || 'ℹ'}
      </span>
      {toast.message}
    </div>
  );
};

const useToast = () => {
  const ctx = React.useContext(ToastContext);
  if (!ctx) return (msg) => { alert(msg); }; // フォールバック
  return ctx;
};

// ========================================
// メインアプリ
// ========================================

const App = () => {
  // v34: Google OAuth認証状態
  const [googleAuthed, setGoogleAuthed] = useState(() => {
    // sessionStorageから復元を試みる
    try {
      const savedToken = sessionStorage.getItem('bb_auth_token');
      const savedUser = sessionStorage.getItem('bb_auth_user');
      if (savedToken && savedUser) {
        const user = JSON.parse(savedUser);
        window.AUTH.idToken = savedToken;
        window.AUTH.user = user;
        window.AUTH.isLoggedIn = true;
        window.GAS_CONFIG.currentUser = user.email;
        window.GAS_CONFIG.userEmail = user.email;
        window.GAS_CONFIG.userName = user.name;
        window.GAS_CONFIG.memberName = user.name;
        window.GAS_CONFIG.studentId = user.studentId;
        window.GAS_CONFIG.permissions = user.permissions;
        window.GAS_CONFIG.deploymentMode = 'gas';
        // トークンリフレッシュタイマーを開始
        scheduleTokenRefresh();
        return true;
      }
    } catch (e) {}
    return false;
  });
  
  // auth-expiredイベントのリスナー（トークンリフレッシュ失敗時のみ発火）
  // データ消失を防ぐため、即座にアンマウントせず警告バナーを表示
  const [showReloginBanner, setShowReloginBanner] = useState(false);
  
  useEffect(() => {
    const handler = () => {
      // ★ ここでsetGoogleAuthed(false)しない → Appはアンマウントされない → データ保持
      setShowReloginBanner(true);
    };
    window.addEventListener('auth-expired', handler);
    return () => window.removeEventListener('auth-expired', handler);
  }, []);
  
  // 再ログイン処理（バナーから呼び出し）
  const handleRelogin = () => {
    // Google Sign-Inを再初期化してプロンプト表示
    if (window.google?.accounts?.id) {
      window.google.accounts.id.initialize({
        client_id: window.OAUTH_CONFIG.clientId,
        callback: async (response) => {
          if (response?.credential) {
            const idToken = response.credential;
            // GAS APIで再検証
            try {
              const url = new URL(window.GAS_CONFIG.gasUrl);
              url.searchParams.set('action', 'login');
              url.searchParams.set('id_token', idToken);
              const res = await fetch(url.toString(), { method: 'GET', redirect: 'follow' });
              const data = await res.json();
              if (data.success) {
                window.AUTH.idToken = idToken;
                window.AUTH.user = data.user;
                window.AUTH.isLoggedIn = true;
                window.AUTH._tokenExpired = false;
                try { sessionStorage.setItem('bb_auth_token', idToken); } catch(e) {}
                scheduleTokenRefresh();
                setShowReloginBanner(false);
                alert('再ログインしました。もう一度保存してください。');
              } else {
                alert('再ログインに失敗しました: ' + (data.error || ''));
              }
            } catch (err) {
              alert('通信エラー: ' + err.message);
            }
          }
        },
        auto_select: false // 明示的にユーザーに選択させる
      });
      window.google.accounts.id.prompt();
    }
  };
  
  // GASモード検出（v34: Google認証後は常にtrue）
  // ※ Reactフックルール遵守のため、条件分岐returnの前に全変数・全フックを宣言
  const isGasMode = true;
  const gasUser = window.GAS_CONFIG?.currentUser || null;
  
  // ログイン状態（Google OAuth認証済みならパスワード不要）
  const [isLoggedIn, setIsLoggedIn] = useState(() => {
    // Google OAuth認証済み（sessionStorageから復元含む）ならログイン済みとする
    if (googleAuthed) {
      LoginManager.saveSession(); // セッションも更新
      return true;
    }
    return LoginManager.checkSession();
  });
  
  const [view, setView] = useState('input');
  const [customers, setCustomers] = useState([]);
  // GASモードの場合は、GAS_CONFIGから学生番号を取得
  const [studentId, setStudentId] = useState(() => {
    if (isGasMode && window.GAS_CONFIG?.studentId) {
      return window.GAS_CONFIG.studentId;
    }
    return StorageManager.getStudentId() || '0001';
  });
  const [showSettings, setShowSettings] = useState(false);
  
  // GASモードかつ管理者でない場合は学生番号の変更を禁止
  const canChangeStudentId = !isGasMode || window.GAS_CONFIG?.permissions?.includes('admin');
  
  // AI設定関連のstate
  const [showAISettingsAuth, setShowAISettingsAuth] = useState(false);
  const [showAISettings, setShowAISettings] = useState(false);
  const [aiSettings, setAiSettings] = useState(() => AISettingsManager.getSettings());
  const [aiAdvice, setAiAdvice] = useState(null);
  const [isGeneratingAI, setIsGeneratingAI] = useState(false);
  const [aiError, setAiError] = useState(null);
  
  // AI診断モーダル表示（ヘッダーから起動用）
  const [showAIDiagnosis, setShowAIDiagnosis] = useState(false);
  
  const todayStr = new Date().toISOString().split('T')[0];
  
  // 歩留まり率マスターを取得（GASモードの場合はスプレッドシートから）
  const savedYieldMaster = GASDataManager.getYieldMaster();
  
  const [currentData, setCurrentData] = useState({
    id: null,
    companyName: '',
    contactName: '',
    industry: '',
    companySize: '',
    diagnosisDate: todayStr,
    inquiryNo: InquiryNoManager.generateNextInquiryNo('', todayStr),
    assigneeId: (() => {
      const gasId = window.GAS_CONFIG?.deploymentMode === 'gas' ? window.GAS_CONFIG?.studentId : null;
      return String(gasId || StorageManager.getStudentId() || '0001').padStart(4, '0');
    })(),
    staffScores: {},
    executiveScores: {},
    studentScores: {},
    mindsetScores: {},
    funnelData: {},
    staffAnswers: {},
    executiveAnswers: {},
    studentAnswers: {},
    recruitmentMethods: {},
    targetLayers: {},
    yieldSettings: {},
    industryAverages: {},
    adjustedAverages: {},
    notes: '',
    todayChallenge: '',       // 今日解決したいこと
    pastChallenges: '',       // 過去に挑戦してきたこと
    improvementGoals: {},     // 改善目標（現状実績）
    targetNotes: '',          // ターゲット学生 特記事項メモ
    yieldMaster: savedYieldMaster,
    methodMaster: GASDataManager.getMethodMaster() || DEFAULT_RECRUITMENT_METHODS,
    layerMediaUsage: GASDataManager.getMediaUsageMaster() || DEFAULT_LAYER_MEDIA_USAGE
  });
  const [isExporting, setIsExporting] = useState(false);
  const sheetRef = useRef(null);
  
  // ボタンフィードバック用state
  const toast = useToast();
  const [isSaving, setIsSaving] = useState(false);
  const isSavingRef = React.useRef(false); // 同期的ガード（React state は非同期のため連打対策）
  const [saveComplete, setSaveComplete] = useState(false);
  const [isCreatingNew, setIsCreatingNew] = useState(false);
  
  // サイドバナー用state（すべてのuseStateは早期returnの前に配置）
  const [generatingButtonId, setGeneratingButtonId] = useState(null);
  const [lastGeneratedButtonId, setLastGeneratedButtonId] = useState(null);
  const [showReDiagnosisModal, setShowReDiagnosisModal] = useState(false);
  const [reDiagnosisAdditionalInfo, setReDiagnosisAdditionalInfo] = useState('');
  const [showProPaymentModal, setShowProPaymentModal] = useState(false);
  const [proPaymentCode, setProPaymentCode] = useState('');
  const [proPaymentError, setProPaymentError] = useState('');
  
  // GASモードの場合、起動時にマスターデータを読み込み
  const [masterDataLoaded, setMasterDataLoaded] = useState(!isGasMode);
  const [masterDataError, setMasterDataError] = useState(null);
  
  useEffect(() => {
    if (isGasMode && !masterDataLoaded) {
      GASDataManager.loadAllMasterData().then(() => {
        // マスターデータ読み込み完了後、各マスターを更新
        const yieldMaster = GASDataManager.getYieldMaster();
        const methodMaster = GASDataManager.getMethodMaster();
        const layerMediaUsage = GASDataManager.getMediaUsageMaster();
        
        setCurrentData(prev => ({ 
          ...prev, 
          yieldMaster: yieldMaster || prev.yieldMaster,
          methodMaster: methodMaster || prev.methodMaster,
          layerMediaUsage: layerMediaUsage || prev.layerMediaUsage
        }));
        setMasterDataLoaded(true);
      }).catch(err => {
        console.error('マスターデータ読み込みエラー:', err);
        setMasterDataError('マスターデータの読み込みに失敗しました。ページを再読み込みしてください。');
        setMasterDataLoaded(true);
      });
    }
  }, [isGasMode, masterDataLoaded]);
  
  // GASモードの場合、マスターデータ読み込み完了後にAI設定を更新
  useEffect(() => {
    if (isGasMode && masterDataLoaded) {
      const updatedSettings = AISettingsManager.getSettings();
      console.log('AI設定を更新:', updatedSettings);
      setAiSettings(updatedSettings);
    }
  }, [isGasMode, masterDataLoaded]);
  
  // すべてのuseEffectを早期リターンの前に配置（Reactのフックルール）
  // ログイン成功後の顧客データ読み込み
  const [customerLoadError, setCustomerLoadError] = useState(null);
  const [customerLoadRetry, setCustomerLoadRetry] = useState(0);
  
  useEffect(() => {
    if (!isLoggedIn) return;
    
    if (isGasMode) {
      // GASモード: スプレッドシートから顧客データを読み込み
      console.log('[useEffect:顧客読込] 開始 isGasMode:', isGasMode, 'retry:', customerLoadRetry);
      setCustomerLoadError(null);
      
      GASDataManager.fetchAllCustomers()
        .then(fetchResult => {
          // fetchResultは { customers, questionMasterCache } または配列（互換）
          const gasCustomers = fetchResult ? (fetchResult.customers || fetchResult) : null;
          const qmCache = fetchResult?.questionMasterCache || {};
          const customerCount = Array.isArray(gasCustomers) ? gasCustomers.length : 0;
          console.log('[useEffect:顧客読込] fetchAllCustomers結果:', customerCount + '件, マスターキャッシュ:', Object.keys(qmCache).length + '種類');
          if (gasCustomers && customerCount > 0) {
            const normalizedCustomers = gasCustomers.map(c => normalizeGASCustomer(c, qmCache));
            setCustomers(normalizedCustomers);
            setCustomerLoadError(null);
          } else if (gasCustomers && customerCount === 0) {
            setCustomers([]);
            setCustomerLoadError(null);
          } else {
            console.warn('[useEffect:顧客読込] fetchAllCustomersがnullを返しました');
            setCustomers([]);
            setCustomerLoadError('顧客データの取得に失敗しました（設定を確認してください）');
          }
        })
        .catch(err => {
          console.error('[useEffect:顧客読込] エラー:', err);
          setCustomers([]);
          setCustomerLoadError('顧客データの読み込みに失敗: ' + (err.message || err));
        });
    } else {
      // スタンドアロンモード: ローカルストレージから読み込み
      setCustomers(StorageManager.getCustomers());
      setStudentId(StorageManager.getStudentId());
    }
  }, [isLoggedIn, isGasMode, customerLoadRetry]);
  
  // セッションチェック（ページ表示時）- GASモードでもパスワード認証を使用
  // ※ useState初期化子でLoginManager.checkSession()を呼び済み
  //   GASモードでは_gasLoginConfigが未読み込みのためfalseが返り、毎回ログイン画面を表示
  //   スタンドアロンモードではlocalStorageからセッションを復元
  // ※ ここではGASモードでマスターデータ読み込み完了後もセッションを自動復元しない
  //   （ページロード時は毎回パスワード入力を要求する仕様）

  // 定期的なセッションチェック（ログイン中のみ、セッション切れを検出）
  useEffect(() => {
    if (!isLoggedIn) return;

    const checkAuth = () => {
      const stillLoggedIn = LoginManager.checkSession();
      if (!stillLoggedIn) {
        setIsLoggedIn(false);
      }
    };

    // 5分ごとにセッション切れをチェック
    const interval = setInterval(checkAuth, 5 * 60 * 1000);
    return () => clearInterval(interval);
  }, [isLoggedIn]);
  
  // 学生番号、業種、診断日が変更されたら問い合わせ番号を再生成
  useEffect(() => {
    if (isLoggedIn && !currentData.id) {
      const currentStudentId = String(
        (window.GAS_CONFIG?.deploymentMode === 'gas' ? window.GAS_CONFIG?.studentId : null) 
        || StorageManager.getStudentId() || '0001'
      ).padStart(4, '0');
      
      // v34: 予約済み通番がある場合は業種コード部分だけ差し替え（新たな採番は不要）
      if (currentData.reservedSeqNo) {
        const newNo = InquiryNoManager.buildInquiryNo(
          currentStudentId, currentData.industry, currentData.diagnosisDate, currentData.reservedSeqNo
        );
        setCurrentData(prev => ({
          ...prev,
          inquiryNo: newNo,
          assigneeId: currentStudentId
        }));
      } else {
        // フォールバック: ローカル生成（初回ログイン直後等）
        setCurrentData(prev => ({
          ...prev,
          inquiryNo: InquiryNoManager.generateNextInquiryNoLocal(prev.industry, prev.diagnosisDate),
          assigneeId: currentStudentId
        }));
      }
    }
  }, [isLoggedIn, studentId, currentData.industry, currentData.diagnosisDate]);
  
  // v34: ログイン後の初回サーバー採番（新規診断状態で未予約の場合）
  useEffect(() => {
    if (isLoggedIn && isGasMode && !currentData.id && !currentData.reservedSeqNo && window.AUTH?.isLoggedIn) {
      (async () => {
        try {
          const reserved = await InquiryNoManager.reserveFromServer(currentData.industry, currentData.diagnosisDate);
          if (reserved) {
            setCurrentData(prev => ({
              ...prev,
              inquiryNo: reserved.inquiryNo,
              reservedSeqNo: reserved.sequentialNo
            }));
          }
        } catch (e) {
          console.log('[初回採番] フォールバック使用:', e.message);
        }
      })();
    }
  }, [isLoggedIn]);
  
  // ========== 全フック宣言完了 ==========
  // Google OAuth未認証の場合はログイン画面を表示
  if (!googleAuthed) {
    return <GoogleLoginScreen onLoginSuccess={(user) => {
      setGoogleAuthed(true);
      // Google OAuth認証成功 = ログイン完了（パスワード画面をスキップ）
      LoginManager.saveSession();
      setIsLoggedIn(true);
      // 学生番号をGAS_CONFIGから同期
      if (window.GAS_CONFIG?.studentId) {
        const gasStudentId = String(window.GAS_CONFIG.studentId).padStart(4, '0');
        setStudentId(gasStudentId);
        StorageManager.setStudentId(gasStudentId);
      }
    }} />;
  }
  
  // ログイン成功時
  const handleLogin = () => {
    // ログイン状態を更新 → useEffectが顧客データを読み込む
    setIsLoggedIn(true);
    
    // GASモードの場合は GAS_CONFIG から学生番号を取得し、localStorageにも同期
    // ※ InquiryNoManagerがStorageManager.getStudentId()（localStorage）を参照するため
    if (isGasMode && window.GAS_CONFIG?.studentId) {
      const gasStudentId = String(window.GAS_CONFIG.studentId).padStart(4, '0');
      setStudentId(gasStudentId);
      StorageManager.setStudentId(gasStudentId);
    }
  };
  
  // ログアウト
  const handleLogout = () => {
    LoginManager.logout();
    setIsLoggedIn(false);
  };
  
  // ログイン画面表示（ログインが必要な場合）
  if (!isLoggedIn) {
    return <LoginScreen onLogin={handleLogin} />;
  }
  
  const handleStudentIdChange = (newId) => {
    // 数字のみ許可、最大4桁
    const formattedId = newId.replace(/[^0-9]/g, '').slice(0, 4);
    setStudentId(formattedId);
    // 保存時は4桁にパディング
    StorageManager.setStudentId(formattedId.padStart(4, '0'));
  };
  
  // 顧客一覧をリフレッシュするヘルパー関数
  const refreshCustomers = async () => {
    console.log('[refreshCustomers] 開始, isGasMode:', isGasMode);
    if (isGasMode) {
      try {
        const fetchResult = await GASDataManager.fetchAllCustomers();
        const gasCustomers = fetchResult ? (fetchResult.customers || fetchResult) : null;
        const qmCache = fetchResult?.questionMasterCache || {};
        const customerCount = Array.isArray(gasCustomers) ? gasCustomers.length : 0;
        console.log('[refreshCustomers] 取得結果:', customerCount + '件');
        if (gasCustomers && customerCount > 0) {
          const normalizedCustomers = gasCustomers.map(c => normalizeGASCustomer(c, qmCache));
          setCustomers(normalizedCustomers);
          return normalizedCustomers;
        }
      } catch (err) {
        console.error('[refreshCustomers] エラー:', err);
      }
    } else {
      const localCustomers = StorageManager.getCustomers();
      setCustomers(localCustomers);
      return localCustomers;
    }
    return [];
  };
  
  // 保存処理
  const handleSave = async (silent = false) => {
    // 同期的ガード（useRefは即時反映されるため連打・ダブルクリック防止に有効）
    if (isSavingRef.current) return false;
    isSavingRef.current = true;
    
    if (!currentData.companyName) {
      isSavingRef.current = false;
      if (!silent) {
        toast('企業名を入力してください', 'warning');
      }
      return false;
    }
    
    setIsSaving(true);
    setSaveComplete(false);
    
    try {
      // 新規保存の場合のみ商談カウントをインクリメント
      const isNew = !currentData.id;
      if (isNew) {
        InquiryNoManager.confirmInquiryNo(currentData.diagnosisDate);
      }
      
      // 診断日に時刻が含まれていない場合、現在時刻を付加
      let diagnosisDateWithTime = currentData.diagnosisDate || '';
      if (diagnosisDateWithTime && !diagnosisDateWithTime.includes(' ') && !diagnosisDateWithTime.includes('T')) {
        const now = new Date();
        const timeStr = String(now.getHours()).padStart(2, '0') + ':' + String(now.getMinutes()).padStart(2, '0');
        diagnosisDateWithTime = diagnosisDateWithTime + ' ' + timeStr;
      }
      
      const toSave = {
        ...currentData,
        diagnosisDate: diagnosisDateWithTime,
        id: currentData.id || currentData.inquiryNo || `cust_${Date.now()}`,
        updatedAt: new Date().toISOString(),
        aiResult: currentData.aiResult || (aiAdvice ? JSON.stringify(aiAdvice) : ''),
        savedQuestionMaster: currentData.savedQuestionMaster || getQuestionMasterFromStorage()
      };
      
      if (isGasMode) {
        try {
          await GASDataManager.saveCustomer(toSave);
          setCurrentData(toSave);
          await refreshCustomers();
          if (!silent) {
            setSaveComplete(true);
            toast('スプレッドシートに保存しました', 'success');
            setTimeout(() => setSaveComplete(false), 1500);
          }
          return true;
        } catch (e) {
          console.error('スプレッドシート保存エラー:', e);
          if (!silent) {
            toast('保存に失敗しました: ' + e.message, 'error', 4000);
          }
          return false;
        }
      } else {
        StorageManager.saveCustomer(toSave);
        setCustomers(StorageManager.getCustomers());
        setCurrentData(toSave);
        
        const ssConfig = SpreadsheetManager.getConfig();
        if (ssConfig.enabled && ssConfig.scriptUrl) {
          try {
            await SpreadsheetManager.saveCustomer(toSave);
            if (!silent) {
              setSaveComplete(true);
              toast('保存しました（スプレッドシートにも同期）', 'success');
              setTimeout(() => setSaveComplete(false), 1500);
            }
          } catch (e) {
            console.error('スプレッドシート保存エラー:', e);
            if (!silent) { toast('ローカル保存済み（スプレッドシート同期失敗）', 'warning', 4000); }
          }
        } else {
          if (!silent) {
            setSaveComplete(true);
            toast('保存しました', 'success');
            setTimeout(() => setSaveComplete(false), 1500);
          }
        }
        return true;
      }
    } finally {
      setIsSaving(false);
      isSavingRef.current = false;
    }
  };
  
  const handleSelect = (customer) => {
    // 顧客データを読み込む際、マスターデータは現在の値を維持
    const currentYieldMaster = GASDataManager.getYieldMaster();
    const currentMethodMaster = GASDataManager.getMethodMaster() || DEFAULT_RECRUITMENT_METHODS;
    const currentLayerMediaUsage = GASDataManager.getMediaUsageMaster() || DEFAULT_LAYER_MEDIA_USAGE;
    
    // 回答データが復元されているか確認（normalizeGASCustomerで処理済みのはず）
    const hasAnswers = customer.staffAnswers && Object.keys(customer.staffAnswers).length > 0;
    
    if (DEBUG_MODE) {
      debugLog('[handleSelect] 選択顧客:', customer.companyName);
      debugLog('[handleSelect] staffAnswers有無:', hasAnswers, '件数:', Object.keys(customer.staffAnswers || {}).length);
      debugLog('[handleSelect] executiveAnswers件数:', Object.keys(customer.executiveAnswers || {}).length);
      debugLog('[handleSelect] staffScores:', JSON.stringify(customer.staffScores));
    }
    
    setCurrentData({
      ...customer,
      yieldMaster: customer.yieldMaster || currentYieldMaster,
      methodMaster: customer.methodMaster || currentMethodMaster,
      layerMediaUsage: customer.layerMediaUsage || currentLayerMediaUsage
    });
    
    // v34-fix: 保存済みAI診断結果があればaiAdvice stateに復元
    const savedAiResult = customer.aiResult || customer['AI診断結果'] || '';
    if (savedAiResult) {
      try {
        const parsed = typeof savedAiResult === 'string' ? JSON.parse(savedAiResult) : savedAiResult;
        if (parsed && (parsed.prescription || parsed.organizationIssue)) {
          setAiAdvice(parsed);
        } else {
          setAiAdvice(null);
        }
      } catch (e) {
        // JSON以外の場合（旧形式のテキスト等）はprescriptionとして表示
        if (savedAiResult.trim()) {
          setAiAdvice({ prescription: savedAiResult, organizationIssue: '', forRecruiter: '', forManagement: '' });
        } else {
          setAiAdvice(null);
        }
      }
    } else {
      setAiAdvice(null);
    }
  };
  
  // 事前問診データ取込
  const handleImportPreInput = async (inquiryNo) => {
    if (!inquiryNo) {
      alert('問い合わせ番号がありません。');
      return;
    }
    
    try {
      // v34: publicFetch使用（事前問診データは認証不要）
      let result;
      try {
        result = await publicFetch('getCustomerPreInput', { id: inquiryNo });
      } catch (err) {
        toast('事前問診データの取得に失敗しました: ' + err.message, 'error', 4000);
        return;
      }
      
      if (!result || !result.success) {
        toast('事前問診データが見つかりません（未完了の可能性）', 'warning', 4000);
        return;
      }
      
      if (!result.data) {
        toast('事前問診データが見つかりません（未開始の可能性）', 'warning', 4000);
        return;
      }
      
      const preInput = typeof result.data === 'string' ? JSON.parse(result.data) : result.data;
      const status = preInput.status || result.status || '';
      
      // 職種キー→ラベル変換
      const JOB_TYPE_LABELS = {
        sales: '営業職', engineering: '技術職（機械・電気等）', it: 'IT・システムエンジニア',
        manufacturing: '製造・生産管理', rd: '研究開発', design: '設計・CAD',
        admin: '事務・管理', accounting: '経理・財務', hr: '人事・総務',
        planning: '企画・マーケティング', welfare: '福祉・介護・保育',
        construction: '施工管理・建築', logistics: '物流・配送', service: '接客・サービス', other: 'その他'
      };
      const jobTypeLabel = JOB_TYPE_LABELS[preInput.jobType] || preInput.jobType || '';
      
      // 取込確認
      const staffCount = Object.keys(preInput.staffAnswers || {}).filter(k => preInput.staffAnswers[k]).length;
      const execCount = Object.keys(preInput.executiveAnswers || {}).filter(k => preInput.executiveAnswers[k]).length;
      const methodCount = Object.values(preInput.recruitmentMethods || {}).filter(m => m?.active).length;
      const layerCount = Object.values(preInput.targetLayers || {}).filter(l => l?.enabled).length;
      
      // 採用手法の優先順位リスト
      const methodList = Object.entries(preInput.recruitmentMethods || {})
        .filter(([_, m]) => m?.active)
        .sort((a, b) => (a[1].priority || 999) - (b[1].priority || 999))
        .map(([key, m], i) => `  ${i + 1}位: ${key}`)
        .join('\n');
      
      // ファネルデータのサマリー
      const fd = preInput.funnelData || {};
      const yd = fd.yearData?.['27卒'] || fd;
      const funnelSummary = (yd.targetAwareness || yd.interest || yd.applications || yd.screening || yd.offers || yd.acceptance)
        ? `認知${yd.targetAwareness || '-'} → 興味${yd.interest || '-'} → 接触${yd.applications || '-'} → 選考${yd.screening || '-'} → 内々定${yd.offers || '-'} → 承諾${yd.acceptance || '-'}`
        : 'なし';
      
      const confirmed = confirm(
        `事前問診データを取り込みます。\n\n` +
        `ステータス: ${status === '完了' ? '回答完了' : '入力中'}\n` +
        `職種: ${jobTypeLabel || '未選択'}\n` +
        `ターゲット層: ${layerCount}層\n` +
        `採用手法: ${methodCount}件\n` +
        (methodList ? methodList + '\n' : '') +
        `担当者問診: ${staffCount}問回答\n` +
        `上層部問診: ${execCount}問回答\n` +
        `ファネル: ${funnelSummary}\n\n` +
        `※ 現在の入力内容に上書きされます。よろしいですか？`
      );
      
      if (!confirmed) return;
      
      // データマージ
      setCurrentData(prev => {
        // 採用手法: preInputの active/priority を取込み、既存の budget 等は保持
        const mergedMethods = { ...prev.recruitmentMethods };
        if (preInput.recruitmentMethods) {
          Object.entries(preInput.recruitmentMethods).forEach(([key, m]) => {
            mergedMethods[key] = {
              ...mergedMethods[key],  // 既存の budget 等を保持
              active: m.active,
              priority: m.priority
            };
          });
          // preInputで非アクティブ（未選択）のものは既存もクリア
          Object.keys(mergedMethods).forEach(key => {
            if (!preInput.recruitmentMethods[key]) {
              mergedMethods[key] = { ...mergedMethods[key], active: false };
            }
          });
        }
        
        // ファネル: yearData構造を深くマージ
        const mergedFunnel = preInput.funnelData 
          ? {
              ...prev.funnelData,
              ...preInput.funnelData,
              yearData: {
                ...prev.funnelData?.yearData,
                ...preInput.funnelData?.yearData
              }
            }
          : prev.funnelData;
        
        // メモ: 職種情報を追記（既存メモは保持）
        let mergedNotes = prev.notes || '';
        if (jobTypeLabel) {
          const preInputNote = `【事前問診】採用職種: ${jobTypeLabel}`;
          if (!mergedNotes.includes('【事前問診】採用職種:')) {
            mergedNotes = mergedNotes ? mergedNotes + '\n' + preInputNote : preInputNote;
          } else {
            // 既存の職種行を更新
            mergedNotes = mergedNotes.replace(/【事前問診】採用職種:.*/, preInputNote);
          }
        }
        
        return {
          ...prev,
          // ターゲット学生
          targetLayers: preInput.targetLayers || prev.targetLayers,
          // 採用手法（優先順位込み）
          recruitmentMethods: mergedMethods,
          // 問診回答
          staffAnswers: preInput.staffAnswers || prev.staffAnswers,
          executiveAnswers: preInput.executiveAnswers || prev.executiveAnswers,
          // ファネル（BB診断形式で深くマージ）
          funnelData: mergedFunnel,
          // メモ（職種情報追記）
          notes: mergedNotes,
          remarks: mergedNotes,
          // 事前問診ステータス（表示用）
          _preInputStatus: status,
          _preInputImportedAt: new Date().toISOString(),
          _preInputJobType: preInput.jobType
        };
      });
      
      toast('事前問診データを取り込みました', 'success');
      
    } catch (e) {
      console.error('事前問診データ取込エラー:', e);
      toast('データの取込に失敗しました: ' + (e.message || '不明なエラー'), 'error', 4000);
    }
  };
  
  const handleDelete = async (id) => {
    // GASモードの場合はスプレッドシートから削除
    if (isGasMode) {
      try {
        await GASDataManager.deleteCustomer(id);
        // 削除後に顧客一覧を再取得
        await refreshCustomers();
      } catch (e) {
        console.error('スプレッドシート削除エラー:', e);
        alert('削除に失敗しました: ' + e.message);
      }
    } else {
      // スタンドアロンモード: ローカルから削除
      StorageManager.deleteCustomer(id);
      setCustomers(StorageManager.getCustomers());
      
      // スプレッドシートからも削除（有効な場合）
      const ssConfig = SpreadsheetManager.getConfig();
      if (ssConfig.enabled && ssConfig.scriptUrl) {
        try {
          await SpreadsheetManager.deleteCustomer(id);
        } catch (e) {
          console.error('スプレッドシート削除エラー:', e);
        }
      }
    }
    
    if (currentData.id === id) {
      handleNew();
    }
  };
  
  const handleNew = async () => {
    if (isCreatingNew) return;
    setIsCreatingNew(true);
    try {
    const newDate = new Date().toISOString().split('T')[0];
    // マスターデータは現在の値を維持
    const currentYieldMaster = GASDataManager.getYieldMaster();
    const currentMethodMaster = GASDataManager.getMethodMaster() || DEFAULT_RECRUITMENT_METHODS;
    const currentLayerMediaUsage = GASDataManager.getMediaUsageMaster() || DEFAULT_LAYER_MEDIA_USAGE;
    
    // v34: GASモードではサーバーから通番を予約
    let inquiryNo = '';
    let reservedSeqNo = null;
    if (isGasMode && window.AUTH?.isLoggedIn) {
      const reserved = await InquiryNoManager.reserveFromServer('', newDate);
      if (reserved) {
        inquiryNo = reserved.inquiryNo;
        reservedSeqNo = reserved.sequentialNo;
      } else {
        // フォールバック: ローカル生成
        inquiryNo = InquiryNoManager.generateNextInquiryNoLocal('', newDate);
      }
    } else {
      inquiryNo = InquiryNoManager.generateNextInquiryNoLocal('', newDate);
    }
    
    setCurrentData({
      id: null,
      companyName: '',
      contactName: '',
      industry: '',
      companySize: '',
      diagnosisDate: newDate,
      inquiryNo: inquiryNo,
      reservedSeqNo: reservedSeqNo, // v34: サーバー予約済み通番を保持
      staffScores: {},
      executiveScores: {},
      studentScores: {},
      mindsetScores: {},
      funnelData: {},
      staffAnswers: {},
      executiveAnswers: {},
      studentAnswers: {},
      recruitmentMethods: {},
      targetLayers: {},
      yieldSettings: {},
      industryAverages: {},
      adjustedAverages: {},
      notes: '',
      todayChallenge: '',       // 今日解決したいこと
      pastChallenges: '',       // 過去に挑戦してきたこと
      improvementGoals: {},     // 改善目標（現状実績）
      targetNotes: '',          // ターゲット学生 特記事項メモ
      yieldMaster: currentYieldMaster,
      methodMaster: currentMethodMaster,
      layerMediaUsage: currentLayerMediaUsage
    });
    // 新規診断時はAIアドバイスをクリア
    setAiAdvice(null);
    setAiError(null);
    toast('新規診断を開始しました', 'info');
    } finally {
      setIsCreatingNew(false);
    }
  };
  
  // デフォルトのAIアドバイスを生成（AI未使用）
  const generateDefaultAdvice = () => {
    // 【inventory 10-A #6】effectiveData構築（共通関数を使用）
    const { effectiveData, finalScore, rank, diagType, typeDef, rankDef } = buildEffectiveData(currentData);
    
    // 症例タイプ別のデフォルトアドバイス
    const typeAdvices = {
      'stealth-ghost': {
        prescription: '今すぐSNSやWantedlyでの情報発信を開始してください。求人サイトへの掲載だけでは「存在しない会社」のまま。まずは週1回の発信から始め、会社の存在証明を作ることが最優先です。',
        forStaff: '求人原稿の更新頻度を上げ、採用サイトのコンテンツを充実させましょう。社員インタビューや職場風景の写真を追加し、「生きている会社」であることを証明してください。',
        forExecutive: '採用広報予算の見直しが必要です。知名度がない状態での媒体出稿は費用対効果が低い。まずはオウンドメディアやSNSでの認知獲得に投資を集中させてください。',
        organizationIssue: '「良い仕事をしていれば自然と人が集まる」という思い込みが根本原因。今の時代、発信しなければ存在しないのと同じです。採用広報への意識改革が急務です。'
      },
      'passion-mismatch': {
        prescription: '熱意のアピールを一旦やめ、学生が知りたい「具体的な条件」の明示に集中してください。給与、勤務地、残業時間、休日数など、数字で示せる情報を前面に出しましょう。',
        forStaff: '求人原稿から「アットホーム」「やりがい」などの抽象的な表現を削除し、具体的な数字と事実だけで構成し直してください。熱意は面接で伝えれば十分です。',
        forExecutive: '会社説明会やインターンの内容を見直してください。社長の想いを語る時間を減らし、実際の仕事内容や待遇面の説明時間を増やすことが効果的です。',
        organizationIssue: '「うちの熱意が伝われば学生は来る」という自己満足的な発想が問題。学生は熱意よりも「自分の生活がどうなるか」を知りたがっています。'
      },
      'spec-chief': {
        prescription: '条件の羅列をやめ、「この会社で働く人の顔」が見えるコンテンツを増やしてください。社員の一日、入社後の成長ストーリーなど、人間味のある発信が必要です。',
        forStaff: '社員インタビューや座談会コンテンツを作成し、実際に働く人の声を発信してください。数字だけでは「冷たい会社」という印象を与えてしまいます。',
        forExecutive: '採用ブランディングに投資してください。条件は良いのに選ばれないのは、「この会社で働きたい」という感情を引き出せていないからです。',
        organizationIssue: '「条件が良ければ人は来る」という合理主義的な思い込みが原因。採用は論理だけでなく感情で決まるものです。人の温かみを見せる努力をしてください。'
      },
      'diamond-rough': {
        prescription: '「うちならでは」の強みを言語化し、他社との明確な差別化ポイントを作ってください。なぜこの会社を選ぶべきなのか、一言で説明できる状態を目指しましょう。',
        forStaff: '競合他社の採用ページを分析し、差別化できるポイントを見つけてください。同じような表現では埋もれます。尖った強みを前面に押し出す原稿に変更を。',
        forExecutive: '自社の独自性（USP）を経営レベルで定義し直す必要があります。「なぜうちで働くべきか」に答えられない状態では、優秀な人材は競合に流れます。',
        organizationIssue: '「うちは普通の良い会社」という謙虚さが裏目に出ています。普通では選ばれません。自社の強みを過小評価する文化を改め、堂々とアピールしてください。'
      },
      'black-box-beauty': {
        prescription: '今すぐ発信力を強化してください。実力があるのに知られていないのは最も惜しい状態。SNS、採用広報、メディア露出など、認知拡大に全力を注ぎましょう。',
        forStaff: '採用広報の頻度と質を大幅に上げてください。「知ってもらえれば勝てる」なら、知ってもらうことに全リソースを投入すべきです。',
        forExecutive: '採用マーケティングへの投資を増やしてください。良い会社なのに人が来ないのは、シンプルに露出が足りないからです。広報予算の増額を検討してください。',
        organizationIssue: '「良いものは自然と広まる」という受け身の姿勢が問題。今の時代、自ら発信しなければ誰にも気づいてもらえません。能動的な採用広報への転換が必要です。'
      },
      'future-blind': {
        prescription: 'キャリアパスの可視化を最優先で行ってください。入社後3年、5年、10年でどうなれるのか、具体的なモデルケースを示すことが急務です。',
        forStaff: '先輩社員のキャリアストーリーをまとめ、求人ページに掲載してください。「この会社でどう成長できるか」が見えないと、学生は不安で応募できません。',
        forExecutive: '人材育成制度とキャリアパスを明文化し、採用メッセージに組み込んでください。将来が見えない会社に優秀な学生は来ません。',
        organizationIssue: '「入ってみれば分かる」という昔ながらの考え方が問題。今の学生は将来像を重視します。キャリアを可視化しない姿勢は、学生への配慮不足です。'
      },
      'selection-maze': {
        prescription: '選考プロセスの簡略化を即座に実行してください。応募から内定までの期間短縮、連絡スピードの向上が最優先課題です。',
        forStaff: '選考フローを見直し、不要なステップを削除してください。連絡は24時間以内、選考結果は1週間以内を厳守。学生を待たせることは機会損失です。',
        forExecutive: '選考プロセスの承認フローを簡素化してください。上層部の承認待ちで連絡が遅れることは、優秀な学生を競合に取られる原因になります。',
        organizationIssue: '「じっくり見極めたい」という慎重さが裏目に出ています。今の採用市場では、スピードも品質の一部。学生のUXを軽視する姿勢を改めてください。'
      },
      'closing-weak': {
        prescription: '内定者フォローを強化し、承諾前の不安解消に全力を注いでください。内定から承諾までの期間に何度も接触し、競合に流れることを防ぎましょう。',
        forStaff: '内定者との定期的なコミュニケーションを確立してください。内定後の放置は承諾率を大きく下げます。面談、懇親会、職場見学などを積極的に。',
        forExecutive: '内定者フォロー予算を確保し、承諾率向上に投資してください。内定まで行っても承諾されなければ、それまでの採用コストが無駄になります。',
        organizationIssue: '「内定を出せば来てくれる」という甘い認識が問題。今の学生は複数内定が当たり前。最後まで選ばれる努力を怠る姿勢を改めてください。'
      }
    };
    
    const defaultAdvice = typeAdvices[diagType] || typeAdvices['stealth-ghost'];
    
    return {
      prescription: defaultAdvice.prescription,
      forStaff: defaultAdvice.forStaff,
      forExecutive: defaultAdvice.forExecutive,
      organizationIssue: defaultAdvice.organizationIssue
    };
  };
  
  // サイドバナーボタンクリック処理
  const handleSideButtonClick = (buttonId) => {
    if (buttonId === 'btn1') {
      // 再診断ボタンの場合
      if (!lastGeneratedButtonId) {
        // まだ診断を実行していない場合はデフォルトのアドバイスを表示（AI未使用）
        const defaultAdvice = generateDefaultAdvice();
        setAiAdvice(defaultAdvice);
      } else {
        // 以前に診断を実行している場合はモーダルを表示
        setReDiagnosisAdditionalInfo('');
        setShowReDiagnosisModal(true);
      }
    } else if (buttonId === 'btn4') {
      // Pro診断ボタンの場合 - 決済確認モーダルを表示
      setProPaymentCode('');
      setProPaymentError('');
      setShowProPaymentModal(true);
    } else {
      // その他のボタンは通常通り実行
      handleGenerateAIWithButton(buttonId);
    }
  };
  
  // Pro診断の決済確認と実行
  const handleProDiagnosisSubmit = () => {
    // 決済番号のバリデーション
    if (!proPaymentCode.trim()) {
      setProPaymentError('決済番号を入力してください');
      return;
    }
    
    // 決済番号の形式チェック（例：8桁以上の英数字）
    if (proPaymentCode.trim().length < 6) {
      setProPaymentError('決済番号は6文字以上で入力してください');
      return;
    }
    
    // 決済確認成功 - モーダルを閉じて診断実行
    setShowProPaymentModal(false);
    setProPaymentError('');
    handleGenerateAIWithButton('btn4');
  };
  
  // 再診断実行（追加情報付き）
  const handleReDiagnosis = async () => {
    if (!aiSettings.apiKey) {
      alert('APIキーが設定されていません。ヘッダーの設定アイコンから設定を行ってください。');
      return;
    }
    
    // ベースとなるボタン設定を取得
    const buttons = aiSettings.sideButtons || DEFAULT_SIDE_BUTTONS;
    const baseButtonConfig = buttons.find(b => b.id === lastGeneratedButtonId);
    if (!baseButtonConfig) {
      alert('ベース診断の設定が見つかりません');
      return;
    }
    
    setShowReDiagnosisModal(false);
    setGeneratingButtonId('btn1');
    setIsGeneratingAI(true);
    setAiError(null);
    
    try {
      // 【inventory 10-A #7 / 10-C】effectiveData + AI診断データ構築（共通関数を使用）
      const { effectiveData, finalScore, rank, typeDef } = buildEffectiveData(currentData);
      const { diagnosisDataForAI } = buildDiagnosisDataForAI(currentData, effectiveData, rank, typeDef);
      
      // プロンプトを構築
      const currentPreset = AI_TONE_PRESETS[aiSettings.selectedPreset] || AI_TONE_PRESETS.standard;
      const systemPrompt = aiSettings.selectedPreset === 'custom' 
        ? (aiSettings.customSystemPrompt || currentPreset.systemPrompt)
        : currentPreset.systemPrompt;
      
      // ベースのプロンプトを使用し、追加情報を付加
      let userPrompt = buildUserPrompt(baseButtonConfig.prompt, diagnosisDataForAI);
      if (reDiagnosisAdditionalInfo.trim()) {
        userPrompt += `\n\n【追加の指示・情報】\n${reDiagnosisAdditionalInfo.trim()}`;
      }
      
      // API呼び出し
      const generateFunc = aiSettings.apiType === 'openai' 
        ? generateAIDiagnosisOpenAI 
        : generateAIDiagnosisGemini;
      
      const rawResult = await generateFunc(systemPrompt, userPrompt, aiSettings.apiKey);
      const parsedResult = parseAIResponse(rawResult);
      
      if (parsedResult) {
        setAiAdvice(parsedResult);
        
        // v34-fix: AI結果をcurrentDataに書き戻す（保存時に顧客シートに反映されるように）
        const aiResultJson = JSON.stringify(parsedResult);
        setCurrentData(prev => ({ ...prev, aiResult: aiResultJson }));
        
        // スプレッドシートにAI履歴を保存（バックグラウンド）
        SpreadsheetManager.saveAIHistory({
          customerId: currentData.id,
          companyName: currentData.companyName,
          diagnosisType: `再診断（${baseButtonConfig.label}ベース）`,
          prescription: parsedResult.prescription,
          forStaff: parsedResult.forStaff,
          forExecutive: parsedResult.forExecutive,
          organizationIssue: parsedResult.organizationIssue,
          additionalInfo: reDiagnosisAdditionalInfo.trim()
        }).catch(e => {
          if (DEBUG_MODE) {
            debugLog('AI履歴保存スキップ:', e.message);
          }
        });
        
      } else {
        throw new Error('AIの出力を解析できませんでした');
      }
      
    } catch (error) {
      console.error('AI生成エラー:', error);
      alert('AI生成エラー: ' + (error.message || 'AIアドバイスの生成に失敗しました'));
    } finally {
      setIsGeneratingAI(false);
      setGeneratingButtonId(null);
    }
  };
  
  // AI診断アドバイス生成（サイドバナー対応）
  const handleGenerateAIWithButton = async (buttonId) => {
    if (!aiSettings.apiKey) {
      alert('APIキーが設定されていません。ヘッダーの設定アイコンから設定を行ってください。');
      return;
    }
    
    // ボタン設定を取得
    const buttons = aiSettings.sideButtons || DEFAULT_SIDE_BUTTONS;
    const buttonConfig = buttons.find(b => b.id === buttonId);
    if (!buttonConfig) {
      alert('ボタン設定が見つかりません');
      return;
    }
    
    setGeneratingButtonId(buttonId);
    setIsGeneratingAI(true);
    setAiError(null);
    
    try {
      // 【inventory 10-A #8 / 10-C】effectiveData + AI診断データ構築（共通関数を使用）
      const { effectiveData, finalScore, rank, typeDef } = buildEffectiveData(currentData);
      const { diagnosisDataForAI } = buildDiagnosisDataForAI(currentData, effectiveData, rank, typeDef);
      
      // プロンプトを構築（口調プリセットはシステムプロンプトに使用）
      const currentPreset = AI_TONE_PRESETS[aiSettings.selectedPreset] || AI_TONE_PRESETS.standard;
      const systemPrompt = aiSettings.selectedPreset === 'custom' 
        ? (aiSettings.customSystemPrompt || currentPreset.systemPrompt)
        : currentPreset.systemPrompt;
      
      // ボタン専用のプロンプトを使用
      const userPrompt = buildUserPrompt(buttonConfig.prompt, diagnosisDataForAI);
      
      // API呼び出し
      const generateFunc = aiSettings.apiType === 'openai' 
        ? generateAIDiagnosisOpenAI 
        : generateAIDiagnosisGemini;
      
      const rawResult = await generateFunc(systemPrompt, userPrompt, aiSettings.apiKey);
      const parsedResult = parseAIResponse(rawResult);
      
      if (parsedResult) {
        setAiAdvice(parsedResult);
        // btn1以外の場合、最後に実行したボタンIDを保存（再診断のベースとして使用）
        if (buttonId !== 'btn1') {
          setLastGeneratedButtonId(buttonId);
        }
        
        // v34-fix: AI結果をcurrentDataに書き戻す（保存時に顧客シートに反映されるように）
        const aiResultJson = JSON.stringify(parsedResult);
        setCurrentData(prev => ({ ...prev, aiResult: aiResultJson }));
        
        // スプレッドシートにAI履歴を保存（バックグラウンド）
        SpreadsheetManager.saveAIHistory({
          customerId: currentData.id,
          companyName: currentData.companyName,
          diagnosisType: buttonConfig.label,
          prescription: parsedResult.prescription,
          forStaff: parsedResult.forStaff,
          forExecutive: parsedResult.forExecutive,
          organizationIssue: parsedResult.organizationIssue,
          additionalInfo: ''
        }).catch(e => {
          if (DEBUG_MODE) {
            debugLog('AI履歴保存スキップ:', e.message);
          }
        });
        
      } else {
        throw new Error('AIの出力を解析できませんでした');
      }
      
    } catch (error) {
      console.error('AI生成エラー:', error);
      alert('AI生成エラー: ' + (error.message || 'AIアドバイスの生成に失敗しました'));
    } finally {
      setIsGeneratingAI(false);
      setGeneratingButtonId(null);
    }
  };
  
  // 旧互換用（内部では使用しないが残しておく）
  const handleGenerateAI = async () => {
    handleGenerateAIWithButton('btn1');
  };
  
  const exportPDF = async () => {
    if (!sheetRef.current) return;
    setIsExporting(true);
    
    // createPatternのエラーを防ぐためのポリフィル
    const originalCreatePattern = CanvasRenderingContext2D.prototype.createPattern;
    CanvasRenderingContext2D.prototype.createPattern = function(image, repetition) {
      if (image && (image.width === 0 || image.height === 0)) {
        // 0サイズの場合は空のパターンを返す代わりにnullを返す
        return null;
      }
      return originalCreatePattern.call(this, image, repetition);
    };
    
    // SVG画像の復元用配列（エラー時にも使用）
    let svgImageReplacements = [];
    
    try {
      // フォント読み込み完了を待つ
      await document.fonts.ready;
      
      // フォントを強制的に読み込み
      const fontFamilies = ['Noto Sans JP', 'Outfit'];
      for (const family of fontFamilies) {
        try {
          await document.fonts.load(`400 12px "${family}"`);
          await document.fonts.load(`700 12px "${family}"`);
        } catch (e) {
          console.warn(`Font load warning: ${family}`, e);
        }
      }
      
      // アニメーション完了を待つ
      await new Promise(resolve => setTimeout(resolve, 2000));
      
      // PDF出力用のクラスを追加
      sheetRef.current.classList.add('pdf-export-mode');
      await new Promise(resolve => setTimeout(resolve, 100));
      
      // グラデーション背景を持つ要素を一時的に単色に変換
      const gradientElements = [];
      sheetRef.current.querySelectorAll('*').forEach(el => {
        const style = window.getComputedStyle(el);
        const bg = style.backgroundImage;
        if (bg && bg.includes('gradient')) {
          gradientElements.push({
            element: el,
            originalBg: el.style.backgroundImage,
            originalBgColor: el.style.backgroundColor
          });
          // グラデーションの最初の色を抽出して単色に
          const colorMatch = bg.match(/rgb[a]?\([^)]+\)/);
          if (colorMatch) {
            el.style.backgroundImage = 'none';
            el.style.backgroundColor = colorMatch[0];
          }
        }
      });
      
      // 全てのcanvasを画像に変換（実際のDOMで）
      const canvasReplacements = [];
      const allCanvases = Array.from(sheetRef.current.querySelectorAll('canvas'));
      
      for (let i = 0; i < allCanvases.length; i++) {
        const canvas = allCanvases[i];
        try {
          // canvasのサイズをチェック
          if (canvas.width === 0 || canvas.height === 0) {
            console.warn('Skipping canvas with 0 dimensions');
            continue;
          }
          
          const dataUrl = canvas.toDataURL('image/png');
          const img = document.createElement('img');
          img.src = dataUrl;
          img.style.cssText = canvas.style.cssText;
          img.style.width = canvas.style.width || (canvas.width + 'px');
          img.style.height = canvas.style.height || (canvas.height + 'px');
          img.style.display = 'block';
          
          // 画像の読み込みを待つ
          await new Promise((resolve, reject) => {
            img.onload = resolve;
            img.onerror = reject;
            if (img.complete) resolve();
          });
          
          const parent = canvas.parentNode;
          parent.insertBefore(img, canvas);
          parent.removeChild(canvas);
          
          canvasReplacements.push({ img, canvas, parent });
        } catch (e) {
          console.warn('Canvas replacement failed:', e);
        }
      }
      
      // SVG画像をcanvasに描画してPNGに変換（html2canvasが確実に処理できるように）
      svgImageReplacements = [];
      const svgImages = sheetRef.current.querySelectorAll('img[src^="data:image/svg+xml"]');
      
      for (const img of svgImages) {
        try {
          const originalSrc = img.src;
          const originalStyle = img.style.cssText;
          
          // 画像の読み込みを待つ
          await new Promise((resolve) => {
            if (img.complete && img.naturalWidth > 0) {
              resolve();
            } else {
              img.onload = resolve;
              img.onerror = resolve;
              setTimeout(resolve, 5000);
            }
          });
          
          // SVG画像をcanvasに描画（高解像度で）
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          const imgElement = new Image();
          imgElement.crossOrigin = 'anonymous';
          
          // スケールファクター（高解像度のため）
          const scale = 3; // 3倍の解像度
          
          await new Promise((resolve) => {
            imgElement.onload = () => {
              try {
                // 画像サイズを取得（元のimgタグのサイズまたは読み込んだ画像のサイズ）
                const baseWidth = img.naturalWidth || imgElement.width || img.offsetWidth || 500;
                const baseHeight = img.naturalHeight || imgElement.height || img.offsetHeight || 500;
                
                // 高解像度でcanvasを作成
                canvas.width = baseWidth * scale;
                canvas.height = baseHeight * scale;
                
                // 高解像度で描画
                ctx.scale(scale, scale);
                ctx.drawImage(imgElement, 0, 0, baseWidth, baseHeight);
                
                // canvasをPNGデータURLに変換（最高品質）
                const pngDataUrl = canvas.toDataURL('image/png', 1.0);
                
                // 元のimgタグのsrcをPNGデータURLに置き換え
                img.src = pngDataUrl;
                img.style.cssText = originalStyle;
                // 元のサイズを維持
                if (img.style.width) {
                  img.style.width = baseWidth + 'px';
                }
                if (img.style.height) {
                  img.style.height = baseHeight + 'px';
                }
                
                svgImageReplacements.push({ img, originalSrc });
                resolve();
              } catch (e) {
                console.warn('SVG to canvas conversion failed:', e);
                resolve(); // エラーでも続行
              }
            };
            imgElement.onerror = () => {
              console.warn('SVG image load failed, keeping original');
              resolve(); // エラーでも続行（元のsrcを保持）
            };
            imgElement.src = originalSrc;
            setTimeout(() => {
              if (!imgElement.complete) {
                console.warn('SVG image load timeout');
                resolve(); // タイムアウトでも続行
              }
            }, 10000); // タイムアウトを10秒に延長
          });
        } catch (e) {
          console.warn('SVG image processing error:', e);
        }
      }
      
      // 全ての画像（通常の画像）の読み込みを待つ
      const regularImages = sheetRef.current.querySelectorAll('img:not([src^="data:image/svg+xml"])');
      const imagePromises = Array.from(regularImages).map(img => {
        return new Promise((resolve) => {
          if (img.complete && img.naturalWidth > 0) {
            resolve();
          } else {
            img.onload = () => resolve();
            img.onerror = () => resolve();
            setTimeout(() => resolve(), 5000);
          }
        });
      });
      await Promise.all(imagePromises);
      await new Promise(resolve => setTimeout(resolve, 500)); // 追加の待機時間
      
      // html2canvasでキャプチャ
      // foreignObjectRendering: falseに戻して、要素全体を確実にキャプチャ
      const capturedCanvas = await html2canvas(sheetRef.current, {
        scale: 2,
        useCORS: true,
        allowTaint: true,
        backgroundColor: '#ffffff',
        logging: false,
        imageTimeout: 30000,
        foreignObjectRendering: false, // 要素全体を確実にキャプチャするためにfalseに戻す
        onclone: (clonedDoc) => {
          // クローンされたドキュメント内の画像を確認
          const clonedImages = clonedDoc.querySelectorAll('img');
          clonedImages.forEach(img => {
            if (img.src && img.src.startsWith('data:image/svg+xml')) {
              // SVG画像が正しく読み込まれているか確認
              if (!img.complete || img.naturalWidth === 0) {
                console.warn('SVG image not loaded:', img.src.substring(0, 50));
              } else {
                if (DEBUG_MODE) {
                  debugLog('SVG image loaded successfully:', img.naturalWidth, 'x', img.naturalHeight);
                }
              }
            }
          });
        }
      });
      
      // 元のcanvasを復元
      for (const { img, canvas, parent } of canvasReplacements) {
        if (img.parentNode) {
          img.parentNode.insertBefore(canvas, img);
          img.parentNode.removeChild(img);
        }
      }
      
      // グラデーション背景を復元
      for (const { element, originalBg, originalBgColor } of gradientElements) {
        element.style.backgroundImage = originalBg;
        element.style.backgroundColor = originalBgColor;
      }
      
      // SVG画像を元に戻す
      for (const { img, originalSrc } of svgImageReplacements) {
        if (img && img.parentNode) {
          img.src = originalSrc;
        }
      }
      
      // PDF出力用クラスを削除
      sheetRef.current.classList.remove('pdf-export-mode');
      
      // PDFを生成
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
      
      const pdfWidth = 297;
      const pdfHeight = 210;
      const imgWidth = capturedCanvas.width;
      const imgHeight = capturedCanvas.height;
      const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);
      const finalWidth = imgWidth * ratio;
      const finalHeight = imgHeight * ratio;
      const offsetX = (pdfWidth - finalWidth) / 2;
      const offsetY = (pdfHeight - finalHeight) / 2;
      
      const imgData = capturedCanvas.toDataURL('image/png', 1.0);
      pdf.addImage(imgData, 'PNG', offsetX, offsetY, finalWidth, finalHeight);
      pdf.save(`採用BB診断_${currentData.companyName || '企業名未設定'}_${currentData.diagnosisDate}.pdf`);
      
    } catch (e) {
      console.error('PDF export error:', e);
      alert('PDF出力に失敗しました: ' + e.message);
      
      // エラー時の復元処理
      if (sheetRef.current) {
        // SVG画像を元に戻す
        for (const { img, originalSrc } of svgImageReplacements) {
          if (img && img.parentNode) {
            img.src = originalSrc;
          }
        }
        sheetRef.current.classList.remove('pdf-export-mode');
      }
    } finally {
      // ポリフィルを元に戻す
      CanvasRenderingContext2D.prototype.createPattern = originalCreatePattern;
      setIsExporting(false);
    }
  };
  
  return (
    <div className="min-h-screen">
      {/* v34-fix: セッション期限切れ時の再ログインバナー（データ保持したまま表示） */}
      {showReloginBanner && (
        <div className="fixed inset-0 z-[9999] bg-black/50 flex items-start justify-center pt-20 no-print">
          <div className="bg-white rounded-xl shadow-2xl p-6 max-w-md mx-4 text-center">
            <div className="text-4xl mb-3">⚠️</div>
            <h3 className="text-lg font-bold text-gray-800 mb-2">セッションが期限切れです</h3>
            <p className="text-sm text-gray-600 mb-1">入力データはそのまま保持されています。</p>
            <p className="text-sm text-gray-600 mb-4">再ログイン後にもう一度保存してください。</p>
            <button
              onClick={handleRelogin}
              className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-sm transition"
            >
              Googleアカウントで再ログイン
            </button>
            <button
              onClick={() => setShowReloginBanner(false)}
              className="block mx-auto mt-3 text-xs text-gray-400 hover:text-gray-600"
            >
              あとで再ログインする
            </button>
          </div>
        </div>
      )}
      {/* GASモード：ユーザー情報バー */}
      {isGasMode && gasUser && (
        <div className="bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-xs py-1.5 px-4 flex justify-between items-center no-print">
          <div className="flex items-center gap-4">
            <span className="opacity-80">🔒 セキュアモード</span>
            <span className="flex items-center gap-1.5">
              <span className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
              <span className="font-medium">{gasUser.name}</span>
              <span className="opacity-70">（{gasUser.roleLabel}）</span>
            </span>
          </div>
          <div className="flex items-center gap-3">
            <span className="opacity-70">{gasUser.email}</span>
          </div>
        </div>
      )}
      
      {/* ヘッダー */}
      <header className="bg-white/90 backdrop-blur-lg shadow-sm sticky top-0 z-50 no-print">
        <div className="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
          <div className="flex items-center gap-3">
            <div className="w-12 h-12 flex items-center justify-center overflow-hidden"><img src="data:image/png;base64,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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADG32Jo3WSo3s1HnpbbdOpkgfJjd6prmmd4AAfXkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf//Z" alt="Gakusapo" className="w-full h-full object-contain" /></div>
            <div>
              <h1 className="text-lg font-bold text-gray-800">採用ブラックボックス診断</h1>
              <p className="text-xs text-gray-500">Gakusapo 診断ツール v2.0</p>
            </div>
          </div>
          <div className="flex items-center gap-3">
            {/* ログアウトボタン（ログイン機能有効時に表示） */}
            {LoginManager.getConfig().enabled && (
              <button
                onClick={handleLogout}
                className="p-2.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition"
                title="ログアウト"
              >
                <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                  <path strokeLinecap="round" strokeLinejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                </svg>
              </button>
            )}
            {/* 設定（管理者用） - GASモードではadmin権限のみ、スタンドアロンでは常に表示 */}
            {(!isGasMode || (isGasMode && window.GAS_CONFIG?.permissions?.includes('admin'))) && (
              <button
                onClick={() => setShowAISettingsAuth(true)}
                className="p-2.5 text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition"
                title="設定"
              >
                <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                  <path strokeLinecap="round" strokeLinejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                  <path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
              </button>
            )}
            {/* 学生番号表示 */}
            <button
              onClick={() => setShowSettings(true)}
              className="px-3 py-2 text-xs bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-lg font-medium transition"
            >
              学生No: {studentId.padStart(4, '0')}
            </button>
            <button 
              onClick={handleNew}
              disabled={isCreatingNew}
              className={`btn-ripple px-4 py-2.5 text-sm rounded-xl font-medium transition flex items-center gap-1.5 ${
                isCreatingNew
                  ? 'bg-gray-200 text-gray-400 cursor-wait'
                  : 'bg-gray-100 hover:bg-gray-200 text-gray-700'
              }`}
            >
              {isCreatingNew ? (
                <>
                  <svg className="w-3.5 h-3.5 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2.5}>
                    <circle cx="12" cy="12" r="10" className="opacity-25" /><path d="M4 12a8 8 0 018-8" className="opacity-75" />
                  </svg>
                  採番中...
                </>
              ) : '+ 新規診断'}
            </button>
            <button 
              onClick={handleSave}
              disabled={isSaving}
              className={`btn-ripple px-4 py-2.5 text-sm rounded-xl font-medium shadow-lg transition flex items-center gap-1.5 min-w-[90px] justify-center ${
                saveComplete
                  ? 'bg-emerald-600 text-white'
                  : isSaving
                  ? 'bg-gray-400 text-white cursor-wait'
                  : 'bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white'
              }`}
            >
              {isSaving ? (
                <>
                  <svg className="w-3.5 h-3.5 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2.5}>
                    <circle cx="12" cy="12" r="10" className="opacity-25" /><path d="M4 12a8 8 0 018-8" className="opacity-75" />
                  </svg>
                  保存中...
                </>
              ) : saveComplete ? (<><span>✓</span> 完了</>) : '保存'}
            </button>
            <div className="flex bg-gray-100 rounded-xl p-1 ml-2">
              <button
                onClick={() => setView('input')}
                className={`px-4 py-2.5 text-sm rounded-lg transition font-medium ${
                  view === 'input' 
                    ? 'bg-white shadow text-blue-600' 
                    : 'text-gray-600 hover:text-gray-800'
                }`}
              >
                入力
              </button>
              <button
                onClick={() => setView('database')}
                className={`px-4 py-2.5 text-sm rounded-lg transition font-medium ${
                  view === 'database' 
                    ? 'bg-white shadow text-blue-600' 
                    : 'text-gray-600 hover:text-gray-800'
                }`}
              >
                顧客DB
              </button>
              <button
                onClick={() => setView('result')}
                className={`px-4 py-2.5 text-sm rounded-lg transition font-medium ${
                  view === 'result' 
                    ? 'bg-white shadow text-blue-600' 
                    : 'text-gray-600 hover:text-gray-800'
                }`}
              >
                結果
              </button>
            </div>
          </div>
        </div>
      </header>
      
      {/* 学生番号設定モーダル */}
      {showSettings && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 no-print">
          <div className="bg-white rounded-2xl p-6 w-full max-w-md shadow-2xl">
            <h3 className="text-lg font-bold text-gray-800 mb-4">
              学生番号設定
            </h3>
            {/* GASモードで管理者以外は変更不可のメッセージ */}
            {isGasMode && !canChangeStudentId ? (
              <>
                <div className="mb-4 p-4 bg-blue-50 border border-blue-200 rounded-xl">
                  <div className="flex items-center gap-2 text-blue-800">
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span className="font-medium">あなたの学生番号</span>
                  </div>
                  <p className="mt-2 text-sm text-blue-700">
                    学生番号はメンバー登録時に割り当てられています。<br/>
                    変更が必要な場合は管理者にお問い合わせください。
                  </p>
                </div>
                <div className="mb-6">
                  <label className="block text-sm font-medium text-gray-700 mb-2">学生番号（4桁）</label>
                  <div className="w-full px-4 py-3 bg-gray-100 border border-gray-200 rounded-xl text-2xl font-mono text-center tracking-widest text-gray-600">
                    {studentId.padStart(4, '0')}
                  </div>
                </div>
              </>
            ) : (
              <>
                <p className="text-sm text-gray-500 mb-4">
                  ログインした学生の番号を入力してください。
                </p>
                <div className="mb-6">
                  <label className="block text-sm font-medium text-gray-700 mb-2">学生番号（4桁）</label>
                  <input
                    type="text"
                    value={studentId}
                    onChange={(e) => handleStudentIdChange(e.target.value)}
                    maxLength={4}
                    className="w-full px-4 py-3 border border-gray-200 rounded-xl text-2xl font-mono text-center tracking-widest focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"
                    placeholder="0001"
                  />
                </div>
              </>
            )}
            <div className="p-4 bg-gray-50 rounded-xl mb-6">
              <div className="text-xs text-gray-500 mb-2">問い合わせ番号プレビュー</div>
              <div className="text-xl font-mono font-bold text-indigo-600">
                {currentData.inquiryNo || '-------------'}
              </div>
              {currentData.reservedSeqNo && (
                <div className="text-xs text-green-600 mt-1">✓ サーバー採番済み（通番: {String(currentData.reservedSeqNo).padStart(3, '0')}）</div>
              )}
            </div>
            <div className="flex gap-3">
              <button
                onClick={() => setShowSettings(false)}
                className="flex-1 px-4 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 text-white rounded-xl font-medium transition"
              >
                完了
              </button>
            </div>
          </div>
        </div>
      )}
      
      {/* AI診断モーダル（ヘッダーから起動用） */}
      {showAIDiagnosis && (
        <AIDiagnosisModal 
          data={currentData}
          onClose={() => setShowAIDiagnosis(false)}
          onComplete={() => {
            setShowAIDiagnosis(false);
          }}
        />
      )}
      
      {/* AI設定認証モーダル */}
      {showAISettingsAuth && (
        <AISettingsAuthModal
          onSuccess={() => {
            setShowAISettingsAuth(false);
            setShowAISettings(true);
          }}
          onClose={() => setShowAISettingsAuth(false)}
        />
      )}
      
      {/* AI設定画面モーダル */}
      {showAISettings && (
        <AISettingsModal
          settings={aiSettings}
          onSave={(newSettings) => {
            setAiSettings(newSettings);
            AISettingsManager.saveSettings(newSettings);
            // マスターデータが更新された可能性があるので、currentDataを更新
            const updatedYieldMaster = GASDataManager.getYieldMaster();
            const updatedMethodMaster = GASDataManager.getMethodMaster();
            const updatedLayerMediaUsage = GASDataManager.getMediaUsageMaster();
            
            setCurrentData(prev => ({ 
              ...prev, 
              yieldMaster: updatedYieldMaster || prev.yieldMaster,
              methodMaster: updatedMethodMaster || prev.methodMaster,
              layerMediaUsage: updatedLayerMediaUsage || prev.layerMediaUsage
            }));
          }}
          onClose={() => setShowAISettings(false)}
        />
      )}
      
      {/* マスターデータ読み込み中 */}
      {isGasMode && !masterDataLoaded && (
        <div className="fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center">
          <div className="text-center">
            <div className="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
            <p className="text-gray-600 font-medium">マスターデータを読み込み中...</p>
          </div>
        </div>
      )}
      
      {/* マスターデータエラー警告 */}
      {masterDataError && (
        <div className="fixed top-4 left-1/2 -translate-x-1/2 z-50 max-w-lg">
          <div className="bg-amber-50 border border-amber-200 text-amber-800 px-4 py-3 rounded-xl shadow-lg flex items-start gap-3">
            <svg className="w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
            </svg>
            <div className="flex-1">
              <p className="text-sm">{masterDataError}</p>
            </div>
            <button
              onClick={() => setMasterDataError(null)}
              className="text-amber-500 hover:text-amber-700"
            >
              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
        </div>
      )}
      
      {/* メイン */}
      <main className="max-w-7xl mx-auto px-4 py-6">
        {view === 'input' ? (
          <div className="space-y-6">
            <InputForm 
              data={currentData} 
              onChange={setCurrentData}
              onStartDiagnosis={() => {
                // 自動保存してから診断開始
                handleSave(true);
                setShowAIDiagnosis(true);
              }}
              onImportPreInput={handleImportPreInput}
            />
          </div>
        ) : view === 'database' ? (
          <div>
            {/* 顧客データ読み込みエラー表示 */}
            {customerLoadError && (
              <div className="mb-4 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-xl flex items-center gap-3">
                <svg className="w-5 h-5 text-red-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
                <div className="flex-1">
                  <p className="text-sm font-medium">顧客データの読み込みに失敗しました</p>
                  <p className="text-xs mt-1 text-red-600">{customerLoadError}</p>
                </div>
                <button
                  onClick={() => setCustomerLoadRetry(prev => prev + 1)}
                  className="px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-700 text-sm rounded-lg font-medium transition"
                >
                  再読み込み
                </button>
              </div>
            )}
            {/* 顧客が0件でエラーなしの場合もリロードボタンを表示（GASモード） */}
            {isGasMode && customers.length === 0 && !customerLoadError && (
              <div className="mb-4 bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-xl flex items-center gap-3">
                <svg className="w-5 h-5 text-blue-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <p className="flex-1 text-sm">顧客データがありません。スプレッドシートにデータがある場合は再読み込みしてください。</p>
                <button
                  onClick={() => setCustomerLoadRetry(prev => prev + 1)}
                  className="px-3 py-1.5 bg-blue-100 hover:bg-blue-200 text-blue-700 text-sm rounded-lg font-medium transition"
                >
                  再読み込み
                </button>
              </div>
            )}
            <CustomerDatabase 
              customers={customers}
              onSelect={(c) => { handleSelect(c); setView('input'); }}
              onDelete={handleDelete}
              selectedId={currentData.id}
            />
          </div>
        ) : (
          <div className="space-y-6">
            <div className="flex justify-between items-center no-print">
              <h2 className="text-xl font-bold text-gray-800">診断結果プレビュー</h2>
              <button
                onClick={exportPDF}
                disabled={isExporting}
                className={`btn-ripple px-6 py-3 rounded-xl font-medium shadow-lg transition flex items-center gap-2 ${
                  isExporting
                    ? 'bg-gray-400 text-white cursor-wait'
                    : 'bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-600 hover:from-blue-600 hover:via-indigo-600 hover:to-purple-700 text-white'
                }`}
              >
                {isExporting && (
                  <svg className="w-4 h-4 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={2.5}>
                    <circle cx="12" cy="12" r="10" className="opacity-25" /><path d="M4 12a8 8 0 018-8" className="opacity-75" />
                  </svg>
                )}
                {isExporting ? '出力中...' : 'PDFで出力'}
              </button>
            </div>
            
            <div className="overflow-x-auto pb-4 flex justify-center">
              <DiagnosisSheet 
                ref={sheetRef} 
                data={currentData}
                aiSettings={aiSettings}
                aiAdvice={aiAdvice}
                onGenerateAI={handleGenerateAI}
                isGeneratingAI={isGeneratingAI}
                aiError={aiError}
              />
            </div>
          </div>
        )}
      </main>
      
      {/* サイドバナーボタン（診断結果画面でのみ表示） */}
      {view === 'result' && (
        <div className="side-banner-container no-print">
          {(aiSettings.sideButtons || DEFAULT_SIDE_BUTTONS).map((btn) => (
            <button
              key={btn.id}
              className={`side-banner-btn ${btn.id === 'btn4' ? 'pro-btn' : ''}`}
              onClick={() => handleSideButtonClick(btn.id)}
              disabled={isGeneratingAI}
            >
              {btn.label}
            </button>
          ))}
        </div>
      )}
      
      {/* Pro診断 決済確認モーダル */}
      {showProPaymentModal && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 no-print">
          <div className="bg-white rounded-2xl w-full max-w-md shadow-2xl mx-4 overflow-hidden">
            {/* ヘッダー */}
            <div className="bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 px-6 py-5">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-3">
                  <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                    <span className="text-2xl">👑</span>
                  </div>
                  <div>
                    <h3 className="text-xl font-bold text-white">Pro診断</h3>
                    <p className="text-xs text-blue-200">プレミアム診断サービス</p>
                  </div>
                </div>
                <button
                  onClick={() => setShowProPaymentModal(false)}
                  className="p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                    <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
            </div>
            
            {/* コンテンツ */}
            <div className="p-6">
              {/* 注意事項 */}
              <div className="mb-5 p-4 bg-amber-50 border border-amber-200 rounded-xl">
                <div className="flex items-start gap-3">
                  <svg className="w-6 h-6 text-amber-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                  </svg>
                  <div>
                    <div className="text-sm font-bold text-amber-800 mb-1">ご利用前の注意事項</div>
                    <ul className="text-xs text-amber-700 space-y-1">
                      <li>• Pro診断は有料サービスです</li>
                      <li>• 診断実行には決済番号が必要です</li>
                      <li>• 決済番号は事前にお支払い完了後に発行されます</li>
                      <li>• 1つの決済番号で1回のみ診断可能です</li>
                    </ul>
                  </div>
                </div>
              </div>
              
              {/* Pro診断の特徴 */}
              <div className="mb-5 p-4 bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl">
                <div className="text-sm font-bold text-blue-800 mb-2">✨ Pro診断の特徴</div>
                <ul className="text-xs text-blue-700 space-y-1">
                  <li>• コンサルタント視点の高度な分析</li>
                  <li>• ROI最大化のための投資戦略提案</li>
                  <li>• 競争優位性構築のための組織変革アドバイス</li>
                </ul>
              </div>
              
              {/* 決済番号入力 */}
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  決済番号 <span className="text-red-500">*</span>
                </label>
                <input
                  type="text"
                  value={proPaymentCode}
                  onChange={(e) => {
                    setProPaymentCode(e.target.value);
                    setProPaymentError('');
                  }}
                  className={`w-full px-4 py-3 border rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition ${
                    proPaymentError ? 'border-red-300 bg-red-50' : 'border-gray-200'
                  }`}
                  placeholder="例：PRO-XXXXXXXX"
                />
                {proPaymentError && (
                  <p className="mt-2 text-xs text-red-500 flex items-center gap-1">
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                    {proPaymentError}
                  </p>
                )}
                <p className="mt-2 text-xs text-gray-500">
                  決済完了後にメールで送付された番号を入力してください
                </p>
              </div>
            </div>
            
            {/* フッター */}
            <div className="px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3">
              <button
                onClick={() => setShowProPaymentModal(false)}
                className="px-5 py-2.5 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl font-medium transition"
              >
                キャンセル
              </button>
              <button
                onClick={handleProDiagnosisSubmit}
                className="px-6 py-2.5 bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 hover:from-blue-700 hover:via-indigo-700 hover:to-purple-700 text-white rounded-xl font-medium shadow-lg transition"
              >
                👑 Pro診断を実行
              </button>
            </div>
          </div>
        </div>
      )}
      
      {/* 再診断モーダル */}
      {showReDiagnosisModal && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 no-print">
          <div className="bg-white rounded-2xl w-full max-w-lg shadow-2xl mx-4 overflow-hidden">
            {/* ヘッダー */}
            <div className="bg-gradient-to-r from-blue-500 to-indigo-600 px-6 py-4">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                    <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                  </div>
                  <div>
                    <h3 className="text-lg font-bold text-white">再診断</h3>
                    <p className="text-xs text-blue-100">
                      {lastGeneratedButtonId && (aiSettings.sideButtons || DEFAULT_SIDE_BUTTONS).find(b => b.id === lastGeneratedButtonId)?.label || '診断'}をベースに再生成
                    </p>
                  </div>
                </div>
                <button
                  onClick={() => setShowReDiagnosisModal(false)}
                  className="p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                    <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
            </div>
            
            {/* コンテンツ */}
            <div className="p-6">
              <div className="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-xl">
                <div className="text-sm text-blue-800">
                  <span className="font-bold">
                    {(aiSettings.sideButtons || DEFAULT_SIDE_BUTTONS).find(b => b.id === lastGeneratedButtonId)?.label}
                  </span>
                  の診断結果をベースに、追加情報を加えて再診断します。
                </div>
              </div>
              
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  追加情報・指示（任意）
                </label>
                <textarea
                  value={reDiagnosisAdditionalInfo}
                  onChange={(e) => setReDiagnosisAdditionalInfo(e.target.value)}
                  className="w-full h-32 px-4 py-3 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition resize-none"
                  placeholder="例：&#10;・採用予算は年間500万円程度&#10;・中途採用よりも新卒採用を重視したい&#10;・地方企業なので首都圏との差別化が課題"
                />
                <p className="mt-2 text-xs text-gray-500">
                  追加の条件や詳細情報を入力すると、より具体的なアドバイスが生成されます。
                </p>
              </div>
            </div>
            
            {/* フッター */}
            <div className="px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3">
              <button
                onClick={() => setShowReDiagnosisModal(false)}
                className="px-5 py-2.5 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl font-medium transition"
              >
                キャンセル
              </button>
              <button
                onClick={handleReDiagnosis}
                className="px-6 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white rounded-xl font-medium shadow-lg transition flex items-center gap-2"
              >
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
                再診断を実行
              </button>
            </div>
          </div>
        </div>
      )}
      
      {/* AI生成ローディングオーバーレイ */}
      {isGeneratingAI && (
        <div className="ai-loading-overlay">
          <div className="ai-loading-card">
            <div className="text-xl font-bold text-gray-800 mb-1">
              {generatingButtonId === 'btn1' && lastGeneratedButtonId 
                ? `再診断`
                : (generatingButtonId && (aiSettings.sideButtons || DEFAULT_SIDE_BUTTONS).find(b => b.id === generatingButtonId)?.label || 'AI診断')
              }
            </div>
            <div className="text-gray-500 text-sm mb-6">
              {generatingButtonId === 'btn1' && lastGeneratedButtonId 
                ? `${(aiSettings.sideButtons || DEFAULT_SIDE_BUTTONS).find(b => b.id === lastGeneratedButtonId)?.label}ベース`
                : ''
              }
            </div>
            <div className="ai-loading-progress">
              <div className="ai-loading-progress-bar"></div>
            </div>
            <div className="text-sm text-gray-600 mt-5 ai-loading-status flex items-center justify-center">
              診断データを分析中
              <span className="ai-loading-dots">
                <span></span>
                <span></span>
                <span></span>
              </span>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

ReactDOM.render(<ToastProvider><App /></ToastProvider>, document.getElementById('root'));
  </script>
</body>
</html>
